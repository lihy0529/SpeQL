[
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,ss_store_sk as s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) as sumsales\n            from store_sales, date_dim, store, item\n       where ss_sold_date_sk = d_date_sk\n          and ss_item_sk = i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, ss_store_sk)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category\n  union all\n  select null as i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results)\n\nselect  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n     from results_rollup) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 11.080581,
                    "execution_time": 10.3551,
                    "compile_time": 0.000789,
                    "planning_time": 0.05387,
                    "create_size": 5632
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 21.784536,
                    "execution_time": 10.218933,
                    "compile_time": 10.713944,
                    "planning_time": 0.140513,
                    "create_size": 5632
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 16.014042,
                    "execution_time": 15.257504,
                    "compile_time": 0.001482,
                    "planning_time": 0.038429,
                    "create_size": 5790
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 27.811915,
                    "execution_time": 15.265412,
                    "compile_time": 13.828017,
                    "planning_time": 0.084692,
                    "create_size": 5787
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*     i_category          i_class                 i_brand                i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0         Women         swimwear        edu packamalg #2    antiableationcallypriought    2001      4     10         326   2928.00\n1      Children         toddlers       exportiexporti #2     antipricallyableableought    2002      2      5           1     39.69\n2   Electronics       automotive  edu packamalgamalg #16          priationn stcallypri    2001      3      8         124    322.56\n3        Sports           tennis         edu packmaxi #4           priantiesecallyanti    2001      3      8         376   7295.65\n4      Children          newborn         amalgexporti #2        n stoughtationoughtpri    2001      4     11         158    342.54\n5   Electronics           memory       univamalgamalg #2     ationeseoughtantieseought    2001      3      8         253   7709.37\n6        Sports         baseball      importonameless #4            pribarcallyeseeing    2001      4     12         278      0.00\n7         Shoes           womens        amalgedu pack #1     eingn stablecallyeseought    2002      2      4          26   1055.52\n8          Home  curtains/drapes       edu packbrand #10     n steseoughtbarcallyought    2001      3      9          25   2993.76\n9   Electronics      televisions       maxiunivamalg #10        antin stcallyationeing    2001      4     10         400    451.36\n10       Sports         baseball      importonameless #2         oughtn steingantieing    2001      4     12         220   1694.16\n11          Men            pants       exportiimporto #2  priationationcallycallyought    2002      2      4         100   4421.30\n12        Music        classical      edu packscholar #2                 prin stesepri    2001      4     11         116   1927.77\n13          Men           shirts       importoimporto #2          oughtbarableeinganti    2001      4     12          46   3866.82\n14      Jewelry           estate        edu packbrand #5         eingableeseoughtcally    2002      2      6         286   6809.39\n15         Home             rugs            corpbrand #6      antieingesepricallyought    2002      2      6         316   1117.92\n16      Jewelry     loose stones         exportibrand #8       prieingantieseeingought    2001      3      9          55    451.20\n17          Men            pants       exportiimporto #1   callyn stantieingoughtought    2002      2      4         370   7092.18\n18          Men   sports-apparel      edu packimporto #2     ationcallyeseprieingought    2001      4     10         373    802.23\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.095784,
                    "execution_time": 0.008303,
                    "compile_time": 0.076142,
                    "planning_time": 0.004495
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.384539,
                    "execution_time": 0.008524,
                    "compile_time": 3.323884,
                    "planning_time": 0.040397
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*     i_category          i_class                 i_brand                i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0         Women         swimwear        edu packamalg #2    antiableationcallypriought    2001      4     10         326   2928.00\n1      Children         toddlers       exportiexporti #2     antipricallyableableought    2002      2      5           1     39.69\n2   Electronics       automotive  edu packamalgamalg #16          priationn stcallypri    2001      3      8         124    322.56\n3        Sports           tennis         edu packmaxi #4           priantiesecallyanti    2001      3      8         376   7295.65\n4      Children          newborn         amalgexporti #2        n stoughtationoughtpri    2001      4     11         158    342.54\n5   Electronics           memory       univamalgamalg #2     ationeseoughtantieseought    2001      3      8         253   7709.37\n6        Sports         baseball      importonameless #4            pribarcallyeseeing    2001      4     12         278      0.00\n7         Shoes           womens        amalgedu pack #1     eingn stablecallyeseought    2002      2      4          26   1055.52\n8          Home  curtains/drapes       edu packbrand #10     n steseoughtbarcallyought    2001      3      9          25   2993.76\n9   Electronics      televisions       maxiunivamalg #10        antin stcallyationeing    2001      4     10         400    451.36\n10       Sports         baseball      importonameless #2         oughtn steingantieing    2001      4     12         220   1694.16\n11          Men            pants       exportiimporto #2  priationationcallycallyought    2002      2      4         100   4421.30\n12        Music        classical      edu packscholar #2                 prin stesepri    2001      4     11         116   1927.77\n13          Men           shirts       importoimporto #2          oughtbarableeinganti    2001      4     12          46   3866.82\n14      Jewelry           estate        edu packbrand #5         eingableeseoughtcally    2002      2      6         286   6809.39\n15         Home             rugs            corpbrand #6      antieingesepricallyought    2002      2      6         316   1117.92\n16      Jewelry     loose stones         exportibrand #8       prieingantieseeingought    2001      3      9          55    451.20\n17          Men            pants       exportiimporto #1   callyn stantieingoughtought    2002      2      4         370   7092.18\n18          Men   sports-apparel      edu packimporto #2     ationcallyeseprieingought    2001      4     10         373    802.23\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM RESULTS_ROLLUP LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,SS_STORE_SK as s_store_id\n                  ,sum(coalesce(SS_SALES_PRICE*SS_QUANTITY,0)) as sumsales\n            from store_sales ,date_dim ,store ,item\n       where  SS_SOLD_DATE_SK=d_date_sk\n          and SS_ITEM_SK=i_item_sk\n          and SS_STORE_SK = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, SS_STORE_SK)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category\n  union all\n  select null as i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n        from results_rollup) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*     i_category          i_class                 i_brand                i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0         Women         swimwear        edu packamalg #2    antiableationcallypriought    2001      4     10         326   2928.00\n1      Children         toddlers       exportiexporti #2     antipricallyableableought    2002      2      5           1     39.69\n2   Electronics       automotive  edu packamalgamalg #16          priationn stcallypri    2001      3      8         124    322.56\n3        Sports           tennis         edu packmaxi #4           priantiesecallyanti    2001      3      8         376   7295.65\n4      Children          newborn         amalgexporti #2        n stoughtationoughtpri    2001      4     11         158    342.54\n5   Electronics           memory       univamalgamalg #2     ationeseoughtantieseought    2001      3      8         253   7709.37\n6        Sports         baseball      importonameless #4            pribarcallyeseeing    2001      4     12         278      0.00\n7         Shoes           womens        amalgedu pack #1     eingn stablecallyeseought    2002      2      4          26   1055.52\n8          Home  curtains/drapes       edu packbrand #10     n steseoughtbarcallyought    2001      3      9          25   2993.76\n9   Electronics      televisions       maxiunivamalg #10        antin stcallyationeing    2001      4     10         400    451.36\n10       Sports         baseball      importonameless #2         oughtn steingantieing    2001      4     12         220   1694.16\n11          Men            pants       exportiimporto #2  priationationcallycallyought    2002      2      4         100   4421.30\n12        Music        classical      edu packscholar #2                 prin stesepri    2001      4     11         116   1927.77\n13          Men           shirts       importoimporto #2          oughtbarableeinganti    2001      4     12          46   3866.82\n14      Jewelry           estate        edu packbrand #5         eingableeseoughtcally    2002      2      6         286   6809.39\n15         Home             rugs            corpbrand #6      antieingesepricallyought    2002      2      6         316   1117.92\n16      Jewelry     loose stones         exportibrand #8       prieingantieseeingought    2001      3      9          55    451.20\n17          Men            pants       exportiimporto #1   callyn stantieingoughtought    2002      2      4         370   7092.18\n18          Men   sports-apparel      edu packimporto #2     ationcallyeseprieingought    2001      4     10         373    802.23\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019572,
                    "execution_time": 0.007988,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004611
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.067364,
                    "execution_time": 0.00929,
                    "compile_time": 0.034067,
                    "planning_time": 0.004842
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*     i_category          i_class                 i_brand                i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0         Women         swimwear        edu packamalg #2    antiableationcallypriought    2001      4     10         326   2928.00\n1      Children         toddlers       exportiexporti #2     antipricallyableableought    2002      2      5           1     39.69\n2   Electronics       automotive  edu packamalgamalg #16          priationn stcallypri    2001      3      8         124    322.56\n3        Sports           tennis         edu packmaxi #4           priantiesecallyanti    2001      3      8         376   7295.65\n4      Children          newborn         amalgexporti #2        n stoughtationoughtpri    2001      4     11         158    342.54\n5   Electronics           memory       univamalgamalg #2     ationeseoughtantieseought    2001      3      8         253   7709.37\n6        Sports         baseball      importonameless #4            pribarcallyeseeing    2001      4     12         278      0.00\n7         Shoes           womens        amalgedu pack #1     eingn stablecallyeseought    2002      2      4          26   1055.52\n8          Home  curtains/drapes       edu packbrand #10     n steseoughtbarcallyought    2001      3      9          25   2993.76\n9   Electronics      televisions       maxiunivamalg #10        antin stcallyationeing    2001      4     10         400    451.36\n10       Sports         baseball      importonameless #2         oughtn steingantieing    2001      4     12         220   1694.16\n11          Men            pants       exportiimporto #2  priationationcallycallyought    2002      2      4         100   4421.30\n12        Music        classical      edu packscholar #2                 prin stesepri    2001      4     11         116   1927.77\n13          Men           shirts       importoimporto #2          oughtbarableeinganti    2001      4     12          46   3866.82\n14      Jewelry           estate        edu packbrand #5         eingableeseoughtcally    2002      2      6         286   6809.39\n15         Home             rugs            corpbrand #6      antieingesepricallyought    2002      2      6         316   1117.92\n16      Jewelry     loose stones         exportibrand #8       prieingantieseeingought    2001      3      9          55    451.20\n17          Men            pants       exportiimporto #1   callyn stantieingoughtought    2002      2      4         370   7092.18\n18          Men   sports-apparel      edu packimporto #2     ationcallyeseprieingought    2001      4     10         373    802.23\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n/*CURSOR_IDENTIFIER*/, s_store_id, sumsales\n        from results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.415747,
                    "execution_time": 13.653349,
                    "compile_time": 0.000789,
                    "planning_time": 0.054718,
                    "create_size": 6400
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.995649,
                    "execution_time": 13.97923,
                    "compile_time": 0.180596,
                    "planning_time": 0.057297,
                    "create_size": 6400
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH RESULTS_ROLLUP AS ( SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" LIMIT 21",
                "preview": "\n/*     i_category          i_class                 i_brand               i_product_name  d_year  d_qoy        s_store_id  sumsales\n0        Sports           hockey        brandnameless #9          eingableeingbarn st    2002      1  AAAAAAAAKABAAAAA    120.60\n1         Music          country       importoscholar #2     priantin steseoughtought    2001      4  AAAAAAAACIAAAAAA   1410.21\n2   Electronics         monitors    importoamalgamalg #3            pribarprin steing    2001      4  AAAAAAAAOFAAAAAA   1508.57\n3   Electronics         monitors    importoamalgamalg #3  ationbarn stationationought    2001      4  AAAAAAAAKJAAAAAA   6450.18\n4         Women       fragrances         importoamalg #2            ationationprianti    2002      1  AAAAAAAALFAAAAAA   2147.16\n5       Jewelry           estate        edu packbrand #4   antioughtpriablecallyought    2002      1  AAAAAAAAIEBAAAAA    118.35\n6         Books          mystery        corpunivamalg #4   pricallyantioughteingought    2001      4  AAAAAAAAAIAAAAAA    401.96\n7           Men           shirts       importoimporto #2         ationpricallyantiese    2001      3  AAAAAAAAACAAAAAA    139.23\n8   Electronics       automotive  edu packamalgamalg #15     priantiprioughteingought    2001      3  AAAAAAAALCAAAAAA   2191.64\n9         Music        classical      edu packscholar #2    ationeseanticallyeseought    2002      1  AAAAAAAAEMAAAAAA   1344.72\n10         Home           accent        amalgnameless #4        priesepriablebarought    2001      4  AAAAAAAALOAAAAAA   1962.24\n11  Electronics       camcorders    importounivamalg #11    antieseablen stcallyought    2001      4  AAAAAAAALHBAAAAA      0.18\n12  Electronics          musical       corpunivamalg #17         prioughtantieinganti    2001      3  AAAAAAAAGNAAAAAA   1346.19\n13     Children         toddlers       exportiexporti #2           n stablebarprin st    2001      4  AAAAAAAALLAAAAAA   3097.00\n14        Music        classical      edu packscholar #2   priationationeseoughtought    2001      4  AAAAAAAACPAAAAAA   5927.72\n15     Children  school-uniforms      edu packexporti #2      ationationcallyablen st    2001      3  AAAAAAAAIEBAAAAA   1874.25\n16         Home          bedding         importobrand #6        antiantiationpriation    2002      1  AAAAAAAAGGBAAAAA   1672.43\n17        Books        self-help     exportiunivamalg #6       n stbareingeseeseought    2001      4  AAAAAAAAPDBAAAAA   1686.70\n18       Sports            pools             univmaxi #2  oughtn stoughtbarcallyought    2001      3  AAAAAAAAMLAAAAAA    542.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 10.749483,
                    "execution_time": 10.680116,
                    "compile_time": 0.000959,
                    "planning_time": 0.040503
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 17.563694,
                    "execution_time": 10.708157,
                    "compile_time": 7.130932,
                    "planning_time": 0.097032
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH RESULTS_ROLLUP AS ( SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\"",
                "rewrite": "WITH RESULTS_ROLLUP AS ( SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
            }
        ],
        "preview": "\n/*     i_category          i_class                 i_brand               i_product_name  d_year  d_qoy        s_store_id  sumsales\n0        Sports           hockey        brandnameless #9          eingableeingbarn st    2002      1  AAAAAAAAKABAAAAA    120.60\n1         Music          country       importoscholar #2     priantin steseoughtought    2001      4  AAAAAAAACIAAAAAA   1410.21\n2   Electronics         monitors    importoamalgamalg #3            pribarprin steing    2001      4  AAAAAAAAOFAAAAAA   1508.57\n3   Electronics         monitors    importoamalgamalg #3  ationbarn stationationought    2001      4  AAAAAAAAKJAAAAAA   6450.18\n4         Women       fragrances         importoamalg #2            ationationprianti    2002      1  AAAAAAAALFAAAAAA   2147.16\n5       Jewelry           estate        edu packbrand #4   antioughtpriablecallyought    2002      1  AAAAAAAAIEBAAAAA    118.35\n6         Books          mystery        corpunivamalg #4   pricallyantioughteingought    2001      4  AAAAAAAAAIAAAAAA    401.96\n7           Men           shirts       importoimporto #2         ationpricallyantiese    2001      3  AAAAAAAAACAAAAAA    139.23\n8   Electronics       automotive  edu packamalgamalg #15     priantiprioughteingought    2001      3  AAAAAAAALCAAAAAA   2191.64\n9         Music        classical      edu packscholar #2    ationeseanticallyeseought    2002      1  AAAAAAAAEMAAAAAA   1344.72\n10         Home           accent        amalgnameless #4        priesepriablebarought    2001      4  AAAAAAAALOAAAAAA   1962.24\n11  Electronics       camcorders    importounivamalg #11    antieseablen stcallyought    2001      4  AAAAAAAALHBAAAAA      0.18\n12  Electronics          musical       corpunivamalg #17         prioughtantieinganti    2001      3  AAAAAAAAGNAAAAAA   1346.19\n13     Children         toddlers       exportiexporti #2           n stablebarprin st    2001      4  AAAAAAAALLAAAAAA   3097.00\n14        Music        classical      edu packscholar #2   priationationeseoughtought    2001      4  AAAAAAAACPAAAAAA   5927.72\n15     Children  school-uniforms      edu packexporti #2      ationationcallyablen st    2001      3  AAAAAAAAIEBAAAAA   1874.25\n16         Home          bedding         importobrand #6        antiantiationpriation    2002      1  AAAAAAAAGGBAAAAA   1672.43\n17        Books        self-help     exportiunivamalg #6       n stbareingeseeseought    2001      4  AAAAAAAAPDBAAAAA   1686.70\n18       Sports            pools             univmaxi #2  oughtn stoughtbarcallyought    2001      3  AAAAAAAAMLAAAAAA    542.36\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n/*CURSOR_IDENTIFIER*/, s_store_id, sumsales\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 17.103676,
                    "execution_time": 16.365354,
                    "compile_time": 0.001398,
                    "planning_time": 0.041449,
                    "create_size": 6555
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 27.970127,
                    "execution_time": 16.34534,
                    "compile_time": 11.461389,
                    "planning_time": 0.084071,
                    "create_size": 6557
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class               i_brand                i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0           Men      accessories       amalgimporto #2      ationpripricallyeseought    2001      3      8  AAAAAAAAPNAAAAAA    545.88\n1       Jewelry          costume       importobrand #6        antiesebarprieingought    2002      1      1  AAAAAAAAPABAAAAA   6197.80\n2           Men           shirts     importoimporto #2    oughtantin stpriationought    2001      3      8  AAAAAAAAOOAAAAAA   2435.40\n3          Home       mattresses          maxibrand #8   ationoughtprieingoughtought    2002      1      3  AAAAAAAAJHAAAAAA    455.80\n4   Electronics           karoke  scholarunivamalg #17  oughteseationationoughtought    2002      1      3  AAAAAAAAGCAAAAAA   7603.05\n5         Books        parenting           corpmaxi #4      ationeingbarbareingought    2001      3      8  AAAAAAAANIBAAAAA   7198.17\n6         Women        maternity       exportiamalg #2        pripriantiantipriought    2001      3      9  AAAAAAAAMLAAAAAA   7628.64\n7   Electronics           karoke  scholarunivamalg #15       priprieseeingcallyought    2001      3      8  AAAAAAAAEIBAAAAA    300.32\n8      Children  school-uniforms    edu packexporti #2     ationbarableoughtbarought    2001      3      9  AAAAAAAAGDBAAAAA    714.47\n9      Children         toddlers     exportiexporti #2       pribarbaroughtantiought    2001      4     10  AAAAAAAADKAAAAAA   5949.90\n10        Music             rock       amalgscholar #2       antiablen stesebarought    2002      3      7  AAAAAAAAHGAAAAAA   2348.64\n11  Electronics          musical     corpunivamalg #14     anticallyoughtbarpriought    2001      4     12  AAAAAAAAICAAAAAA    352.35\n12          Men   sports-apparel    edu packimporto #2         anticallyableationese    2001      4     12  AAAAAAAAGGBAAAAA    635.12\n13        Shoes           womens      amalgedu pack #2     ationationeseoughtbarable    2001      3      8  AAAAAAAAIFAAAAAA    342.00\n14         Home       mattresses          maxibrand #5      esen steseoughteingought    2002      1      3  AAAAAAAAPABAAAAA   3887.40\n15        Shoes             kids    exportiedu pack #2        antipripriprin stought    2001      4     12  AAAAAAAAGDBAAAAA  10365.42\n16      Jewelry    jewelry boxes          univbrand #4       priableationbarpriought    2002      1      1  AAAAAAAACIAAAAAA    551.70\n17          Men   sports-apparel    edu packimporto #2              antin stpriought    2002      1      2  AAAAAAAAIAAAAAAA   5301.12\n18         Home           tables    scholarnameless #9     eingeseantieingoughtought    2002      1      3  AAAAAAAAGHAAAAAA   1903.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.08103,
                    "execution_time": 0.008158,
                    "compile_time": 0.062022,
                    "planning_time": 0.004219
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.160797,
                    "execution_time": 0.008354,
                    "compile_time": 3.101889,
                    "planning_time": 0.040153
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class               i_brand                i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0           Men      accessories       amalgimporto #2      ationpripricallyeseought    2001      3      8  AAAAAAAAPNAAAAAA    545.88\n1       Jewelry          costume       importobrand #6        antiesebarprieingought    2002      1      1  AAAAAAAAPABAAAAA   6197.80\n2           Men           shirts     importoimporto #2    oughtantin stpriationought    2001      3      8  AAAAAAAAOOAAAAAA   2435.40\n3          Home       mattresses          maxibrand #8   ationoughtprieingoughtought    2002      1      3  AAAAAAAAJHAAAAAA    455.80\n4   Electronics           karoke  scholarunivamalg #17  oughteseationationoughtought    2002      1      3  AAAAAAAAGCAAAAAA   7603.05\n5         Books        parenting           corpmaxi #4      ationeingbarbareingought    2001      3      8  AAAAAAAANIBAAAAA   7198.17\n6         Women        maternity       exportiamalg #2        pripriantiantipriought    2001      3      9  AAAAAAAAMLAAAAAA   7628.64\n7   Electronics           karoke  scholarunivamalg #15       priprieseeingcallyought    2001      3      8  AAAAAAAAEIBAAAAA    300.32\n8      Children  school-uniforms    edu packexporti #2     ationbarableoughtbarought    2001      3      9  AAAAAAAAGDBAAAAA    714.47\n9      Children         toddlers     exportiexporti #2       pribarbaroughtantiought    2001      4     10  AAAAAAAADKAAAAAA   5949.90\n10        Music             rock       amalgscholar #2       antiablen stesebarought    2002      3      7  AAAAAAAAHGAAAAAA   2348.64\n11  Electronics          musical     corpunivamalg #14     anticallyoughtbarpriought    2001      4     12  AAAAAAAAICAAAAAA    352.35\n12          Men   sports-apparel    edu packimporto #2         anticallyableationese    2001      4     12  AAAAAAAAGGBAAAAA    635.12\n13        Shoes           womens      amalgedu pack #2     ationationeseoughtbarable    2001      3      8  AAAAAAAAIFAAAAAA    342.00\n14         Home       mattresses          maxibrand #5      esen steseoughteingought    2002      1      3  AAAAAAAAPABAAAAA   3887.40\n15        Shoes             kids    exportiedu pack #2        antipripriprin stought    2001      4     12  AAAAAAAAGDBAAAAA  10365.42\n16      Jewelry    jewelry boxes          univbrand #4       priableationbarpriought    2002      1      1  AAAAAAAACIAAAAAA    551.70\n17          Men   sports-apparel    edu packimporto #2              antin stpriought    2002      1      2  AAAAAAAAIAAAAAAA   5301.12\n18         Home           tables    scholarnameless #9     eingeseantieingoughtought    2002      1      3  AAAAAAAAGHAAAAAA   1903.85\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n/*CURSOR_IDENTIFIER*/, sumsales\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class               i_brand               i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0         Shoes           womens      amalgedu pack #2         oughtbaroughtbareing    2001      4     12  AAAAAAAAOBBAAAAA   5042.52\n1      Children  school-uniforms    edu packexporti #2          n steingeingn stese    2001      4     11  AAAAAAAAIEBAAAAA     61.22\n2         Music             rock       amalgscholar #2            prieseantieingese    2002      1      2  AAAAAAAANIBAAAAA   1231.92\n3         Shoes           womens      amalgedu pack #2          pricallypriableable    2002      3      7  AAAAAAAAGKAAAAAA    841.35\n4   Electronics          musical      corpunivamalg #6              pricallybareing    2001      3      8  AAAAAAAAOGAAAAAA    967.20\n5         Women          dresses         amalgamalg #1      eingoughtcallyantiation    2002      1      3  AAAAAAAACFAAAAAA      5.95\n6         Women       fragrances       importoamalg #2  antipricallyationationought    2001      4     11  AAAAAAAAGHAAAAAA   4515.74\n7         Music          country     importoscholar #2     antioughtantipribarought    2001      3      9  AAAAAAAALHBAAAAA     17.60\n8           Men            pants     exportiimporto #2          pricallyantiantipri    2002      2      6  AAAAAAAAHCBAAAAA    482.12\n9           Men      accessories       amalgimporto #2    ationeseantipriationought    2001      4     10  AAAAAAAANAAAAAAA    345.78\n10     Children          newborn       amalgexporti #1     eingationableablebarable    2002      2      5  AAAAAAAAFIAAAAAA    173.71\n11        Women          dresses         amalgamalg #2         antiableationbarable    2001      4     11  AAAAAAAAMKAAAAAA     20.40\n12        Books   entertainments       edu packmaxi #4        antiationantiationpri    2002      2      5  AAAAAAAAIGAAAAAA    760.00\n13          Men            pants     exportiimporto #1     barbaroughtantiableought    2002      2      4  AAAAAAAANAAAAAAA   4300.32\n14        Books        self-help  exportiunivamalg #10          ationprin stpriable    2002      1      3  AAAAAAAAKDBAAAAA   1687.68\n15     Children         toddlers     exportiexporti #2  antioughtanticallyn stought    2002      1      3  AAAAAAAAAFAAAAAA   1022.31\n16          Men            pants     exportiimporto #1     barcallyablebarn stought    2002      1      2  AAAAAAAAOIBAAAAA   1064.37\n17       Sports             golf           corpmaxi #8             ationn stbarable    2002      2      5  AAAAAAAAODAAAAAA   3655.41\n18        Shoes         athletic   edu packedu pack #2     antiationeingbarpriought    2001      4     12  AAAAAAAAGHAAAAAA    869.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019669,
                    "execution_time": 0.008745,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004285
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019087,
                    "execution_time": 0.008244,
                    "compile_time": 5e-05,
                    "planning_time": 0.004172
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class               i_brand               i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0         Shoes           womens      amalgedu pack #2         oughtbaroughtbareing    2001      4     12  AAAAAAAAOBBAAAAA   5042.52\n1      Children  school-uniforms    edu packexporti #2          n steingeingn stese    2001      4     11  AAAAAAAAIEBAAAAA     61.22\n2         Music             rock       amalgscholar #2            prieseantieingese    2002      1      2  AAAAAAAANIBAAAAA   1231.92\n3         Shoes           womens      amalgedu pack #2          pricallypriableable    2002      3      7  AAAAAAAAGKAAAAAA    841.35\n4   Electronics          musical      corpunivamalg #6              pricallybareing    2001      3      8  AAAAAAAAOGAAAAAA    967.20\n5         Women          dresses         amalgamalg #1      eingoughtcallyantiation    2002      1      3  AAAAAAAACFAAAAAA      5.95\n6         Women       fragrances       importoamalg #2  antipricallyationationought    2001      4     11  AAAAAAAAGHAAAAAA   4515.74\n7         Music          country     importoscholar #2     antioughtantipribarought    2001      3      9  AAAAAAAALHBAAAAA     17.60\n8           Men            pants     exportiimporto #2          pricallyantiantipri    2002      2      6  AAAAAAAAHCBAAAAA    482.12\n9           Men      accessories       amalgimporto #2    ationeseantipriationought    2001      4     10  AAAAAAAANAAAAAAA    345.78\n10     Children          newborn       amalgexporti #1     eingationableablebarable    2002      2      5  AAAAAAAAFIAAAAAA    173.71\n11        Women          dresses         amalgamalg #2         antiableationbarable    2001      4     11  AAAAAAAAMKAAAAAA     20.40\n12        Books   entertainments       edu packmaxi #4        antiationantiationpri    2002      2      5  AAAAAAAAIGAAAAAA    760.00\n13          Men            pants     exportiimporto #1     barbaroughtantiableought    2002      2      4  AAAAAAAANAAAAAAA   4300.32\n14        Books        self-help  exportiunivamalg #10          ationprin stpriable    2002      1      3  AAAAAAAAKDBAAAAA   1687.68\n15     Children         toddlers     exportiexporti #2  antioughtanticallyn stought    2002      1      3  AAAAAAAAAFAAAAAA   1022.31\n16          Men            pants     exportiimporto #1     barcallyablebarn stought    2002      1      2  AAAAAAAAOIBAAAAA   1064.37\n17       Sports             golf           corpmaxi #8             ationn stbarable    2002      2      5  AAAAAAAAODAAAAAA   3655.41\n18        Shoes         athletic   edu packedu pack #2     antiationeingbarpriought    2001      4     12  AAAAAAAAGHAAAAAA    869.85\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class               i_brand                i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0           Men      accessories       amalgimporto #2      ationpripricallyeseought    2001      3      8  AAAAAAAAPNAAAAAA    545.88\n1       Jewelry          costume       importobrand #6        antiesebarprieingought    2002      1      1  AAAAAAAAPABAAAAA   6197.80\n2           Men           shirts     importoimporto #2    oughtantin stpriationought    2001      3      8  AAAAAAAAOOAAAAAA   2435.40\n3          Home       mattresses          maxibrand #8   ationoughtprieingoughtought    2002      1      3  AAAAAAAAJHAAAAAA    455.80\n4   Electronics           karoke  scholarunivamalg #17  oughteseationationoughtought    2002      1      3  AAAAAAAAGCAAAAAA   7603.05\n5         Books        parenting           corpmaxi #4      ationeingbarbareingought    2001      3      8  AAAAAAAANIBAAAAA   7198.17\n6         Women        maternity       exportiamalg #2        pripriantiantipriought    2001      3      9  AAAAAAAAMLAAAAAA   7628.64\n7   Electronics           karoke  scholarunivamalg #15       priprieseeingcallyought    2001      3      8  AAAAAAAAEIBAAAAA    300.32\n8      Children  school-uniforms    edu packexporti #2     ationbarableoughtbarought    2001      3      9  AAAAAAAAGDBAAAAA    714.47\n9      Children         toddlers     exportiexporti #2       pribarbaroughtantiought    2001      4     10  AAAAAAAADKAAAAAA   5949.90\n10        Music             rock       amalgscholar #2       antiablen stesebarought    2002      3      7  AAAAAAAAHGAAAAAA   2348.64\n11  Electronics          musical     corpunivamalg #14     anticallyoughtbarpriought    2001      4     12  AAAAAAAAICAAAAAA    352.35\n12          Men   sports-apparel    edu packimporto #2         anticallyableationese    2001      4     12  AAAAAAAAGGBAAAAA    635.12\n13        Shoes           womens      amalgedu pack #2     ationationeseoughtbarable    2001      3      8  AAAAAAAAIFAAAAAA    342.00\n14         Home       mattresses          maxibrand #5      esen steseoughteingought    2002      1      3  AAAAAAAAPABAAAAA   3887.40\n15        Shoes             kids    exportiedu pack #2        antipripriprin stought    2001      4     12  AAAAAAAAGDBAAAAA  10365.42\n16      Jewelry    jewelry boxes          univbrand #4       priableationbarpriought    2002      1      1  AAAAAAAACIAAAAAA    551.70\n17          Men   sports-apparel    edu packimporto #2              antin stpriought    2002      1      2  AAAAAAAAIAAAAAAA   5301.12\n18         Home           tables    scholarnameless #9     eingeseantieingoughtought    2002      1      3  AAAAAAAAGHAAAAAA   1903.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.110472,
                    "execution_time": 0.008029,
                    "compile_time": 0.091471,
                    "planning_time": 0.004271
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019486,
                    "execution_time": 0.008377,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004355
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class               i_brand                i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0           Men      accessories       amalgimporto #2      ationpripricallyeseought    2001      3      8  AAAAAAAAPNAAAAAA    545.88\n1       Jewelry          costume       importobrand #6        antiesebarprieingought    2002      1      1  AAAAAAAAPABAAAAA   6197.80\n2           Men           shirts     importoimporto #2    oughtantin stpriationought    2001      3      8  AAAAAAAAOOAAAAAA   2435.40\n3          Home       mattresses          maxibrand #8   ationoughtprieingoughtought    2002      1      3  AAAAAAAAJHAAAAAA    455.80\n4   Electronics           karoke  scholarunivamalg #17  oughteseationationoughtought    2002      1      3  AAAAAAAAGCAAAAAA   7603.05\n5         Books        parenting           corpmaxi #4      ationeingbarbareingought    2001      3      8  AAAAAAAANIBAAAAA   7198.17\n6         Women        maternity       exportiamalg #2        pripriantiantipriought    2001      3      9  AAAAAAAAMLAAAAAA   7628.64\n7   Electronics           karoke  scholarunivamalg #15       priprieseeingcallyought    2001      3      8  AAAAAAAAEIBAAAAA    300.32\n8      Children  school-uniforms    edu packexporti #2     ationbarableoughtbarought    2001      3      9  AAAAAAAAGDBAAAAA    714.47\n9      Children         toddlers     exportiexporti #2       pribarbaroughtantiought    2001      4     10  AAAAAAAADKAAAAAA   5949.90\n10        Music             rock       amalgscholar #2       antiablen stesebarought    2002      3      7  AAAAAAAAHGAAAAAA   2348.64\n11  Electronics          musical     corpunivamalg #14     anticallyoughtbarpriought    2001      4     12  AAAAAAAAICAAAAAA    352.35\n12          Men   sports-apparel    edu packimporto #2         anticallyableationese    2001      4     12  AAAAAAAAGGBAAAAA    635.12\n13        Shoes           womens      amalgedu pack #2     ationationeseoughtbarable    2001      3      8  AAAAAAAAIFAAAAAA    342.00\n14         Home       mattresses          maxibrand #5      esen steseoughteingought    2002      1      3  AAAAAAAAPABAAAAA   3887.40\n15        Shoes             kids    exportiedu pack #2        antipripriprin stought    2001      4     12  AAAAAAAAGDBAAAAA  10365.42\n16      Jewelry    jewelry boxes          univbrand #4       priableationbarpriought    2002      1      1  AAAAAAAACIAAAAAA    551.70\n17          Men   sports-apparel    edu packimporto #2              antin stpriought    2002      1      2  AAAAAAAAIAAAAAAA   5301.12\n18         Home           tables    scholarnameless #9     eingeseantieingoughtought    2002      1      3  AAAAAAAAGHAAAAAA   1903.85\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category    i_class             i_brand i_product_name  d_year d_qoy d_moy s_store_id      sumsales  rk\n0       Music       None                None           None     NaN  None  None       None  1.007963e+10   1\n1       Music       rock                None           None     NaN  None  None       None  2.551177e+09   2\n2       Music  classical                None           None     NaN  None  None       None  2.531438e+09   3\n3       Music    country                None           None     NaN  None  None       None  2.500641e+09   4\n4       Music        pop                None           None     NaN  None  None       None  2.476372e+09   5\n5       Music       rock     amalgscholar #2           None     NaN  None  None       None  2.268973e+09   6\n6       Music  classical  edu packscholar #2           None     NaN  None  None       None  2.258491e+09   7\n7       Music    country   importoscholar #2           None     NaN  None  None       None  2.225397e+09   8\n8       Music        pop   exportischolar #2           None     NaN  None  None       None  2.201648e+09   9\n9       Music       rock     amalgscholar #1           None     NaN  None  None       None  2.792154e+08  10\n10      Music    country   importoscholar #1           None     NaN  None  None       None  2.731414e+08  11\n11      Music        pop   exportischolar #1           None     NaN  None  None       None  2.726440e+08  12\n12      Music  classical  edu packscholar #1           None     NaN  None  None       None  2.719602e+08  13\n13      Music                           None           None     NaN  None  None       None  2.000785e+07  14\n14      Music                                          None     NaN  None  None       None  8.588672e+06  15\n15      Music                                                   NaN  None  None       None  5.117487e+06  16\n16      Music                                                2001.0  None  None       None  3.235923e+06  17\n17      Music              exportischolar #2           None     NaN  None  None       None  3.193422e+06  18\n18      Music       rock                               None     NaN  None  None       None  2.988398e+06  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 13.07858,
                    "execution_time": 13.06526,
                    "compile_time": 0.000101,
                    "planning_time": 0.0051
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 19.345994,
                    "execution_time": 16.024846,
                    "compile_time": 4.635747,
                    "planning_time": 0.040713
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category    i_class             i_brand i_product_name  d_year d_qoy d_moy s_store_id      sumsales  rk\n0       Music       None                None           None     NaN  None  None       None  1.007963e+10   1\n1       Music       rock                None           None     NaN  None  None       None  2.551177e+09   2\n2       Music  classical                None           None     NaN  None  None       None  2.531438e+09   3\n3       Music    country                None           None     NaN  None  None       None  2.500641e+09   4\n4       Music        pop                None           None     NaN  None  None       None  2.476372e+09   5\n5       Music       rock     amalgscholar #2           None     NaN  None  None       None  2.268973e+09   6\n6       Music  classical  edu packscholar #2           None     NaN  None  None       None  2.258491e+09   7\n7       Music    country   importoscholar #2           None     NaN  None  None       None  2.225397e+09   8\n8       Music        pop   exportischolar #2           None     NaN  None  None       None  2.201648e+09   9\n9       Music       rock     amalgscholar #1           None     NaN  None  None       None  2.792154e+08  10\n10      Music    country   importoscholar #1           None     NaN  None  None       None  2.731414e+08  11\n11      Music        pop   exportischolar #1           None     NaN  None  None       None  2.726440e+08  12\n12      Music  classical  edu packscholar #1           None     NaN  None  None       None  2.719602e+08  13\n13      Music                           None           None     NaN  None  None       None  2.000785e+07  14\n14      Music                                          None     NaN  None  None       None  8.588672e+06  15\n15      Music                                                   NaN  None  None       None  5.117487e+06  16\n16      Music                                                2001.0  None  None       None  3.235923e+06  17\n17      Music              exportischolar #2           None     NaN  None  None       None  3.193422e+06  18\n18      Music       rock                               None     NaN  None  None       None  2.988398e+06  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class             i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0   Electronics             None                None           None   None  None  None       None  1.006937e+10   1\n1   Electronics      televisions                None           None   None  None  None       None  6.705877e+08   2\n2   Electronics         personal                None           None   None  None  None       None  6.690000e+08   3\n3   Electronics           memory                None           None   None  None  None       None  6.522748e+08   4\n4   Electronics           karoke                None           None   None  None  None       None  6.469813e+08   5\n5   Electronics  dvd/vcr players                None           None   None  None  None       None  6.462968e+08   6\n6   Electronics         scanners                None           None   None  None  None       None  6.434170e+08   7\n7   Electronics         monitors                None           None   None  None  None       None  6.396661e+08   8\n8   Electronics      disk drives                None           None   None  None  None       None  6.314665e+08   9\n9   Electronics       camcorders                None           None   None  None  None       None  6.230023e+08  10\n10  Electronics           stereo                None           None   None  None  None       None  6.195787e+08  11\n11  Electronics          musical                None           None   None  None  None       None  6.164511e+08  12\n12  Electronics            audio                None           None   None  None  None       None  6.071756e+08  13\n13  Electronics         portable                None           None   None  None  None       None  6.032595e+08  14\n14  Electronics          cameras                None           None   None  None  None       None  6.030559e+08  15\n15  Electronics       automotive                None           None   None  None  None       None  6.013666e+08  16\n16  Electronics         wireless                None           None   None  None  None       None  5.861731e+08  17\n17  Electronics         personal  brandunivamalg #11           None   None  None  None       None  5.534263e+07  18\n18  Electronics          cameras  amalgunivamalg #16           None   None  None  None       None  5.199091e+07  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 14.629548,
                    "execution_time": 14.616282,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.005184
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 13.088459,
                    "execution_time": 13.074723,
                    "compile_time": 0.000113,
                    "planning_time": 0.005384
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class             i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0   Electronics             None                None           None   None  None  None       None  1.006937e+10   1\n1   Electronics      televisions                None           None   None  None  None       None  6.705877e+08   2\n2   Electronics         personal                None           None   None  None  None       None  6.690000e+08   3\n3   Electronics           memory                None           None   None  None  None       None  6.522748e+08   4\n4   Electronics           karoke                None           None   None  None  None       None  6.469813e+08   5\n5   Electronics  dvd/vcr players                None           None   None  None  None       None  6.462968e+08   6\n6   Electronics         scanners                None           None   None  None  None       None  6.434170e+08   7\n7   Electronics         monitors                None           None   None  None  None       None  6.396661e+08   8\n8   Electronics      disk drives                None           None   None  None  None       None  6.314665e+08   9\n9   Electronics       camcorders                None           None   None  None  None       None  6.230023e+08  10\n10  Electronics           stereo                None           None   None  None  None       None  6.195787e+08  11\n11  Electronics          musical                None           None   None  None  None       None  6.164511e+08  12\n12  Electronics            audio                None           None   None  None  None       None  6.071756e+08  13\n13  Electronics         portable                None           None   None  None  None       None  6.032595e+08  14\n14  Electronics          cameras                None           None   None  None  None       None  6.030559e+08  15\n15  Electronics       automotive                None           None   None  None  None       None  6.013666e+08  16\n16  Electronics         wireless                None           None   None  None  None       None  5.861731e+08  17\n17  Electronics         personal  brandunivamalg #11           None   None  None  None       None  5.534263e+07  18\n18  Electronics          cameras  amalgunivamalg #16           None   None  None  None       None  5.199091e+07  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 21.45387,
                    "execution_time": 21.389,
                    "compile_time": 0.000564,
                    "planning_time": 0.004921,
                    "create_size": 6383
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 22.225214,
                    "execution_time": 21.911028,
                    "compile_time": 4.70479,
                    "planning_time": 0.121937,
                    "create_size": 6383
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.176839,
                    "execution_time": 0.060969,
                    "compile_time": 0.081853,
                    "planning_time": 0.00616,
                    "create_size": 286
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.426506,
                    "execution_time": 0.073226,
                    "compile_time": 7.254594,
                    "planning_time": 0.063468,
                    "create_size": 286
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*     i_category          i_class             i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0   Electronics             None                None           None   None  None  None       None  1.006937e+10   1\n1   Electronics      televisions                None           None   None  None  None       None  6.705877e+08   2\n2   Electronics         personal                None           None   None  None  None       None  6.690000e+08   3\n3   Electronics           memory                None           None   None  None  None       None  6.522748e+08   4\n4   Electronics           karoke                None           None   None  None  None       None  6.469813e+08   5\n5   Electronics  dvd/vcr players                None           None   None  None  None       None  6.462968e+08   6\n6   Electronics         scanners                None           None   None  None  None       None  6.434170e+08   7\n7   Electronics         monitors                None           None   None  None  None       None  6.396661e+08   8\n8   Electronics      disk drives                None           None   None  None  None       None  6.314665e+08   9\n9   Electronics       camcorders                None           None   None  None  None       None  6.230023e+08  10\n10  Electronics           stereo                None           None   None  None  None       None  6.195787e+08  11\n11  Electronics          musical                None           None   None  None  None       None  6.164511e+08  12\n12  Electronics            audio                None           None   None  None  None       None  6.071756e+08  13\n13  Electronics         portable                None           None   None  None  None       None  6.032595e+08  14\n14  Electronics          cameras                None           None   None  None  None       None  6.030559e+08  15\n15  Electronics       automotive                None           None   None  None  None       None  6.013666e+08  16\n16  Electronics         wireless                None           None   None  None  None       None  5.861731e+08  17\n17  Electronics         personal  brandunivamalg #11           None   None  None  None       None  5.534263e+07  18\n18  Electronics          cameras  amalgunivamalg #16           None   None  None  None       None  5.199091e+07  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.099914,
                    "execution_time": 0.007886,
                    "compile_time": 0.079004,
                    "planning_time": 0.005837
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.321277,
                    "execution_time": 0.007963,
                    "compile_time": 3.2608,
                    "planning_time": 0.041273
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*     i_category          i_class             i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0   Electronics             None                None           None   None  None  None       None  1.006937e+10   1\n1   Electronics      televisions                None           None   None  None  None       None  6.705877e+08   2\n2   Electronics         personal                None           None   None  None  None       None  6.690000e+08   3\n3   Electronics           memory                None           None   None  None  None       None  6.522748e+08   4\n4   Electronics           karoke                None           None   None  None  None       None  6.469813e+08   5\n5   Electronics  dvd/vcr players                None           None   None  None  None       None  6.462968e+08   6\n6   Electronics         scanners                None           None   None  None  None       None  6.434170e+08   7\n7   Electronics         monitors                None           None   None  None  None       None  6.396661e+08   8\n8   Electronics      disk drives                None           None   None  None  None       None  6.314665e+08   9\n9   Electronics       camcorders                None           None   None  None  None       None  6.230023e+08  10\n10  Electronics           stereo                None           None   None  None  None       None  6.195787e+08  11\n11  Electronics          musical                None           None   None  None  None       None  6.164511e+08  12\n12  Electronics            audio                None           None   None  None  None       None  6.071756e+08  13\n13  Electronics         portable                None           None   None  None  None       None  6.032595e+08  14\n14  Electronics          cameras                None           None   None  None  None       None  6.030559e+08  15\n15  Electronics       automotive                None           None   None  None  None       None  6.013666e+08  16\n16  Electronics         wireless                None           None   None  None  None       None  5.861731e+08  17\n17  Electronics         personal  brandunivamalg #11           None   None  None  None       None  5.534263e+07  18\n18  Electronics          cameras  amalgunivamalg #16           None   None  None  None       None  5.199091e+07  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" LIMIT 21",
                "preview": "\n/*   i_category   i_class i_brand i_product_name  d_year  d_qoy  d_moy s_store_id      sumsales  rk\n0                  None    None           None     NaN    NaN    NaN       None  2.425322e+08   1\n1                          None           None     NaN    NaN    NaN       None  1.288673e+08   2\n2                                         None     NaN    NaN    NaN       None  6.217733e+07   3\n3                                                  NaN    NaN    NaN       None  3.453657e+07   4\n4                                               2001.0    NaN    NaN       None  2.449620e+07   5\n5                                               2001.0    4.0    NaN       None  1.607472e+07   6\n6                                               2002.0    NaN    NaN       None  1.004037e+07   7\n7                                               2001.0    3.0    NaN       None  8.421483e+06   8\n8                                               2001.0    4.0   12.0       None  6.250903e+06   9\n9                                               2001.0    4.0   11.0       None  6.036141e+06  10\n10                 mens    None           None     NaN    NaN    NaN       None  5.859038e+06  11\n11              newborn    None           None     NaN    NaN    NaN       None  4.635453e+06  12\n12                                              2002.0    1.0    NaN       None  4.435410e+06  13\n13              dresses    None           None     NaN    NaN    NaN       None  4.340513e+06  14\n14                                              2002.0    2.0    NaN       None  4.232845e+06  15\n15                                              2001.0    3.0    9.0       None  4.177728e+06  16\n16                                              2001.0    3.0    8.0       None  4.096545e+06  17\n17             toddlers    None           None     NaN    NaN    NaN       None  4.063074e+06  18\n18                                              2001.0    4.0   10.0       None  3.787673e+06  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.055935,
                    "execution_time": 0.01182,
                    "compile_time": 0.028966,
                    "planning_time": 0.005598
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.524987,
                    "execution_time": 0.015821,
                    "compile_time": 3.45506,
                    "planning_time": 0.040981
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category   i_class i_brand i_product_name  d_year  d_qoy  d_moy s_store_id      sumsales  rk\n0                  None    None           None     NaN    NaN    NaN       None  2.425322e+08   1\n1                          None           None     NaN    NaN    NaN       None  1.288673e+08   2\n2                                         None     NaN    NaN    NaN       None  6.217733e+07   3\n3                                                  NaN    NaN    NaN       None  3.453657e+07   4\n4                                               2001.0    NaN    NaN       None  2.449620e+07   5\n5                                               2001.0    4.0    NaN       None  1.607472e+07   6\n6                                               2002.0    NaN    NaN       None  1.004037e+07   7\n7                                               2001.0    3.0    NaN       None  8.421483e+06   8\n8                                               2001.0    4.0   12.0       None  6.250903e+06   9\n9                                               2001.0    4.0   11.0       None  6.036141e+06  10\n10                 mens    None           None     NaN    NaN    NaN       None  5.859038e+06  11\n11              newborn    None           None     NaN    NaN    NaN       None  4.635453e+06  12\n12                                              2002.0    1.0    NaN       None  4.435410e+06  13\n13              dresses    None           None     NaN    NaN    NaN       None  4.340513e+06  14\n14                                              2002.0    2.0    NaN       None  4.232845e+06  15\n15                                              2001.0    3.0    9.0       None  4.177728e+06  16\n16                                              2001.0    3.0    8.0       None  4.096545e+06  17\n17             toddlers    None           None     NaN    NaN    NaN       None  4.063074e+06  18\n18                                              2001.0    4.0   10.0       None  3.787673e+06  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" LIMIT 21",
                "preview": "\n/*   i_category i_class             i_brand i_product_name  d_year  d_qoy  d_moy s_store_id      sumsales  rk\n0                        edu packamalg #2           None     NaN    NaN    NaN       None  2.390389e+06  41\n1                      edu packexporti #2           None     NaN    NaN    NaN       None  2.556374e+06  37\n2                      exportiedu pack #2           None     NaN    NaN    NaN       None  3.606720e+06  22\n3                         amalgimporto #2           None     NaN    NaN    NaN       None  2.534349e+06  38\n4                                                   None     NaN    NaN    NaN       None  6.217733e+07   3\n5                      exportiedu pack #2                    NaN    NaN    NaN       None  2.671222e+06  34\n6                                                         2001.0    3.0    NaN       None  8.421483e+06   8\n7                                                            NaN    NaN    NaN       None  3.453657e+07   4\n8                       exportiexporti #2           None     NaN    NaN    NaN       None  2.710926e+06  32\n9                                                         2001.0    NaN    NaN       None  2.449620e+07   5\n10                                                        2001.0    4.0    NaN       None  1.607472e+07   6\n11                                                        2002.0    1.0    NaN       None  4.435410e+06  13\n12                                                        2002.0    NaN    NaN       None  1.004037e+07   7\n13                                                        2002.0    2.0    NaN       None  4.232845e+06  15\n14                                                        2001.0    3.0    9.0       None  4.177728e+06  16\n15                                                        2001.0    3.0    8.0       None  4.096545e+06  17\n16                                                        2001.0    4.0   12.0       None  6.250903e+06   9\n17                                                        2001.0    4.0   10.0       None  3.787673e+06  19\n18                                                        2001.0    4.0   11.0       None  6.036141e+06  10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035176,
                    "execution_time": 0.009437,
                    "compile_time": 0.012908,
                    "planning_time": 0.005933
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.510527,
                    "execution_time": 0.009289,
                    "compile_time": 4.455478,
                    "planning_time": 0.04101
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class             i_brand i_product_name  d_year  d_qoy  d_moy s_store_id      sumsales  rk\n0                        edu packamalg #2           None     NaN    NaN    NaN       None  2.390389e+06  41\n1                      edu packexporti #2           None     NaN    NaN    NaN       None  2.556374e+06  37\n2                      exportiedu pack #2           None     NaN    NaN    NaN       None  3.606720e+06  22\n3                         amalgimporto #2           None     NaN    NaN    NaN       None  2.534349e+06  38\n4                                                   None     NaN    NaN    NaN       None  6.217733e+07   3\n5                      exportiedu pack #2                    NaN    NaN    NaN       None  2.671222e+06  34\n6                                                         2001.0    3.0    NaN       None  8.421483e+06   8\n7                                                            NaN    NaN    NaN       None  3.453657e+07   4\n8                       exportiexporti #2           None     NaN    NaN    NaN       None  2.710926e+06  32\n9                                                         2001.0    NaN    NaN       None  2.449620e+07   5\n10                                                        2001.0    4.0    NaN       None  1.607472e+07   6\n11                                                        2002.0    1.0    NaN       None  4.435410e+06  13\n12                                                        2002.0    NaN    NaN       None  1.004037e+07   7\n13                                                        2002.0    2.0    NaN       None  4.232845e+06  15\n14                                                        2001.0    3.0    9.0       None  4.177728e+06  16\n15                                                        2001.0    3.0    8.0       None  4.096545e+06  17\n16                                                        2001.0    4.0   12.0       None  6.250903e+06   9\n17                                                        2001.0    4.0   10.0       None  3.787673e+06  19\n18                                                        2001.0    4.0   11.0       None  6.036141e+06  10\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2002.0    2.0    5.0       None   1464703.97  92\n1                                                       2001.0    4.0   11.0       None   6036140.79  10\n2                                                       2002.0    2.0    4.0       None   1395656.65  94\n3                                                       2002.0    3.0    NaN       None   1372117.64  96\n4                                                 None     NaN    NaN    NaN       None  62177331.32   3\n5                                                       2002.0    1.0    1.0       None   1712667.31  77\n6                                                       2001.0    3.0    NaN       None   8421482.76   8\n7                                                          NaN    NaN    NaN       None  34536571.00   4\n8                                                       2002.0    3.0    7.0       None   1372117.64  96\n9                                                       2001.0    NaN    NaN       None  24496199.05   5\n10                                                      2001.0    4.0    NaN       None  16074716.29   6\n11                                                      2002.0    1.0    NaN       None   4435409.79  13\n12                                                      2002.0    NaN    NaN       None  10040371.95   7\n13                                                      2002.0    2.0    NaN       None   4232844.52  15\n14                                                      2001.0    3.0    9.0       None   4177728.31  16\n15                                                      2001.0    3.0    8.0       None   4096545.42  17\n16                                                      2001.0    4.0   12.0       None   6250902.76   9\n17                                                      2001.0    4.0   10.0       None   3787672.74  19\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0382,
                    "execution_time": 0.008494,
                    "compile_time": 0.01731,
                    "planning_time": 0.005804
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.321818,
                    "execution_time": 0.00966,
                    "compile_time": 4.268371,
                    "planning_time": 0.041193
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2002.0    2.0    5.0       None   1464703.97  92\n1                                                       2001.0    4.0   11.0       None   6036140.79  10\n2                                                       2002.0    2.0    4.0       None   1395656.65  94\n3                                                       2002.0    3.0    NaN       None   1372117.64  96\n4                                                 None     NaN    NaN    NaN       None  62177331.32   3\n5                                                       2002.0    1.0    1.0       None   1712667.31  77\n6                                                       2001.0    3.0    NaN       None   8421482.76   8\n7                                                          NaN    NaN    NaN       None  34536571.00   4\n8                                                       2002.0    3.0    7.0       None   1372117.64  96\n9                                                       2001.0    NaN    NaN       None  24496199.05   5\n10                                                      2001.0    4.0    NaN       None  16074716.29   6\n11                                                      2002.0    1.0    NaN       None   4435409.79  13\n12                                                      2002.0    NaN    NaN       None  10040371.95   7\n13                                                      2002.0    2.0    NaN       None   4232844.52  15\n14                                                      2001.0    3.0    9.0       None   4177728.31  16\n15                                                      2001.0    3.0    8.0       None   4096545.42  17\n16                                                      2001.0    4.0   12.0       None   6250902.76   9\n17                                                      2001.0    4.0   10.0       None   3787672.74  19\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2002.0    2.0    5.0       None   1464703.97  92\n1                                                       2001.0    4.0   10.0       None   3787672.74  19\n2                                                       2002.0    2.0    4.0       None   1395656.65  94\n3                                                       2002.0    3.0    NaN       None   1372117.64  96\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2002.0    1.0    1.0       None   1712667.31  77\n6                                                       2001.0    3.0    NaN       None   8421482.76   8\n7                                                          NaN    NaN    NaN       None  34536571.00   4\n8                                                       2002.0    3.0    7.0       None   1372117.64  96\n9                                                       2001.0    NaN    NaN       None  24496199.05   5\n10                                                      2001.0    4.0    NaN       None  16074716.29   6\n11                                                      2002.0    1.0    NaN       None   4435409.79  13\n12                                                      2002.0    NaN    NaN       None  10040371.95   7\n13                                                      2002.0    2.0    NaN       None   4232844.52  15\n14                                                      2001.0    3.0    9.0       None   4177728.31  16\n15                                                      2001.0    3.0    8.0       None   4096545.42  17\n16                                                      2001.0    4.0   12.0       None   6250902.76   9\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038724,
                    "execution_time": 0.009422,
                    "compile_time": 0.016724,
                    "planning_time": 0.00582
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.501398,
                    "execution_time": 0.009911,
                    "compile_time": 4.448215,
                    "planning_time": 0.041318
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2002.0    2.0    5.0       None   1464703.97  92\n1                                                       2001.0    4.0   10.0       None   3787672.74  19\n2                                                       2002.0    2.0    4.0       None   1395656.65  94\n3                                                       2002.0    3.0    NaN       None   1372117.64  96\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2002.0    1.0    1.0       None   1712667.31  77\n6                                                       2001.0    3.0    NaN       None   8421482.76   8\n7                                                          NaN    NaN    NaN       None  34536571.00   4\n8                                                       2002.0    3.0    7.0       None   1372117.64  96\n9                                                       2001.0    NaN    NaN       None  24496199.05   5\n10                                                      2001.0    4.0    NaN       None  16074716.29   6\n11                                                      2002.0    1.0    NaN       None   4435409.79  13\n12                                                      2002.0    NaN    NaN       None  10040371.95   7\n13                                                      2002.0    2.0    NaN       None   4232844.52  15\n14                                                      2001.0    3.0    9.0       None   4177728.31  16\n15                                                      2001.0    3.0    8.0       None   4096545.42  17\n16                                                      2001.0    4.0   12.0       None   6250902.76   9\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    4.0    NaN       None  16074716.29   6\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    8.0       None   4096545.42  17\n3                                                       2001.0    4.0   11.0       None   6036140.79  10\n4                                                       2001.0    4.0   10.0       None   3787672.74  19\n5                                                       2001.0    NaN    NaN       None  24496199.05   5\n6                                                       2001.0    3.0    NaN       None   8421482.76   8\n7                                                       2001.0    4.0   12.0       None   6250902.76   9\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    3.0    7.0       None   1372117.64  96\n11                                                      2002.0    3.0    NaN       None   1372117.64  96\n12                                                      2002.0    NaN    NaN       None  10040371.95   7\n13                                                      2002.0    2.0    NaN       None   4232844.52  15\n14                                                      2002.0    2.0    4.0       None   1395656.65  94\n15                                                      2002.0    2.0    5.0       None   1464703.97  92\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.034378,
                    "execution_time": 0.00872,
                    "compile_time": 0.012826,
                    "planning_time": 0.005901
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.92588,
                    "execution_time": 0.009292,
                    "compile_time": 4.872457,
                    "planning_time": 0.041617
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    4.0    NaN       None  16074716.29   6\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    8.0       None   4096545.42  17\n3                                                       2001.0    4.0   11.0       None   6036140.79  10\n4                                                       2001.0    4.0   10.0       None   3787672.74  19\n5                                                       2001.0    NaN    NaN       None  24496199.05   5\n6                                                       2001.0    3.0    NaN       None   8421482.76   8\n7                                                       2001.0    4.0   12.0       None   6250902.76   9\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    3.0    7.0       None   1372117.64  96\n11                                                      2002.0    3.0    NaN       None   1372117.64  96\n12                                                      2002.0    NaN    NaN       None  10040371.95   7\n13                                                      2002.0    2.0    NaN       None   4232844.52  15\n14                                                      2002.0    2.0    4.0       None   1395656.65  94\n15                                                      2002.0    2.0    5.0       None   1464703.97  92\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    9.0       None   4177728.31  16\n1                                                       2001.0    3.0    NaN       None   8421482.76   8\n2                                                       2001.0    3.0    8.0       None   4096545.42  17\n3                                                       2001.0    4.0   12.0       None   6250902.76   9\n4                                                       2001.0    4.0    NaN       None  16074716.29   6\n5                                                       2001.0    4.0   11.0       None   6036140.79  10\n6                                                       2001.0    4.0   10.0       None   3787672.74  19\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    NaN       None   4232844.52  15\n11                                                      2002.0    2.0    4.0       None   1395656.65  94\n12                                                      2002.0    2.0    5.0       None   1464703.97  92\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038686,
                    "execution_time": 0.009475,
                    "compile_time": 0.01631,
                    "planning_time": 0.005928
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.915147,
                    "execution_time": 0.010098,
                    "compile_time": 4.861547,
                    "planning_time": 0.041613
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    9.0       None   4177728.31  16\n1                                                       2001.0    3.0    NaN       None   8421482.76   8\n2                                                       2001.0    3.0    8.0       None   4096545.42  17\n3                                                       2001.0    4.0   12.0       None   6250902.76   9\n4                                                       2001.0    4.0    NaN       None  16074716.29   6\n5                                                       2001.0    4.0   11.0       None   6036140.79  10\n6                                                       2001.0    4.0   10.0       None   3787672.74  19\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    NaN       None   4232844.52  15\n11                                                      2002.0    2.0    4.0       None   1395656.65  94\n12                                                      2002.0    2.0    5.0       None   1464703.97  92\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035984,
                    "execution_time": 0.008684,
                    "compile_time": 0.014449,
                    "planning_time": 0.006148
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.354474,
                    "execution_time": 0.009382,
                    "compile_time": 5.300639,
                    "planning_time": 0.041717
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036617,
                    "execution_time": 0.008447,
                    "compile_time": 0.014357,
                    "planning_time": 0.00662
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.768504,
                    "execution_time": 0.009251,
                    "compile_time": 4.714489,
                    "planning_time": 0.041984
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04064,
                    "execution_time": 0.008732,
                    "compile_time": 0.017982,
                    "planning_time": 0.006613
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.32813,
                    "execution_time": 0.010051,
                    "compile_time": 4.273642,
                    "planning_time": 0.041972
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST , \"DW2\".\"RK\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040469,
                    "execution_time": 0.00866,
                    "compile_time": 0.017799,
                    "planning_time": 0.006856
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.155614,
                    "execution_time": 0.01026,
                    "compile_time": 5.100467,
                    "planning_time": 0.042113
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST , \"DW2\".\"RK\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" LIMIT 21",
                "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022627,
                    "execution_time": 0.008554,
                    "compile_time": 0.000122,
                    "planning_time": 0.006797
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022524,
                    "execution_time": 0.008681,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.006777
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"RK\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   i_category i_class           i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                                                       2001.0    3.0    8.0       None   4096545.42  17\n1                                                       2001.0    3.0    9.0       None   4177728.31  16\n2                                                       2001.0    3.0    NaN       None   8421482.76   8\n3                                                       2001.0    4.0   10.0       None   3787672.74  19\n4                                                       2001.0    4.0   11.0       None   6036140.79  10\n5                                                       2001.0    4.0   12.0       None   6250902.76   9\n6                                                       2001.0    4.0    NaN       None  16074716.29   6\n7                                                       2001.0    NaN    NaN       None  24496199.05   5\n8                                                       2002.0    1.0    1.0       None   1712667.31  77\n9                                                       2002.0    1.0    NaN       None   4435409.79  13\n10                                                      2002.0    2.0    4.0       None   1395656.65  94\n11                                                      2002.0    2.0    5.0       None   1464703.97  92\n12                                                      2002.0    2.0    NaN       None   4232844.52  15\n13                                                      2002.0    3.0    7.0       None   1372117.64  96\n14                                                      2002.0    3.0    NaN       None   1372117.64  96\n15                                                      2002.0    NaN    NaN       None  10040371.95   7\n16                                                         NaN    NaN    NaN       None  34536571.00   4\n17                                                None     NaN    NaN    NaN       None  62177331.32   3\n18                     amalgedu pack #2           None     NaN    NaN    NaN       None   2014295.16  52\n...*/"
    }
]