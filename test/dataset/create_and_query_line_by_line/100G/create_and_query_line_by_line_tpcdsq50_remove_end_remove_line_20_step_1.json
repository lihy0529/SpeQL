[
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.729938,
                    "execution_time": 0.531675,
                    "compile_time": 0.090542,
                    "planning_time": 0.065603,
                    "create_size": 144
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 23.672127,
                    "execution_time": 1.949849,
                    "compile_time": 21.557418,
                    "planning_time": 0.067262,
                    "create_size": 144
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing             1             867    Oak Washington            RD      Suite 260         Fairview    Ziebach County      SD  55709      213         152         171          163          334\n1         cally             1             123           Valley           Lane        Suite I          Liberty     Walker County      AL  33451      217         156         166          153          323\n2           ese             1             758      Green Walnut           Dr.      Suite 220            Union    Ziebach County      SD  58721      232         161         200          185          322\n3           pri             1             392        Jefferson             Ln        Suite K            Salem  Fairfield County      SC  28048      209         160         188          162          319\n4          anti             1             433           Cherry      Boulevard        Suite G        Riverside     Barrow County      GA  39231      230         167         155          173          314\n5          able             1             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n6          n st             1             616            Cedar         Street        Suite M            Salem    Ziebach County      SD  58048      265         166         179          149          330\n7           bar             1             599      Davis Poplar        Circle        Suite Q         New Hope    Ziebach County      SD  59431      220         154         188          173          351\n8          able             1              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n9          eing             1             310          Jackson          Court       Suite 60          Liberty   Franklin Parish      LA  73451      238         179         150          165          331\n10        ought             1             818              1st           Blvd        Suite Q  Pleasant Valley    Ziebach County      SD  52477      227         149         157          179          305\n11        ation             1             489            Cedar           Cir.      Suite 450      Centerville    Ziebach County      SD  50059      217         148         163          168          274\n12         able             1             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n13          bar             1             903            Sixth          Court        Suite Q   Pleasant Grove     Barrow County      GA  34136      227         165         157          159          349\n14          pri             1             465       Washington             RD      Suite 260        Greenwood  Fairfield County      SC  28828      192         160         170          172          315\n15        cally             1             956       View Sunset       Parkway      Suite 250    Pleasant Hill  Fairfield County      SC  23604      208         173         161          147          342\n16         able             1             749    Railroad Maple         Drive       Suite 10         New Hope  Fairfield County      SC  29431      205         170         162          154          318\n17          ese             1             302           Spruce          Court        Suite L         Fairview   Franklin Parish      LA  75709      229         161         157          170          356\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.050367,
                    "execution_time": 0.007783,
                    "compile_time": 0.030092,
                    "planning_time": 0.005303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.343236,
                    "execution_time": 0.008201,
                    "compile_time": 3.279662,
                    "planning_time": 0.040896
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing             1             867    Oak Washington            RD      Suite 260         Fairview    Ziebach County      SD  55709      213         152         171          163          334\n1         cally             1             123           Valley           Lane        Suite I          Liberty     Walker County      AL  33451      217         156         166          153          323\n2           ese             1             758      Green Walnut           Dr.      Suite 220            Union    Ziebach County      SD  58721      232         161         200          185          322\n3           pri             1             392        Jefferson             Ln        Suite K            Salem  Fairfield County      SC  28048      209         160         188          162          319\n4          anti             1             433           Cherry      Boulevard        Suite G        Riverside     Barrow County      GA  39231      230         167         155          173          314\n5          able             1             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n6          n st             1             616            Cedar         Street        Suite M            Salem    Ziebach County      SD  58048      265         166         179          149          330\n7           bar             1             599      Davis Poplar        Circle        Suite Q         New Hope    Ziebach County      SD  59431      220         154         188          173          351\n8          able             1              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n9          eing             1             310          Jackson          Court       Suite 60          Liberty   Franklin Parish      LA  73451      238         179         150          165          331\n10        ought             1             818              1st           Blvd        Suite Q  Pleasant Valley    Ziebach County      SD  52477      227         149         157          179          305\n11        ation             1             489            Cedar           Cir.      Suite 450      Centerville    Ziebach County      SD  50059      217         148         163          168          274\n12         able             1             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n13          bar             1             903            Sixth          Court        Suite Q   Pleasant Grove     Barrow County      GA  34136      227         165         157          159          349\n14          pri             1             465       Washington             RD      Suite 260        Greenwood  Fairfield County      SC  28828      192         160         170          172          315\n15        cally             1             956       View Sunset       Parkway      Suite 250    Pleasant Hill  Fairfield County      SC  23604      208         173         161          147          342\n16         able             1             749    Railroad Maple         Drive       Suite 10         New Hope  Fairfield County      SC  29431      205         170         162          154          318\n17          ese             1             302           Spruce          Court        Suite L         Fairview   Franklin Parish      LA  75709      229         161         157          170          356\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti             1             818  Central Valley            RD      Suite 210         Fairview      Barrow County      GA  35709      248         176         132          143          317\n1          n st             1             144         3rd 4th          Blvd        Suite 0        Oak Grove  Williamson County      TN  38370      239         149         165          165          309\n2         cally             1             216         Laurel          Drive      Suite 490        Oak Grove    Franklin Parish      LA  78370      203         151         148          140          328\n3           ese             1             800        1st Pine           Ave      Suite 350  Pleasant Valley  Williamson County      TN  32477      236         178         174          144          343\n4          eing             1             687          Ridge           Blvd        Suite P            Union      Barrow County      GA  38721      209         159         151          185          327\n5          eing             1             688     Park Center        Circle       Suite 20          Oakland    Richland County      OH  49843      226         192         141          147          370\n6           bar             1             126        2nd 12th        Circle      Suite 230    Pleasant Hill    Richland County      OH  43604      237         151         174          158          339\n7          able             1             605  Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n8           bar             1             365  Railroad Smith     Boulevard        Suite O   Pleasant Grove  Williamson County      TN  34136      254         143         134          159          324\n9           pri             1             889    River Wilson        Avenue      Suite 210      Centerville    Franklin Parish      LA  70059      208         160         155          167          335\n10        ought             1             810        Lake 8th           Dr.        Suite S      Centerville  Williamson County      TN  30059      234         167         168          164          318\n11         eing             1             662            2nd             RD        Suite A         Fairview   Fairfield County      SC  25709      240         152         159          185          351\n12          bar             1             200           Lake             RD      Suite 320          Liberty     Ziebach County      SD  53451      234         159         149          177          358\n13         able             1             557     Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n14         able             1             543        West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n15         n st             1             495         Valley           Lane        Suite D          Oakland   Fairfield County      SC  29843      227         160         148          154          324\n16         eing             1             238         Spring           Blvd        Suite G        Oak Grove        Luce County      MI  48370      210         152         168          173          353\n17        ation             1             811            Lee         Circle        Suite T           Bethel    Richland County      OH  45281      241         152         164          145          324\n18        ation             1               8     Cedar Maple            ST      Suite 320            Salem     Daviess County      MO  68048      242         164         136          149          304\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01939,
                    "execution_time": 0.007932,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004757
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054,
                    "execution_time": 0.007575,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.039588
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti             1             818  Central Valley            RD      Suite 210         Fairview      Barrow County      GA  35709      248         176         132          143          317\n1          n st             1             144         3rd 4th          Blvd        Suite 0        Oak Grove  Williamson County      TN  38370      239         149         165          165          309\n2         cally             1             216         Laurel          Drive      Suite 490        Oak Grove    Franklin Parish      LA  78370      203         151         148          140          328\n3           ese             1             800        1st Pine           Ave      Suite 350  Pleasant Valley  Williamson County      TN  32477      236         178         174          144          343\n4          eing             1             687          Ridge           Blvd        Suite P            Union      Barrow County      GA  38721      209         159         151          185          327\n5          eing             1             688     Park Center        Circle       Suite 20          Oakland    Richland County      OH  49843      226         192         141          147          370\n6           bar             1             126        2nd 12th        Circle      Suite 230    Pleasant Hill    Richland County      OH  43604      237         151         174          158          339\n7          able             1             605  Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n8           bar             1             365  Railroad Smith     Boulevard        Suite O   Pleasant Grove  Williamson County      TN  34136      254         143         134          159          324\n9           pri             1             889    River Wilson        Avenue      Suite 210      Centerville    Franklin Parish      LA  70059      208         160         155          167          335\n10        ought             1             810        Lake 8th           Dr.        Suite S      Centerville  Williamson County      TN  30059      234         167         168          164          318\n11         eing             1             662            2nd             RD        Suite A         Fairview   Fairfield County      SC  25709      240         152         159          185          351\n12          bar             1             200           Lake             RD      Suite 320          Liberty     Ziebach County      SD  53451      234         159         149          177          358\n13         able             1             557     Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n14         able             1             543        West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n15         n st             1             495         Valley           Lane        Suite D          Oakland   Fairfield County      SC  29843      227         160         148          154          324\n16         eing             1             238         Spring           Blvd        Suite G        Oak Grove        Luce County      MI  48370      210         152         168          173          353\n17        ation             1             811            Lee         Circle        Suite T           Bethel    Richland County      OH  45281      241         152         164          145          324\n18        ation             1               8     Cedar Maple            ST      Suite 320            Salem     Daviess County      MO  68048      242         164         136          149          304\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing           1.0             754             Ash         Street        Suite O          Bethel    Richland County      OH  45281      218         165         169          178          345\n1         cally           1.0             701  Sunset Chestnut            RD        Suite P     Centerville   Fairfield County      SC  20059      207         166         170          163          330\n2         cally           NaN             688                         Avenue       Suite 50                                         SC             231         172         148          172          324\n3         cally           1.0             966       Poplar 1st         Drive        Suite F        New Hope     Daviess County      MO  69431      203         174         166          155          348\n4           pri           1.0              84           First           Cir.      Suite 180         Liberty     Ziebach County      SD  53451      238         158         179          165          342\n5          anti           1.0             720     2nd Sycamore         Drive        Suite J        Fairview  Williamson County      TN  35709      225         158         140          195          317\n6          eing           1.0             303       Fifteenth             RD      Suite 340       Greenwood     Daviess County      MO  68828      225         140         150          152          308\n7          anti           1.0             897          Ash Oak        Circle        Suite T           Salem   Fairfield County      SC  28048      233         161         173          153          336\n8          anti           1.0             797        10th 14th          Cir.      Suite 470       Greenwood    Franklin Parish      LA  78828      248         166         175          171          349\n9           bar           1.0              41             Oak          Court      Suite 170         Oakland   Fairfield County      SC  29843      244         149         169          160          335\n10        ation           1.0             544      Lake Second         Court        Suite T          Midway     Ziebach County      SD  51904      229         164         188          156          301\n11        cally           1.0             826            Park         Street      Suite 340           Salem     Ziebach County      SD  58048      228         161         164          159          348\n12        ation           1.0             442        East 13th        Avenue      Suite 350   Pleasant Hill  Williamson County      TN  33604      242         154         143          158          338\n13         anti           1.0             192     5th Highland          Blvd        Suite N          Bethel  Williamson County      TN  35281      247         167         176          175          304\n14          bar           1.0             700       Third View          Road      Suite 420       Oak Grove     Daviess County      MO  68370      241         166         143          163          344\n15         able           1.0             545            Pine             ST        Suite D         Liberty    Richland County      OH  43451      219         169         167          149          359\n16          bar           1.0             829       Jefferson           Lane      Suite 110     Five Points  Williamson County      TN  36098      251         171         149          174          340\n17         eing           1.0             317      Ridge Green          Lane        Suite A  Mount Pleasant   Fairfield County      SC  21933      198         175         153          167          281\n18          bar           1.0             741       Hillcrest            Ave       Suite 20          Bethel   Fairfield County      SC  25281      225         176         152          151          308\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.117146,
                    "execution_time": 0.007458,
                    "compile_time": 0.09828,
                    "planning_time": 0.004657
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019437,
                    "execution_time": 0.008044,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004685
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing           1.0             754             Ash         Street        Suite O          Bethel    Richland County      OH  45281      218         165         169          178          345\n1         cally           1.0             701  Sunset Chestnut            RD        Suite P     Centerville   Fairfield County      SC  20059      207         166         170          163          330\n2         cally           NaN             688                         Avenue       Suite 50                                         SC             231         172         148          172          324\n3         cally           1.0             966       Poplar 1st         Drive        Suite F        New Hope     Daviess County      MO  69431      203         174         166          155          348\n4           pri           1.0              84           First           Cir.      Suite 180         Liberty     Ziebach County      SD  53451      238         158         179          165          342\n5          anti           1.0             720     2nd Sycamore         Drive        Suite J        Fairview  Williamson County      TN  35709      225         158         140          195          317\n6          eing           1.0             303       Fifteenth             RD      Suite 340       Greenwood     Daviess County      MO  68828      225         140         150          152          308\n7          anti           1.0             897          Ash Oak        Circle        Suite T           Salem   Fairfield County      SC  28048      233         161         173          153          336\n8          anti           1.0             797        10th 14th          Cir.      Suite 470       Greenwood    Franklin Parish      LA  78828      248         166         175          171          349\n9           bar           1.0              41             Oak          Court      Suite 170         Oakland   Fairfield County      SC  29843      244         149         169          160          335\n10        ation           1.0             544      Lake Second         Court        Suite T          Midway     Ziebach County      SD  51904      229         164         188          156          301\n11        cally           1.0             826            Park         Street      Suite 340           Salem     Ziebach County      SD  58048      228         161         164          159          348\n12        ation           1.0             442        East 13th        Avenue      Suite 350   Pleasant Hill  Williamson County      TN  33604      242         154         143          158          338\n13         anti           1.0             192     5th Highland          Blvd        Suite N          Bethel  Williamson County      TN  35281      247         167         176          175          304\n14          bar           1.0             700       Third View          Road      Suite 420       Oak Grove     Daviess County      MO  68370      241         166         143          163          344\n15         able           1.0             545            Pine             ST        Suite D         Liberty    Richland County      OH  43451      219         169         167          149          359\n16          bar           1.0             829       Jefferson           Lane      Suite 110     Five Points  Williamson County      TN  36098      251         171         149          174          340\n17         eing           1.0             317      Ridge Green          Lane        Suite A  Mount Pleasant   Fairfield County      SC  21933      198         175         153          167          281\n18          bar           1.0             741       Hillcrest            Ave       Suite 20          Bethel   Fairfield County      SC  25281      225         176         152          151          308\n...*/"
    },
    {
        "input": "select /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         ought             1             387          15th 5th       Parkway       Suite 80          Midway   Fairfield County      SC  21904      231         163         147          136          314\n1         ation             1             421     Adams Madison            Ln        Suite P       Riverside   Fairfield County      SC  29231      217         139         184          151          313\n2           bar             1             107     Poplar Wilson            RD        Suite R   Pleasant Hill  Williamson County      TN  33604      209         149         176          176          350\n3          eing             1             920      Ninth Laurel           Ave        Suite K       Riverside      Walker County      AL  39231      212         184         179          180          343\n4         cally             1             588  River Thirteenth           Ct.        Suite A  Mount Pleasant        Luce County      MI  41933      206         164         168          154          296\n5          eing             1             980          Jackson         Circle        Suite S     Shady Grove      Barrow County      GA  32812      207         166         165          160          376\n6           ese             1             849          7th 13th         Drive      Suite 400   Pleasant Hill     Ziebach County      SD  53604      220         161         140          165          347\n7           pri             1             728            Adams            Way        Suite T         Oakland        Luce County      MI  49843      230         188         147          155          306\n8           bar             1             174         Sycamore             Ln        Suite O        Fairview    Franklin Parish      LA  75709      219         148         151          149          338\n9          n st             1             274            Smith        Parkway      Suite 300     Centerville     Ziebach County      SD  50059      252         189         173          161          372\n10          bar             1             377             Pine        Parkway      Suite 160          Midway        Luce County      MI  41904      229         162         173          158          340\n11         n st             1             425           Willow            Ct.        Suite M  Mount Pleasant     Ziebach County      SD  51933      215         183         175          142          316\n12          bar             1               9            Third         Circle      Suite 110       Greenwood      Walker County      AL  38828      236         141         148          160          326\n13        cally             1             588         View Mill         Court      Suite 160       Greenwood     Ziebach County      SD  58828      210         153         159          143          305\n14        cally             1             257           Cherry         Avenue      Suite 310     Five Points  Williamson County      TN  36098      216         172         165          157          291\n15         n st             1             638           Cherry            Dr.        Suite T       Riverside        Luce County      MI  49231      197         160         178          168          337\n16          bar             1             265        Park South            RD      Suite 430  Pleasant Grove    Richland County      OH  44136      211         169         175          170          336\n17        ation             1             226              5th            Dr.      Suite 330         Liberty     Ziebach County      SD  53451      208         171         170          158          360\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019886,
                    "execution_time": 0.00824,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.004806
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018945,
                    "execution_time": 0.007492,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.004694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         ought             1             387          15th 5th       Parkway       Suite 80          Midway   Fairfield County      SC  21904      231         163         147          136          314\n1         ation             1             421     Adams Madison            Ln        Suite P       Riverside   Fairfield County      SC  29231      217         139         184          151          313\n2           bar             1             107     Poplar Wilson            RD        Suite R   Pleasant Hill  Williamson County      TN  33604      209         149         176          176          350\n3          eing             1             920      Ninth Laurel           Ave        Suite K       Riverside      Walker County      AL  39231      212         184         179          180          343\n4         cally             1             588  River Thirteenth           Ct.        Suite A  Mount Pleasant        Luce County      MI  41933      206         164         168          154          296\n5          eing             1             980          Jackson         Circle        Suite S     Shady Grove      Barrow County      GA  32812      207         166         165          160          376\n6           ese             1             849          7th 13th         Drive      Suite 400   Pleasant Hill     Ziebach County      SD  53604      220         161         140          165          347\n7           pri             1             728            Adams            Way        Suite T         Oakland        Luce County      MI  49843      230         188         147          155          306\n8           bar             1             174         Sycamore             Ln        Suite O        Fairview    Franklin Parish      LA  75709      219         148         151          149          338\n9          n st             1             274            Smith        Parkway      Suite 300     Centerville     Ziebach County      SD  50059      252         189         173          161          372\n10          bar             1             377             Pine        Parkway      Suite 160          Midway        Luce County      MI  41904      229         162         173          158          340\n11         n st             1             425           Willow            Ct.        Suite M  Mount Pleasant     Ziebach County      SD  51933      215         183         175          142          316\n12          bar             1               9            Third         Circle      Suite 110       Greenwood      Walker County      AL  38828      236         141         148          160          326\n13        cally             1             588         View Mill         Court      Suite 160       Greenwood     Ziebach County      SD  58828      210         153         159          143          305\n14        cally             1             257           Cherry         Avenue      Suite 310     Five Points  Williamson County      TN  36098      216         172         165          157          291\n15         n st             1             638           Cherry            Dr.        Suite T       Riverside        Luce County      MI  49231      197         160         178          168          337\n16          bar             1             265        Park South            RD      Suite 430  Pleasant Grove    Richland County      OH  44136      211         169         175          170          336\n17        ation             1             226              5th            Dr.      Suite 330         Liberty     Ziebach County      SD  53451      208         171         170          158          360\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         ought             1             387          15th 5th       Parkway       Suite 80          Midway   Fairfield County      SC  21904      231         163         147          136          314\n1         ation             1             421     Adams Madison            Ln        Suite P       Riverside   Fairfield County      SC  29231      217         139         184          151          313\n2           bar             1             107     Poplar Wilson            RD        Suite R   Pleasant Hill  Williamson County      TN  33604      209         149         176          176          350\n3          eing             1             920      Ninth Laurel           Ave        Suite K       Riverside      Walker County      AL  39231      212         184         179          180          343\n4         cally             1             588  River Thirteenth           Ct.        Suite A  Mount Pleasant        Luce County      MI  41933      206         164         168          154          296\n5          eing             1             980          Jackson         Circle        Suite S     Shady Grove      Barrow County      GA  32812      207         166         165          160          376\n6           ese             1             849          7th 13th         Drive      Suite 400   Pleasant Hill     Ziebach County      SD  53604      220         161         140          165          347\n7           pri             1             728            Adams            Way        Suite T         Oakland        Luce County      MI  49843      230         188         147          155          306\n8           bar             1             174         Sycamore             Ln        Suite O        Fairview    Franklin Parish      LA  75709      219         148         151          149          338\n9          n st             1             274            Smith        Parkway      Suite 300     Centerville     Ziebach County      SD  50059      252         189         173          161          372\n10          bar             1             377             Pine        Parkway      Suite 160          Midway        Luce County      MI  41904      229         162         173          158          340\n11         n st             1             425           Willow            Ct.        Suite M  Mount Pleasant     Ziebach County      SD  51933      215         183         175          142          316\n12          bar             1               9            Third         Circle      Suite 110       Greenwood      Walker County      AL  38828      236         141         148          160          326\n13        cally             1             588         View Mill         Court      Suite 160       Greenwood     Ziebach County      SD  58828      210         153         159          143          305\n14        cally             1             257           Cherry         Avenue      Suite 310     Five Points  Williamson County      TN  36098      216         172         165          157          291\n15         n st             1             638           Cherry            Dr.        Suite T       Riverside        Luce County      MI  49231      197         160         178          168          337\n16          bar             1             265        Park South            RD      Suite 430  Pleasant Grove    Richland County      OH  44136      211         169         175          170          336\n17        ation             1             226              5th            Dr.      Suite 330         Liberty     Ziebach County      SD  53451      208         171         170          158          360\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018899,
                    "execution_time": 0.007416,
                    "compile_time": 6e-05,
                    "planning_time": 0.004816
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019325,
                    "execution_time": 0.007504,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004842
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         ought             1             387          15th 5th       Parkway       Suite 80          Midway   Fairfield County      SC  21904      231         163         147          136          314\n1         ation             1             421     Adams Madison            Ln        Suite P       Riverside   Fairfield County      SC  29231      217         139         184          151          313\n2           bar             1             107     Poplar Wilson            RD        Suite R   Pleasant Hill  Williamson County      TN  33604      209         149         176          176          350\n3          eing             1             920      Ninth Laurel           Ave        Suite K       Riverside      Walker County      AL  39231      212         184         179          180          343\n4         cally             1             588  River Thirteenth           Ct.        Suite A  Mount Pleasant        Luce County      MI  41933      206         164         168          154          296\n5          eing             1             980          Jackson         Circle        Suite S     Shady Grove      Barrow County      GA  32812      207         166         165          160          376\n6           ese             1             849          7th 13th         Drive      Suite 400   Pleasant Hill     Ziebach County      SD  53604      220         161         140          165          347\n7           pri             1             728            Adams            Way        Suite T         Oakland        Luce County      MI  49843      230         188         147          155          306\n8           bar             1             174         Sycamore             Ln        Suite O        Fairview    Franklin Parish      LA  75709      219         148         151          149          338\n9          n st             1             274            Smith        Parkway      Suite 300     Centerville     Ziebach County      SD  50059      252         189         173          161          372\n10          bar             1             377             Pine        Parkway      Suite 160          Midway        Luce County      MI  41904      229         162         173          158          340\n11         n st             1             425           Willow            Ct.        Suite M  Mount Pleasant     Ziebach County      SD  51933      215         183         175          142          316\n12          bar             1               9            Third         Circle      Suite 110       Greenwood      Walker County      AL  38828      236         141         148          160          326\n13        cally             1             588         View Mill         Court      Suite 160       Greenwood     Ziebach County      SD  58828      210         153         159          143          305\n14        cally             1             257           Cherry         Avenue      Suite 310     Five Points  Williamson County      TN  36098      216         172         165          157          291\n15         n st             1             638           Cherry            Dr.        Suite T       Riverside        Luce County      MI  49231      197         160         178          168          337\n16          bar             1             265        Park South            RD      Suite 430  Pleasant Grove    Richland County      OH  44136      211         169         175          170          336\n17        ation             1             226              5th            Dr.      Suite 330         Liberty     Ziebach County      SD  53451      208         171         170          158          360\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         ought             1             387          15th 5th       Parkway       Suite 80          Midway   Fairfield County      SC  21904      231         163         147          136          314\n1         ation             1             421     Adams Madison            Ln        Suite P       Riverside   Fairfield County      SC  29231      217         139         184          151          313\n2           bar             1             107     Poplar Wilson            RD        Suite R   Pleasant Hill  Williamson County      TN  33604      209         149         176          176          350\n3          eing             1             920      Ninth Laurel           Ave        Suite K       Riverside      Walker County      AL  39231      212         184         179          180          343\n4         cally             1             588  River Thirteenth           Ct.        Suite A  Mount Pleasant        Luce County      MI  41933      206         164         168          154          296\n5          eing             1             980          Jackson         Circle        Suite S     Shady Grove      Barrow County      GA  32812      207         166         165          160          376\n6           ese             1             849          7th 13th         Drive      Suite 400   Pleasant Hill     Ziebach County      SD  53604      220         161         140          165          347\n7           pri             1             728            Adams            Way        Suite T         Oakland        Luce County      MI  49843      230         188         147          155          306\n8           bar             1             174         Sycamore             Ln        Suite O        Fairview    Franklin Parish      LA  75709      219         148         151          149          338\n9          n st             1             274            Smith        Parkway      Suite 300     Centerville     Ziebach County      SD  50059      252         189         173          161          372\n10          bar             1             377             Pine        Parkway      Suite 160          Midway        Luce County      MI  41904      229         162         173          158          340\n11         n st             1             425           Willow            Ct.        Suite M  Mount Pleasant     Ziebach County      SD  51933      215         183         175          142          316\n12          bar             1               9            Third         Circle      Suite 110       Greenwood      Walker County      AL  38828      236         141         148          160          326\n13        cally             1             588         View Mill         Court      Suite 160       Greenwood     Ziebach County      SD  58828      210         153         159          143          305\n14        cally             1             257           Cherry         Avenue      Suite 310     Five Points  Williamson County      TN  36098      216         172         165          157          291\n15         n st             1             638           Cherry            Dr.        Suite T       Riverside        Luce County      MI  49231      197         160         178          168          337\n16          bar             1             265        Park South            RD      Suite 430  Pleasant Grove    Richland County      OH  44136      211         169         175          170          336\n17        ation             1             226              5th            Dr.      Suite 330         Liberty     Ziebach County      SD  53451      208         171         170          158          360\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01926,
                    "execution_time": 0.007687,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.004636
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019314,
                    "execution_time": 0.007437,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004945
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         ought             1             387          15th 5th       Parkway       Suite 80          Midway   Fairfield County      SC  21904      231         163         147          136          314\n1         ation             1             421     Adams Madison            Ln        Suite P       Riverside   Fairfield County      SC  29231      217         139         184          151          313\n2           bar             1             107     Poplar Wilson            RD        Suite R   Pleasant Hill  Williamson County      TN  33604      209         149         176          176          350\n3          eing             1             920      Ninth Laurel           Ave        Suite K       Riverside      Walker County      AL  39231      212         184         179          180          343\n4         cally             1             588  River Thirteenth           Ct.        Suite A  Mount Pleasant        Luce County      MI  41933      206         164         168          154          296\n5          eing             1             980          Jackson         Circle        Suite S     Shady Grove      Barrow County      GA  32812      207         166         165          160          376\n6           ese             1             849          7th 13th         Drive      Suite 400   Pleasant Hill     Ziebach County      SD  53604      220         161         140          165          347\n7           pri             1             728            Adams            Way        Suite T         Oakland        Luce County      MI  49843      230         188         147          155          306\n8           bar             1             174         Sycamore             Ln        Suite O        Fairview    Franklin Parish      LA  75709      219         148         151          149          338\n9          n st             1             274            Smith        Parkway      Suite 300     Centerville     Ziebach County      SD  50059      252         189         173          161          372\n10          bar             1             377             Pine        Parkway      Suite 160          Midway        Luce County      MI  41904      229         162         173          158          340\n11         n st             1             425           Willow            Ct.        Suite M  Mount Pleasant     Ziebach County      SD  51933      215         183         175          142          316\n12          bar             1               9            Third         Circle      Suite 110       Greenwood      Walker County      AL  38828      236         141         148          160          326\n13        cally             1             588         View Mill         Court      Suite 160       Greenwood     Ziebach County      SD  58828      210         153         159          143          305\n14        cally             1             257           Cherry         Avenue      Suite 310     Five Points  Williamson County      TN  36098      216         172         165          157          291\n15         n st             1             638           Cherry            Dr.        Suite T       Riverside        Luce County      MI  49231      197         160         178          168          337\n16          bar             1             265        Park South            RD      Suite 430  Pleasant Grove    Richland County      OH  44136      211         169         175          170          336\n17        ation             1             226              5th            Dr.      Suite 330         Liberty     Ziebach County      SD  53451      208         171         170          158          360\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing           1.0             656       Washington            Dr.       Suite 50          Liberty   Fairfield County      SC  23451      253         175         167          160          337\n1           bar           1.0             363           Center             ST        Suite E         Fairview    Franklin Parish      LA  75709      220         182         194          168          357\n2          eing           1.0             242    Johnson Wilson            ST        Suite T         Fairview    Richland County      OH  45709      227         170         156          159          340\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4           ese           1.0             984              Oak           Cir.        Suite D  Pleasant Valley  Williamson County      TN  32477      226         177         187          156          337\n5          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n6         cally           1.0             409          4th 15th         Drive        Suite Q            Salem        Luce County      MI  48048      236         177         181          161          350\n7         ought           1.0             150    Maple Williams          Lane        Suite D         Fairview  Williamson County      TN  35709      224         124         165          133          330\n8         cally           1.0             709              7th           Lane      Suite 210      Five Points        Luce County      MI  46098      225         176         152          152          326\n9                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n10         anti           1.0             321             11th        Parkway        Suite G    Pleasant Hill    Franklin Parish      LA  73604      234         142         180          163          291\n11         anti           1.0             630    Third Railroad            Ln        Suite D          Oakland      Walker County      AL  39843      251         157         163          150          316\n12        ought           1.0             667          3rd 15th           Ct.        Suite U   Mount Pleasant      Walker County      AL  31933      209         182         141          140          310\n13          ese           1.0             208            Maple             ST        Suite F        Riverside   Fairfield County      SC  29231      231         177         192          174          334\n14         n st           1.0              49       Locust Lake           Way       Suite 90          Liberty    Franklin Parish      LA  73451      232         165         174          178          340\n15        ation           1.0              11         Broadway             ST        Suite P         Fairview      Barrow County      GA  35709      226         152         162          166          302\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17        cally           1.0             561              1st             ST        Suite B        Greenwood    Richland County      OH  48828      228         158         175          167          307\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019139,
                    "execution_time": 0.007443,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.004838
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019042,
                    "execution_time": 0.007421,
                    "compile_time": 6e-05,
                    "planning_time": 0.004931
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing           1.0             656       Washington            Dr.       Suite 50          Liberty   Fairfield County      SC  23451      253         175         167          160          337\n1           bar           1.0             363           Center             ST        Suite E         Fairview    Franklin Parish      LA  75709      220         182         194          168          357\n2          eing           1.0             242    Johnson Wilson            ST        Suite T         Fairview    Richland County      OH  45709      227         170         156          159          340\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4           ese           1.0             984              Oak           Cir.        Suite D  Pleasant Valley  Williamson County      TN  32477      226         177         187          156          337\n5          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n6         cally           1.0             409          4th 15th         Drive        Suite Q            Salem        Luce County      MI  48048      236         177         181          161          350\n7         ought           1.0             150    Maple Williams          Lane        Suite D         Fairview  Williamson County      TN  35709      224         124         165          133          330\n8         cally           1.0             709              7th           Lane      Suite 210      Five Points        Luce County      MI  46098      225         176         152          152          326\n9                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n10         anti           1.0             321             11th        Parkway        Suite G    Pleasant Hill    Franklin Parish      LA  73604      234         142         180          163          291\n11         anti           1.0             630    Third Railroad            Ln        Suite D          Oakland      Walker County      AL  39843      251         157         163          150          316\n12        ought           1.0             667          3rd 15th           Ct.        Suite U   Mount Pleasant      Walker County      AL  31933      209         182         141          140          310\n13          ese           1.0             208            Maple             ST        Suite F        Riverside   Fairfield County      SC  29231      231         177         192          174          334\n14         n st           1.0              49       Locust Lake           Way       Suite 90          Liberty    Franklin Parish      LA  73451      232         165         174          178          340\n15        ation           1.0              11         Broadway             ST        Suite P         Fairview      Barrow County      GA  35709      226         152         162          166          302\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17        cally           1.0             561              1st             ST        Suite B        Greenwood    Richland County      OH  48828      228         158         175          167          307\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese             1             252       Woodland           Cir.        Suite F    Five Points   Fairfield County      SC  26098      235         154         168          166          395\n1           ese             1             986        2nd Park           Ave        Suite V       New Hope    Richland County      OH  49431      231         146         163          172          354\n2           ese             1             408  Washington 1st        Circle      Suite 390         Bethel    Richland County      OH  45281      215         144         169          164          305\n3           ese             1             197         Walnut         Circle        Suite S    Five Points     Ziebach County      SD  56098      229         158         150          150          341\n4          able             1             300         Forest           Lane      Suite 230      Riverside      Walker County      AL  39231      217         157         160          168          338\n5          able             1             972       Chestnut             Wy        Suite S          Union      Walker County      AL  38721      242         168         177          179          329\n6         ought             1             714       North 7th         Court        Suite S        Oakland  Williamson County      TN  39843      205         201         154          152          333\n7         ought             1             602    Chestnut 5th     Boulevard        Suite C  Pleasant Hill  Williamson County      TN  33604      222         160         148          166          298\n8           ese             1             635           11th           Blvd        Suite Q    Five Points     Ziebach County      SD  56098      198         164         141          162          359\n9           pri             1             872     Washington           Pkwy       Suite 70         Midway        Luce County      MI  41904      264         166         168          163          311\n10         anti             1             921     Walnut Lake           Ave      Suite 400         Bethel    Richland County      OH  45281      229         171         180          144          290\n11        ation             1             232  5th Washington            RD        Suite R    Centerville    Richland County      OH  40059      236         153         165          186          327\n12          pri             1             343           14th             Ln        Suite P      Greenwood  Williamson County      TN  38828      223         160         193          172          358\n13          bar             1             824      Second 2nd       Parkway       Suite 90      Riverside     Daviess County      MO  69231      194         185         158          151          312\n14        cally             1             353      Third View         Drive      Suite 380         Midway     Daviess County      MO  61904      234         148         172          139          314\n15        ought             1             767         Spring             Wy      Suite 250        Liberty     Ziebach County      SD  53451      224         157         186          159          297\n16         anti             1             536            5th          Drive        Suite E    Shady Grove      Walker County      AL  32812      228         168         173          167          343\n17         eing             1             618   Jefferson Lee          Pkwy        Suite W         Bethel    Richland County      OH  45281      243         160         147          164          317\n18         eing             1             490        Pine Ash           Ct.        Suite T    Five Points        Luce County      MI  46098      238         158         154          152          309\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018678,
                    "execution_time": 0.007286,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004718
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019434,
                    "execution_time": 0.007638,
                    "compile_time": 6e-05,
                    "planning_time": 0.004913
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese             1             252       Woodland           Cir.        Suite F    Five Points   Fairfield County      SC  26098      235         154         168          166          395\n1           ese             1             986        2nd Park           Ave        Suite V       New Hope    Richland County      OH  49431      231         146         163          172          354\n2           ese             1             408  Washington 1st        Circle      Suite 390         Bethel    Richland County      OH  45281      215         144         169          164          305\n3           ese             1             197         Walnut         Circle        Suite S    Five Points     Ziebach County      SD  56098      229         158         150          150          341\n4          able             1             300         Forest           Lane      Suite 230      Riverside      Walker County      AL  39231      217         157         160          168          338\n5          able             1             972       Chestnut             Wy        Suite S          Union      Walker County      AL  38721      242         168         177          179          329\n6         ought             1             714       North 7th         Court        Suite S        Oakland  Williamson County      TN  39843      205         201         154          152          333\n7         ought             1             602    Chestnut 5th     Boulevard        Suite C  Pleasant Hill  Williamson County      TN  33604      222         160         148          166          298\n8           ese             1             635           11th           Blvd        Suite Q    Five Points     Ziebach County      SD  56098      198         164         141          162          359\n9           pri             1             872     Washington           Pkwy       Suite 70         Midway        Luce County      MI  41904      264         166         168          163          311\n10         anti             1             921     Walnut Lake           Ave      Suite 400         Bethel    Richland County      OH  45281      229         171         180          144          290\n11        ation             1             232  5th Washington            RD        Suite R    Centerville    Richland County      OH  40059      236         153         165          186          327\n12          pri             1             343           14th             Ln        Suite P      Greenwood  Williamson County      TN  38828      223         160         193          172          358\n13          bar             1             824      Second 2nd       Parkway       Suite 90      Riverside     Daviess County      MO  69231      194         185         158          151          312\n14        cally             1             353      Third View         Drive      Suite 380         Midway     Daviess County      MO  61904      234         148         172          139          314\n15        ought             1             767         Spring             Wy      Suite 250        Liberty     Ziebach County      SD  53451      224         157         186          159          297\n16         anti             1             536            5th          Drive        Suite E    Shady Grove      Walker County      AL  32812      228         168         173          167          343\n17         eing             1             618   Jefferson Lee          Pkwy        Suite W         Bethel    Richland County      OH  45281      243         160         147          164          317\n18         eing             1             490        Pine Ash           Ct.        Suite T    Five Points        Luce County      MI  46098      238         158         154          152          309\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing           1.0             754             Ash         Street        Suite O          Bethel    Richland County      OH  45281      218         165         169          178          345\n1         cally           1.0             701  Sunset Chestnut            RD        Suite P     Centerville   Fairfield County      SC  20059      207         166         170          163          330\n2         cally           NaN             688                         Avenue       Suite 50                                         SC             231         172         148          172          324\n3         cally           1.0             966       Poplar 1st         Drive        Suite F        New Hope     Daviess County      MO  69431      203         174         166          155          348\n4           pri           1.0              84           First           Cir.      Suite 180         Liberty     Ziebach County      SD  53451      238         158         179          165          342\n5          anti           1.0             720     2nd Sycamore         Drive        Suite J        Fairview  Williamson County      TN  35709      225         158         140          195          317\n6          eing           1.0             303       Fifteenth             RD      Suite 340       Greenwood     Daviess County      MO  68828      225         140         150          152          308\n7          anti           1.0             897          Ash Oak        Circle        Suite T           Salem   Fairfield County      SC  28048      233         161         173          153          336\n8          anti           1.0             797        10th 14th          Cir.      Suite 470       Greenwood    Franklin Parish      LA  78828      248         166         175          171          349\n9           bar           1.0              41             Oak          Court      Suite 170         Oakland   Fairfield County      SC  29843      244         149         169          160          335\n10        ation           1.0             544      Lake Second         Court        Suite T          Midway     Ziebach County      SD  51904      229         164         188          156          301\n11        cally           1.0             826            Park         Street      Suite 340           Salem     Ziebach County      SD  58048      228         161         164          159          348\n12        ation           1.0             442        East 13th        Avenue      Suite 350   Pleasant Hill  Williamson County      TN  33604      242         154         143          158          338\n13         anti           1.0             192     5th Highland          Blvd        Suite N          Bethel  Williamson County      TN  35281      247         167         176          175          304\n14          bar           1.0             700       Third View          Road      Suite 420       Oak Grove     Daviess County      MO  68370      241         166         143          163          344\n15         able           1.0             545            Pine             ST        Suite D         Liberty    Richland County      OH  43451      219         169         167          149          359\n16          bar           1.0             829       Jefferson           Lane      Suite 110     Five Points  Williamson County      TN  36098      251         171         149          174          340\n17         eing           1.0             317      Ridge Green          Lane        Suite A  Mount Pleasant   Fairfield County      SC  21933      198         175         153          167          281\n18          bar           1.0             741       Hillcrest            Ave       Suite 20          Bethel   Fairfield County      SC  25281      225         176         152          151          308\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018962,
                    "execution_time": 0.007481,
                    "compile_time": 6e-05,
                    "planning_time": 0.004799
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019168,
                    "execution_time": 0.007466,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.004903
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number          s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing           1.0             754             Ash         Street        Suite O          Bethel    Richland County      OH  45281      218         165         169          178          345\n1         cally           1.0             701  Sunset Chestnut            RD        Suite P     Centerville   Fairfield County      SC  20059      207         166         170          163          330\n2         cally           NaN             688                         Avenue       Suite 50                                         SC             231         172         148          172          324\n3         cally           1.0             966       Poplar 1st         Drive        Suite F        New Hope     Daviess County      MO  69431      203         174         166          155          348\n4           pri           1.0              84           First           Cir.      Suite 180         Liberty     Ziebach County      SD  53451      238         158         179          165          342\n5          anti           1.0             720     2nd Sycamore         Drive        Suite J        Fairview  Williamson County      TN  35709      225         158         140          195          317\n6          eing           1.0             303       Fifteenth             RD      Suite 340       Greenwood     Daviess County      MO  68828      225         140         150          152          308\n7          anti           1.0             897          Ash Oak        Circle        Suite T           Salem   Fairfield County      SC  28048      233         161         173          153          336\n8          anti           1.0             797        10th 14th          Cir.      Suite 470       Greenwood    Franklin Parish      LA  78828      248         166         175          171          349\n9           bar           1.0              41             Oak          Court      Suite 170         Oakland   Fairfield County      SC  29843      244         149         169          160          335\n10        ation           1.0             544      Lake Second         Court        Suite T          Midway     Ziebach County      SD  51904      229         164         188          156          301\n11        cally           1.0             826            Park         Street      Suite 340           Salem     Ziebach County      SD  58048      228         161         164          159          348\n12        ation           1.0             442        East 13th        Avenue      Suite 350   Pleasant Hill  Williamson County      TN  33604      242         154         143          158          338\n13         anti           1.0             192     5th Highland          Blvd        Suite N          Bethel  Williamson County      TN  35281      247         167         176          175          304\n14          bar           1.0             700       Third View          Road      Suite 420       Oak Grove     Daviess County      MO  68370      241         166         143          163          344\n15         able           1.0             545            Pine             ST        Suite D         Liberty    Richland County      OH  43451      219         169         167          149          359\n16          bar           1.0             829       Jefferson           Lane      Suite 110     Five Points  Williamson County      TN  36098      251         171         149          174          340\n17         eing           1.0             317      Ridge Green          Lane        Suite A  Mount Pleasant   Fairfield County      SC  21933      198         175         153          167          281\n18          bar           1.0             741       Hillcrest            Ave       Suite 20          Bethel   Fairfield County      SC  25281      225         176         152          151          308\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing             1             867    Oak Washington            RD      Suite 260         Fairview    Ziebach County      SD  55709      213         152         171          163          334\n1         cally             1             123           Valley           Lane        Suite I          Liberty     Walker County      AL  33451      217         156         166          153          323\n2           ese             1             758      Green Walnut           Dr.      Suite 220            Union    Ziebach County      SD  58721      232         161         200          185          322\n3           pri             1             392        Jefferson             Ln        Suite K            Salem  Fairfield County      SC  28048      209         160         188          162          319\n4          anti             1             433           Cherry      Boulevard        Suite G        Riverside     Barrow County      GA  39231      230         167         155          173          314\n5          able             1             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n6          n st             1             616            Cedar         Street        Suite M            Salem    Ziebach County      SD  58048      265         166         179          149          330\n7           bar             1             599      Davis Poplar        Circle        Suite Q         New Hope    Ziebach County      SD  59431      220         154         188          173          351\n8          able             1              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n9          eing             1             310          Jackson          Court       Suite 60          Liberty   Franklin Parish      LA  73451      238         179         150          165          331\n10        ought             1             818              1st           Blvd        Suite Q  Pleasant Valley    Ziebach County      SD  52477      227         149         157          179          305\n11        ation             1             489            Cedar           Cir.      Suite 450      Centerville    Ziebach County      SD  50059      217         148         163          168          274\n12         able             1             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n13          bar             1             903            Sixth          Court        Suite Q   Pleasant Grove     Barrow County      GA  34136      227         165         157          159          349\n14          pri             1             465       Washington             RD      Suite 260        Greenwood  Fairfield County      SC  28828      192         160         170          172          315\n15        cally             1             956       View Sunset       Parkway      Suite 250    Pleasant Hill  Fairfield County      SC  23604      208         173         161          147          342\n16         able             1             749    Railroad Maple         Drive       Suite 10         New Hope  Fairfield County      SC  29431      205         170         162          154          318\n17          ese             1             302           Spruce          Court        Suite L         Fairview   Franklin Parish      LA  75709      229         161         157          170          356\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019295,
                    "execution_time": 0.007982,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004688
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019238,
                    "execution_time": 0.007444,
                    "compile_time": 6e-05,
                    "planning_time": 0.004947
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          eing             1             867    Oak Washington            RD      Suite 260         Fairview    Ziebach County      SD  55709      213         152         171          163          334\n1         cally             1             123           Valley           Lane        Suite I          Liberty     Walker County      AL  33451      217         156         166          153          323\n2           ese             1             758      Green Walnut           Dr.      Suite 220            Union    Ziebach County      SD  58721      232         161         200          185          322\n3           pri             1             392        Jefferson             Ln        Suite K            Salem  Fairfield County      SC  28048      209         160         188          162          319\n4          anti             1             433           Cherry      Boulevard        Suite G        Riverside     Barrow County      GA  39231      230         167         155          173          314\n5          able             1             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n6          n st             1             616            Cedar         Street        Suite M            Salem    Ziebach County      SD  58048      265         166         179          149          330\n7           bar             1             599      Davis Poplar        Circle        Suite Q         New Hope    Ziebach County      SD  59431      220         154         188          173          351\n8          able             1              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n9          eing             1             310          Jackson          Court       Suite 60          Liberty   Franklin Parish      LA  73451      238         179         150          165          331\n10        ought             1             818              1st           Blvd        Suite Q  Pleasant Valley    Ziebach County      SD  52477      227         149         157          179          305\n11        ation             1             489            Cedar           Cir.      Suite 450      Centerville    Ziebach County      SD  50059      217         148         163          168          274\n12         able             1             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n13          bar             1             903            Sixth          Court        Suite Q   Pleasant Grove     Barrow County      GA  34136      227         165         157          159          349\n14          pri             1             465       Washington             RD      Suite 260        Greenwood  Fairfield County      SC  28828      192         160         170          172          315\n15        cally             1             956       View Sunset       Parkway      Suite 250    Pleasant Hill  Fairfield County      SC  23604      208         173         161          147          342\n16         able             1             749    Railroad Maple         Drive       Suite 10         New Hope  Fairfield County      SC  29431      205         170         162          154          318\n17          ese             1             302           Spruce          Court        Suite L         Fairview   Franklin Parish      LA  75709      229         161         157          170          356\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                             38721      238         141         167          156          324\n1          able           1.0             954           Walnut           Pkwy        Suite L        Oak Grove   Franklin Parish      LA  78370      217         171         155          154          309\n2          able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove       Luce County      MI  44136      225         141         152          180          358\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville     Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n5          able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland     Walker County      AL  39843      219         159         169          173          331\n6          able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel    Ziebach County      SD  55281      238         155         161          149          343\n7          able           1.0             255         Sycamore            Dr.      Suite 410           Midway    Ziebach County      SD  51904      226         163         156          170          309\n8          able           1.0             605    Williams South            Ln        Suite D         Fairview   Richland County      OH  45709      215         177         184          152          337\n9          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland    Ziebach County      SD  59843      223         172         140          152          306\n10         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n11         able           1.0             824           Valley           Cir.        Suite A         Fairview    Daviess County      MO  65709      247         159         173          168          320\n12         able           1.0             227              8th           Road      Suite 290         New Hope       Luce County      MI  49431      198         151         157          174          341\n13         able           1.0             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n14         able           1.0             128             15th             RD        Suite T          Oakland       Luce County      MI  49843      218         167         164          144          297\n15         able           1.0             868         Main Park           Ct.      Suite 240           Bethel    Daviess County      MO  65281      243         156         144          168          343\n16         able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview   Richland County      OH  45709      199         177         158          152          316\n17         able           1.0             841     Mill Woodland          Pkwy        Suite S   Pleasant Grove       Luce County      MI  44136      250         156         179          169          321\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043976,
                    "execution_time": 0.009081,
                    "compile_time": 0.022297,
                    "planning_time": 0.005323
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.190367,
                    "execution_time": 0.00923,
                    "compile_time": 5.134704,
                    "planning_time": 0.041031
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                             38721      238         141         167          156          324\n1          able           1.0             954           Walnut           Pkwy        Suite L        Oak Grove   Franklin Parish      LA  78370      217         171         155          154          309\n2          able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove       Luce County      MI  44136      225         141         152          180          358\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville     Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n5          able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland     Walker County      AL  39843      219         159         169          173          331\n6          able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel    Ziebach County      SD  55281      238         155         161          149          343\n7          able           1.0             255         Sycamore            Dr.      Suite 410           Midway    Ziebach County      SD  51904      226         163         156          170          309\n8          able           1.0             605    Williams South            Ln        Suite D         Fairview   Richland County      OH  45709      215         177         184          152          337\n9          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland    Ziebach County      SD  59843      223         172         140          152          306\n10         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n11         able           1.0             824           Valley           Cir.        Suite A         Fairview    Daviess County      MO  65709      247         159         173          168          320\n12         able           1.0             227              8th           Road      Suite 290         New Hope       Luce County      MI  49431      198         151         157          174          341\n13         able           1.0             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n14         able           1.0             128             15th             RD        Suite T          Oakland       Luce County      MI  49843      218         167         164          144          297\n15         able           1.0             868         Main Park           Ct.      Suite 240           Bethel    Daviess County      MO  65281      243         156         144          168          343\n16         able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview   Richland County      OH  45709      199         177         158          152          316\n17         able           1.0             841     Mill Woodland          Pkwy        Suite S   Pleasant Grove       Luce County      MI  44136      250         156         179          169          321\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                             38721      238         141         167          156          324\n1          able           1.0             954           Walnut           Pkwy        Suite L        Oak Grove   Franklin Parish      LA  78370      217         171         155          154          309\n2          able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove       Luce County      MI  44136      225         141         152          180          358\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville     Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n5          able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland     Walker County      AL  39843      219         159         169          173          331\n6          able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel    Ziebach County      SD  55281      238         155         161          149          343\n7          able           1.0             255         Sycamore            Dr.      Suite 410           Midway    Ziebach County      SD  51904      226         163         156          170          309\n8          able           1.0             605    Williams South            Ln        Suite D         Fairview   Richland County      OH  45709      215         177         184          152          337\n9          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland    Ziebach County      SD  59843      223         172         140          152          306\n10         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n11         able           1.0             824           Valley           Cir.        Suite A         Fairview    Daviess County      MO  65709      247         159         173          168          320\n12         able           1.0             227              8th           Road      Suite 290         New Hope       Luce County      MI  49431      198         151         157          174          341\n13         able           1.0             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n14         able           1.0             128             15th             RD        Suite T          Oakland       Luce County      MI  49843      218         167         164          144          297\n15         able           1.0             868         Main Park           Ct.      Suite 240           Bethel    Daviess County      MO  65281      243         156         144          168          343\n16         able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview   Richland County      OH  45709      199         177         158          152          316\n17         able           1.0             841     Mill Woodland          Pkwy        Suite S   Pleasant Grove       Luce County      MI  44136      250         156         179          169          321\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043904,
                    "execution_time": 0.008504,
                    "compile_time": 0.022589,
                    "planning_time": 0.005444
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.141903,
                    "execution_time": 0.009144,
                    "compile_time": 5.088375,
                    "planning_time": 0.040867
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city          s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                             38721      238         141         167          156          324\n1          able           1.0             954           Walnut           Pkwy        Suite L        Oak Grove   Franklin Parish      LA  78370      217         171         155          154          309\n2          able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove       Luce County      MI  44136      225         141         152          180          358\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville     Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley   Franklin Parish      LA  72477      239         174         168          164          336\n5          able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland     Walker County      AL  39843      219         159         169          173          331\n6          able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel    Ziebach County      SD  55281      238         155         161          149          343\n7          able           1.0             255         Sycamore            Dr.      Suite 410           Midway    Ziebach County      SD  51904      226         163         156          170          309\n8          able           1.0             605    Williams South            Ln        Suite D         Fairview   Richland County      OH  45709      215         177         184          152          337\n9          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland    Ziebach County      SD  59843      223         172         140          152          306\n10         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood    Ziebach County      SD  58828      225         157         162          156          336\n11         able           1.0             824           Valley           Cir.        Suite A         Fairview    Daviess County      MO  65709      247         159         173          168          320\n12         able           1.0             227              8th           Road      Suite 290         New Hope       Luce County      MI  49431      198         151         157          174          341\n13         able           1.0             479        Park First          Lane       Suite 20            Salem     Walker County      AL  38048      231         161         147          142          322\n14         able           1.0             128             15th             RD        Suite T          Oakland       Luce County      MI  49843      218         167         164          144          297\n15         able           1.0             868         Main Park           Ct.      Suite 240           Bethel    Daviess County      MO  65281      243         156         144          168          343\n16         able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview   Richland County      OH  45709      199         177         158          152          316\n17         able           1.0             841     Mill Woodland          Pkwy        Suite S   Pleasant Grove       Luce County      MI  44136      250         156         179          169          321\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04072,
                    "execution_time": 0.008687,
                    "compile_time": 0.019384,
                    "planning_time": 0.005467
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.154591,
                    "execution_time": 0.009716,
                    "compile_time": 5.100382,
                    "planning_time": 0.040707
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041994,
                    "execution_time": 0.009257,
                    "compile_time": 0.019677,
                    "planning_time": 0.005703
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.193167,
                    "execution_time": 0.009199,
                    "compile_time": 5.139504,
                    "planning_time": 0.040883
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0432,
                    "execution_time": 0.008336,
                    "compile_time": 0.021783,
                    "planning_time": 0.005738
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.916266,
                    "execution_time": 0.00922,
                    "compile_time": 4.862153,
                    "planning_time": 0.041112
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038152,
                    "execution_time": 0.009229,
                    "compile_time": 0.015407,
                    "planning_time": 0.006015
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.87607,
                    "execution_time": 0.0093,
                    "compile_time": 4.822113,
                    "planning_time": 0.041149
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036422,
                    "execution_time": 0.008623,
                    "compile_time": 0.014217,
                    "planning_time": 0.006044
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.717619,
                    "execution_time": 0.009022,
                    "compile_time": 4.662961,
                    "planning_time": 0.041429
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038956,
                    "execution_time": 0.008531,
                    "compile_time": 0.016539,
                    "planning_time": 0.006218
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.662694,
                    "execution_time": 0.009285,
                    "compile_time": 5.585596,
                    "planning_time": 0.06394
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03721,
                    "execution_time": 0.008739,
                    "compile_time": 0.014719,
                    "planning_time": 0.0063
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.138087,
                    "execution_time": 0.009877,
                    "compile_time": 5.083505,
                    "planning_time": 0.041521
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" , \"S_ZIP\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039117,
                    "execution_time": 0.009515,
                    "compile_time": 0.01548,
                    "planning_time": 0.006396
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.291834,
                    "execution_time": 0.009921,
                    "compile_time": 4.236226,
                    "planning_time": 0.041824
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST, \"S_ZIP\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" , \"S_ZIP\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023538,
                    "execution_time": 0.009409,
                    "compile_time": 0.000101,
                    "planning_time": 0.006387
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023373,
                    "execution_time": 0.00926,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.006382
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST, \"S_ZIP\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number     s_street_name s_street_type s_suite_number           s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                         NaN                     Valley Valley                      Suite S                                              38721      238         141         167          156          324\n1          able           1.0             128             15th             RD        Suite T          Oakland        Luce County      MI  49843      218         167         164          144          297\n2          able           1.0             227              8th           Road      Suite 290         New Hope        Luce County      MI  49431      198         151         157          174          341\n3          able           1.0             228           Cherry         Avenue        Suite G      Centerville      Walker County      AL  30059      231         173         153          149          354\n4          able           1.0             255         Sycamore            Dr.      Suite 410           Midway     Ziebach County      SD  51904      226         163         156          170          309\n5          able           1.0             292      Walnut North        Circle        Suite Q  Pleasant Valley    Franklin Parish      LA  72477      239         174         168          164          336\n6          able           1.0             300           Forest           Lane      Suite 230        Riverside      Walker County      AL  39231      217         157         160          168          338\n7          able           1.0             302    Walnut Madison            Wy        Suite T          Oakland     Ziebach County      SD  59843      223         172         140          152          306\n8          able           1.0             441             11th             ST        Suite H            Union  Williamson County      TN  38721      192         176         170          149          346\n9          able           1.0             443  Hickory Sycamore        Street        Suite C         Fairview    Richland County      OH  45709      199         177         158          152          316\n10         able           1.0             479        Park First          Lane       Suite 20            Salem      Walker County      AL  38048      231         161         147          142          322\n11         able           1.0              49      Highland 1st         Drive       Suite 80        Greenwood     Ziebach County      SD  58828      225         157         162          156          336\n12         able           1.0             543          West Elm            Ln        Suite A   Pleasant Grove        Luce County      MI  44136      225         141         152          180          358\n13         able           1.0             545             Pine             ST        Suite D          Liberty    Richland County      OH  43451      219         169         167          149          359\n14         able           1.0             557       Elevnth 7th          Pkwy        Suite L          Oakland      Walker County      AL  39843      219         159         169          173          331\n15         able           1.0             605    Williams South            Ln        Suite D         Fairview    Richland County      OH  45709      215         177         184          152          337\n16         able           1.0             667       Ridge Maple          Pkwy        Suite X           Bethel     Ziebach County      SD  55281      238         155         161          149          343\n17         able           1.0             702         Cedar 6th          Blvd      Suite 370         Fairview    Richland County      OH  45709      234         145         189          150          312\n...*/"
    }
]