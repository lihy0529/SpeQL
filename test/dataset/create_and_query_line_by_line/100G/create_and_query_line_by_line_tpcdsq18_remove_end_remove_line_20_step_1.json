[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n )  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.182988,
                    "execution_time": 0.263053,
                    "compile_time": 0.035098,
                    "planning_time": 0.102239,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.91808,
                    "execution_time": 2.958162,
                    "compile_time": 16.110243,
                    "planning_time": 0.077085,
                    "create_size": 1792
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.787714,
                    "execution_time": 0.280504,
                    "compile_time": 0.384855,
                    "planning_time": 0.012455,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.630222,
                    "execution_time": 0.400411,
                    "compile_time": 13.146053,
                    "planning_time": 0.054669,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state         ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAKOJPCAAA  United States       OK   McIntosh County  35.0   82.44     0.00    5.77 -1074.85  1928.0   3.0\n1   AAAAAAAAOGAMAAAA  United States       OK   McIntosh County  21.0   39.60     0.00   17.82  -318.78  1928.0   3.0\n2   AAAAAAAAKEMHCAAA  United States       OK   McIntosh County  58.0    9.90   156.08    8.41   -36.60  1928.0   3.0\n3   AAAAAAAAELCFAAAA  United States       OK   McIntosh County  64.0   89.69     0.00   36.77  -700.16  1928.0   3.0\n4   AAAAAAAAPIIBCAAA  United States       OK   Okmulgee County  83.0   62.31     0.00   41.12  -307.93  1942.0   0.0\n5   AAAAAAAAAIJGCAAA                      OK  Cleveland County  91.0  159.43  7381.60  153.05  1152.38  1940.0   5.0\n6   AAAAAAAAFKOHBAAA  United States       KY    Hancock County  89.0   38.91     0.00    3.89 -2009.62  1966.0   4.0\n7   AAAAAAAACBLFAAAA  United States       KY    Hancock County  21.0  170.68     0.00   83.63   156.03  1966.0   4.0\n8   AAAAAAAAPFKLCAAA  United States       KY    Clinton County  88.0  167.80  1860.49  105.71  2469.99  1932.0   1.0\n9   AAAAAAAAEPBIAAAA  United States       SD    Perkins County  41.0  170.97     0.00   75.22    75.44  1942.0   5.0\n10  AAAAAAAABDDJAAAA  United States       SD    Perkins County  37.0    7.69     0.00    0.99  -129.87  1942.0   5.0\n11  AAAAAAAAAAMGBAAA  United States       KY   Nicholas County  49.0   23.05     0.00   19.82  -125.44  1948.0   1.0\n12  AAAAAAAAOBFOAAAA  United States       KY   Nicholas County  64.0   84.97     0.00    0.00 -5035.52  1948.0   1.0\n13  AAAAAAAAIBBKCAAA  United States       KY   Nicholas County  79.0   93.52  1306.20   48.63 -1942.15  1948.0   1.0\n14  AAAAAAAANPBEBAAA  United States       KY   Nicholas County  85.0   93.01     0.00   80.91  1641.35  1948.0   1.0\n15  AAAAAAAACGPFAAAA  United States       KY   Nicholas County  25.0   31.46     0.00   12.26   -73.50  1948.0   1.0\n16  AAAAAAAABNBMBAAA  United States       KY     Mercer County  82.0    8.65     0.00    5.62    81.18  1953.0   0.0\n17  AAAAAAAACNJFAAAA  United States       KY     Mercer County  12.0   54.18   269.81   27.09  -269.81  1953.0   0.0\n18  AAAAAAAAANEFBAAA  United States       OK     Nowata County  24.0    4.65     0.00    1.34   -32.40  1963.0   2.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.078428,
                    "execution_time": 0.009577,
                    "compile_time": 0.057749,
                    "planning_time": 0.004339
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.15996,
                    "execution_time": 0.00833,
                    "compile_time": 3.101956,
                    "planning_time": 0.039794
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state         ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAKOJPCAAA  United States       OK   McIntosh County  35.0   82.44     0.00    5.77 -1074.85  1928.0   3.0\n1   AAAAAAAAOGAMAAAA  United States       OK   McIntosh County  21.0   39.60     0.00   17.82  -318.78  1928.0   3.0\n2   AAAAAAAAKEMHCAAA  United States       OK   McIntosh County  58.0    9.90   156.08    8.41   -36.60  1928.0   3.0\n3   AAAAAAAAELCFAAAA  United States       OK   McIntosh County  64.0   89.69     0.00   36.77  -700.16  1928.0   3.0\n4   AAAAAAAAPIIBCAAA  United States       OK   Okmulgee County  83.0   62.31     0.00   41.12  -307.93  1942.0   0.0\n5   AAAAAAAAAIJGCAAA                      OK  Cleveland County  91.0  159.43  7381.60  153.05  1152.38  1940.0   5.0\n6   AAAAAAAAFKOHBAAA  United States       KY    Hancock County  89.0   38.91     0.00    3.89 -2009.62  1966.0   4.0\n7   AAAAAAAACBLFAAAA  United States       KY    Hancock County  21.0  170.68     0.00   83.63   156.03  1966.0   4.0\n8   AAAAAAAAPFKLCAAA  United States       KY    Clinton County  88.0  167.80  1860.49  105.71  2469.99  1932.0   1.0\n9   AAAAAAAAEPBIAAAA  United States       SD    Perkins County  41.0  170.97     0.00   75.22    75.44  1942.0   5.0\n10  AAAAAAAABDDJAAAA  United States       SD    Perkins County  37.0    7.69     0.00    0.99  -129.87  1942.0   5.0\n11  AAAAAAAAAAMGBAAA  United States       KY   Nicholas County  49.0   23.05     0.00   19.82  -125.44  1948.0   1.0\n12  AAAAAAAAOBFOAAAA  United States       KY   Nicholas County  64.0   84.97     0.00    0.00 -5035.52  1948.0   1.0\n13  AAAAAAAAIBBKCAAA  United States       KY   Nicholas County  79.0   93.52  1306.20   48.63 -1942.15  1948.0   1.0\n14  AAAAAAAANPBEBAAA  United States       KY   Nicholas County  85.0   93.01     0.00   80.91  1641.35  1948.0   1.0\n15  AAAAAAAACGPFAAAA  United States       KY   Nicholas County  25.0   31.46     0.00   12.26   -73.50  1948.0   1.0\n16  AAAAAAAABNBMBAAA  United States       KY     Mercer County  82.0    8.65     0.00    5.62    81.18  1953.0   0.0\n17  AAAAAAAACNJFAAAA  United States       KY     Mercer County  12.0   54.18   269.81   27.09  -269.81  1953.0   0.0\n18  AAAAAAAAANEFBAAA  United States       OK     Nowata County  24.0    4.65     0.00    1.34   -32.40  1963.0   2.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales,\n      customer_demographics cd1,\n      customer_demographics cd2,\n      customer,\n      customer_address,\n      date_dim,\n      item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7\n\tfrom results\n\tgroup by i_item_id \n) as subquery \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"SUBQUERY\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"SUBQUERY\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SUBQUERY\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SUBQUERY\".\"CA_STATE\" AS \"CA_STATE\" , \"SUBQUERY\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SUBQUERY\".\"AGG1\" AS \"AGG1\" , \"SUBQUERY\".\"AGG2\" AS \"AGG2\" , \"SUBQUERY\".\"AGG3\" AS \"AGG3\" , \"SUBQUERY\".\"AGG4\" AS \"AGG4\" , \"SUBQUERY\".\"AGG5\" AS \"AGG5\" , \"SUBQUERY\".\"AGG6\" AS \"AGG6\" , \"SUBQUERY\".\"AGG7\" AS \"AGG7\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.912495,
                    "execution_time": 0.654385,
                    "compile_time": 0.170392,
                    "planning_time": 0.022506,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.035756,
                    "execution_time": 0.687275,
                    "compile_time": 6.251049,
                    "planning_time": 0.065571,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAMKLDCAAA  United States       CA        Glenn County  53.0   44.82     0.00   41.23  1336.66  1981.0   0.0\n1   AAAAAAAAKMDKCAAA  United States       CA        Glenn County  99.0  115.37     0.00   59.99  -941.49  1981.0   0.0\n2   AAAAAAAALNPEAAAA  United States       KY   Livingston County  79.0  178.92     0.00  132.40  4005.30  1975.0   6.0\n3   AAAAAAAAOLGHCAAA  United States       CA        Modoc County  76.0  137.02     0.00   41.10 -1956.24  1941.0   0.0\n4   AAAAAAAAEMEBCAAA  United States       CA        Marin County  50.0   48.45   479.52   26.64  -341.02  1990.0   5.0\n5   AAAAAAAABHNMBAAA  United States       CA         Yuba County  76.0   26.78   873.40   15.53  -555.72  1949.0   4.0\n6   AAAAAAAANMEACAAA  United States       KY        Floyd County  67.0   89.08     0.00    5.34 -3936.25  1960.0   0.0\n7   AAAAAAAAFJDJCAAA  United States       KY         Owen County  83.0  149.86     0.00  103.40  4202.29  1942.0   4.0\n8   AAAAAAAAJBMAAAAA  United States       KY         Owen County  90.0   15.95   280.11   10.04  -109.11  1942.0   4.0\n9   AAAAAAAAEPFDBAAA  United States       SD         Todd County   7.0  109.24     0.00   64.45    56.98  1947.0   0.0\n10  AAAAAAAANJADAAAA  United States       WI      Douglas County  85.0   52.63     0.00   40.52  -941.80  1925.0   3.0\n11  AAAAAAAALLOEAAAA  United States       CA  Santa Clara County  68.0    8.37     0.00    1.67  -157.76  1934.0   3.0\n12  AAAAAAAAKGIABAAA  United States       SD  Charles Mix County  36.0  271.72     0.00  217.37  4520.52  1964.0   1.0\n13  AAAAAAAAMFGPCAAA  United States       SD  Charles Mix County   8.0   59.77     0.00   49.01   157.68  1964.0   1.0\n14  AAAAAAAABKCGAAAA  United States       SD  Charles Mix County  61.0   64.56  3332.96   59.39 -3105.43  1964.0   1.0\n15  AAAAAAAAIOLKBAAA  United States       WI     Bayfield County  62.0   58.48   606.16   22.22 -1914.36  1933.0   5.0\n16  AAAAAAAAKDBJCAAA  United States       WI     Bayfield County  80.0   49.32     0.00   40.44   672.80  1933.0   5.0\n17  AAAAAAAACMFPBAAA  United States       AL      Madison County  64.0  167.62     0.00   92.19   481.92  1925.0   0.0\n18  AAAAAAAAAOFKCAAA  United States       AL      Madison County  65.0   48.65     0.00   36.00    -2.60  1925.0   0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01855,
                    "execution_time": 0.007684,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004357
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.131015,
                    "execution_time": 0.008337,
                    "compile_time": 0.075378,
                    "planning_time": 0.039817
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAMKLDCAAA  United States       CA        Glenn County  53.0   44.82     0.00   41.23  1336.66  1981.0   0.0\n1   AAAAAAAAKMDKCAAA  United States       CA        Glenn County  99.0  115.37     0.00   59.99  -941.49  1981.0   0.0\n2   AAAAAAAALNPEAAAA  United States       KY   Livingston County  79.0  178.92     0.00  132.40  4005.30  1975.0   6.0\n3   AAAAAAAAOLGHCAAA  United States       CA        Modoc County  76.0  137.02     0.00   41.10 -1956.24  1941.0   0.0\n4   AAAAAAAAEMEBCAAA  United States       CA        Marin County  50.0   48.45   479.52   26.64  -341.02  1990.0   5.0\n5   AAAAAAAABHNMBAAA  United States       CA         Yuba County  76.0   26.78   873.40   15.53  -555.72  1949.0   4.0\n6   AAAAAAAANMEACAAA  United States       KY        Floyd County  67.0   89.08     0.00    5.34 -3936.25  1960.0   0.0\n7   AAAAAAAAFJDJCAAA  United States       KY         Owen County  83.0  149.86     0.00  103.40  4202.29  1942.0   4.0\n8   AAAAAAAAJBMAAAAA  United States       KY         Owen County  90.0   15.95   280.11   10.04  -109.11  1942.0   4.0\n9   AAAAAAAAEPFDBAAA  United States       SD         Todd County   7.0  109.24     0.00   64.45    56.98  1947.0   0.0\n10  AAAAAAAANJADAAAA  United States       WI      Douglas County  85.0   52.63     0.00   40.52  -941.80  1925.0   3.0\n11  AAAAAAAALLOEAAAA  United States       CA  Santa Clara County  68.0    8.37     0.00    1.67  -157.76  1934.0   3.0\n12  AAAAAAAAKGIABAAA  United States       SD  Charles Mix County  36.0  271.72     0.00  217.37  4520.52  1964.0   1.0\n13  AAAAAAAAMFGPCAAA  United States       SD  Charles Mix County   8.0   59.77     0.00   49.01   157.68  1964.0   1.0\n14  AAAAAAAABKCGAAAA  United States       SD  Charles Mix County  61.0   64.56  3332.96   59.39 -3105.43  1964.0   1.0\n15  AAAAAAAAIOLKBAAA  United States       WI     Bayfield County  62.0   58.48   606.16   22.22 -1914.36  1933.0   5.0\n16  AAAAAAAAKDBJCAAA  United States       WI     Bayfield County  80.0   49.32     0.00   40.44   672.80  1933.0   5.0\n17  AAAAAAAACMFPBAAA  United States       AL      Madison County  64.0  167.62     0.00   92.19   481.92  1925.0   0.0\n18  AAAAAAAAAOFKCAAA  United States       AL      Madison County  65.0   48.65     0.00   36.00    -2.60  1925.0   0.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n group by i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAABJPFBAAA  United States       OK    Pittsburg County  74.0   81.66  4009.94   64.51 -2141.44  1985.0   4.0\n1   AAAAAAAAGLHOCAAA  United States       OK    Pittsburg County  10.0   66.02     0.00   23.10   -31.00  1985.0   4.0\n2   AAAAAAAACHPIAAAA  United States       KY      Pulaski County  42.0   33.37     0.00   27.69   292.32  1928.0   5.0\n3   AAAAAAAAIBDBDAAA  United States       KY      Pulaski County  60.0   51.72     0.00   46.54   750.60  1928.0   5.0\n4   AAAAAAAAJFKKAAAA  United States       KY      Pulaski County  92.0  137.54     0.00  122.41  5899.96  1928.0   5.0\n5   AAAAAAAAHKGOAAAA  United States       KY        Mason County  65.0  103.67     0.00   75.67 -1561.30  1934.0   0.0\n6   AAAAAAAADGIBBAAA  United States       KY        Mason County   1.0  148.59     0.00  129.27    66.57  1934.0   0.0\n7   AAAAAAAABLANAAAA  United States       WI       Taylor County  65.0   77.42     0.00   43.35 -2165.15  1968.0   1.0\n8   AAAAAAAAODDKBAAA  United States       WI       Taylor County  61.0   19.24     0.00    5.96   -89.67  1968.0   1.0\n9   AAAAAAAALDNICAAA  United States       SD        Moody County  23.0   58.79     0.00   42.91  -265.19  1972.0   0.0\n10  AAAAAAAAMJEBAAAA  United States       SD        Lyman County  70.0   54.70     0.00   42.11  1124.20  1960.0   4.0\n11  AAAAAAAAONMBBAAA  United States       SD        Lyman County   7.0  161.61   126.80   95.34  -157.74  1960.0   4.0\n12  AAAAAAAAEFOPCAAA  United States       SD        Lyman County  76.0    1.82     0.00    0.25  -101.84  1960.0   4.0\n13  AAAAAAAAPFABBAAA  United States       WI      Portage County  71.0   74.26     0.00   13.36 -2900.35  1988.0   6.0\n14  AAAAAAAAHHEJBAAA  United States       WI      Portage County  19.0    7.65     0.00    7.19    57.57  1988.0   6.0\n15  AAAAAAAAECDOAAAA  United States       SD  Charles Mix County  10.0  121.48   199.17   24.29  -432.67  1929.0   3.0\n16  AAAAAAAAJPBFBAAA  United States       SD        Spink County  64.0  101.88     0.00    3.05 -4859.52  1989.0   5.0\n17  AAAAAAAALHIEBAAA  United States       SD        Spink County  81.0   20.52     0.00    6.56  -831.06  1989.0   5.0\n18  AAAAAAAAEJFFCAAA  United States       SD        Spink County  40.0  238.56     0.00  143.13  1938.40  1989.0   5.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018733,
                    "execution_time": 0.00767,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004312
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019735,
                    "execution_time": 0.008479,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.004582
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAABJPFBAAA  United States       OK    Pittsburg County  74.0   81.66  4009.94   64.51 -2141.44  1985.0   4.0\n1   AAAAAAAAGLHOCAAA  United States       OK    Pittsburg County  10.0   66.02     0.00   23.10   -31.00  1985.0   4.0\n2   AAAAAAAACHPIAAAA  United States       KY      Pulaski County  42.0   33.37     0.00   27.69   292.32  1928.0   5.0\n3   AAAAAAAAIBDBDAAA  United States       KY      Pulaski County  60.0   51.72     0.00   46.54   750.60  1928.0   5.0\n4   AAAAAAAAJFKKAAAA  United States       KY      Pulaski County  92.0  137.54     0.00  122.41  5899.96  1928.0   5.0\n5   AAAAAAAAHKGOAAAA  United States       KY        Mason County  65.0  103.67     0.00   75.67 -1561.30  1934.0   0.0\n6   AAAAAAAADGIBBAAA  United States       KY        Mason County   1.0  148.59     0.00  129.27    66.57  1934.0   0.0\n7   AAAAAAAABLANAAAA  United States       WI       Taylor County  65.0   77.42     0.00   43.35 -2165.15  1968.0   1.0\n8   AAAAAAAAODDKBAAA  United States       WI       Taylor County  61.0   19.24     0.00    5.96   -89.67  1968.0   1.0\n9   AAAAAAAALDNICAAA  United States       SD        Moody County  23.0   58.79     0.00   42.91  -265.19  1972.0   0.0\n10  AAAAAAAAMJEBAAAA  United States       SD        Lyman County  70.0   54.70     0.00   42.11  1124.20  1960.0   4.0\n11  AAAAAAAAONMBBAAA  United States       SD        Lyman County   7.0  161.61   126.80   95.34  -157.74  1960.0   4.0\n12  AAAAAAAAEFOPCAAA  United States       SD        Lyman County  76.0    1.82     0.00    0.25  -101.84  1960.0   4.0\n13  AAAAAAAAPFABBAAA  United States       WI      Portage County  71.0   74.26     0.00   13.36 -2900.35  1988.0   6.0\n14  AAAAAAAAHHEJBAAA  United States       WI      Portage County  19.0    7.65     0.00    7.19    57.57  1988.0   6.0\n15  AAAAAAAAECDOAAAA  United States       SD  Charles Mix County  10.0  121.48   199.17   24.29  -432.67  1929.0   3.0\n16  AAAAAAAAJPBFBAAA  United States       SD        Spink County  64.0  101.88     0.00    3.05 -4859.52  1989.0   5.0\n17  AAAAAAAALHIEBAAA  United States       SD        Spink County  81.0   20.52     0.00    6.56  -831.06  1989.0   5.0\n18  AAAAAAAAEJFFCAAA  United States       SD        Spink County  40.0  238.56     0.00  143.13  1938.40  1989.0   5.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n ) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state         ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOMEFCAAA  United States       CA  Riverside County  13.0  216.40     0.00   71.41  -344.63  1930.0   4.0\n1   AAAAAAAAMBJNCAAA  United States       CA  Riverside County  44.0    5.85     0.00    3.45     6.16  1930.0   4.0\n2   AAAAAAAAABBADAAA  United States       CA  Riverside County  43.0   64.77     0.00    5.18  -744.33  1930.0   4.0\n3   AAAAAAAAOPGPCAAA  United States       CA    Alameda County   1.0   77.66     0.00   51.25   -14.57  1969.0   0.0\n4   AAAAAAAACAJGCAAA  United States       CA    Alameda County   6.0  147.49    40.24   10.32  -298.96  1969.0   0.0\n5   AAAAAAAAKNKKBAAA  United States       WI   Florence County  32.0  147.15     0.00  103.00   804.48  1937.0   4.0\n6   AAAAAAAAHKFECAAA  United States       KY      Boyle County  69.0   47.75     0.00   33.90   806.61  1952.0   2.0\n7   AAAAAAAAIMKDCAAA  United States       SD  McPherson County  55.0  168.12     0.00  151.30  3037.65  1966.0   1.0\n8   AAAAAAAALKHADAAA  United States       CA       Kern County  95.0  132.72  3152.10  132.72  3335.45  1980.0   3.0\n9   AAAAAAAAFGPGCAAA  United States       SD      Moody County  98.0   41.39     0.00   38.90  2432.36  1949.0   5.0\n10  AAAAAAAAMGIPCAAA  United States       OK      Ellis County  90.0  119.15  2316.24   64.34 -4775.04  1986.0   3.0\n11  AAAAAAAAFAAPCAAA  United States       OK      Ellis County  85.0   21.99     0.00    1.75  -623.90  1986.0   3.0\n12  AAAAAAAACOBACAAA  United States       OK      Ellis County  94.0   18.54     0.00   15.01   719.10  1986.0   3.0\n13  AAAAAAAAPPKCBAAA  United States       OK        Kay County  66.0   20.83   138.44    8.74  -304.76  1990.0   0.0\n14  AAAAAAAAKIAMBAAA  United States       WI  Winnebago County  99.0    8.71     0.00    5.13    89.10  1952.0   1.0\n15  AAAAAAAAMIOBCAAA  United States       WI  Winnebago County  52.0    7.87    53.58    3.22   -61.90  1952.0   1.0\n16  AAAAAAAAJFDGCAAA  United States       WI  Winnebago County  79.0   30.41     0.00   30.41  1534.97  1952.0   1.0\n17  AAAAAAAAECEABAAA  United States       SD      Deuel County  89.0   38.30     0.00    4.21 -1755.97  1981.0   0.0\n18  AAAAAAAACNPFAAAA  United States       KY    Bourbon County  71.0  131.23     0.00   90.54  3248.25  1928.0   6.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018773,
                    "execution_time": 0.007634,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004467
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019966,
                    "execution_time": 0.008713,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004613
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state         ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOMEFCAAA  United States       CA  Riverside County  13.0  216.40     0.00   71.41  -344.63  1930.0   4.0\n1   AAAAAAAAMBJNCAAA  United States       CA  Riverside County  44.0    5.85     0.00    3.45     6.16  1930.0   4.0\n2   AAAAAAAAABBADAAA  United States       CA  Riverside County  43.0   64.77     0.00    5.18  -744.33  1930.0   4.0\n3   AAAAAAAAOPGPCAAA  United States       CA    Alameda County   1.0   77.66     0.00   51.25   -14.57  1969.0   0.0\n4   AAAAAAAACAJGCAAA  United States       CA    Alameda County   6.0  147.49    40.24   10.32  -298.96  1969.0   0.0\n5   AAAAAAAAKNKKBAAA  United States       WI   Florence County  32.0  147.15     0.00  103.00   804.48  1937.0   4.0\n6   AAAAAAAAHKFECAAA  United States       KY      Boyle County  69.0   47.75     0.00   33.90   806.61  1952.0   2.0\n7   AAAAAAAAIMKDCAAA  United States       SD  McPherson County  55.0  168.12     0.00  151.30  3037.65  1966.0   1.0\n8   AAAAAAAALKHADAAA  United States       CA       Kern County  95.0  132.72  3152.10  132.72  3335.45  1980.0   3.0\n9   AAAAAAAAFGPGCAAA  United States       SD      Moody County  98.0   41.39     0.00   38.90  2432.36  1949.0   5.0\n10  AAAAAAAAMGIPCAAA  United States       OK      Ellis County  90.0  119.15  2316.24   64.34 -4775.04  1986.0   3.0\n11  AAAAAAAAFAAPCAAA  United States       OK      Ellis County  85.0   21.99     0.00    1.75  -623.90  1986.0   3.0\n12  AAAAAAAACOBACAAA  United States       OK      Ellis County  94.0   18.54     0.00   15.01   719.10  1986.0   3.0\n13  AAAAAAAAPPKCBAAA  United States       OK        Kay County  66.0   20.83   138.44    8.74  -304.76  1990.0   0.0\n14  AAAAAAAAKIAMBAAA  United States       WI  Winnebago County  99.0    8.71     0.00    5.13    89.10  1952.0   1.0\n15  AAAAAAAAMIOBCAAA  United States       WI  Winnebago County  52.0    7.87    53.58    3.22   -61.90  1952.0   1.0\n16  AAAAAAAAJFDGCAAA  United States       WI  Winnebago County  79.0   30.41     0.00   30.41  1534.97  1952.0   1.0\n17  AAAAAAAAECEABAAA  United States       SD      Deuel County  89.0   38.30     0.00    4.21 -1755.97  1981.0   0.0\n18  AAAAAAAACNPFAAAA  United States       KY    Bourbon County  71.0  131.23     0.00   90.54  3248.25  1928.0   6.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\t) as combined_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"COMBINED_RESULTS\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"COMBINED_RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"COMBINED_RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"COMBINED_RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"COMBINED_RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"COMBINED_RESULTS\".\"AGG1\" AS \"AGG1\" , \"COMBINED_RESULTS\".\"AGG2\" AS \"AGG2\" , \"COMBINED_RESULTS\".\"AGG3\" AS \"AGG3\" , \"COMBINED_RESULTS\".\"AGG4\" AS \"AGG4\" , \"COMBINED_RESULTS\".\"AGG5\" AS \"AGG5\" , \"COMBINED_RESULTS\".\"AGG6\" AS \"AGG6\" , \"COMBINED_RESULTS\".\"AGG7\" AS \"AGG7\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.892912,
                    "execution_time": 0.698077,
                    "compile_time": 0.057535,
                    "planning_time": 0.028282,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.265974,
                    "execution_time": 0.68861,
                    "compile_time": 5.414322,
                    "planning_time": 0.071082,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state        ca_county  agg1    agg2    agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAACMJECAAA  United States       OK   Haskell County  13.0  140.05    0.00  107.83   361.40  1960.0   3.0\n1   AAAAAAAAJDCPCAAA  United States       KY    Kenton County   5.0   62.10    0.00   34.77    70.00  1989.0   3.0\n2   AAAAAAAACBLCBAAA  United States       KY    Kenton County  79.0  242.80    0.00  218.52  9497.38  1989.0   3.0\n3   AAAAAAAABLBPAAAA  United States       AL    Monroe County  53.0  128.47    0.00   78.36  -542.72  1934.0   3.0\n4   AAAAAAAADECEAAAA  United States       KY     Wayne County  45.0   42.89    0.00   26.16    35.10  1964.0   4.0\n5   AAAAAAAAAMCJCAAA  United States       KY     Wayne County  65.0  166.44    0.00   96.53  1047.80  1964.0   4.0\n6   AAAAAAAAGLGAAAAA  United States       KY   Johnson County   8.0   69.38    0.00   45.79   141.60  1936.0   2.0\n7   AAAAAAAABJPIBAAA  United States       WI    Oconto County  73.0  111.45    0.00   98.07  2688.59  1950.0   4.0\n8   AAAAAAAAGPOADAAA  United States       CA      Mono County  97.0   84.65  847.13   20.31 -3438.97  1932.0   4.0\n9   AAAAAAAAPCEICAAA  United States       OK  Stephens County  56.0  251.19    0.00    0.00 -5582.08  1967.0   6.0\n10  AAAAAAAAFEEECAAA  United States       OK  Stephens County  51.0  150.97    0.00  126.81  1964.52  1967.0   6.0\n11  AAAAAAAAFIKFAAAA  United States       OK  Stephens County  35.0   38.42    0.00   29.19   525.35  1967.0   6.0\n12  AAAAAAAAGHFIAAAA  United States       KY  Calloway County  31.0  134.59    0.00   71.33   736.87  1944.0   2.0\n13  AAAAAAAAIDDPCAAA  United States       KY  Calloway County  87.0   20.87  340.38   15.65   -41.10  1944.0   2.0\n14  AAAAAAAAEAPKAAAA  United States       KY  Magoffin County  35.0   80.02    0.00   10.40 -2303.35  1963.0   2.0\n15  AAAAAAAALKJHAAAA  United States       WI     Price County  34.0   72.55    0.00   42.07  -496.74  1948.0   5.0\n16  AAAAAAAADPCKBAAA  United States       KY    Marion County  18.0  154.80  662.86   60.37  -699.76  1951.0   2.0\n17  AAAAAAAAIMIDAAAA  United States       NV      Lyon County  31.0   80.73    0.00   56.72   622.40  1956.0   5.0\n18  AAAAAAAAKJFFAAAA  United States       NV      Lyon County  69.0   25.40    0.00    0.25  -656.88  1929.0   4.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018701,
                    "execution_time": 0.007647,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004492
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055547,
                    "execution_time": 0.008717,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040054
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state        ca_county  agg1    agg2    agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAACMJECAAA  United States       OK   Haskell County  13.0  140.05    0.00  107.83   361.40  1960.0   3.0\n1   AAAAAAAAJDCPCAAA  United States       KY    Kenton County   5.0   62.10    0.00   34.77    70.00  1989.0   3.0\n2   AAAAAAAACBLCBAAA  United States       KY    Kenton County  79.0  242.80    0.00  218.52  9497.38  1989.0   3.0\n3   AAAAAAAABLBPAAAA  United States       AL    Monroe County  53.0  128.47    0.00   78.36  -542.72  1934.0   3.0\n4   AAAAAAAADECEAAAA  United States       KY     Wayne County  45.0   42.89    0.00   26.16    35.10  1964.0   4.0\n5   AAAAAAAAAMCJCAAA  United States       KY     Wayne County  65.0  166.44    0.00   96.53  1047.80  1964.0   4.0\n6   AAAAAAAAGLGAAAAA  United States       KY   Johnson County   8.0   69.38    0.00   45.79   141.60  1936.0   2.0\n7   AAAAAAAABJPIBAAA  United States       WI    Oconto County  73.0  111.45    0.00   98.07  2688.59  1950.0   4.0\n8   AAAAAAAAGPOADAAA  United States       CA      Mono County  97.0   84.65  847.13   20.31 -3438.97  1932.0   4.0\n9   AAAAAAAAPCEICAAA  United States       OK  Stephens County  56.0  251.19    0.00    0.00 -5582.08  1967.0   6.0\n10  AAAAAAAAFEEECAAA  United States       OK  Stephens County  51.0  150.97    0.00  126.81  1964.52  1967.0   6.0\n11  AAAAAAAAFIKFAAAA  United States       OK  Stephens County  35.0   38.42    0.00   29.19   525.35  1967.0   6.0\n12  AAAAAAAAGHFIAAAA  United States       KY  Calloway County  31.0  134.59    0.00   71.33   736.87  1944.0   2.0\n13  AAAAAAAAIDDPCAAA  United States       KY  Calloway County  87.0   20.87  340.38   15.65   -41.10  1944.0   2.0\n14  AAAAAAAAEAPKAAAA  United States       KY  Magoffin County  35.0   80.02    0.00   10.40 -2303.35  1963.0   2.0\n15  AAAAAAAALKJHAAAA  United States       WI     Price County  34.0   72.55    0.00   42.07  -496.74  1948.0   5.0\n16  AAAAAAAADPCKBAAA  United States       KY    Marion County  18.0  154.80  662.86   60.37  -699.76  1951.0   2.0\n17  AAAAAAAAIMIDAAAA  United States       NV      Lyon County  31.0   80.73    0.00   56.72   622.40  1956.0   5.0\n18  AAAAAAAAKJFFAAAA  United States       NV      Lyon County  69.0   25.40    0.00    0.25  -656.88  1929.0   4.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        NULL::character varying as ca_country,\n        NULL::character varying as ca_state, \n        NULL::character varying as ca_county,\n        NULL::decimal(12,2) as agg1,\n        NULL::decimal(12,2) as agg2,\n        NULL::decimal(12,2) as agg3,\n        NULL::decimal(12,2) as agg4,\n        NULL::decimal(12,2) as agg5,\n        NULL::decimal(12,2) as agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n  from item,\n       customer_demographics cd1\n  where cd1.cd_gender = 'M' and \n        cd1.cd_education_status = 'Primary'\n )\nselect i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\nfrom (\n    select i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n        avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country, ca_state, ca_county\n    union all\n    select i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country, ca_state\n    union all\n    select i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country\n    union all\n    select i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id\n    union all\n    select NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH RESULTS AS ( SELECT I_ITEM_ID , CAST ( NULL AS VARCHAR ) AS CA_COUNTRY , CAST ( NULL AS VARCHAR ) AS CA_STATE , CAST ( NULL AS VARCHAR ) AS CA_COUNTY , CAST ( NULL AS DECIMAL ( 12 , 2 ) ) AS AGG1 , CAST ( NULL AS DECIMAL ( 12 , 2 ) ) AS AGG2 , CAST ( NULL AS DECIMAL ( 12 , 2 ) ) AS AGG3 , CAST ( NULL AS DECIMAL ( 12 , 2 ) ) AS AGG4 , CAST ( NULL AS DECIMAL ( 12 , 2 ) ) AS AGG5 , CAST ( NULL AS DECIMAL ( 12 , 2 ) ) AS AGG6 , CAST ( CD1.CD_DEP_COUNT AS DECIMAL ( 12 , 2 ) ) AS AGG7 FROM ITEM , CUSTOMER_DEMOGRAPHICS AS CD1 WHERE CD1.CD_GENDER = 'M' AND CD1.CD_EDUCATION_STATUS = 'Primary' ) SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AGG1 , AGG2 , AGG3 , AGG4 , AGG5 , AGG6 , AGG7 FROM ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY UNION ALL SELECT I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS ) AS FINAL_RESULTS LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOFFNBAAA  United States       CA       Sutter County   3.0  187.98   380.65  169.18  -105.19  1962.0   1.0\n1   AAAAAAAACNMGBAAA  United States       CA       Sutter County  93.0  160.35     0.00  149.12  4884.36  1962.0   1.0\n2   AAAAAAAAOCKDAAAA  United States       KY      Garrard County  49.0  106.14     0.00   20.16 -2893.45  1977.0   3.0\n3   AAAAAAAAHKMJCAAA  United States       KY      Garrard County  32.0  124.13     0.00   60.82   537.60  1977.0   3.0\n4   AAAAAAAAOCEMAAAA  United States       KY          Lee County  97.0  234.51  3184.51   65.66 -6254.56  1988.0   1.0\n5   AAAAAAAABGILCAAA  United States       KY          Lee County  88.0  108.98     0.00   87.18  3675.76  1988.0   1.0\n6   AAAAAAAAAPMMBAAA  United States       KY          Lee County  35.0    7.27     0.00    0.00  -108.85  1988.0   1.0\n7   AAAAAAAAKGCNBAAA  United States       WI    Milwaukee County  76.0   69.32     0.00   54.06  2316.48  1925.0   6.0\n8   AAAAAAAAGFPECAAA  United States       WI    Milwaukee County  85.0   26.18     0.00    0.26 -2203.20  1925.0   6.0\n9   AAAAAAAAOBINCAAA  United States       AL        Lamar County  65.0   30.54     0.00   21.07   120.90  1927.0   5.0\n10  AAAAAAAAPIGLAAAA  United States       KY       Shelby County  40.0  107.96     0.00    7.55 -2616.00  1925.0   4.0\n11  AAAAAAAADGIFAAAA  United States       OK       Beaver County  90.0   73.39     0.00   22.75 -1010.70  1971.0   5.0\n12  AAAAAAAAMDFJAAAA  United States       KY       Mercer County  22.0  136.28     0.00  106.29   792.88  1962.0   3.0\n13  AAAAAAAAKPALBAAA  United States       SD      Sanborn County  37.0   14.04     0.00   11.65   -73.63  1929.0   5.0\n14  AAAAAAAAGLNOCAAA  United States       CA  San Joaquin County  23.0   23.99   244.07   18.95  -314.45  1944.0   0.0\n15  AAAAAAAAECLHBAAA  United States       KY        Union County  81.0   85.86     0.00   27.47 -4399.11  1958.0   3.0\n16  AAAAAAAAMLEPBAAA  United States       CA      Trinity County  91.0  102.03     0.00   29.58 -3417.05  1931.0   1.0\n17  AAAAAAAAABHMAAAA  United States       OK     Stephens County  97.0   51.92     0.00   35.30  -173.63  1965.0   6.0\n18  AAAAAAAAFOJPAAAA  United States       OK     Stephens County  53.0   83.20   549.69   24.12 -2027.33  1965.0   6.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019468,
                    "execution_time": 0.008354,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004497
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019785,
                    "execution_time": 0.008153,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004746
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state           ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOFFNBAAA  United States       CA       Sutter County   3.0  187.98   380.65  169.18  -105.19  1962.0   1.0\n1   AAAAAAAACNMGBAAA  United States       CA       Sutter County  93.0  160.35     0.00  149.12  4884.36  1962.0   1.0\n2   AAAAAAAAOCKDAAAA  United States       KY      Garrard County  49.0  106.14     0.00   20.16 -2893.45  1977.0   3.0\n3   AAAAAAAAHKMJCAAA  United States       KY      Garrard County  32.0  124.13     0.00   60.82   537.60  1977.0   3.0\n4   AAAAAAAAOCEMAAAA  United States       KY          Lee County  97.0  234.51  3184.51   65.66 -6254.56  1988.0   1.0\n5   AAAAAAAABGILCAAA  United States       KY          Lee County  88.0  108.98     0.00   87.18  3675.76  1988.0   1.0\n6   AAAAAAAAAPMMBAAA  United States       KY          Lee County  35.0    7.27     0.00    0.00  -108.85  1988.0   1.0\n7   AAAAAAAAKGCNBAAA  United States       WI    Milwaukee County  76.0   69.32     0.00   54.06  2316.48  1925.0   6.0\n8   AAAAAAAAGFPECAAA  United States       WI    Milwaukee County  85.0   26.18     0.00    0.26 -2203.20  1925.0   6.0\n9   AAAAAAAAOBINCAAA  United States       AL        Lamar County  65.0   30.54     0.00   21.07   120.90  1927.0   5.0\n10  AAAAAAAAPIGLAAAA  United States       KY       Shelby County  40.0  107.96     0.00    7.55 -2616.00  1925.0   4.0\n11  AAAAAAAADGIFAAAA  United States       OK       Beaver County  90.0   73.39     0.00   22.75 -1010.70  1971.0   5.0\n12  AAAAAAAAMDFJAAAA  United States       KY       Mercer County  22.0  136.28     0.00  106.29   792.88  1962.0   3.0\n13  AAAAAAAAKPALBAAA  United States       SD      Sanborn County  37.0   14.04     0.00   11.65   -73.63  1929.0   5.0\n14  AAAAAAAAGLNOCAAA  United States       CA  San Joaquin County  23.0   23.99   244.07   18.95  -314.45  1944.0   0.0\n15  AAAAAAAAECLHBAAA  United States       KY        Union County  81.0   85.86     0.00   27.47 -4399.11  1958.0   3.0\n16  AAAAAAAAMLEPBAAA  United States       CA      Trinity County  91.0  102.03     0.00   29.58 -3417.05  1931.0   1.0\n17  AAAAAAAAABHMAAAA  United States       OK     Stephens County  97.0   51.92     0.00   35.30  -173.63  1965.0   6.0\n18  AAAAAAAAFOJPAAAA  United States       OK     Stephens County  53.0   83.20   549.69   24.12 -2027.33  1965.0   6.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAABABAAA                  AL            12.0   59.81     0.00    5.38  -500.64  1965.0   5.0\n1   AAAAAAAAAAMMBAAA                  AL            84.0   11.80     0.00    9.32   374.64  1965.0   5.0\n2   AAAAAAAAABLHBAAA                  AL            99.0  129.56     0.00   32.39 -1171.17  1989.0   2.0\n3   AAAAAAAAACAFAAAA                  AL             5.0  149.68     0.00  131.71   330.30  1960.0   6.0\n4   AAAAAAAAAEJOBAAA                  AL            94.0  109.51     0.00   95.27  2678.06  1934.0   2.0\n5   AAAAAAAAAGCCAAAA                  AL            57.0   60.14     0.00   49.91  -329.46  1940.0   0.0\n6   AAAAAAAAAHCPBAAA                  AL            98.0   40.34  1050.95   15.32 -3210.87  1930.0   3.0\n7   AAAAAAAAAHMBAAAA                  AL            40.0  108.17     0.00   12.98 -1132.40  1989.0   2.0\n8   AAAAAAAAAKONBAAA                  AL            11.0  115.28     0.00  101.44   351.89  1978.0   5.0\n9   AAAAAAAAALFABAAA                  AL            22.0  108.66     0.00   48.89  -456.94  1986.0   2.0\n10  AAAAAAAAALFHCAAA                  AL            22.0  117.14  1236.84   74.96 -1601.16  1979.0   6.0\n11  AAAAAAAAALLDBAAA                  AL            87.0   51.17     0.00   41.95  1847.01  1986.0   2.0\n12  AAAAAAAAAMLEBAAA                  AL            38.0  160.74  3023.47  159.13   924.35  1983.0   6.0\n13  AAAAAAAAAOBABAAA                  AL            76.0  141.29     0.00   63.58 -2523.20  1965.0   5.0\n14  AAAAAAAAAOOJAAAA                  AL            43.0  268.20     0.00  174.33  3651.99  1930.0   3.0\n15  AAAAAAAAAPMLAAAA                  AL            43.0   34.51     0.00   30.71   -28.81  1977.0   6.0\n16  AAAAAAAABCKADAAA                  AL            83.0  101.29     0.00   15.19 -4060.36  1940.0   0.0\n17  AAAAAAAABDCDBAAA                  AL             2.0   98.38     0.00   72.80   -38.30  1940.0   0.0\n18  AAAAAAAABEKICAAA                  AL            88.0  142.68     0.00  134.11  6613.20  1934.0   2.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.053404,
                    "execution_time": 0.023959,
                    "compile_time": 0.017819,
                    "planning_time": 0.004894
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.410014,
                    "execution_time": 0.02454,
                    "compile_time": 5.356055,
                    "planning_time": 0.04036
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAABABAAA                  AL            12.0   59.81     0.00    5.38  -500.64  1965.0   5.0\n1   AAAAAAAAAAMMBAAA                  AL            84.0   11.80     0.00    9.32   374.64  1965.0   5.0\n2   AAAAAAAAABLHBAAA                  AL            99.0  129.56     0.00   32.39 -1171.17  1989.0   2.0\n3   AAAAAAAAACAFAAAA                  AL             5.0  149.68     0.00  131.71   330.30  1960.0   6.0\n4   AAAAAAAAAEJOBAAA                  AL            94.0  109.51     0.00   95.27  2678.06  1934.0   2.0\n5   AAAAAAAAAGCCAAAA                  AL            57.0   60.14     0.00   49.91  -329.46  1940.0   0.0\n6   AAAAAAAAAHCPBAAA                  AL            98.0   40.34  1050.95   15.32 -3210.87  1930.0   3.0\n7   AAAAAAAAAHMBAAAA                  AL            40.0  108.17     0.00   12.98 -1132.40  1989.0   2.0\n8   AAAAAAAAAKONBAAA                  AL            11.0  115.28     0.00  101.44   351.89  1978.0   5.0\n9   AAAAAAAAALFABAAA                  AL            22.0  108.66     0.00   48.89  -456.94  1986.0   2.0\n10  AAAAAAAAALFHCAAA                  AL            22.0  117.14  1236.84   74.96 -1601.16  1979.0   6.0\n11  AAAAAAAAALLDBAAA                  AL            87.0   51.17     0.00   41.95  1847.01  1986.0   2.0\n12  AAAAAAAAAMLEBAAA                  AL            38.0  160.74  3023.47  159.13   924.35  1983.0   6.0\n13  AAAAAAAAAOBABAAA                  AL            76.0  141.29     0.00   63.58 -2523.20  1965.0   5.0\n14  AAAAAAAAAOOJAAAA                  AL            43.0  268.20     0.00  174.33  3651.99  1930.0   3.0\n15  AAAAAAAAAPMLAAAA                  AL            43.0   34.51     0.00   30.71   -28.81  1977.0   6.0\n16  AAAAAAAABCKADAAA                  AL            83.0  101.29     0.00   15.19 -4060.36  1940.0   0.0\n17  AAAAAAAABDCDBAAA                  AL             2.0   98.38     0.00   72.80   -38.30  1940.0   0.0\n18  AAAAAAAABEKICAAA                  AL            88.0  142.68     0.00  134.11  6613.20  1934.0   2.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAABABAAA                  AL            12.0   59.81     0.00    5.38  -500.64  1965.0   5.0\n1   AAAAAAAAAAMMBAAA                  AL            84.0   11.80     0.00    9.32   374.64  1965.0   5.0\n2   AAAAAAAAABLHBAAA                  AL            99.0  129.56     0.00   32.39 -1171.17  1989.0   2.0\n3   AAAAAAAAACAFAAAA                  AL             5.0  149.68     0.00  131.71   330.30  1960.0   6.0\n4   AAAAAAAAAEJOBAAA                  AL            94.0  109.51     0.00   95.27  2678.06  1934.0   2.0\n5   AAAAAAAAAGCCAAAA                  AL            57.0   60.14     0.00   49.91  -329.46  1940.0   0.0\n6   AAAAAAAAAHCPBAAA                  AL            98.0   40.34  1050.95   15.32 -3210.87  1930.0   3.0\n7   AAAAAAAAAHMBAAAA                  AL            40.0  108.17     0.00   12.98 -1132.40  1989.0   2.0\n8   AAAAAAAAAKONBAAA                  AL            11.0  115.28     0.00  101.44   351.89  1978.0   5.0\n9   AAAAAAAAALFABAAA                  AL            22.0  108.66     0.00   48.89  -456.94  1986.0   2.0\n10  AAAAAAAAALFHCAAA                  AL            22.0  117.14  1236.84   74.96 -1601.16  1979.0   6.0\n11  AAAAAAAAALLDBAAA                  AL            87.0   51.17     0.00   41.95  1847.01  1986.0   2.0\n12  AAAAAAAAAMLEBAAA                  AL            38.0  160.74  3023.47  159.13   924.35  1983.0   6.0\n13  AAAAAAAAAOBABAAA                  AL            76.0  141.29     0.00   63.58 -2523.20  1965.0   5.0\n14  AAAAAAAAAOOJAAAA                  AL            43.0  268.20     0.00  174.33  3651.99  1930.0   3.0\n15  AAAAAAAAAPMLAAAA                  AL            43.0   34.51     0.00   30.71   -28.81  1977.0   6.0\n16  AAAAAAAABCKADAAA                  AL            83.0  101.29     0.00   15.19 -4060.36  1940.0   0.0\n17  AAAAAAAABDCDBAAA                  AL             2.0   98.38     0.00   72.80   -38.30  1940.0   0.0\n18  AAAAAAAABEKICAAA                  AL            88.0  142.68     0.00  134.11  6613.20  1934.0   2.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03591,
                    "execution_time": 0.024278,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004858
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.036865,
                    "execution_time": 0.02474,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.005141
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAAABABAAA                  AL            12.0   59.81     0.00    5.38  -500.64  1965.0   5.0\n1   AAAAAAAAAAMMBAAA                  AL            84.0   11.80     0.00    9.32   374.64  1965.0   5.0\n2   AAAAAAAAABLHBAAA                  AL            99.0  129.56     0.00   32.39 -1171.17  1989.0   2.0\n3   AAAAAAAAACAFAAAA                  AL             5.0  149.68     0.00  131.71   330.30  1960.0   6.0\n4   AAAAAAAAAEJOBAAA                  AL            94.0  109.51     0.00   95.27  2678.06  1934.0   2.0\n5   AAAAAAAAAGCCAAAA                  AL            57.0   60.14     0.00   49.91  -329.46  1940.0   0.0\n6   AAAAAAAAAHCPBAAA                  AL            98.0   40.34  1050.95   15.32 -3210.87  1930.0   3.0\n7   AAAAAAAAAHMBAAAA                  AL            40.0  108.17     0.00   12.98 -1132.40  1989.0   2.0\n8   AAAAAAAAAKONBAAA                  AL            11.0  115.28     0.00  101.44   351.89  1978.0   5.0\n9   AAAAAAAAALFABAAA                  AL            22.0  108.66     0.00   48.89  -456.94  1986.0   2.0\n10  AAAAAAAAALFHCAAA                  AL            22.0  117.14  1236.84   74.96 -1601.16  1979.0   6.0\n11  AAAAAAAAALLDBAAA                  AL            87.0   51.17     0.00   41.95  1847.01  1986.0   2.0\n12  AAAAAAAAAMLEBAAA                  AL            38.0  160.74  3023.47  159.13   924.35  1983.0   6.0\n13  AAAAAAAAAOBABAAA                  AL            76.0  141.29     0.00   63.58 -2523.20  1965.0   5.0\n14  AAAAAAAAAOOJAAAA                  AL            43.0  268.20     0.00  174.33  3651.99  1930.0   3.0\n15  AAAAAAAAAPMLAAAA                  AL            43.0   34.51     0.00   30.71   -28.81  1977.0   6.0\n16  AAAAAAAABCKADAAA                  AL            83.0  101.29     0.00   15.19 -4060.36  1940.0   0.0\n17  AAAAAAAABDCDBAAA                  AL             2.0   98.38     0.00   72.80   -38.30  1940.0   0.0\n18  AAAAAAAABEKICAAA                  AL            88.0  142.68     0.00  134.11  6613.20  1934.0   2.0\n...*/"
    }
]