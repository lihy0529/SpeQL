[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n/*CURSOR_IDENTIFIER*/ \n    where ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217 + 11\n    group by ss_store_sk, ss_item_sk) sc\nwhere s_store_sk = sc.ss_store_sk\n  and i_item_sk = sc.ss_item_sk\n  and s_store_sk = sb.ss_store_sk\n  and sc.revenue <= 0.1 * sb.ave\norder by s_store_name, i_item_desc;",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.238245,
                    "execution_time": 1.806363,
                    "compile_time": 0.131294,
                    "planning_time": 0.033268,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.725926,
                    "execution_time": 2.778511,
                    "compile_time": 6.58126,
                    "planning_time": 0.099073,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_store_sk  ss_item_sk  revenue\n0           NaN       76251   314.57\n1         217.0       87411    85.06\n2         392.0      139175   168.52\n3           NaN      145105   213.15\n4         302.0       51083   126.11\n5         256.0         367   163.86\n6         302.0      148487   318.29\n7         256.0      163083    98.95\n8          43.0       65885    43.61\n9          43.0      144427   139.53\n10        295.0       76463    64.50\n11          NaN       30777   235.38\n12        295.0       81009   350.09\n13        176.0        7131   266.25\n14        295.0       32799   148.30\n15        295.0      168131    92.09\n16        208.0      184169    74.87\n17        214.0      118793   118.57\n18        146.0       70159   130.92\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017096,
                    "execution_time": 0.007585,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003394
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055832,
                    "execution_time": 0.008467,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.03875
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\", \"STORE_SALES\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_store_sk  ss_item_sk  revenue\n0           NaN       76251   314.57\n1         217.0       87411    85.06\n2         392.0      139175   168.52\n3           NaN      145105   213.15\n4         302.0       51083   126.11\n5         256.0         367   163.86\n6         302.0      148487   318.29\n7         256.0      163083    98.95\n8          43.0       65885    43.61\n9          43.0      144427   139.53\n10        295.0       76463    64.50\n11          NaN       30777   235.38\n12        295.0       81009   350.09\n13        176.0        7131   266.25\n14        295.0       32799   148.30\n15        295.0      168131    92.09\n16        208.0      184169    74.87\n17        214.0      118793   118.57\n18        146.0       70159   130.92\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store s, item i,\n     (select sa.ss_store_sk, avg(sa.revenue) as ave\n \tfrom\n \t    (select ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by sa.ss_store_sk) sb,\n     (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n    group by ss_store_sk, ss_item_sk) sc\nwhere s.s_store_sk = sb.ss_store_sk\n    and s.s_store_sk = sc.ss_store_sk\n    and i.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SB\" AS \"SB\" ON \"S\".\"S_STORE_SK\" = \"SB\".\"SS_STORE_SK\" JOIN \"SC\" AS \"SC\" ON \"S\".\"S_STORE_SK\" = \"SC\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.112271,
                    "execution_time": 0.032208,
                    "compile_time": 0.031735,
                    "planning_time": 0.024646,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.220991,
                    "execution_time": 0.031905,
                    "compile_time": 3.076608,
                    "planning_time": 0.086778,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.453542,
                    "execution_time": 1.246999,
                    "compile_time": 0.109599,
                    "planning_time": 0.027387,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.385338,
                    "execution_time": 3.967861,
                    "compile_time": 3.257157,
                    "planning_time": 0.085309,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080276,
                    "execution_time": 0.053631,
                    "compile_time": 0.000249,
                    "planning_time": 0.003068,
                    "create_size": 384
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.23789,
                    "execution_time": 0.053656,
                    "compile_time": 0.098218,
                    "planning_time": 0.05844,
                    "create_size": 384
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.14057,
                    "execution_time": 1.862139,
                    "compile_time": 0.000354,
                    "planning_time": 0.026363,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.626468,
                    "execution_time": 1.76898,
                    "compile_time": 3.514274,
                    "planning_time": 0.087544,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.963759,
                    "execution_time": 2.224648,
                    "compile_time": 0.067824,
                    "planning_time": 0.042583,
                    "create_size": 4352
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 17.732299,
                    "execution_time": 4.043122,
                    "compile_time": 12.945708,
                    "planning_time": 0.103884,
                    "create_size": 4352
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                            i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0           bar                                                                                                                                             Early organizations deny sometimes both absent musicians.     96.15             0.37              5.90    importoimporto #2\n1          able  Bodies shall give. Games might give to a authorities. Hours can enjoy in the players. Adjacent purposes will understand polite, fatal rules; sexual patients relax only sexual countries. Total, awar   101.06            60.48              2.05    exportiexporti #2\n2          able                                                                                                                                          Single children sort however always full vegetables. More ear   313.66             5.45              4.90     univnameless #10\n3          able                                                                       Large, dark classes could get flat only german characters. Clear, italian schools wonder at least emotionally real members. Addi   234.67             9.66              2.28    amalgunivamalg #4\n4           bar    Common times might fill gay, regional relationships. Individuals will determine by a animals. Concerned parties could work much from a troops. Late protective provisions shall train at a sheets.      1.27             4.92              3.29         corpbrand #2\n5           bar                                                 Political, additional improvements must provoke also shallow applications. Comparable spots teach probably genes. Political studies give right success    23.31             6.12              2.75      corpnameless #2\n6           bar                      Even excessive times should not make golden, canadian rates. Old conclusions will leave too investigations. Schools provide then neither public fruits. Current awards believe wi    12.55            37.11              0.25   edu packscholar #2\n7         cally                                                                        Structures move after a things. Minutes will not seek much into the women. Permanently correct pilots lay positive, entire chap    97.54             5.34              6.55      namelesscorp #6\n8           bar         Large subjects provide so thus global members. Rich citizens must not buy. Of course significant problems get national directions; experienced chains used to throw now english, top types. So    81.82            79.47             63.57     amalgedu pack #2\n9           pri                                                                                                                                                           There new actions shall underpin especially     63.38            26.10              7.83   importoedu pack #2\n10          bar                                                                                                                             Satisfied, poor victims cost really important, other friends. Problems tur   168.69             4.75              0.69    exportiimporto #2\n11          bar                                                                           Years shake even races. Fair, short changes should lessen urban, living individuals. Fresh, scottish sides will reply to the   214.54             2.09              3.06   edu packexporti #2\n12          bar                                                Substantial, right partners drop for a fields. Cultures can know once blue, inevitable cards. Police would say then well favorable legs. Traditional ob   184.04             4.68              1.77      scholarbrand #8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.113368,
                    "execution_time": 0.008583,
                    "compile_time": 0.09436,
                    "planning_time": 0.003886
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.391996,
                    "execution_time": 0.008126,
                    "compile_time": 3.333438,
                    "planning_time": 0.039375
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                            i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0           bar                                                                                                                                             Early organizations deny sometimes both absent musicians.     96.15             0.37              5.90    importoimporto #2\n1          able  Bodies shall give. Games might give to a authorities. Hours can enjoy in the players. Adjacent purposes will understand polite, fatal rules; sexual patients relax only sexual countries. Total, awar   101.06            60.48              2.05    exportiexporti #2\n2          able                                                                                                                                          Single children sort however always full vegetables. More ear   313.66             5.45              4.90     univnameless #10\n3          able                                                                       Large, dark classes could get flat only german characters. Clear, italian schools wonder at least emotionally real members. Addi   234.67             9.66              2.28    amalgunivamalg #4\n4           bar    Common times might fill gay, regional relationships. Individuals will determine by a animals. Concerned parties could work much from a troops. Late protective provisions shall train at a sheets.      1.27             4.92              3.29         corpbrand #2\n5           bar                                                 Political, additional improvements must provoke also shallow applications. Comparable spots teach probably genes. Political studies give right success    23.31             6.12              2.75      corpnameless #2\n6           bar                      Even excessive times should not make golden, canadian rates. Old conclusions will leave too investigations. Schools provide then neither public fruits. Current awards believe wi    12.55            37.11              0.25   edu packscholar #2\n7         cally                                                                        Structures move after a things. Minutes will not seek much into the women. Permanently correct pilots lay positive, entire chap    97.54             5.34              6.55      namelesscorp #6\n8           bar         Large subjects provide so thus global members. Rich citizens must not buy. Of course significant problems get national directions; experienced chains used to throw now english, top types. So    81.82            79.47             63.57     amalgedu pack #2\n9           pri                                                                                                                                                           There new actions shall underpin especially     63.38            26.10              7.83   importoedu pack #2\n10          bar                                                                                                                             Satisfied, poor victims cost really important, other friends. Problems tur   168.69             4.75              0.69    exportiimporto #2\n11          bar                                                                           Years shake even races. Fair, short changes should lessen urban, living individuals. Fresh, scottish sides will reply to the   214.54             2.09              3.06   edu packexporti #2\n12          bar                                                Substantial, right partners drop for a fields. Cultures can know once blue, inevitable cards. Police would say then well favorable legs. Traditional ob   184.04             4.68              1.77      scholarbrand #8\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SC\" AS \"SC\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                            i_item_desc  revenue  i_current_price  i_wholesale_cost          i_brand\n0         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   162.33             0.19              0.11  importomaxi #11\n1         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   142.33             0.19              0.11  importomaxi #11\n2         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   143.14             0.19              0.11  importomaxi #11\n3         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   223.98             0.19              0.11  importomaxi #11\n4         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    40.24             0.19              0.11  importomaxi #11\n5         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   108.16             0.19              0.11  importomaxi #11\n6         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    73.95             0.19              0.11  importomaxi #11\n7         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    38.83             0.19              0.11  importomaxi #11\n8         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   107.95             0.19              0.11  importomaxi #11\n9         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    62.53             0.19              0.11  importomaxi #11\n10        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   321.35             0.19              0.11  importomaxi #11\n11        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   182.15             0.19              0.11  importomaxi #11\n12        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    65.29             0.19              0.11  importomaxi #11\n13        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s     8.22             0.19              0.11  importomaxi #11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.787352,
                    "execution_time": 2.708348,
                    "compile_time": 0.00044,
                    "planning_time": 0.056655
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.8265,
                    "execution_time": 2.728447,
                    "compile_time": 6.865753,
                    "planning_time": 0.131723
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name                                                                                                                                                                            i_item_desc  revenue  i_current_price  i_wholesale_cost          i_brand\n0         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   162.33             0.19              0.11  importomaxi #11\n1         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   142.33             0.19              0.11  importomaxi #11\n2         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   143.14             0.19              0.11  importomaxi #11\n3         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   223.98             0.19              0.11  importomaxi #11\n4         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    40.24             0.19              0.11  importomaxi #11\n5         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   108.16             0.19              0.11  importomaxi #11\n6         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    73.95             0.19              0.11  importomaxi #11\n7         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    38.83             0.19              0.11  importomaxi #11\n8         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   107.95             0.19              0.11  importomaxi #11\n9         ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    62.53             0.19              0.11  importomaxi #11\n10        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   321.35             0.19              0.11  importomaxi #11\n11        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s   182.15             0.19              0.11  importomaxi #11\n12        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s    65.29             0.19              0.11  importomaxi #11\n13        ought  Plans consult interested, light boys. Selective, other problems create scientific, young parties. Sufficient speakers might not kiss too social, basic interests. Dual, other times s     8.22             0.19              0.11  importomaxi #11\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and sc.ss_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SB\" AS \"SB\" JOIN \"SC\" AS \"SC\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"SS_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n      sc.ss_item_sk = sc.ss_item_sk\n      and store.s_store_sk = sb.ss_store_sk\n      and item.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SC\" AS \"SC\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" AND \"SC\".\"SS_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.882078,
                    "execution_time": 5.582085,
                    "compile_time": 0.000258,
                    "planning_time": 0.024311,
                    "create_size": 6528
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.948683,
                    "execution_time": 5.583782,
                    "compile_time": 0.000265,
                    "planning_time": 0.087004,
                    "create_size": 6528
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.446199,
                    "execution_time": 2.225473,
                    "compile_time": 0.00038,
                    "planning_time": 0.005822,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.07489,
                    "execution_time": 2.083679,
                    "compile_time": 3.72054,
                    "planning_time": 0.060908,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SPEQLITE_TEMP_TABLE_8\".\"REVENUE\" ) AS \"AVE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" GROUP BY \"SPEQLITE_TEMP_TABLE_8\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.349617,
                    "execution_time": 0.271058,
                    "compile_time": 0.050062,
                    "planning_time": 0.003549,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.866571,
                    "execution_time": 0.271304,
                    "compile_time": 3.502536,
                    "planning_time": 0.060922,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.438449,
                    "execution_time": 2.178471,
                    "compile_time": 0.000374,
                    "planning_time": 0.005628,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.213827,
                    "execution_time": 2.195809,
                    "compile_time": 3.692604,
                    "planning_time": 0.062112,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" AND \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.292536,
                    "execution_time": 0.660817,
                    "compile_time": 0.000674,
                    "planning_time": 0.039342,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.592818,
                    "execution_time": 0.628621,
                    "compile_time": 9.305377,
                    "planning_time": 0.106581,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_11\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                        i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0           ese                                                                                                                                       Small horses ought to enact without a students. Medical esta     5.34              NaN               NaN     edu packscholar #2\n1          n st                                                                                                                                                                                  Other machines at     5.22             5.67              1.75      exportiexporti #2\n2           pri                                                                                   Negative, existing classes end churches; able goods may show from a weaknesses. Abroad evident streets will gain     7.44             8.61              6.28        amalgexporti #2\n3           bar               Industrial, new interests may feel sometimes bad, large factors. American, common symptoms confess too about possible groups. Just french acts find massive libraries. Nurses place      0.57             0.24              0.21        edu packcorp #6\n4          eing                                              So individual trends consult just revolutionary, conscious communications. Members would not make readers; so responsible officers adopt by the advis     4.18             4.13              2.10       edu packamalg #2\n5         ought                                                                                                                     New features can dry better practical men; pleasant trees increase always old-     7.62             2.07              3.31   scholarunivamalg #12\n6         cally                                                                                                                                                Supreme questions may worsen public windows. Most o     0.00             3.73              2.31      importoimporto #2\n7           ese                                          Human days should rush in a years; long paintings would not depend now gastric years. Keen services attend ago sharp policies. Grey rules will deal in a      1.53             1.83              1.42          amalgamalg #2\n8         ought             Original churches hide acceptable, guilty systems. Remote goods could like gently unexpected abilities. Little trousers get wide questions. Widely poor minutes build in a processes;      2.78             3.05              2.25       corpunivamalg #8\n9           bar                                                                                          More determined bases could increase between a unions. Quick hours deal more sharp days. Surprising impro     7.81             1.43              0.64   exportiunivamalg #12\n10         eing       Important volunteers must comply much current variables; besides free programmes provide quite other prisoners. Low, bad records attack at all clothes. Just clear figures will ensure now c     8.68             4.53              0.49      exportiexporti #2\n11        ought                                                                                                                                                                    Still other pairs must change a     5.16             0.85              0.07      exportischolar #2\n12          bar                                                                                                                                                            Costs resemble high exceptional, trying     3.51            44.39             26.63  edu packunivamalg #10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017979,
                    "execution_time": 0.007823,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.003781
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.157825,
                    "execution_time": 0.007986,
                    "compile_time": 0.102131,
                    "planning_time": 0.039421
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" AND \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_11\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                        i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0           ese                                                                                                                                       Small horses ought to enact without a students. Medical esta     5.34              NaN               NaN     edu packscholar #2\n1          n st                                                                                                                                                                                  Other machines at     5.22             5.67              1.75      exportiexporti #2\n2           pri                                                                                   Negative, existing classes end churches; able goods may show from a weaknesses. Abroad evident streets will gain     7.44             8.61              6.28        amalgexporti #2\n3           bar               Industrial, new interests may feel sometimes bad, large factors. American, common symptoms confess too about possible groups. Just french acts find massive libraries. Nurses place      0.57             0.24              0.21        edu packcorp #6\n4          eing                                              So individual trends consult just revolutionary, conscious communications. Members would not make readers; so responsible officers adopt by the advis     4.18             4.13              2.10       edu packamalg #2\n5         ought                                                                                                                     New features can dry better practical men; pleasant trees increase always old-     7.62             2.07              3.31   scholarunivamalg #12\n6         cally                                                                                                                                                Supreme questions may worsen public windows. Most o     0.00             3.73              2.31      importoimporto #2\n7           ese                                          Human days should rush in a years; long paintings would not depend now gastric years. Keen services attend ago sharp policies. Grey rules will deal in a      1.53             1.83              1.42          amalgamalg #2\n8         ought             Original churches hide acceptable, guilty systems. Remote goods could like gently unexpected abilities. Little trousers get wide questions. Widely poor minutes build in a processes;      2.78             3.05              2.25       corpunivamalg #8\n9           bar                                                                                          More determined bases could increase between a unions. Quick hours deal more sharp days. Surprising impro     7.81             1.43              0.64   exportiunivamalg #12\n10         eing       Important volunteers must comply much current variables; besides free programmes provide quite other prisoners. Low, bad records attack at all clothes. Just clear figures will ensure now c     8.68             4.53              0.49      exportiexporti #2\n11        ought                                                                                                                                                                    Still other pairs must change a     5.16             0.85              0.07      exportischolar #2\n12          bar                                                                                                                                                            Costs resemble high exceptional, trying     3.51            44.39             26.63  edu packunivamalg #10\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       store.s_store_sk = sc.ss_store_sk and\n      item.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.299566,
                    "execution_time": 0.63386,
                    "compile_time": 0.000699,
                    "planning_time": 0.039818,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.342961,
                    "execution_time": 0.635199,
                    "compile_time": 3.988866,
                    "planning_time": 0.105987,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                       i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0         ation                 Duties think potentially very, professional parts. Private, great roads send at present. Female poles would not understand successfully. Wide farmers may show fully previous, ci     0.00             2.24              1.18      brandnameless #2\n1          eing                                                                                                                                                                         Police improve here profe     3.81             3.37              1.24       univnameless #4\n2          eing                                                                                                                            Horses last results. There thorough parents sail everywhere into a gua     8.25            34.11              4.66       amalgimporto #1\n3         cally                                                                                                                                                                         Big, actual units must se     7.06             2.35              2.40     univamalgamalg #2\n4          anti                                                     Officially active schools glimpse both children. Possible hands keep ears. Again chronic ideas should want immediately soon environmental pup     2.24             4.21              3.49   amalgamalgamalg #11\n5          anti                                                                                                                                                                     Religious, external years see     8.42            11.11              6.66  scholarunivamalg #12\n6         cally                                                                                                                                                                 Sudden, dead cars should state cr     0.80            63.66              4.85         amalgamalg #2\n7         ought                                                                                                                                                                                   Dirty, outside      0.74            23.68              1.51       importoamalg #2\n8           ese                            Welsh areas would go often. Western assessments show never therefore rough bodies. Men cannot see cases. Sides represent also weeks; totally only areas shall not run      8.80             3.57              5.53         amalgamalg #2\n9          eing                                                                                                                                     Still jewish hours would contact interests. Also central rate     5.78             2.48              1.24     maxiunivamalg #16\n10         anti                                                                                Minutes may not pay likely prisoners. Narrow organisers put either later only departments. New, legal hours ensure     3.90             6.04              4.46     importoimporto #2\n11         n st                                                            Male costs can give actually. Leaves will form absent relations. Together personal points may sign in a attacks. There high persons ke     1.52             2.91              3.71     corpunivamalg #12\n12        cally                                      Words investigate black, vulnerable towns. Irish, beautiful volunteers will not stop just. Sufficient, dirty tickets show kinds. Examples could not get ther     5.45             4.96              2.59     univamalgamalg #3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018019,
                    "execution_time": 0.00778,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.003772
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05692,
                    "execution_time": 0.008526,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039335
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                       i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0         ation                 Duties think potentially very, professional parts. Private, great roads send at present. Female poles would not understand successfully. Wide farmers may show fully previous, ci     0.00             2.24              1.18      brandnameless #2\n1          eing                                                                                                                                                                         Police improve here profe     3.81             3.37              1.24       univnameless #4\n2          eing                                                                                                                            Horses last results. There thorough parents sail everywhere into a gua     8.25            34.11              4.66       amalgimporto #1\n3         cally                                                                                                                                                                         Big, actual units must se     7.06             2.35              2.40     univamalgamalg #2\n4          anti                                                     Officially active schools glimpse both children. Possible hands keep ears. Again chronic ideas should want immediately soon environmental pup     2.24             4.21              3.49   amalgamalgamalg #11\n5          anti                                                                                                                                                                     Religious, external years see     8.42            11.11              6.66  scholarunivamalg #12\n6         cally                                                                                                                                                                 Sudden, dead cars should state cr     0.80            63.66              4.85         amalgamalg #2\n7         ought                                                                                                                                                                                   Dirty, outside      0.74            23.68              1.51       importoamalg #2\n8           ese                            Welsh areas would go often. Western assessments show never therefore rough bodies. Men cannot see cases. Sides represent also weeks; totally only areas shall not run      8.80             3.57              5.53         amalgamalg #2\n9          eing                                                                                                                                     Still jewish hours would contact interests. Also central rate     5.78             2.48              1.24     maxiunivamalg #16\n10         anti                                                                                Minutes may not pay likely prisoners. Narrow organisers put either later only departments. New, legal hours ensure     3.90             6.04              4.46     importoimporto #2\n11         n st                                                            Male costs can give actually. Leaves will form absent relations. Together personal points may sign in a attacks. There high persons ke     1.52             2.91              3.71     corpunivamalg #12\n12        cally                                      Words investigate black, vulnerable towns. Irish, beautiful volunteers will not stop just. Sufficient, dirty tickets show kinds. Examples could not get ther     5.45             4.96              2.59     univamalgamalg #3\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" , \"I_ITEM_DESC\" LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0                               1.08             1.89              0.62                     \n1                               0.00             4.92               NaN                     \n2                               7.47             4.09               NaN                     \n3                               2.87             5.40              3.67                     \n4                               5.86              NaN               NaN                     \n5                               4.24             1.36               NaN     edu packbrand #7\n6                               0.80             6.18              2.96    amalgnameless #10\n7                               8.80              NaN               NaN                     \n8                               2.89              NaN              4.01     namelessbrand #3\n9                               4.26              NaN              1.77         amalgmaxi #2\n10                              4.11              NaN              1.46                     \n11                              0.42              NaN               NaN     edu packamalg #2\n12                              5.51             1.08              0.87      exportiamalg #2\n13                              8.06             0.29               NaN    amalgunivamalg #1\n14                              5.51              NaN              1.18                     \n15                              0.90              NaN               NaN                     \n16                              3.45            60.87             17.57  edu packedu pack #2\n17                              3.67              NaN              2.51                     \n18                              4.79             2.39              1.24      amalgimporto #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.106073,
                    "execution_time": 0.079911,
                    "compile_time": 0.015503,
                    "planning_time": 0.004135
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.960641,
                    "execution_time": 0.080828,
                    "compile_time": 4.906764,
                    "planning_time": 0.039346
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0                               1.08             1.89              0.62                     \n1                               0.00             4.92               NaN                     \n2                               7.47             4.09               NaN                     \n3                               2.87             5.40              3.67                     \n4                               5.86              NaN               NaN                     \n5                               4.24             1.36               NaN     edu packbrand #7\n6                               0.80             6.18              2.96    amalgnameless #10\n7                               8.80              NaN               NaN                     \n8                               2.89              NaN              4.01     namelessbrand #3\n9                               4.26              NaN              1.77         amalgmaxi #2\n10                              4.11              NaN              1.46                     \n11                              0.42              NaN               NaN     edu packamalg #2\n12                              5.51             1.08              0.87      exportiamalg #2\n13                              8.06             0.29               NaN    amalgunivamalg #1\n14                              5.51              NaN              1.18                     \n15                              0.90              NaN               NaN                     \n16                              3.45            60.87             17.57  edu packedu pack #2\n17                              3.67              NaN              2.51                     \n18                              4.79             2.39              1.24      amalgimporto #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" , \"I_ITEM_DESC\" LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0                               1.08             1.89              0.62                     \n1                               0.00             4.92               NaN                     \n2                               7.47             4.09               NaN                     \n3                               2.87             5.40              3.67                     \n4                               5.86              NaN               NaN                     \n5                               4.24             1.36               NaN     edu packbrand #7\n6                               0.80             6.18              2.96    amalgnameless #10\n7                               8.80              NaN               NaN                     \n8                               2.89              NaN              4.01     namelessbrand #3\n9                               4.26              NaN              1.77         amalgmaxi #2\n10                              4.11              NaN              1.46                     \n11                              0.42              NaN               NaN     edu packamalg #2\n12                              5.51             1.08              0.87      exportiamalg #2\n13                              8.06             0.29               NaN    amalgunivamalg #1\n14                              5.51              NaN              1.18                     \n15                              0.90              NaN               NaN                     \n16                              3.45            60.87             17.57  edu packedu pack #2\n17                              3.67              NaN              2.51                     \n18                              4.79             2.39              1.24      amalgimporto #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.090833,
                    "execution_time": 0.080323,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.090967,
                    "execution_time": 0.080197,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004145
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost              i_brand\n0                               1.08             1.89              0.62                     \n1                               0.00             4.92               NaN                     \n2                               7.47             4.09               NaN                     \n3                               2.87             5.40              3.67                     \n4                               5.86              NaN               NaN                     \n5                               4.24             1.36               NaN     edu packbrand #7\n6                               0.80             6.18              2.96    amalgnameless #10\n7                               8.80              NaN               NaN                     \n8                               2.89              NaN              4.01     namelessbrand #3\n9                               4.26              NaN              1.77         amalgmaxi #2\n10                              4.11              NaN              1.46                     \n11                              0.42              NaN               NaN     edu packamalg #2\n12                              5.51             1.08              0.87      exportiamalg #2\n13                              8.06             0.29               NaN    amalgunivamalg #1\n14                              5.51              NaN              1.18                     \n15                              0.90              NaN               NaN                     \n16                              3.45            60.87             17.57  edu packedu pack #2\n17                              3.67              NaN              2.51                     \n18                              4.79             2.39              1.24      amalgimporto #2\n...*/"
    }
]