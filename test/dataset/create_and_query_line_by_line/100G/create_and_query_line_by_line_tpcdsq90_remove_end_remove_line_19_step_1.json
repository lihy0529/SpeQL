[
    {
        "input": "-- start template query90.tpl query 40 in stream 0\n/*CURSOR_IDENTIFIER*/ SELECT 1",
        "optimize": [
            "SELECT 1 AS \"1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT 1 AS \"1\" LIMIT 21",
                "preview": "\n/*   1\n0  1*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.698388,
                    "execution_time": 0.489791,
                    "compile_time": 0.000348,
                    "planning_time": 0.075675
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.602509,
                    "execution_time": 0.202001,
                    "compile_time": 0.001786,
                    "planning_time": 0.107421
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 1 AS \"1\"",
                "rewrite": "SELECT 1 AS \"1\""
            }
        ],
        "preview": "\n/*   1\n0  1*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(1 as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       ) as subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( 1 AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, 1 as pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n) as derived_table /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH DERIVED_TABLE AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH DERIVED_TABLE AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\"",
                "rewrite": "WITH DERIVED_TABLE AS ( SELECT COUNT ( * ) AS \"AMC\" , 1 AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"DERIVED_TABLE\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"DERIVED_TABLE\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SUBQUERY\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SUBQUERY\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) as amc, count(*) as pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n/*CURSOR_IDENTIFIER*/) t",
        "optimize": [
            "WITH \"T\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"T\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"T\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.414978,
                    "execution_time": 0.272658,
                    "compile_time": 0.070532,
                    "planning_time": 0.042497,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.454196,
                    "execution_time": 4.902643,
                    "compile_time": 3.400146,
                    "planning_time": 0.114562,
                    "create_size": 5
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0          1.0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.048119,
                    "execution_time": 0.007235,
                    "compile_time": 0.03183,
                    "planning_time": 0.003318
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.137549,
                    "execution_time": 0.007874,
                    "compile_time": 3.082674,
                    "planning_time": 0.038252
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0          1.0*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n/*CURSOR_IDENTIFIER*/ ) t",
        "optimize": [
            "WITH \"T\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"T\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"T\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS \"AMC\" , \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106662,
                    "execution_time": 0.039841,
                    "compile_time": 0.0173,
                    "planning_time": 0.023887,
                    "create_size": 80
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.031082,
                    "execution_time": 0.040681,
                    "compile_time": 2.875547,
                    "planning_time": 0.084373,
                    "create_size": 65
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017051,
                    "execution_time": 0.007539,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003492
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.144578,
                    "execution_time": 0.007302,
                    "compile_time": 0.089764,
                    "planning_time": 0.038746
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_2\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc, count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n/*CURSOR_IDENTIFIER*/ ) t",
        "optimize": [
            "WITH \"T\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"T\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"T\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS \"AMC\" , \"SPEQLITE_TEMP_TABLE_1\".\"PMC\" AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.562828,
                    "execution_time": 0.307847,
                    "compile_time": 0.161309,
                    "planning_time": 0.028658,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.156052,
                    "execution_time": 0.58099,
                    "compile_time": 6.402263,
                    "planning_time": 0.093807,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017252,
                    "execution_time": 0.007712,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003457
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055578,
                    "execution_time": 0.007864,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039125
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_3\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0           1.0\n1           1.0\n2           1.0\n3           1.0\n4           1.0\n5           1.0\n6           1.0\n7           1.0\n8           1.0\n9           1.0\n10          1.0\n11          1.0\n12          1.0\n13          1.0\n14          1.0\n15          1.0\n16          1.0\n17          1.0\n18          1.0\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from (\n       select count(*) as amc, count(*) as pmc \n       from household_demographics, web_page\n       where web_page.wp_web_page_sk is not null\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200\n     ) at\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND NOT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" IS NULL WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"AT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT COUNT ( * ) AS \"AMC\" , COUNT ( * ) AS \"PMC\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND NOT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" IS NULL WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.134259,
                    "execution_time": 0.036308,
                    "compile_time": 0.041181,
                    "planning_time": 0.02956,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.418053,
                    "execution_time": 0.208519,
                    "compile_time": 6.245163,
                    "planning_time": 0.092542,
                    "create_size": 5
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0          1.0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017378,
                    "execution_time": 0.007606,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003603
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052996,
                    "execution_time": 0.007843,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039045
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_4\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0          1.0*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n/*CURSOR_IDENTIFIER*/ )  pmc",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"AMC\" AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.458943,
                    "execution_time": 5.312835,
                    "compile_time": 0.061956,
                    "planning_time": 0.034754,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.541945,
                    "execution_time": 12.297932,
                    "compile_time": 3.088283,
                    "planning_time": 0.099224,
                    "create_size": 2176
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT COUNT ( * ) AS \"PMC\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060739,
                    "execution_time": 0.033173,
                    "compile_time": 0.000286,
                    "planning_time": 0.002651,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.122339,
                    "execution_time": 0.034721,
                    "compile_time": 0.000322,
                    "planning_time": 0.058722,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_6\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_6\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0    71969917.0\n1    71969917.0\n2    71969917.0\n3    71969917.0\n4    71969917.0\n5    71969917.0\n6    71969917.0\n7    71969917.0\n8    71969917.0\n9    71969917.0\n10   71969917.0\n11   71969917.0\n12   71969917.0\n13   71969917.0\n14   71969917.0\n15   71969917.0\n16   71969917.0\n17   71969917.0\n18   71969917.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 3.72619,
                    "execution_time": 3.714661,
                    "compile_time": 0.031086,
                    "planning_time": 0.00429
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.868782,
                    "execution_time": 3.806817,
                    "compile_time": 3.296757,
                    "planning_time": 0.039627
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_6\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_6\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0    71969917.0\n1    71969917.0\n2    71969917.0\n3    71969917.0\n4    71969917.0\n5    71969917.0\n6    71969917.0\n7    71969917.0\n8    71969917.0\n9    71969917.0\n10   71969917.0\n11   71969917.0\n12   71969917.0\n13   71969917.0\n14   71969917.0\n15   71969917.0\n16   71969917.0\n17   71969917.0\n18   71969917.0\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\"",
                "rewrite": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"TIME_DIM\" AS \"TIME_DIM\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\nand ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 19 and 19+1\n         and household_demographics.hd_dep_count = 5\n         and web_page.wp_char_count between 5201 and 5500) bt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"BT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 5 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 20 AND \"TIME_DIM\".\"T_HOUR\" >= 19 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5500 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5201 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"BT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"BT\" AS \"BT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.480858,
                    "execution_time": 1.292946,
                    "compile_time": 0.000256,
                    "planning_time": 0.027296,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.565409,
                    "execution_time": 1.301805,
                    "compile_time": 0.000269,
                    "planning_time": 0.087701,
                    "create_size": 1664
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.213837,
                    "execution_time": 0.1076,
                    "compile_time": 0.039598,
                    "planning_time": 0.03684,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.432972,
                    "execution_time": 0.109008,
                    "compile_time": 6.186495,
                    "planning_time": 0.100945,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 5 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 20 AND \"TIME_DIM\".\"T_HOUR\" >= 19 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5500 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5201 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.222263,
                    "execution_time": 0.112556,
                    "compile_time": 0.032741,
                    "planning_time": 0.047183,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.53695,
                    "execution_time": 0.111652,
                    "compile_time": 3.289193,
                    "planning_time": 0.101868,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_8\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.102145,
                    "execution_time": 0.044097,
                    "compile_time": 0.031821,
                    "planning_time": 0.004124,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.420546,
                    "execution_time": 0.045694,
                    "compile_time": 3.284717,
                    "planning_time": 0.064154,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.294314*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033829,
                    "execution_time": 0.009326,
                    "compile_time": 0.015992,
                    "planning_time": 0.00285
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.089448,
                    "execution_time": 0.007608,
                    "compile_time": 3.036009,
                    "planning_time": 0.038623
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_8\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_9\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.294314*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\"",
                "rewrite": "WITH PMC AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" ) SELECT CAST ( \"SPEQLITE_TEMP_TABLE_5\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"PMC\" AS \"PMC\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.378733,
                    "execution_time": 0.263928,
                    "compile_time": 0.050658,
                    "planning_time": 0.033501,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.382734,
                    "execution_time": 2.103202,
                    "compile_time": 3.133227,
                    "planning_time": 0.109814,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_8\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_11\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.072424,
                    "execution_time": 0.044116,
                    "compile_time": 0.000313,
                    "planning_time": 0.004729,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.223232,
                    "execution_time": 0.043833,
                    "compile_time": 0.095428,
                    "planning_time": 0.061178,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.000136*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015977,
                    "execution_time": 0.006913,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003329
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.091067,
                    "execution_time": 0.007852,
                    "compile_time": 0.038454,
                    "planning_time": 0.038725
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_8\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_11\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.000136*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"_Q_0\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"_Q_0\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"PMC\" AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.087764,
                    "execution_time": 0.038917,
                    "compile_time": 0.000288,
                    "planning_time": 0.024057,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.151483,
                    "execution_time": 0.038973,
                    "compile_time": 0.000289,
                    "planning_time": 0.083737,
                    "create_size": 48
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_8\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_13\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.074558,
                    "execution_time": 0.045599,
                    "compile_time": 0.000283,
                    "planning_time": 0.004207,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.196488,
                    "execution_time": 0.045389,
                    "compile_time": 0.057966,
                    "planning_time": 0.065967,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    am_pm_ratio\n0      0.000136\n1      0.000136\n2      0.000136\n3      0.000136\n4      0.000136\n5      0.000136\n6      0.000136\n7      0.000136\n8      0.000136\n9      0.000136\n10     0.000136\n11     0.000136\n12     0.000136\n13     0.000136\n14     0.000136\n15     0.000136\n16     0.000136\n17     0.000136\n18     0.000136\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015175,
                    "execution_time": 0.006745,
                    "compile_time": 3.9e-05,
                    "planning_time": 0.002938
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052435,
                    "execution_time": 0.007319,
                    "compile_time": 5e-05,
                    "planning_time": 0.038183
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_8\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_13\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    am_pm_ratio\n0      0.000136\n1      0.000136\n2      0.000136\n3      0.000136\n4      0.000136\n5      0.000136\n6      0.000136\n7      0.000136\n8      0.000136\n9      0.000136\n10     0.000136\n11     0.000136\n12     0.000136\n13     0.000136\n14     0.000136\n15     0.000136\n16     0.000136\n17     0.000136\n18     0.000136\n...*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n/*CURSOR_IDENTIFIER*/ ) pmc",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PMC\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PMC\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PMC\" AS \"PMC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.109086,
                    "execution_time": 0.03162,
                    "compile_time": 0.031477,
                    "planning_time": 0.022537,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.458973,
                    "execution_time": 0.031904,
                    "compile_time": 3.31782,
                    "planning_time": 0.081509,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 AND \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.214147,
                    "execution_time": 0.107877,
                    "compile_time": 0.042587,
                    "planning_time": 0.032679,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.174266,
                    "execution_time": 1.736116,
                    "compile_time": 3.290703,
                    "planning_time": 0.098743,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.664947,
                    "execution_time": 0.586282,
                    "compile_time": 0.015503,
                    "planning_time": 0.032528,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.067919,
                    "execution_time": 0.600667,
                    "compile_time": 3.340287,
                    "planning_time": 0.098502,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_16\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_17\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.070732,
                    "execution_time": 0.044562,
                    "compile_time": 0.000281,
                    "planning_time": 0.004161,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.128563,
                    "execution_time": 0.045609,
                    "compile_time": 0.000289,
                    "planning_time": 0.06057,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.009071*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015778,
                    "execution_time": 0.007141,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003081
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051826,
                    "execution_time": 0.00755,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038466
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_16\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_17\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.009071*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) pt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PT\" AS \"PT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.112711,
                    "execution_time": 0.031559,
                    "compile_time": 0.032179,
                    "planning_time": 0.023726,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.465214,
                    "execution_time": 0.032646,
                    "compile_time": 3.316719,
                    "planning_time": 0.084642,
                    "create_size": 5
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT COUNT ( * ) AS \"AMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.831788,
                    "execution_time": 1.756268,
                    "compile_time": 0.016999,
                    "planning_time": 0.027623,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.160821,
                    "execution_time": 1.755814,
                    "compile_time": 3.282133,
                    "planning_time": 0.088606,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT COUNT ( * ) AS \"PMC\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.198919,
                    "execution_time": 0.138843,
                    "compile_time": 0.000462,
                    "planning_time": 0.028612,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.314036,
                    "execution_time": 0.136952,
                    "compile_time": 0.053371,
                    "planning_time": 0.089069,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT CAST ( \"SPEQLITE_TEMP_TABLE_20\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071366,
                    "execution_time": 0.04445,
                    "compile_time": 0.000298,
                    "planning_time": 0.004141,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.126624,
                    "execution_time": 0.043376,
                    "compile_time": 0.000276,
                    "planning_time": 0.061002,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.535879*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016004,
                    "execution_time": 0.007492,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002921
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051881,
                    "execution_time": 0.007393,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038513
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_20\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.535879*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PT\" AS \"PT\" ORDER BY \"AM_PM_RATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"AM_PM_RATIO\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.535879*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.055658,
                    "execution_time": 0.007807,
                    "compile_time": 0.039224,
                    "planning_time": 0.003085
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.753605,
                    "execution_time": 0.009052,
                    "compile_time": 4.702003,
                    "planning_time": 0.038641
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_20\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ORDER BY \"AM_PM_RATIO\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"AM_PM_RATIO\" NULLS LAST"
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.535879*/"
    },
    {
        "input": "-- start template query90.tpl query 40 in stream 0\nselect /* TPC-DS query90.tpl 0.40 */  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\n from ( select count(*) amc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 7 and 7+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) at,\n      ( select count(*) pmc\n       from web_sales, household_demographics , time_dim, web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 18 and 18+1\n         and household_demographics.hd_dep_count = 9\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_TIME_SK\" AS \"WS_SOLD_TIME_SK\" , \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" AS \"WS_SHIP_HDEMO_SK\" , \"WEB_SALES\".\"WS_WEB_PAGE_SK\" AS \"WS_WEB_PAGE_SK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"HOUSEHOLD_DEMOGRAPHICS_2\" AS ( SELECT \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AS \"HD_DEMO_SK\" , \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" AS \"HD_DEP_COUNT\" FROM \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" WHERE \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 9 ) , \"WEB_PAGE_2\" AS ( SELECT \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" AS \"WP_WEB_PAGE_SK\" , \"WEB_PAGE\".\"WP_CHAR_COUNT\" AS \"WP_CHAR_COUNT\" FROM \"WEB_PAGE\" AS \"WEB_PAGE\" WHERE \"WEB_PAGE\".\"WP_CHAR_COUNT\" <= 5200 AND \"WEB_PAGE\".\"WP_CHAR_COUNT\" >= 5000 ) , \"AT\" AS ( SELECT COUNT ( * ) AS \"AMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 8 AND \"TIME_DIM\".\"T_HOUR\" >= 7 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) , \"PT\" AS ( SELECT COUNT ( * ) AS \"PMC\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"HOUSEHOLD_DEMOGRAPHICS_2\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"WEB_SALES\".\"WS_SHIP_HDEMO_SK\" JOIN \"TIME_DIM\" AS \"TIME_DIM\" ON \"TIME_DIM\".\"T_HOUR\" <= 19 AND \"TIME_DIM\".\"T_HOUR\" >= 18 AND \"TIME_DIM\".\"T_TIME_SK\" = \"WEB_SALES\".\"WS_SOLD_TIME_SK\" JOIN \"WEB_PAGE_2\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" ) SELECT CAST ( \"AT\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"PT\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"AT\" AS \"AT\" CROSS JOIN \"PT\" AS \"PT\" ORDER BY \"AM_PM_RATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"AM_PM_RATIO\" LIMIT 21",
                "preview": "\n/*   am_pm_ratio\n0     0.535879*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016611,
                    "execution_time": 0.007819,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.00312
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016679,
                    "execution_time": 0.007858,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.003105
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT CAST ( \"SPEQLITE_TEMP_TABLE_20\".\"AMC\" AS DECIMAL ( 15 , 4 ) ) / CAST ( \"SPEQLITE_TEMP_TABLE_21\".\"PMC\" AS DECIMAL ( 15 , 4 ) ) AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ORDER BY \"AM_PM_RATIO\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"AM_PM_RATIO\" AS \"AM_PM_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"AM_PM_RATIO\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   am_pm_ratio\n0     0.535879*/"
    }
]