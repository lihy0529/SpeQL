[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   '' as w_warehouse_name\n  ,'' as sm_type\n  ,'' as web_name\n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK > 30) and \n                 (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK > 60) and \n                 (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK > 90) and\n                 (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (WS_SHIP_DATE_SK - WS_SOLD_DATE_SK  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name sm_type web_name   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                    17991194    17992654    17992031     17998457            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.23461,
                    "execution_time": 0.144268,
                    "compile_time": 0.043606,
                    "planning_time": 0.038124
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.015621,
                    "execution_time": 5.695382,
                    "compile_time": 3.376916,
                    "planning_time": 0.090385
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "rewrite": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
            }
        ],
        "preview": "\n/*  w_warehouse_name sm_type web_name   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                    17991194    17992654    17992031     17998457            0*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring('unknown warehouse',1,20) as w_warehouse_name\n  ,'unknown sm_type' as sm_type\n  ,'unknown web_name' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( 'unknown warehouse' , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , 'unknown sm_type' AS \"SM_TYPE\" , 'unknown web_name' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUBSTRING ( 'unknown warehouse' FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , 'unknown sm_type' AS \"SM_TYPE\" , 'unknown web_name' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" LIMIT 21",
                "preview": "\n/*    w_warehouse_name          sm_type          web_name   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  unknown warehouse  unknown sm_type  unknown web_name  17991194    17992654    17992031     17998457            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.201354,
                    "execution_time": 0.144328,
                    "compile_time": 0.016774,
                    "planning_time": 0.031392
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.172139,
                    "execution_time": 0.144893,
                    "compile_time": 2.930145,
                    "planning_time": 0.087173
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING('unknown warehouse', 1, 20) AS \"W_WAREHOUSE_NAME\", 'unknown sm_type' AS \"SM_TYPE\", 'unknown web_name' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "rewrite": "SELECT SUBSTRING('unknown warehouse', 1, 20) AS \"W_WAREHOUSE_NAME\", 'unknown sm_type' AS \"SM_TYPE\", 'unknown web_name' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\""
            }
        ],
        "preview": "\n/*    w_warehouse_name          sm_type          web_name   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  unknown warehouse  unknown sm_type  unknown web_name  17991194    17992654    17992031     17998457            0*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\ngroup by w_warehouse_name, sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere 1=1\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,'unknown' as web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", 'unknown' AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , 'unknown' AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n   join warehouse on ws_warehouse_sk = w_warehouse_sk\n   join ship_mode on ws_ship_mode_sk = sm_ship_mode_sk\n   join web_site on ws_web_site_sk = web_site_sk\n   join date_dim on ws_ship_date_sk = d_date_sk\nwhere\n    d_month_seq between 1185 and 1185 + 11\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.446063,
                    "execution_time": 0.245877,
                    "compile_time": 0.10226,
                    "planning_time": 0.062476,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.785372,
                    "execution_time": 4.005312,
                    "compile_time": 11.751607,
                    "planning_time": 0.148021,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0    Friendly, suitable     TWO DAY   site_1     8937        9051        8859         8973            0\n1   Local, mass universi    REGULAR   site_2     8918        8982        8984         9051            0\n2   Local, mass universi    EXPRESS   site_1    12050       11665       11933        12015            0\n3    Friendly, suitable     TWO DAY   site_2     9022        8929        9082         9083            0\n4         Quite effectiv    EXPRESS   site_3    12211       11892       11940        11758            0\n5   Local, mass universi   NEXT DAY   site_0    12124       12109       11983        12125            0\n6       Plain, reluctant  OVERNIGHT   site_3     8986        8941        9006         8934            0\n7            Doors canno  OVERNIGHT   site_1     9012        9102        8806         9032            0\n8     New proceedings fo    TWO DAY   site_0     9022        9069        8872         8966            0\n9          Important dem    EXPRESS   site_0    11882       12113       12063        11891            0\n10  Local, mass universi    EXPRESS   site_2    11888       12005       11934        11993            0\n11                          LIBRARY   site_0     8886        9016        8984         8879            0\n12                          EXPRESS   site_3    11840       11868       11965        12016            0\n13      Plain, reluctant    REGULAR   site_2     8991        8862        8909         8999            0\n14  Important issues liv    TWO DAY   site_0     9057        8937        8878         8981            0\n15      National, comple    TWO DAY   site_1     9044        8885        8866         9050            0\n16      Please central m    TWO DAY   site_0     8856        8946        8802         8968            0\n17  Bad cards must make.  OVERNIGHT   site_1     9048        8986        9030         9020            0\n18           Doors canno   NEXT DAY   site_1    12024       12145       12004        12235            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.12392,
                    "execution_time": 0.007427,
                    "compile_time": 0.106048,
                    "planning_time": 0.004173
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.124362,
                    "execution_time": 0.008336,
                    "compile_time": 3.06304,
                    "planning_time": 0.042389
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0    Friendly, suitable     TWO DAY   site_1     8937        9051        8859         8973            0\n1   Local, mass universi    REGULAR   site_2     8918        8982        8984         9051            0\n2   Local, mass universi    EXPRESS   site_1    12050       11665       11933        12015            0\n3    Friendly, suitable     TWO DAY   site_2     9022        8929        9082         9083            0\n4         Quite effectiv    EXPRESS   site_3    12211       11892       11940        11758            0\n5   Local, mass universi   NEXT DAY   site_0    12124       12109       11983        12125            0\n6       Plain, reluctant  OVERNIGHT   site_3     8986        8941        9006         8934            0\n7            Doors canno  OVERNIGHT   site_1     9012        9102        8806         9032            0\n8     New proceedings fo    TWO DAY   site_0     9022        9069        8872         8966            0\n9          Important dem    EXPRESS   site_0    11882       12113       12063        11891            0\n10  Local, mass universi    EXPRESS   site_2    11888       12005       11934        11993            0\n11                          LIBRARY   site_0     8886        9016        8984         8879            0\n12                          EXPRESS   site_3    11840       11868       11965        12016            0\n13      Plain, reluctant    REGULAR   site_2     8991        8862        8909         8999            0\n14  Important issues liv    TWO DAY   site_0     9057        8937        8878         8981            0\n15      National, comple    TWO DAY   site_1     9044        8885        8866         9050            0\n16      Please central m    TWO DAY   site_0     8856        8946        8802         8968            0\n17  Bad cards must make.  OVERNIGHT   site_1     9048        8986        9030         9020            0\n18           Doors canno   NEXT DAY   site_1    12024       12145       12004        12235            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\ngroup by \n   substring(w_warehouse_name,1,20),\n   sm_type,\n   web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\ngroup by substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20) as w_warehouse_name\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.877283,
                    "execution_time": 1.777348,
                    "compile_time": 0.000491,
                    "planning_time": 0.063299,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.108138,
                    "execution_time": 1.777707,
                    "compile_time": 5.141654,
                    "planning_time": 0.147095,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_2\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*        w_warehouse_name    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       Please central m    REGULAR   site_2   214410      216840      214452       213918            0\n1      New, net purposes   NEXT DAY   site_2   289944      286860      287826       286008            0\n2          Important dem    LIBRARY   site_1   214482      214578      218454       214056            0\n3          Important dem    LIBRARY   site_2   214482      214578      218454       214056            0\n4   Important issues liv  OVERNIGHT   site_0   215532      215532      214992       215304            0\n5       National, comple    TWO DAY   site_3   214704      215304      214626       215814            0\n6       National, comple   NEXT DAY   site_3   285954      288150      285330       289836            0\n7   Important issues liv    EXPRESS   site_0   288720      286470      288762       285996            0\n8       Plain, reluctant    REGULAR   site_0   214368      215010      215040       215964            0\n9     New proceedings fo   NEXT DAY   site_0   288120      286224      286974       286476            0\n10        Quite effectiv    REGULAR   site_1   212640      220044      214182       214818            0\n11        Quite effectiv    REGULAR   site_3   212640      220044      214182       214818            0\n12           Rooms cook   OVERNIGHT   site_3   216630      214608      217212       216012            0\n13   Friendly, suitable    NEXT DAY   site_1   289644      285342      289218       287790            0\n14   Friendly, suitable    NEXT DAY   site_3   289644      285342      289218       287790            0\n15      Please central m   NEXT DAY   site_0   288318      288960      287640       288966            0\n16     New, net purposes    REGULAR   site_0   216414      217890      216120       216492            0\n17     New, net purposes    REGULAR   site_3   216414      217890      216120       216492            0\n18      Please central m    EXPRESS   site_1   286590      287592      287082       288096            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019068,
                    "execution_time": 0.00795,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.00449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.099034,
                    "execution_time": 0.007565,
                    "compile_time": 0.042545,
                    "planning_time": 0.042411
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_2\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*        w_warehouse_name    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       Please central m    REGULAR   site_2   214410      216840      214452       213918            0\n1      New, net purposes   NEXT DAY   site_2   289944      286860      287826       286008            0\n2          Important dem    LIBRARY   site_1   214482      214578      218454       214056            0\n3          Important dem    LIBRARY   site_2   214482      214578      218454       214056            0\n4   Important issues liv  OVERNIGHT   site_0   215532      215532      214992       215304            0\n5       National, comple    TWO DAY   site_3   214704      215304      214626       215814            0\n6       National, comple   NEXT DAY   site_3   285954      288150      285330       289836            0\n7   Important issues liv    EXPRESS   site_0   288720      286470      288762       285996            0\n8       Plain, reluctant    REGULAR   site_0   214368      215010      215040       215964            0\n9     New proceedings fo   NEXT DAY   site_0   288120      286224      286974       286476            0\n10        Quite effectiv    REGULAR   site_1   212640      220044      214182       214818            0\n11        Quite effectiv    REGULAR   site_3   212640      220044      214182       214818            0\n12           Rooms cook   OVERNIGHT   site_3   216630      214608      217212       216012            0\n13   Friendly, suitable    NEXT DAY   site_1   289644      285342      289218       287790            0\n14   Friendly, suitable    NEXT DAY   site_3   289644      285342      289218       287790            0\n15      Please central m   NEXT DAY   site_0   288318      288960      287640       288966            0\n16     New, net purposes    REGULAR   site_0   216414      217890      216120       216492            0\n17     New, net purposes    REGULAR   site_3   216414      217890      216120       216492            0\n18      Please central m    EXPRESS   site_1   286590      287592      287082       288096            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20),\n   sm_type,\n   web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           NEXT DAY   site_0    11994       12028       11846        12118            0\n1          OVERNIGHT   site_0     9048        9098        8954         8914            0\n2            LIBRARY   site_0     8886        9016        8984         8879            0\n3            REGULAR   site_0     9009        8773        9025         9027            0\n4            REGULAR   site_3     9070        8809        8860         9067            0\n5           NEXT DAY   site_2    12061       12058       11965        11879            0\n6            EXPRESS   site_1    11894       11994       11801        12158            0\n7           NEXT DAY   site_1    11865       11949       12030        11950            0\n8          OVERNIGHT   site_3     8830        8880        8876         9092            0\n9          OVERNIGHT   site_1     8916        9005        8896         8831            0\n10           LIBRARY   site_1     9098        9011        9214         8869            0\n11           EXPRESS   site_3    11840       11868       11965        12016            0\n12           TWO DAY   site_1     9147        8845        8931         9009            0\n13           REGULAR   site_1     9006        9069        9056         9009            0\n14           LIBRARY   site_3     9031        8897        8967         9001            0\n15           REGULAR   site_2     9004        9000        8999         8889            0\n16           TWO DAY   site_2     8892        8862        9038         8907            0\n17         OVERNIGHT   site_2     8844        8995        9020         9012            0\n18           EXPRESS   site_2    11811       11979       11753        12220            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033373,
                    "execution_time": 0.009063,
                    "compile_time": 0.013294,
                    "planning_time": 0.004527
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.349271,
                    "execution_time": 0.00913,
                    "compile_time": 5.293279,
                    "planning_time": 0.042449
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           NEXT DAY   site_0    11994       12028       11846        12118            0\n1          OVERNIGHT   site_0     9048        9098        8954         8914            0\n2            LIBRARY   site_0     8886        9016        8984         8879            0\n3            REGULAR   site_0     9009        8773        9025         9027            0\n4            REGULAR   site_3     9070        8809        8860         9067            0\n5           NEXT DAY   site_2    12061       12058       11965        11879            0\n6            EXPRESS   site_1    11894       11994       11801        12158            0\n7           NEXT DAY   site_1    11865       11949       12030        11950            0\n8          OVERNIGHT   site_3     8830        8880        8876         9092            0\n9          OVERNIGHT   site_1     8916        9005        8896         8831            0\n10           LIBRARY   site_1     9098        9011        9214         8869            0\n11           EXPRESS   site_3    11840       11868       11965        12016            0\n12           TWO DAY   site_1     9147        8845        8931         9009            0\n13           REGULAR   site_1     9006        9069        9056         9009            0\n14           LIBRARY   site_3     9031        8897        8967         9001            0\n15           REGULAR   site_2     9004        9000        8999         8889            0\n16           TWO DAY   site_2     8892        8862        9038         8907            0\n17         OVERNIGHT   site_2     8844        8995        9020         9012            0\n18           EXPRESS   site_2    11811       11979       11753        12220            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS   site_1    11894       11994       11801        12158            0\n1            EXPRESS   site_0    11918       11918       11804        12050            0\n2            EXPRESS   site_3    11840       11868       11965        12016            0\n3            EXPRESS   site_2    11811       11979       11753        12220            0\n4            LIBRARY   site_3     9031        8897        8967         9001            0\n5            LIBRARY   site_1     9098        9011        9214         8869            0\n6            LIBRARY   site_2     9144        8784        9090         8838            0\n7            LIBRARY   site_0     8886        9016        8984         8879            0\n8           NEXT DAY   site_3    11963       12047       11927        12026            0\n9           NEXT DAY   site_0    11994       12028       11846        12118            0\n10          NEXT DAY   site_2    12061       12058       11965        11879            0\n11          NEXT DAY   site_1    11865       11949       12030        11950            0\n12         OVERNIGHT   site_2     8844        8995        9020         9012            0\n13         OVERNIGHT   site_0     9048        9098        8954         8914            0\n14         OVERNIGHT   site_3     8830        8880        8876         9092            0\n15         OVERNIGHT   site_1     8916        9005        8896         8831            0\n16           REGULAR   site_3     9070        8809        8860         9067            0\n17           REGULAR   site_0     9009        8773        9025         9027            0\n18           REGULAR   site_2     9004        9000        8999         8889            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032328,
                    "execution_time": 0.008397,
                    "compile_time": 0.013211,
                    "planning_time": 0.004377
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.682383,
                    "execution_time": 0.009781,
                    "compile_time": 4.626919,
                    "planning_time": 0.04286
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS   site_1    11894       11994       11801        12158            0\n1            EXPRESS   site_0    11918       11918       11804        12050            0\n2            EXPRESS   site_3    11840       11868       11965        12016            0\n3            EXPRESS   site_2    11811       11979       11753        12220            0\n4            LIBRARY   site_3     9031        8897        8967         9001            0\n5            LIBRARY   site_1     9098        9011        9214         8869            0\n6            LIBRARY   site_2     9144        8784        9090         8838            0\n7            LIBRARY   site_0     8886        9016        8984         8879            0\n8           NEXT DAY   site_3    11963       12047       11927        12026            0\n9           NEXT DAY   site_0    11994       12028       11846        12118            0\n10          NEXT DAY   site_2    12061       12058       11965        11879            0\n11          NEXT DAY   site_1    11865       11949       12030        11950            0\n12         OVERNIGHT   site_2     8844        8995        9020         9012            0\n13         OVERNIGHT   site_0     9048        9098        8954         8914            0\n14         OVERNIGHT   site_3     8830        8880        8876         9092            0\n15         OVERNIGHT   site_1     8916        9005        8896         8831            0\n16           REGULAR   site_3     9070        8809        8860         9067            0\n17           REGULAR   site_0     9009        8773        9025         9027            0\n18           REGULAR   site_2     9004        9000        8999         8889            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n       ,web_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"WEB_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS   site_0    11918       11918       11804        12050            0\n1            EXPRESS   site_1    11894       11994       11801        12158            0\n2            EXPRESS   site_2    11811       11979       11753        12220            0\n3            EXPRESS   site_3    11840       11868       11965        12016            0\n4            LIBRARY   site_0     8886        9016        8984         8879            0\n5            LIBRARY   site_1     9098        9011        9214         8869            0\n6            LIBRARY   site_2     9144        8784        9090         8838            0\n7            LIBRARY   site_3     9031        8897        8967         9001            0\n8           NEXT DAY   site_0    11994       12028       11846        12118            0\n9           NEXT DAY   site_1    11865       11949       12030        11950            0\n10          NEXT DAY   site_2    12061       12058       11965        11879            0\n11          NEXT DAY   site_3    11963       12047       11927        12026            0\n12         OVERNIGHT   site_0     9048        9098        8954         8914            0\n13         OVERNIGHT   site_1     8916        9005        8896         8831            0\n14         OVERNIGHT   site_2     8844        8995        9020         9012            0\n15         OVERNIGHT   site_3     8830        8880        8876         9092            0\n16           REGULAR   site_0     9009        8773        9025         9027            0\n17           REGULAR   site_1     9006        9069        9056         9009            0\n18           REGULAR   site_2     9004        9000        8999         8889            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040393,
                    "execution_time": 0.00852,
                    "compile_time": 0.020148,
                    "planning_time": 0.005098
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.868876,
                    "execution_time": 0.009118,
                    "compile_time": 4.814472,
                    "planning_time": 0.042999
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"WEB_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS   site_0    11918       11918       11804        12050            0\n1            EXPRESS   site_1    11894       11994       11801        12158            0\n2            EXPRESS   site_2    11811       11979       11753        12220            0\n3            EXPRESS   site_3    11840       11868       11965        12016            0\n4            LIBRARY   site_0     8886        9016        8984         8879            0\n5            LIBRARY   site_1     9098        9011        9214         8869            0\n6            LIBRARY   site_2     9144        8784        9090         8838            0\n7            LIBRARY   site_3     9031        8897        8967         9001            0\n8           NEXT DAY   site_0    11994       12028       11846        12118            0\n9           NEXT DAY   site_1    11865       11949       12030        11950            0\n10          NEXT DAY   site_2    12061       12058       11965        11879            0\n11          NEXT DAY   site_3    11963       12047       11927        12026            0\n12         OVERNIGHT   site_0     9048        9098        8954         8914            0\n13         OVERNIGHT   site_1     8916        9005        8896         8831            0\n14         OVERNIGHT   site_2     8844        8995        9020         9012            0\n15         OVERNIGHT   site_3     8830        8880        8876         9092            0\n16           REGULAR   site_0     9009        8773        9025         9027            0\n17           REGULAR   site_1     9006        9069        9056         9009            0\n18           REGULAR   site_2     9004        9000        8999         8889            0\n...*/"
    },
    {
        "input": "-- start template query62.tpl query 24 in stream 0\nselect /* TPC-DS query62.tpl 0.24 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   web_sales\n  ,warehouse\n  ,ship_mode\n  ,web_site\n  ,date_dim\nwhere\n    d_month_seq between 1185 and 1185 + 11\nand ws_ship_date_sk   = d_date_sk\nand ws_warehouse_sk   = w_warehouse_sk\nand ws_ship_mode_sk   = sm_ship_mode_sk\nand ws_web_site_sk    = web_site_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,web_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n       ,web_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"WEB_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS   site_0    11918       11918       11804        12050            0\n1            EXPRESS   site_1    11894       11994       11801        12158            0\n2            EXPRESS   site_2    11811       11979       11753        12220            0\n3            EXPRESS   site_3    11840       11868       11965        12016            0\n4            LIBRARY   site_0     8886        9016        8984         8879            0\n5            LIBRARY   site_1     9098        9011        9214         8869            0\n6            LIBRARY   site_2     9144        8784        9090         8838            0\n7            LIBRARY   site_3     9031        8897        8967         9001            0\n8           NEXT DAY   site_0    11994       12028       11846        12118            0\n9           NEXT DAY   site_1    11865       11949       12030        11950            0\n10          NEXT DAY   site_2    12061       12058       11965        11879            0\n11          NEXT DAY   site_3    11963       12047       11927        12026            0\n12         OVERNIGHT   site_0     9048        9098        8954         8914            0\n13         OVERNIGHT   site_1     8916        9005        8896         8831            0\n14         OVERNIGHT   site_2     8844        8995        9020         9012            0\n15         OVERNIGHT   site_3     8830        8880        8876         9092            0\n16           REGULAR   site_0     9009        8773        9025         9027            0\n17           REGULAR   site_1     9006        9069        9056         9009            0\n18           REGULAR   site_2     9004        9000        8999         8889            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019262,
                    "execution_time": 0.008496,
                    "compile_time": 8e-05,
                    "planning_time": 0.004358
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019756,
                    "execution_time": 0.008598,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004595
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" AS \"WEB_NAME\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 60 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 90 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" <= 120 AND \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"WEB_SALES\".\"WS_SHIP_DATE_SK\" - \"WEB_SALES\".\"WS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SHIP_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1196 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1185 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" = \"WEB_SALES\".\"WS_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"WAREHOUSE\".\"W_WAREHOUSE_SK\" = \"WEB_SALES\".\"WS_WAREHOUSE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"WEB_SITE\".\"WEB_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"WEB_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"WEB_NAME\" AS \"WEB_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"WEB_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   _col_0    sm_type web_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            EXPRESS   site_0    11918       11918       11804        12050            0\n1            EXPRESS   site_1    11894       11994       11801        12158            0\n2            EXPRESS   site_2    11811       11979       11753        12220            0\n3            EXPRESS   site_3    11840       11868       11965        12016            0\n4            LIBRARY   site_0     8886        9016        8984         8879            0\n5            LIBRARY   site_1     9098        9011        9214         8869            0\n6            LIBRARY   site_2     9144        8784        9090         8838            0\n7            LIBRARY   site_3     9031        8897        8967         9001            0\n8           NEXT DAY   site_0    11994       12028       11846        12118            0\n9           NEXT DAY   site_1    11865       11949       12030        11950            0\n10          NEXT DAY   site_2    12061       12058       11965        11879            0\n11          NEXT DAY   site_3    11963       12047       11927        12026            0\n12         OVERNIGHT   site_0     9048        9098        8954         8914            0\n13         OVERNIGHT   site_1     8916        9005        8896         8831            0\n14         OVERNIGHT   site_2     8844        8995        9020         9012            0\n15         OVERNIGHT   site_3     8830        8880        8876         9092            0\n16           REGULAR   site_0     9009        8773        9025         9027            0\n17           REGULAR   site_1     9006        9069        9056         9009            0\n18           REGULAR   site_2     9004        9000        8999         8889            0\n...*/"
    }
]