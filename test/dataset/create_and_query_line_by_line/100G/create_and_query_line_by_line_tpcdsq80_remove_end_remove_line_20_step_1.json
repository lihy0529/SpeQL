[
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n/*CURSOR_IDENTIFIER*/\n                ) AS sales_data\nGROUP BY channel, id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , SUM ( \"SSR\".\"SALES\" ) AS \"SALES\" , SUM ( \"SSR\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SSR\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" GROUP BY 'store channel' , 'store' || \"SSR\".\"STORE_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117459,
                    "execution_time": 0.031337,
                    "compile_time": 0.036742,
                    "planning_time": 0.025462,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.455335,
                    "execution_time": 0.033215,
                    "compile_time": 3.307686,
                    "planning_time": 0.086255,
                    "create_size": 5
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.147729,
                    "execution_time": 0.044501,
                    "compile_time": 0.048363,
                    "planning_time": 0.024659,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.469195,
                    "execution_time": 0.060069,
                    "compile_time": 3.287029,
                    "planning_time": 0.087035,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.132335,
                    "execution_time": 0.032836,
                    "compile_time": 0.051319,
                    "planning_time": 0.023846,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.563965,
                    "execution_time": 0.036333,
                    "compile_time": 3.410668,
                    "planning_time": 0.085656,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.075606,
                    "execution_time": 0.870813,
                    "compile_time": 0.111754,
                    "planning_time": 0.054671,
                    "create_size": 679
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.901932,
                    "execution_time": 1.103014,
                    "compile_time": 6.624469,
                    "planning_time": 0.126421,
                    "create_size": 679
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR ) AS SALES_DATA GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*          channel                     id       sales   returns1      profit\n0   store channel  storeAAAAAAAAMHBAAAAA  2970189.41  137076.58 -1266806.80\n1   store channel  storeAAAAAAAAKJAAAAAA  2933669.89  136948.78 -1471437.99\n2   store channel  storeAAAAAAAAMGBAAAAA  3141660.76  154430.51 -1202581.04\n3   store channel  storeAAAAAAAABAAAAAAA  2979623.00  134244.60 -1384557.13\n4   store channel  storeAAAAAAAAMEAAAAAA  2754616.35  129599.06 -1379394.49\n5   store channel  storeAAAAAAAAOJAAAAAA  2979510.67  146345.14 -1358461.36\n6   store channel  storeAAAAAAAAANAAAAAA  3073688.88  160917.37 -1388212.88\n7   store channel  storeAAAAAAAAEHAAAAAA  2874248.74  144312.57 -1425836.50\n8   store channel  storeAAAAAAAABIBAAAAA  2969581.41  122622.91 -1550977.95\n9   store channel  storeAAAAAAAAILAAAAAA  2934458.63  130457.38 -1250770.18\n10  store channel  storeAAAAAAAACCAAAAAA  3055990.30  141988.92 -1324834.32\n11  store channel  storeAAAAAAAAIGAAAAAA  2888873.37  148747.03 -1340147.15\n12  store channel  storeAAAAAAAABPAAAAAA  3079820.69  166413.88 -1486742.79\n13  store channel  storeAAAAAAAAHGAAAAAA  3293295.02  170990.12 -1419983.07\n14  store channel  storeAAAAAAAAEGBAAAAA  3112087.20  153702.39 -1423581.43\n15  store channel  storeAAAAAAAAIDAAAAAA  2924786.90  200830.21 -1359406.40\n16  store channel  storeAAAAAAAALCAAAAAA  3043884.39  132976.78 -1433527.03\n17  store channel  storeAAAAAAAACLAAAAAA  3211975.26  165407.39 -1477356.17\n18  store channel  storeAAAAAAAAMABAAAAA  3132373.54  139928.05 -1381178.77\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.218154,
                    "execution_time": 0.087023,
                    "compile_time": 0.033692,
                    "planning_time": 0.073956
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.764746,
                    "execution_time": 0.090031,
                    "compile_time": 8.573725,
                    "planning_time": 0.071406
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY 'store channel' , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*          channel                     id       sales   returns1      profit\n0   store channel  storeAAAAAAAAMHBAAAAA  2970189.41  137076.58 -1266806.80\n1   store channel  storeAAAAAAAAKJAAAAAA  2933669.89  136948.78 -1471437.99\n2   store channel  storeAAAAAAAAMGBAAAAA  3141660.76  154430.51 -1202581.04\n3   store channel  storeAAAAAAAABAAAAAAA  2979623.00  134244.60 -1384557.13\n4   store channel  storeAAAAAAAAMEAAAAAA  2754616.35  129599.06 -1379394.49\n5   store channel  storeAAAAAAAAOJAAAAAA  2979510.67  146345.14 -1358461.36\n6   store channel  storeAAAAAAAAANAAAAAA  3073688.88  160917.37 -1388212.88\n7   store channel  storeAAAAAAAAEHAAAAAA  2874248.74  144312.57 -1425836.50\n8   store channel  storeAAAAAAAABIBAAAAA  2969581.41  122622.91 -1550977.95\n9   store channel  storeAAAAAAAAILAAAAAA  2934458.63  130457.38 -1250770.18\n10  store channel  storeAAAAAAAACCAAAAAA  3055990.30  141988.92 -1324834.32\n11  store channel  storeAAAAAAAAIGAAAAAA  2888873.37  148747.03 -1340147.15\n12  store channel  storeAAAAAAAABPAAAAAA  3079820.69  166413.88 -1486742.79\n13  store channel  storeAAAAAAAAHGAAAAAA  3293295.02  170990.12 -1419983.07\n14  store channel  storeAAAAAAAAEGBAAAAA  3112087.20  153702.39 -1423581.43\n15  store channel  storeAAAAAAAAIDAAAAAA  2924786.90  200830.21 -1359406.40\n16  store channel  storeAAAAAAAALCAAAAAA  3043884.39  132976.78 -1433527.03\n17  store channel  storeAAAAAAAACLAAAAAA  3211975.26  165407.39 -1477356.17\n18  store channel  storeAAAAAAAAMABAAAAA  3132373.54  139928.05 -1381178.77\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s.s_store_sk                                  AS store_id, \n                                Sum(ss.ss_ext_sales_price)                    AS sales, \n                                Sum(COALESCE(sr.sr_return_amt, 0))            AS returns1, \n                                Sum(ss.ss_net_profit - COALESCE(sr.sr_net_loss, 0)) AS profit \n                FROM            store_sales ss \n                LEFT OUTER JOIN store_returns sr \n                ON              ( \n                                                ss.ss_item_sk = sr.sr_item_sk \n                                AND             ss.ss_ticket_number = sr.sr_ticket_number)\n                JOIN            date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n                JOIN            store s ON ss.ss_store_sk = s.s_store_sk\n                JOIN            item i ON ss.ss_item_sk = i.i_item_sk\n                JOIN            promotion p ON ss.ss_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN Cast('2000-08-26' AS DATE) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE))\n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        s.s_store_sk) , csr AS \n( \n                SELECT          cp.cp_catalog_page_id                         AS catalog_page_id, \n                                sum(cs.cs_ext_sales_price)                    AS sales, \n                                sum(COALESCE(cr.cr_return_amount, 0))         AS returns1, \n                                sum(cs.cs_net_profit - COALESCE(cr.cr_net_loss, 0)) AS profit \n                FROM            catalog_sales cs \n                LEFT OUTER JOIN catalog_returns cr \n                ON              ( \n                                                cs.cs_item_sk = cr.cr_item_sk \n                                AND             cs.cs_order_number = cr.cr_order_number)\n                JOIN            date_dim d ON cs.cs_sold_date_sk = d.d_date_sk\n                JOIN            catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk\n                JOIN            item i ON cs.cs_item_sk = i.i_item_sk\n                JOIN            promotion p ON cs.cs_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        cp.cp_catalog_page_id) , wsr AS \n( \n                SELECT          ws1.web_site_sk AS web_site_id, \n                                sum(ws.ws_ext_sales_price)                    AS sales, \n                                sum(COALESCE(wr.wr_return_amt, 0))            AS returns1, \n                                sum(ws.ws_net_profit - COALESCE(wr.wr_net_loss, 0)) AS profit \n                FROM            web_sales ws \n                LEFT OUTER JOIN web_returns wr \n                ON              ( \n                                                ws.ws_item_sk = wr.wr_item_sk \n                                AND             ws.ws_order_number = wr.wr_order_number)\n                JOIN            date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n                JOIN            web_site ws1 ON ws.ws_web_site_sk = ws1.web_site_sk\n                JOIN            item i ON ws.ws_item_sk = i.i_item_sk\n                JOIN            promotion p ON ws.ws_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        ws1.web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel,\n                       'catalog' || catalog_page_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   csr \n                UNION ALL\n                SELECT 'web channel' AS channel,\n                       'web' || web_site_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   wsr \n         ) AS combined_results\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"D\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"I\" AS ( SELECT \"I\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"I\" WHERE \"I\".\"I_CURRENT_PRICE\" > 50 ) , \"P\" AS ( SELECT \"P\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"P\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"P\" WHERE \"P\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"S\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"SS\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"SS\".\"SS_NET_PROFIT\" - COALESCE ( \"SR\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" JOIN \"I\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SS\".\"SS_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"P\".\"P_PROMO_SK\" = \"SS\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"S\" ON \"S\".\"S_STORE_SK\" = \"SS\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"SS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"SS\".\"SS_TICKET_NUMBER\" GROUP BY \"S\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CP\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CS\".\"CS_NET_PROFIT\" - COALESCE ( \"CR\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"CATALOG_PAGE\" AS \"CP\" ON \"CP\".\"CP_CATALOG_PAGE_SK\" = \"CS\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" JOIN \"I\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"CS\".\"CS_PROMO_SK\" = \"P\".\"P_PROMO_SK\" GROUP BY \"CP\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WS1\".\"WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WS\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WS\".\"WS_NET_PROFIT\" - COALESCE ( \"WR\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" JOIN \"I\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"P\".\"P_PROMO_SK\" = \"WS\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WS1\" ON \"WS\".\"WS_WEB_SITE_SK\" = \"WS1\".\"WEB_SITE_SK\" GROUP BY \"WS1\".\"WEB_SITE_SK\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S.S_STORE_SK AS STORE_ID , SUM ( SS.SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS.SS_NET_PROFIT - COALESCE ( SR.SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES AS SS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( SS.SS_ITEM_SK = SR.SR_ITEM_SK AND SS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER ) JOIN DATE_DIM AS D ON SS.SS_SOLD_DATE_SK = D.D_DATE_SK JOIN STORE AS S ON SS.SS_STORE_SK = S.S_STORE_SK JOIN ITEM AS I ON SS.SS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON SS.SS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY S.S_STORE_SK ) , CSR AS ( SELECT CP.CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS.CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS.CS_NET_PROFIT - COALESCE ( CR.CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ITEM_SK = CR.CR_ITEM_SK AND CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER ) JOIN DATE_DIM AS D ON CS.CS_SOLD_DATE_SK = D.D_DATE_SK JOIN CATALOG_PAGE AS CP ON CS.CS_CATALOG_PAGE_SK = CP.CP_CATALOG_PAGE_SK JOIN ITEM AS I ON CS.CS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON CS.CS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY CP.CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WS1.WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS.WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS.WS_NET_PROFIT - COALESCE ( WR.WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ITEM_SK = WR.WR_ITEM_SK AND WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER ) JOIN DATE_DIM AS D ON WS.WS_SOLD_DATE_SK = D.D_DATE_SK JOIN WEB_SITE AS WS1 ON WS.WS_WEB_SITE_SK = WS1.WEB_SITE_SK JOIN ITEM AS I ON WS.WS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON WS.WS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY WS1.WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                       id       sales   returns1      profit\n0   catalog channel  catalogAAAAAAAAAOPBAAAA   179212.94    6632.49     4384.68\n1   catalog channel  catalogAAAAAAAAKAMBAAAA   527804.93   18624.96   -47035.13\n2   catalog channel  catalogAAAAAAAAGNLBAAAA  1199169.29   44669.33  -165439.51\n3   catalog channel  catalogAAAAAAAAGFMBAAAA   627727.58   23173.62  -111579.44\n4   catalog channel  catalogAAAAAAAAEABCAAAA   436383.29   16600.97   -80147.35\n5   catalog channel  catalogAAAAAAAAIOLBAAAA  1095372.38   57259.40  -143829.62\n6   catalog channel  catalogAAAAAAAAEAACAAAA   206349.52    3951.01   -49765.99\n7   catalog channel  catalogAAAAAAAANIMBAAAA   637404.84   51981.08   -65141.16\n8   catalog channel  catalogAAAAAAAAOOACAAAA   328370.72   38318.95   -85455.26\n9   catalog channel  catalogAAAAAAAAOPLBAAAA   577821.25   24977.14  -117546.48\n10  catalog channel  catalogAAAAAAAADMACAAAA   401480.33   28554.65   -97708.13\n11  catalog channel  catalogAAAAAAAAEOPBAAAA   183603.70    5172.20   -68290.35\n12    store channel                 store337  2956221.79  137577.69 -1362287.51\n13    store channel                   store8  3034284.62  131186.56 -1331641.72\n14    store channel                 store241  3079820.69  166413.88 -1486742.79\n15    store channel                 store112  3077831.31  145349.45 -1441791.38\n16    store channel                 store118  3035062.37  152112.84 -1437380.22\n17    store channel                 store272  3330888.87  175918.55 -1475147.56\n18  catalog channel  catalogAAAAAAAACELBAAAA  1156074.46   67829.19  -221145.06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.449217,
                    "execution_time": 0.176362,
                    "compile_time": 0.00114,
                    "planning_time": 0.222361
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 12.567076,
                    "execution_time": 3.242041,
                    "compile_time": 8.952501,
                    "planning_time": 0.342366
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                       id       sales   returns1      profit\n0   catalog channel  catalogAAAAAAAAAOPBAAAA   179212.94    6632.49     4384.68\n1   catalog channel  catalogAAAAAAAAKAMBAAAA   527804.93   18624.96   -47035.13\n2   catalog channel  catalogAAAAAAAAGNLBAAAA  1199169.29   44669.33  -165439.51\n3   catalog channel  catalogAAAAAAAAGFMBAAAA   627727.58   23173.62  -111579.44\n4   catalog channel  catalogAAAAAAAAEABCAAAA   436383.29   16600.97   -80147.35\n5   catalog channel  catalogAAAAAAAAIOLBAAAA  1095372.38   57259.40  -143829.62\n6   catalog channel  catalogAAAAAAAAEAACAAAA   206349.52    3951.01   -49765.99\n7   catalog channel  catalogAAAAAAAANIMBAAAA   637404.84   51981.08   -65141.16\n8   catalog channel  catalogAAAAAAAAOOACAAAA   328370.72   38318.95   -85455.26\n9   catalog channel  catalogAAAAAAAAOPLBAAAA   577821.25   24977.14  -117546.48\n10  catalog channel  catalogAAAAAAAADMACAAAA   401480.33   28554.65   -97708.13\n11  catalog channel  catalogAAAAAAAAEOPBAAAA   183603.70    5172.20   -68290.35\n12    store channel                 store337  2956221.79  137577.69 -1362287.51\n13    store channel                   store8  3034284.62  131186.56 -1331641.72\n14    store channel                 store241  3079820.69  166413.88 -1486742.79\n15    store channel                 store112  3077831.31  145349.45 -1441791.38\n16    store channel                 store118  3035062.37  152112.84 -1437380.22\n17    store channel                 store272  3330888.87  175918.55 -1475147.56\n18  catalog channel  catalogAAAAAAAACELBAAAA  1156074.46   67829.19  -221145.06\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(SS_EXT_SALES_PRICE)                       AS sales, \n                                Sum(COALESCE(SR_RETURN_AMT, 0))               AS returns1, \n                                Sum(SS_NET_PROFIT - COALESCE(SR_NET_LOSS, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(CS_EXT_SALES_PRICE)                       AS sales, \n                                sum(COALESCE(CR_RETURN_AMOUNT, 0))            AS returns1, \n                                sum(CS_NET_PROFIT - COALESCE(CR_NET_LOSS, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(WS_EXT_SALES_PRICE)                       AS sales, \n                                sum(COALESCE(WR_RETURN_AMT, 0))               AS returns1, \n                                sum(WS_NET_PROFIT - COALESCE(WR_NET_LOSS, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                'catalog' || catalog_page_id AS id , \n                sales , \n                returns1 , \n                profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                'web' || web_site_id AS id , \n                sales , \n                returns1 , \n                profit \n                FROM   wsr \n) AS data\nGROUP BY channel, id\nORDER BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"DATA\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"DATA\".\"CHANNEL\" AS \"CHANNEL\" , \"DATA\".\"ID\" AS \"ID\" , SUM ( \"DATA\".\"SALES\" ) AS \"SALES\" , SUM ( \"DATA\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"DATA\".\"PROFIT\" ) AS \"PROFIT\" FROM \"DATA\" AS \"DATA\" GROUP BY \"DATA\".\"CHANNEL\" , \"DATA\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS DATA GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel           id     sales  returns1    profit\n0   catalog channel  catalog6957  37767.44   4025.56  -7075.68\n1   catalog channel  catalog6958  45570.68   3423.42   5794.69\n2   catalog channel  catalog6959  52156.13    990.61   1873.08\n3   catalog channel  catalog6960  35828.53   2613.41 -13155.95\n4   catalog channel  catalog6961  51515.64   2164.25  -1355.83\n5   catalog channel  catalog6962  39364.58   4397.00  -3729.10\n6   catalog channel  catalog6963  44035.76   4073.85  11638.12\n7   catalog channel  catalog6964  54531.01    349.27 -12358.35\n8   catalog channel  catalog6965  42720.85      0.00 -11910.22\n9   catalog channel  catalog6966  37179.58   1584.68  -6324.32\n10  catalog channel  catalog6967  10797.08    994.79  -7867.78\n11  catalog channel  catalog6968  39168.13      1.62 -16213.11\n12  catalog channel  catalog6969  59762.19      0.00 -12499.10\n13  catalog channel  catalog6970  33827.44   7779.19 -11665.17\n14  catalog channel  catalog6971  37047.02      0.00 -11119.70\n15  catalog channel  catalog6972  71860.91   2088.00   2427.03\n16  catalog channel  catalog6973  25416.81   8001.49  -1738.80\n17  catalog channel  catalog6974  29929.91     40.21  -6268.53\n18  catalog channel  catalog6975  54397.09    253.60   7589.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.363298,
                    "execution_time": 0.139783,
                    "compile_time": 0.001155,
                    "planning_time": 0.173006
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.623208,
                    "execution_time": 0.140021,
                    "compile_time": 8.109887,
                    "planning_time": 0.316475
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel           id     sales  returns1    profit\n0   catalog channel  catalog6957  37767.44   4025.56  -7075.68\n1   catalog channel  catalog6958  45570.68   3423.42   5794.69\n2   catalog channel  catalog6959  52156.13    990.61   1873.08\n3   catalog channel  catalog6960  35828.53   2613.41 -13155.95\n4   catalog channel  catalog6961  51515.64   2164.25  -1355.83\n5   catalog channel  catalog6962  39364.58   4397.00  -3729.10\n6   catalog channel  catalog6963  44035.76   4073.85  11638.12\n7   catalog channel  catalog6964  54531.01    349.27 -12358.35\n8   catalog channel  catalog6965  42720.85      0.00 -11910.22\n9   catalog channel  catalog6966  37179.58   1584.68  -6324.32\n10  catalog channel  catalog6967  10797.08    994.79  -7867.78\n11  catalog channel  catalog6968  39168.13      1.62 -16213.11\n12  catalog channel  catalog6969  59762.19      0.00 -12499.10\n13  catalog channel  catalog6970  33827.44   7779.19 -11665.17\n14  catalog channel  catalog6971  37047.02      0.00 -11119.70\n15  catalog channel  catalog6972  71860.91   2088.00   2427.03\n16  catalog channel  catalog6973  25416.81   8001.49  -1738.80\n17  catalog channel  catalog6974  29929.91     40.21  -6268.53\n18  catalog channel  catalog6975  54397.09    253.60   7589.48\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                       || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n) AS combined_results\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1    profit\n0     store channel         storeAAAAAAAALFAAAAAA   80312.56   8885.50 -55385.85\n1     store channel         storeAAAAAAAAEGAAAAAA   66739.91   6332.91 -51008.29\n2   catalog channel  catalog_pageAAAAAAAAHEMBAAAA   10971.34    723.62  -3761.59\n3   catalog channel  catalog_pageAAAAAAAAOHMBAAAA   29137.32   9003.57   -488.28\n4   catalog channel  catalog_pageAAAAAAAALEACAAAA   17887.48   1898.40  -5160.48\n5   catalog channel  catalog_pageAAAAAAAALAACAAAA   21060.03      0.00    354.28\n6   catalog channel  catalog_pageAAAAAAAAOILBAAAA   49620.96   2123.79  -4965.20\n7   catalog channel  catalog_pageAAAAAAAAKPPBAAAA    9202.55      0.00  -6278.30\n8   catalog channel  catalog_pageAAAAAAAAOPLBAAAA   25807.84   1369.42  -1728.66\n9     store channel         storeAAAAAAAAGEAAAAAA  134199.73   3683.72 -28694.89\n10    store channel         storeAAAAAAAAGOAAAAAA   89306.07   1062.20 -65398.17\n11    store channel         storeAAAAAAAAOLAAAAAA   50665.09   4733.22 -24469.41\n12    store channel         storeAAAAAAAAOAAAAAAA  143456.98   6467.43 -47939.49\n13    store channel         storeAAAAAAAAPHAAAAAA   87361.20   2072.69 -33652.26\n14  catalog channel  catalog_pageAAAAAAAAGHMBAAAA   24291.38   1098.30    723.85\n15  catalog channel  catalog_pageAAAAAAAAEDLBAAAA   54531.01    349.27 -12358.35\n16  catalog channel  catalog_pageAAAAAAAAKJLBAAAA   30133.57   1260.78  -3146.07\n17  catalog channel  catalog_pageAAAAAAAAJMLBAAAA   13432.97      0.00   -939.41\n18  catalog channel  catalog_pageAAAAAAAADPLBAAAA   22721.99      0.00   4934.98\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.257267,
                    "execution_time": 0.10292,
                    "compile_time": 0.000722,
                    "planning_time": 0.118499
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.954728,
                    "execution_time": 0.10766,
                    "compile_time": 6.572398,
                    "planning_time": 0.245348
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1    profit\n0     store channel         storeAAAAAAAALFAAAAAA   80312.56   8885.50 -55385.85\n1     store channel         storeAAAAAAAAEGAAAAAA   66739.91   6332.91 -51008.29\n2   catalog channel  catalog_pageAAAAAAAAHEMBAAAA   10971.34    723.62  -3761.59\n3   catalog channel  catalog_pageAAAAAAAAOHMBAAAA   29137.32   9003.57   -488.28\n4   catalog channel  catalog_pageAAAAAAAALEACAAAA   17887.48   1898.40  -5160.48\n5   catalog channel  catalog_pageAAAAAAAALAACAAAA   21060.03      0.00    354.28\n6   catalog channel  catalog_pageAAAAAAAAOILBAAAA   49620.96   2123.79  -4965.20\n7   catalog channel  catalog_pageAAAAAAAAKPPBAAAA    9202.55      0.00  -6278.30\n8   catalog channel  catalog_pageAAAAAAAAOPLBAAAA   25807.84   1369.42  -1728.66\n9     store channel         storeAAAAAAAAGEAAAAAA  134199.73   3683.72 -28694.89\n10    store channel         storeAAAAAAAAGOAAAAAA   89306.07   1062.20 -65398.17\n11    store channel         storeAAAAAAAAOLAAAAAA   50665.09   4733.22 -24469.41\n12    store channel         storeAAAAAAAAOAAAAAAA  143456.98   6467.43 -47939.49\n13    store channel         storeAAAAAAAAPHAAAAAA   87361.20   2072.69 -33652.26\n14  catalog channel  catalog_pageAAAAAAAAGHMBAAAA   24291.38   1098.30    723.85\n15  catalog channel  catalog_pageAAAAAAAAEDLBAAAA   54531.01    349.27 -12358.35\n16  catalog channel  catalog_pageAAAAAAAAKJLBAAAA   30133.57   1260.78  -3146.07\n17  catalog channel  catalog_pageAAAAAAAAJMLBAAAA   13432.97      0.00   -939.41\n18  catalog channel  catalog_pageAAAAAAAADPLBAAAA   22721.99      0.00   4934.98\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr\n                UNION ALL\n                SELECT 'web channel' AS channel,\n                       'web_site' \n                              || web_site_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   wsr\n) AS combined\nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id      sales  returns1    profit\n0     store channel           store85  101286.46   7169.57 -39071.89\n1     store channel          store115   74833.70   3574.86 -65462.18\n2     store channel          store280  103047.11   1288.17 -28363.38\n3     store channel          store308   95738.50   2630.37 -62288.10\n4   catalog channel  catalog_page7097   47640.01   3615.05   5618.23\n5   catalog channel  catalog_page6999   17616.43    876.87  -2459.98\n6   catalog channel  catalog_page6968   39168.13      1.62 -16213.11\n7   catalog channel  catalog_page8253   26441.37      0.00   -607.92\n8   catalog channel  catalog_page7260   20941.52   5423.55   2458.79\n9   catalog channel  catalog_page7254   15025.13    353.86    141.02\n10  catalog channel  catalog_page7126   37591.80    543.06  -5939.28\n11  catalog channel  catalog_page8103   17651.47      0.00   1751.41\n12  catalog channel  catalog_page6960   35828.53   2613.41 -13155.95\n13  catalog channel  catalog_page7288    4847.38   1543.32  -6934.27\n14  catalog channel  catalog_page8219   14832.66      0.00 -10296.76\n15  catalog channel  catalog_page7104   44933.57      0.00  -7508.04\n16  catalog channel  catalog_page7198   16728.39   1718.10   7433.41\n17  catalog channel  catalog_page8198   25061.18      0.00   1810.43\n18  catalog channel  catalog_page7232   26137.98   1211.84 -12064.16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.359726,
                    "execution_time": 0.137203,
                    "compile_time": 0.001105,
                    "planning_time": 0.173401
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.6107,
                    "execution_time": 0.142398,
                    "compile_time": 5.115656,
                    "planning_time": 0.29714
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id      sales  returns1    profit\n0     store channel           store85  101286.46   7169.57 -39071.89\n1     store channel          store115   74833.70   3574.86 -65462.18\n2     store channel          store280  103047.11   1288.17 -28363.38\n3     store channel          store308   95738.50   2630.37 -62288.10\n4   catalog channel  catalog_page7097   47640.01   3615.05   5618.23\n5   catalog channel  catalog_page6999   17616.43    876.87  -2459.98\n6   catalog channel  catalog_page6968   39168.13      1.62 -16213.11\n7   catalog channel  catalog_page8253   26441.37      0.00   -607.92\n8   catalog channel  catalog_page7260   20941.52   5423.55   2458.79\n9   catalog channel  catalog_page7254   15025.13    353.86    141.02\n10  catalog channel  catalog_page7126   37591.80    543.06  -5939.28\n11  catalog channel  catalog_page8103   17651.47      0.00   1751.41\n12  catalog channel  catalog_page6960   35828.53   2613.41 -13155.95\n13  catalog channel  catalog_page7288    4847.38   1543.32  -6934.27\n14  catalog channel  catalog_page8219   14832.66      0.00 -10296.76\n15  catalog channel  catalog_page7104   44933.57      0.00  -7508.04\n16  catalog channel  catalog_page7198   16728.39   1718.10   7433.41\n17  catalog channel  catalog_page8198   25061.18      0.00   1810.43\n18  catalog channel  catalog_page7232   26137.98   1211.84 -12064.16\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined_results \nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1    profit\n0     store channel         storeAAAAAAAAMHBAAAAA   86863.79   9127.02 -43703.96\n1   catalog channel  catalog_pageAAAAAAAAGPLBAAAA   15310.27   1144.31 -11839.03\n2   catalog channel  catalog_pageAAAAAAAANIMBAAAA    4229.88      0.00  -4137.12\n3   catalog channel  catalog_pageAAAAAAAAPNLBAAAA   42344.26   3581.72  -6235.23\n4   catalog channel  catalog_pageAAAAAAAADKMBAAAA   23530.46      0.00  -3533.70\n5   catalog channel  catalog_pageAAAAAAAAAOPBAAAA    7468.81      0.00    133.19\n6   catalog channel  catalog_pageAAAAAAAAHHMBAAAA   22219.48    304.36 -11422.73\n7     store channel         storeAAAAAAAAANAAAAAA   59230.46    101.73 -51304.09\n8     store channel         storeAAAAAAAAOJAAAAAA   85988.41   3799.09 -49487.89\n9     store channel         storeAAAAAAAAMEAAAAAA   64851.08    329.83 -39382.98\n10  catalog channel  catalog_pageAAAAAAAAFNPBAAAA    1753.38     36.09   -804.33\n11  catalog channel  catalog_pageAAAAAAAAHFLBAAAA   17616.43    876.87  -2459.98\n12  catalog channel  catalog_pageAAAAAAAAPHMBAAAA   30985.60      0.00  10366.06\n13  catalog channel  catalog_pageAAAAAAAAAGLBAAAA   11807.76    451.60  -1105.63\n14  catalog channel  catalog_pageAAAAAAAAFAACAAAA   14513.78      0.00  -1386.16\n15  catalog channel  catalog_pageAAAAAAAAJHLBAAAA   36969.57      0.00   2859.42\n16  catalog channel  catalog_pageAAAAAAAAMNPBAAAA   34435.24   1805.32   7350.57\n17  catalog channel  catalog_pageAAAAAAAAMBACAAAA   17657.11      0.00  -3810.93\n18  catalog channel  catalog_pageAAAAAAAAMBMBAAAA   20456.23   6255.68  -4476.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.359399,
                    "execution_time": 0.145022,
                    "compile_time": 0.001075,
                    "planning_time": 0.165062
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.233113,
                    "execution_time": 0.321274,
                    "compile_time": 8.564148,
                    "planning_time": 0.292129
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1    profit\n0     store channel         storeAAAAAAAAMHBAAAAA   86863.79   9127.02 -43703.96\n1   catalog channel  catalog_pageAAAAAAAAGPLBAAAA   15310.27   1144.31 -11839.03\n2   catalog channel  catalog_pageAAAAAAAANIMBAAAA    4229.88      0.00  -4137.12\n3   catalog channel  catalog_pageAAAAAAAAPNLBAAAA   42344.26   3581.72  -6235.23\n4   catalog channel  catalog_pageAAAAAAAADKMBAAAA   23530.46      0.00  -3533.70\n5   catalog channel  catalog_pageAAAAAAAAAOPBAAAA    7468.81      0.00    133.19\n6   catalog channel  catalog_pageAAAAAAAAHHMBAAAA   22219.48    304.36 -11422.73\n7     store channel         storeAAAAAAAAANAAAAAA   59230.46    101.73 -51304.09\n8     store channel         storeAAAAAAAAOJAAAAAA   85988.41   3799.09 -49487.89\n9     store channel         storeAAAAAAAAMEAAAAAA   64851.08    329.83 -39382.98\n10  catalog channel  catalog_pageAAAAAAAAFNPBAAAA    1753.38     36.09   -804.33\n11  catalog channel  catalog_pageAAAAAAAAHFLBAAAA   17616.43    876.87  -2459.98\n12  catalog channel  catalog_pageAAAAAAAAPHMBAAAA   30985.60      0.00  10366.06\n13  catalog channel  catalog_pageAAAAAAAAAGLBAAAA   11807.76    451.60  -1105.63\n14  catalog channel  catalog_pageAAAAAAAAFAACAAAA   14513.78      0.00  -1386.16\n15  catalog channel  catalog_pageAAAAAAAAJHLBAAAA   36969.57      0.00   2859.42\n16  catalog channel  catalog_pageAAAAAAAAMNPBAAAA   34435.24   1805.32   7350.57\n17  catalog channel  catalog_pageAAAAAAAAMBACAAAA   17657.11      0.00  -3810.93\n18  catalog channel  catalog_pageAAAAAAAAMBMBAAAA   20456.23   6255.68  -4476.85\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS final_summary \nGROUP BY channel, id \nORDER BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"FINAL_SUMMARY\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"FINAL_SUMMARY\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_SUMMARY\".\"ID\" AS \"ID\" , SUM ( \"FINAL_SUMMARY\".\"SALES\" ) AS \"SALES\" , SUM ( \"FINAL_SUMMARY\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"FINAL_SUMMARY\".\"PROFIT\" ) AS \"PROFIT\" FROM \"FINAL_SUMMARY\" AS \"FINAL_SUMMARY\" GROUP BY \"FINAL_SUMMARY\".\"CHANNEL\" , \"FINAL_SUMMARY\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS FINAL_SUMMARY GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAAACAAAA  24244.67    235.98   6764.68\n1   catalog channel  catalog_pageAAAAAAAAAAMBAAAA  19248.20    654.47 -21165.11\n2   catalog channel  catalog_pageAAAAAAAAABACAAAA   8541.23    111.54  -3775.99\n3   catalog channel  catalog_pageAAAAAAAAABMBAAAA  19908.08   1271.20    -35.54\n4   catalog channel  catalog_pageAAAAAAAAACACAAAA  11431.10    341.88  -1197.26\n5   catalog channel  catalog_pageAAAAAAAAACMBAAAA  12135.69      0.00    -87.84\n6   catalog channel  catalog_pageAAAAAAAAADACAAAA  22356.94    861.64   -971.31\n7   catalog channel  catalog_pageAAAAAAAAADLBAAAA  35828.53   2613.41 -13155.95\n8   catalog channel  catalog_pageAAAAAAAAADMBAAAA  19504.36      0.00  -3436.06\n9   catalog channel  catalog_pageAAAAAAAAAEACAAAA   4649.88      0.00 -14297.26\n10  catalog channel  catalog_pageAAAAAAAAAELBAAAA  32931.26    245.76  -3087.17\n11  catalog channel  catalog_pageAAAAAAAAAEMBAAAA  26137.98   1211.84 -12064.16\n12  catalog channel  catalog_pageAAAAAAAAAFACAAAA  18132.46      0.00   -713.30\n13  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  23328.32      0.00 -14733.00\n14  catalog channel  catalog_pageAAAAAAAAAFMBAAAA  10989.83      0.00  -2274.11\n15  catalog channel  catalog_pageAAAAAAAAAGLBAAAA  11807.76    451.60  -1105.63\n16  catalog channel  catalog_pageAAAAAAAAAGMBAAAA  35738.22      0.00   2386.53\n17  catalog channel  catalog_pageAAAAAAAAAHLBAAAA  41429.81   1162.07 -17957.77\n18  catalog channel  catalog_pageAAAAAAAAAHMBAAAA  23659.97      0.00   3930.16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.360106,
                    "execution_time": 0.140269,
                    "compile_time": 0.001187,
                    "planning_time": 0.168413
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.674754,
                    "execution_time": 0.140059,
                    "compile_time": 7.182926,
                    "planning_time": 0.305395
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAAACAAAA  24244.67    235.98   6764.68\n1   catalog channel  catalog_pageAAAAAAAAAAMBAAAA  19248.20    654.47 -21165.11\n2   catalog channel  catalog_pageAAAAAAAAABACAAAA   8541.23    111.54  -3775.99\n3   catalog channel  catalog_pageAAAAAAAAABMBAAAA  19908.08   1271.20    -35.54\n4   catalog channel  catalog_pageAAAAAAAAACACAAAA  11431.10    341.88  -1197.26\n5   catalog channel  catalog_pageAAAAAAAAACMBAAAA  12135.69      0.00    -87.84\n6   catalog channel  catalog_pageAAAAAAAAADACAAAA  22356.94    861.64   -971.31\n7   catalog channel  catalog_pageAAAAAAAAADLBAAAA  35828.53   2613.41 -13155.95\n8   catalog channel  catalog_pageAAAAAAAAADMBAAAA  19504.36      0.00  -3436.06\n9   catalog channel  catalog_pageAAAAAAAAAEACAAAA   4649.88      0.00 -14297.26\n10  catalog channel  catalog_pageAAAAAAAAAELBAAAA  32931.26    245.76  -3087.17\n11  catalog channel  catalog_pageAAAAAAAAAEMBAAAA  26137.98   1211.84 -12064.16\n12  catalog channel  catalog_pageAAAAAAAAAFACAAAA  18132.46      0.00   -713.30\n13  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  23328.32      0.00 -14733.00\n14  catalog channel  catalog_pageAAAAAAAAAFMBAAAA  10989.83      0.00  -2274.11\n15  catalog channel  catalog_pageAAAAAAAAAGLBAAAA  11807.76    451.60  -1105.63\n16  catalog channel  catalog_pageAAAAAAAAAGMBAAAA  35738.22      0.00   2386.53\n17  catalog channel  catalog_pageAAAAAAAAAHLBAAAA  41429.81   1162.07 -17957.77\n18  catalog channel  catalog_pageAAAAAAAAAHMBAAAA  23659.97      0.00   3930.16\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n    SELECT          ss_store_sk AS store_id, \n                    Sum(ss_ext_sales_price) AS sales, \n                    Sum(COALESCE(sr_return_amt, 0)) AS returns1, \n                    Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n    FROM            store_sales \n    LEFT OUTER JOIN store_returns \n    ON              ( \n                         ss_item_sk = sr_item_sk \n                AND     ss_ticket_number = sr_ticket_number), \n                    date_dim, \n                    store, \n                    item, \n                    promotion \n    WHERE           ss_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n    AND             ss_store_sk = s_store_sk \n    AND             ss_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             ss_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        ss_store_sk) , csr AS \n( \n    SELECT          cs_catalog_page_sk AS catalog_page_id, \n                    sum(cs_ext_sales_price) AS sales, \n                    sum(COALESCE(cr_return_amount, 0)) AS returns1, \n                    sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n    FROM            catalog_sales \n    LEFT OUTER JOIN catalog_returns \n    ON              ( \n                         cs_item_sk = cr_item_sk \n                AND     cs_order_number = cr_order_number), \n                    date_dim, \n                    catalog_page, \n                    item, \n                    promotion \n    WHERE           cs_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, cast('2000-08-26' AS date)) \n    AND             cs_catalog_page_sk = cp_catalog_page_sk \n    AND             cs_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             cs_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        cs_catalog_page_sk) , wsr AS \n( \n    SELECT          ws_web_site_sk AS web_site_id, \n                    sum(ws_ext_sales_price) AS sales, \n                    sum(COALESCE(wr_return_amt, 0)) AS returns1, \n                    sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n    FROM            web_sales \n    LEFT OUTER JOIN web_returns \n    ON              ( \n                         ws_item_sk = wr_item_sk \n                AND     ws_order_number = wr_order_number), \n                    date_dim, \n                    web_site, \n                    item, \n                    promotion \n    WHERE           ws_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, cast('2000-08-26' AS date)) \n    AND             ws_web_site_sk = web_site_sk \n    AND             ws_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             ws_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        ws_web_site_sk) \nSELECT\n     channel , \n     id , \n     sum(sales) AS sales , \n     sum(returns1) AS returns1 , \n     sum(profit) AS profit \nFROM     ( \n            SELECT 'store channel' AS channel , \n                   'store' || store_id AS id , \n                   sales , \n                   returns1 , \n                   profit \n            FROM   ssr \n            UNION ALL \n            SELECT 'catalog channel' AS channel , \n                   'catalog_page' || catalog_page_id AS id , \n                   sales , \n                   returns1 , \n                   profit \n            FROM   csr \n            UNION ALL\n            SELECT 'web channel' AS channel,\n                   'web' || web_site_id AS id,\n                   sales,\n                   returns1,\n                   profit\n            FROM   wsr\n         ) sub\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"SUB\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"SUB\".\"CHANNEL\" AS \"CHANNEL\" , \"SUB\".\"ID\" AS \"ID\" , SUM ( \"SUB\".\"SALES\" ) AS \"SALES\" , SUM ( \"SUB\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SUB\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SUB\" AS \"SUB\" GROUP BY \"SUB\".\"CHANNEL\" , \"SUB\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CS_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CS_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS SUB GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id        sales   returns1      profit\n0     store channel          store115   3291876.27  176701.53 -1348584.76\n1     store channel          store308   3017669.31  124115.69 -1534068.96\n2     store channel          store280   3087412.55  214327.09 -1536084.97\n3     store channel           store85   3197512.31  162425.96 -1358495.91\n4   catalog channel  catalog_page6968   1090585.69   55188.35  -153980.65\n5   catalog channel  catalog_page6999   1235313.83   54018.98  -153145.70\n6   catalog channel  catalog_page7097   1172484.78   55420.37   -63305.21\n7   catalog channel  catalog_page8281    334667.60    7269.65   -74983.05\n8   catalog channel  catalog_page7254    627727.58   23173.62  -111579.44\n9   catalog channel  catalog_page7126   1199169.29   44669.33  -165439.51\n10  catalog channel  catalog_page8103    202303.86    8116.49   -37501.61\n11  catalog channel  catalog_page8253    208121.26    8728.87   -23261.73\n12  catalog channel  catalog_page7260    589426.54   39243.86   -61840.71\n13      web channel              web5  18775387.66  983497.89 -2608121.42\n14    store channel          store128   3246521.78  178210.34 -1414249.50\n15    store channel          store136   3148278.42  135207.56 -1532012.27\n16    store channel          store316   2949352.14  137369.72 -1429560.69\n17    store channel           store32   3058725.30  157195.47 -1326511.26\n18    store channel          store250   3114940.74  148299.29 -1424897.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.396496,
                    "execution_time": 0.172689,
                    "compile_time": 0.001136,
                    "planning_time": 0.173059
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.195813,
                    "execution_time": 0.182114,
                    "compile_time": 8.660345,
                    "planning_time": 0.291748
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id        sales   returns1      profit\n0     store channel          store115   3291876.27  176701.53 -1348584.76\n1     store channel          store308   3017669.31  124115.69 -1534068.96\n2     store channel          store280   3087412.55  214327.09 -1536084.97\n3     store channel           store85   3197512.31  162425.96 -1358495.91\n4   catalog channel  catalog_page6968   1090585.69   55188.35  -153980.65\n5   catalog channel  catalog_page6999   1235313.83   54018.98  -153145.70\n6   catalog channel  catalog_page7097   1172484.78   55420.37   -63305.21\n7   catalog channel  catalog_page8281    334667.60    7269.65   -74983.05\n8   catalog channel  catalog_page7254    627727.58   23173.62  -111579.44\n9   catalog channel  catalog_page7126   1199169.29   44669.33  -165439.51\n10  catalog channel  catalog_page8103    202303.86    8116.49   -37501.61\n11  catalog channel  catalog_page8253    208121.26    8728.87   -23261.73\n12  catalog channel  catalog_page7260    589426.54   39243.86   -61840.71\n13      web channel              web5  18775387.66  983497.89 -2608121.42\n14    store channel          store128   3246521.78  178210.34 -1414249.50\n15    store channel          store136   3148278.42  135207.56 -1532012.27\n16    store channel          store316   2949352.14  137369.72 -1429560.69\n17    store channel           store32   3058725.30  157195.47 -1326511.26\n18    store channel          store250   3114940.74  148299.29 -1424897.53\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          ss_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ss_store_sk) , csr AS \n( \n                SELECT          cs_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cs_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = ws_web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || ws_web_site_sk AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr) AS combined\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WS_WEB_SITE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" WHERE \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SALES\".\"WS_WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WS_WEB_SITE_SK\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CS_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CS_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WS_WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WS_WEB_SITE_SK AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id      sales  returns1    profit\n0   catalog channel  catalog_page6960   35828.53   2613.41 -13155.95\n1   catalog channel  catalog_page7288    4847.38   1543.32  -6934.27\n2   catalog channel  catalog_page8219   14832.66      0.00 -10296.76\n3   catalog channel  catalog_page7104   44933.57      0.00  -7508.04\n4   catalog channel  catalog_page7198   16728.39   1718.10   7433.41\n5   catalog channel  catalog_page8198   25061.18      0.00   1810.43\n6   catalog channel  catalog_page7232   26137.98   1211.84 -12064.16\n7   catalog channel  catalog_page7085   24325.88    160.68 -17032.00\n8   catalog channel  catalog_page7285   10756.19     87.72 -12101.24\n9   catalog channel  catalog_page8093    7629.67    115.96     45.71\n10    store channel          store313  111222.87   8098.78 -48204.41\n11    store channel          store349  114525.80   1399.61 -28705.86\n12    store channel          store232   99774.93   6856.40 -63209.39\n13    store channel          store176   90599.79    937.34 -34373.30\n14    store channel          store277   94758.43   7479.79 -33392.37\n15  catalog channel  catalog_page8085   18643.06   6081.20   2811.90\n16  catalog channel  catalog_page7222   33631.55      0.00  11944.81\n17  catalog channel  catalog_page7201   20647.10   2020.62  -1864.85\n18  catalog channel  catalog_page7148   29060.33  10922.45   7557.23\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.362582,
                    "execution_time": 0.139993,
                    "compile_time": 0.001162,
                    "planning_time": 0.171768
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.351409,
                    "execution_time": 0.141242,
                    "compile_time": 7.856949,
                    "planning_time": 0.294299
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id      sales  returns1    profit\n0   catalog channel  catalog_page6960   35828.53   2613.41 -13155.95\n1   catalog channel  catalog_page7288    4847.38   1543.32  -6934.27\n2   catalog channel  catalog_page8219   14832.66      0.00 -10296.76\n3   catalog channel  catalog_page7104   44933.57      0.00  -7508.04\n4   catalog channel  catalog_page7198   16728.39   1718.10   7433.41\n5   catalog channel  catalog_page8198   25061.18      0.00   1810.43\n6   catalog channel  catalog_page7232   26137.98   1211.84 -12064.16\n7   catalog channel  catalog_page7085   24325.88    160.68 -17032.00\n8   catalog channel  catalog_page7285   10756.19     87.72 -12101.24\n9   catalog channel  catalog_page8093    7629.67    115.96     45.71\n10    store channel          store313  111222.87   8098.78 -48204.41\n11    store channel          store349  114525.80   1399.61 -28705.86\n12    store channel          store232   99774.93   6856.40 -63209.39\n13    store channel          store176   90599.79    937.34 -34373.30\n14    store channel          store277   94758.43   7479.79 -33392.37\n15  catalog channel  catalog_page8085   18643.06   6081.20   2811.90\n16  catalog channel  catalog_page7222   33631.55      0.00  11944.81\n17  catalog channel  catalog_page7201   20647.10   2020.62  -1864.85\n18  catalog channel  catalog_page7148   29060.33  10922.45   7557.23\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n/*CURSOR_IDENTIFIER*/ SELECT 'web channel' AS channel , 'web' || web_site_id AS id , sales , returns1 , profit FROM wsr) GROUP BY channel, id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.219486,
                    "execution_time": 0.12594,
                    "compile_time": 0.000533,
                    "planning_time": 0.055622,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.594621,
                    "execution_time": 0.125499,
                    "compile_time": 4.294884,
                    "planning_time": 0.131461,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.285771,
                    "execution_time": 0.111138,
                    "compile_time": 0.081777,
                    "planning_time": 0.056618,
                    "create_size": 84
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.961174,
                    "execution_time": 0.190329,
                    "compile_time": 6.599769,
                    "planning_time": 0.129371,
                    "create_size": 84
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"SPEQLITE_TEMP_TABLE_5\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"SPEQLITE_TEMP_TABLE_6\".\"WEB_SITE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.206092,
                    "execution_time": 0.049216,
                    "compile_time": 0.116367,
                    "planning_time": 0.009539,
                    "create_size": 24
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.524666,
                    "execution_time": 0.050987,
                    "compile_time": 6.382911,
                    "planning_time": 0.051717,
                    "create_size": 24
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.118883,
                    "execution_time": 0.039816,
                    "compile_time": 0.045628,
                    "planning_time": 0.004688,
                    "create_size": 24
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.494919,
                    "execution_time": 0.040364,
                    "compile_time": 3.359063,
                    "planning_time": 0.060919,
                    "create_size": 24
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAFGACAAAA   332525.61   9696.44  -54373.22\n1   catalog channel  catalog_pageAAAAAAAAGGACAAAA   294792.91  20256.79  -71139.87\n2   catalog channel  catalog_pageAAAAAAAAMILBAAAA  1283273.85  93573.96 -147715.10\n3   catalog channel  catalog_pageAAAAAAAAHMPBAAAA   243271.07  16410.53  -39890.17\n4   catalog channel  catalog_pageAAAAAAAACABCAAAA   407337.92  14694.10  -26680.45\n5   catalog channel  catalog_pageAAAAAAAAANPBAAAA   165908.91   2758.52  -47569.82\n6   catalog channel  catalog_pageAAAAAAAAAIMBAAAA   547802.31  18775.08  -58904.25\n7   catalog channel  catalog_pageAAAAAAAANKLBAAAA  1162462.29  76565.21 -221057.51\n8   catalog channel  catalog_pageAAAAAAAAHLLBAAAA  1101797.70  69280.67 -254574.48\n9   catalog channel  catalog_pageAAAAAAAANCMBAAAA   489543.08  26306.89 -121876.77\n10  catalog channel  catalog_pageAAAAAAAAPKACAAAA   361560.46  19841.76  -32018.43\n11  catalog channel  catalog_pageAAAAAAAAJEACAAAA   158562.77   3308.27  -70831.32\n12  catalog channel  catalog_pageAAAAAAAAIABCAAAA   404701.12  43068.72  -10786.80\n13  catalog channel  catalog_pageAAAAAAAACNLBAAAA  1240449.55  77229.13 -174869.89\n14  catalog channel  catalog_pageAAAAAAAADBMBAAAA   626564.83  37298.15  -76071.54\n15  catalog channel  catalog_pageAAAAAAAABDACAAAA   210594.80  13486.64    6434.64\n16  catalog channel  catalog_pageAAAAAAAAKFLBAAAA  1243378.90  82292.81 -185245.16\n17  catalog channel  catalog_pageAAAAAAAAFMLBAAAA  1222550.86  74375.20 -164994.14\n18  catalog channel  catalog_pageAAAAAAAAFKACAAAA   390193.98  18602.44  -50456.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046537,
                    "execution_time": 0.007978,
                    "compile_time": 0.028898,
                    "planning_time": 0.003619
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.156136,
                    "execution_time": 0.007803,
                    "compile_time": 3.098425,
                    "planning_time": 0.03941
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAFGACAAAA   332525.61   9696.44  -54373.22\n1   catalog channel  catalog_pageAAAAAAAAGGACAAAA   294792.91  20256.79  -71139.87\n2   catalog channel  catalog_pageAAAAAAAAMILBAAAA  1283273.85  93573.96 -147715.10\n3   catalog channel  catalog_pageAAAAAAAAHMPBAAAA   243271.07  16410.53  -39890.17\n4   catalog channel  catalog_pageAAAAAAAACABCAAAA   407337.92  14694.10  -26680.45\n5   catalog channel  catalog_pageAAAAAAAAANPBAAAA   165908.91   2758.52  -47569.82\n6   catalog channel  catalog_pageAAAAAAAAAIMBAAAA   547802.31  18775.08  -58904.25\n7   catalog channel  catalog_pageAAAAAAAANKLBAAAA  1162462.29  76565.21 -221057.51\n8   catalog channel  catalog_pageAAAAAAAAHLLBAAAA  1101797.70  69280.67 -254574.48\n9   catalog channel  catalog_pageAAAAAAAANCMBAAAA   489543.08  26306.89 -121876.77\n10  catalog channel  catalog_pageAAAAAAAAPKACAAAA   361560.46  19841.76  -32018.43\n11  catalog channel  catalog_pageAAAAAAAAJEACAAAA   158562.77   3308.27  -70831.32\n12  catalog channel  catalog_pageAAAAAAAAIABCAAAA   404701.12  43068.72  -10786.80\n13  catalog channel  catalog_pageAAAAAAAACNLBAAAA  1240449.55  77229.13 -174869.89\n14  catalog channel  catalog_pageAAAAAAAADBMBAAAA   626564.83  37298.15  -76071.54\n15  catalog channel  catalog_pageAAAAAAAABDACAAAA   210594.80  13486.64    6434.64\n16  catalog channel  catalog_pageAAAAAAAAKFLBAAAA  1243378.90  82292.81 -185245.16\n17  catalog channel  catalog_pageAAAAAAAAFMLBAAAA  1222550.86  74375.20 -164994.14\n18  catalog channel  catalog_pageAAAAAAAAFKACAAAA   390193.98  18602.44  -50456.09\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          ss_store_sk                                    AS store_id, \n                                SUM(SS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(SR_RETURN_AMT, 0))               AS returns1, \n                                SUM(SS_NET_PROFIT - COALESCE(SR_NET_LOSS, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ss_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                SUM(CS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(CR_RETURN_AMOUNT, 0))            AS returns1, \n                                SUM(CS_NET_PROFIT - COALESCE(CR_NET_LOSS, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                SUM(WS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(WR_RETURN_AMT, 0))               AS returns1, \n                                SUM(WS_NET_PROFIT - COALESCE(WR_NET_LOSS, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         SUM(sales)   AS sales , \n         SUM(returns1) AS returns1 , \n         SUM(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site'\n                              || web_site_id AS id ,\n                       sales ,\n                       returns1 ,\n                       profit \n                FROM   wsr \n/*CURSOR_IDENTIFIER*/ ) \nGROUP BY channel , id \nORDER BY channel , id;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" FROM \"ITEM\" AS \"ITEM\" ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                id        sales    returns1      profit\n0   catalog channel  catalog_page6957  20511255.87   979914.64 -2737864.67\n1   catalog channel  catalog_page6958  21492736.81  1203519.08 -2439025.49\n2   catalog channel  catalog_page6959  21138068.69  1053079.16 -2840163.15\n3   catalog channel  catalog_page6960  21589512.07   987634.13 -2633532.44\n4   catalog channel  catalog_page6961  21376326.62  1054260.33 -2805753.86\n5   catalog channel  catalog_page6962  20955856.65  1042835.60 -2980223.19\n6   catalog channel  catalog_page6963  20989819.62  1039099.83 -2892354.05\n7   catalog channel  catalog_page6964  21505627.95  1105669.51 -2214246.23\n8   catalog channel  catalog_page6965  20403992.23  1145851.23 -3130146.77\n9   catalog channel  catalog_page6966  20807923.07   919649.98 -2503271.67\n10  catalog channel  catalog_page6967  21157210.11  1066843.14 -2872111.25\n11  catalog channel  catalog_page6968  20916884.28  1183826.00 -2710597.64\n12  catalog channel  catalog_page6969  21715612.34  1173262.61 -2831517.86\n13  catalog channel  catalog_page6970  20524342.20  1031078.43 -2927740.26\n14  catalog channel  catalog_page6971  21126339.84   929536.17 -2747470.41\n15  catalog channel  catalog_page6972  21417723.07  1090086.06 -2787143.07\n16  catalog channel  catalog_page6973  22018829.95   998511.79 -2682856.89\n17  catalog channel  catalog_page6974  21586984.36  1148648.29 -2764771.95\n18  catalog channel  catalog_page6975  21708621.49  1027844.23 -2480968.19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.603713,
                    "execution_time": 0.386867,
                    "compile_time": 0.001184,
                    "planning_time": 0.164729
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 19.039533,
                    "execution_time": 0.386968,
                    "compile_time": 18.326061,
                    "planning_time": 0.283252
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id        sales    returns1      profit\n0   catalog channel  catalog_page6957  20511255.87   979914.64 -2737864.67\n1   catalog channel  catalog_page6958  21492736.81  1203519.08 -2439025.49\n2   catalog channel  catalog_page6959  21138068.69  1053079.16 -2840163.15\n3   catalog channel  catalog_page6960  21589512.07   987634.13 -2633532.44\n4   catalog channel  catalog_page6961  21376326.62  1054260.33 -2805753.86\n5   catalog channel  catalog_page6962  20955856.65  1042835.60 -2980223.19\n6   catalog channel  catalog_page6963  20989819.62  1039099.83 -2892354.05\n7   catalog channel  catalog_page6964  21505627.95  1105669.51 -2214246.23\n8   catalog channel  catalog_page6965  20403992.23  1145851.23 -3130146.77\n9   catalog channel  catalog_page6966  20807923.07   919649.98 -2503271.67\n10  catalog channel  catalog_page6967  21157210.11  1066843.14 -2872111.25\n11  catalog channel  catalog_page6968  20916884.28  1183826.00 -2710597.64\n12  catalog channel  catalog_page6969  21715612.34  1173262.61 -2831517.86\n13  catalog channel  catalog_page6970  20524342.20  1031078.43 -2927740.26\n14  catalog channel  catalog_page6971  21126339.84   929536.17 -2747470.41\n15  catalog channel  catalog_page6972  21417723.07  1090086.06 -2787143.07\n16  catalog channel  catalog_page6973  22018829.95   998511.79 -2682856.89\n17  catalog channel  catalog_page6974  21586984.36  1148648.29 -2764771.95\n18  catalog channel  catalog_page6975  21708621.49  1027844.23 -2480968.19\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined \nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1    profit\n0     store channel         storeAAAAAAAAMHBAAAAA   86863.79   9127.02 -43703.96\n1   catalog channel  catalog_pageAAAAAAAAGPLBAAAA   15310.27   1144.31 -11839.03\n2   catalog channel  catalog_pageAAAAAAAANIMBAAAA    4229.88      0.00  -4137.12\n3   catalog channel  catalog_pageAAAAAAAAPNLBAAAA   42344.26   3581.72  -6235.23\n4   catalog channel  catalog_pageAAAAAAAADKMBAAAA   23530.46      0.00  -3533.70\n5   catalog channel  catalog_pageAAAAAAAAAOPBAAAA    7468.81      0.00    133.19\n6   catalog channel  catalog_pageAAAAAAAAHHMBAAAA   22219.48    304.36 -11422.73\n7     store channel         storeAAAAAAAAHGAAAAAA  104664.92   1028.09 -56214.59\n8     store channel         storeAAAAAAAAIGAAAAAA   97495.76   2914.58 -64394.48\n9     store channel         storeAAAAAAAAEGBAAAAA  123723.48  10712.40 -36828.71\n10    store channel         storeAAAAAAAABPAAAAAA   99320.98   2807.17 -32696.53\n11  catalog channel  catalog_pageAAAAAAAAKDLBAAAA   33827.44   7779.19 -11665.17\n12  catalog channel  catalog_pageAAAAAAAAIOPBAAAA   25982.89   3807.94 -17201.97\n13  catalog channel  catalog_pageAAAAAAAAEFMBAAAA   20311.47      0.00   5091.27\n14  catalog channel  catalog_pageAAAAAAAAMGMBAAAA   14767.62      0.00  -2429.10\n15  catalog channel  catalog_pageAAAAAAAALIMBAAAA   16142.43    143.10 -10692.84\n16  catalog channel  catalog_pageAAAAAAAAIELBAAAA   22293.48      0.00 -11057.53\n17  catalog channel  catalog_pageAAAAAAAAFLPBAAAA   11024.67   6361.26  -2728.21\n18    store channel         storeAAAAAAAABAAAAAAA  127872.63   1489.38 -26270.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.356296,
                    "execution_time": 0.140146,
                    "compile_time": 0.001113,
                    "planning_time": 0.165747
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.49232,
                    "execution_time": 0.140169,
                    "compile_time": 0.00111,
                    "planning_time": 0.301483
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id      sales  returns1    profit\n0     store channel         storeAAAAAAAAMHBAAAAA   86863.79   9127.02 -43703.96\n1   catalog channel  catalog_pageAAAAAAAAGPLBAAAA   15310.27   1144.31 -11839.03\n2   catalog channel  catalog_pageAAAAAAAANIMBAAAA    4229.88      0.00  -4137.12\n3   catalog channel  catalog_pageAAAAAAAAPNLBAAAA   42344.26   3581.72  -6235.23\n4   catalog channel  catalog_pageAAAAAAAADKMBAAAA   23530.46      0.00  -3533.70\n5   catalog channel  catalog_pageAAAAAAAAAOPBAAAA    7468.81      0.00    133.19\n6   catalog channel  catalog_pageAAAAAAAAHHMBAAAA   22219.48    304.36 -11422.73\n7     store channel         storeAAAAAAAAHGAAAAAA  104664.92   1028.09 -56214.59\n8     store channel         storeAAAAAAAAIGAAAAAA   97495.76   2914.58 -64394.48\n9     store channel         storeAAAAAAAAEGBAAAAA  123723.48  10712.40 -36828.71\n10    store channel         storeAAAAAAAABPAAAAAA   99320.98   2807.17 -32696.53\n11  catalog channel  catalog_pageAAAAAAAAKDLBAAAA   33827.44   7779.19 -11665.17\n12  catalog channel  catalog_pageAAAAAAAAIOPBAAAA   25982.89   3807.94 -17201.97\n13  catalog channel  catalog_pageAAAAAAAAEFMBAAAA   20311.47      0.00   5091.27\n14  catalog channel  catalog_pageAAAAAAAAMGMBAAAA   14767.62      0.00  -2429.10\n15  catalog channel  catalog_pageAAAAAAAALIMBAAAA   16142.43    143.10 -10692.84\n16  catalog channel  catalog_pageAAAAAAAAIELBAAAA   22293.48      0.00 -11057.53\n17  catalog channel  catalog_pageAAAAAAAAFLPBAAAA   11024.67   6361.26  -2728.21\n18    store channel         storeAAAAAAAABAAAAAAA  127872.63   1489.38 -26270.36\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined_results \nGROUP BY channel, id \nORDER BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page6957  37767.44   4025.56  -7075.68\n1   catalog channel  catalog_page6958  45570.68   3423.42   5794.69\n2   catalog channel  catalog_page6959  52156.13    990.61   1873.08\n3   catalog channel  catalog_page6960  35828.53   2613.41 -13155.95\n4   catalog channel  catalog_page6961  51515.64   2164.25  -1355.83\n5   catalog channel  catalog_page6962  39364.58   4397.00  -3729.10\n6   catalog channel  catalog_page6963  44035.76   4073.85  11638.12\n7   catalog channel  catalog_page6964  54531.01    349.27 -12358.35\n8   catalog channel  catalog_page6965  42720.85      0.00 -11910.22\n9   catalog channel  catalog_page6966  37179.58   1584.68  -6324.32\n10  catalog channel  catalog_page6967  10797.08    994.79  -7867.78\n11  catalog channel  catalog_page6968  39168.13      1.62 -16213.11\n12  catalog channel  catalog_page6969  59762.19      0.00 -12499.10\n13  catalog channel  catalog_page6970  33827.44   7779.19 -11665.17\n14  catalog channel  catalog_page6971  37047.02      0.00 -11119.70\n15  catalog channel  catalog_page6972  71860.91   2088.00   2427.03\n16  catalog channel  catalog_page6973  25416.81   8001.49  -1738.80\n17  catalog channel  catalog_page6974  29929.91     40.21  -6268.53\n18  catalog channel  catalog_page6975  54397.09    253.60   7589.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.350168,
                    "execution_time": 0.13761,
                    "compile_time": 0.001104,
                    "planning_time": 0.163492
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.479481,
                    "execution_time": 0.141259,
                    "compile_time": 0.001089,
                    "planning_time": 0.288817
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page6957  37767.44   4025.56  -7075.68\n1   catalog channel  catalog_page6958  45570.68   3423.42   5794.69\n2   catalog channel  catalog_page6959  52156.13    990.61   1873.08\n3   catalog channel  catalog_page6960  35828.53   2613.41 -13155.95\n4   catalog channel  catalog_page6961  51515.64   2164.25  -1355.83\n5   catalog channel  catalog_page6962  39364.58   4397.00  -3729.10\n6   catalog channel  catalog_page6963  44035.76   4073.85  11638.12\n7   catalog channel  catalog_page6964  54531.01    349.27 -12358.35\n8   catalog channel  catalog_page6965  42720.85      0.00 -11910.22\n9   catalog channel  catalog_page6966  37179.58   1584.68  -6324.32\n10  catalog channel  catalog_page6967  10797.08    994.79  -7867.78\n11  catalog channel  catalog_page6968  39168.13      1.62 -16213.11\n12  catalog channel  catalog_page6969  59762.19      0.00 -12499.10\n13  catalog channel  catalog_page6970  33827.44   7779.19 -11665.17\n14  catalog channel  catalog_page6971  37047.02      0.00 -11119.70\n15  catalog channel  catalog_page6972  71860.91   2088.00   2427.03\n16  catalog channel  catalog_page6973  25416.81   8001.49  -1738.80\n17  catalog channel  catalog_page6974  29929.91     40.21  -6268.53\n18  catalog channel  catalog_page6975  54397.09    253.60   7589.48\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id      sales  returns1    profit\n0   catalog channel  catalog_page7101   29805.66      0.00   1121.98\n1   catalog channel  catalog_page7162   26116.90   1170.54  -7739.95\n2   catalog channel  catalog_page7136   35591.02    748.16 -10519.20\n3   catalog channel  catalog_page7074   41867.86   8284.56 -24660.44\n4   catalog channel  catalog_page7247   32407.15   9379.26    324.81\n5   catalog channel  catalog_page8111   18823.53     78.68  -2067.65\n6   catalog channel  catalog_page7077   45602.73   3429.68   5385.55\n7   catalog channel  catalog_page7152   17647.24      0.00  -2045.24\n8   catalog channel  catalog_page8199    7409.81      0.00  -3217.30\n9     store channel          store104   97495.76   2914.58 -64394.48\n10    store channel          store184  102249.30   4497.98 -37414.84\n11    store channel          store148  105832.20   6023.76 -70083.18\n12  catalog channel  catalog_page7307   16142.43    143.10 -10692.84\n13  catalog channel  catalog_page7112   43514.24    182.34 -13571.20\n14  catalog channel  catalog_page7330   37033.54      0.00   1812.98\n15  catalog channel  catalog_page8179    4094.02      0.85   -995.46\n16  catalog channel  catalog_page7090   43193.91      0.00  -4027.89\n17  catalog channel  catalog_page8144   12727.83    354.72    251.00\n18  catalog channel  catalog_page7151   15602.02      0.00   5098.56\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.342496,
                    "execution_time": 0.138198,
                    "compile_time": 0.000977,
                    "planning_time": 0.157756
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.470686,
                    "execution_time": 0.140539,
                    "compile_time": 0.00102,
                    "planning_time": 0.283165
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id      sales  returns1    profit\n0   catalog channel  catalog_page7101   29805.66      0.00   1121.98\n1   catalog channel  catalog_page7162   26116.90   1170.54  -7739.95\n2   catalog channel  catalog_page7136   35591.02    748.16 -10519.20\n3   catalog channel  catalog_page7074   41867.86   8284.56 -24660.44\n4   catalog channel  catalog_page7247   32407.15   9379.26    324.81\n5   catalog channel  catalog_page8111   18823.53     78.68  -2067.65\n6   catalog channel  catalog_page7077   45602.73   3429.68   5385.55\n7   catalog channel  catalog_page7152   17647.24      0.00  -2045.24\n8   catalog channel  catalog_page8199    7409.81      0.00  -3217.30\n9     store channel          store104   97495.76   2914.58 -64394.48\n10    store channel          store184  102249.30   4497.98 -37414.84\n11    store channel          store148  105832.20   6023.76 -70083.18\n12  catalog channel  catalog_page7307   16142.43    143.10 -10692.84\n13  catalog channel  catalog_page7112   43514.24    182.34 -13571.20\n14  catalog channel  catalog_page7330   37033.54      0.00   1812.98\n15  catalog channel  catalog_page8179    4094.02      0.85   -995.46\n16  catalog channel  catalog_page7090   43193.91      0.00  -4027.89\n17  catalog channel  catalog_page8144   12727.83    354.72    251.00\n18  catalog channel  catalog_page7151   15602.02      0.00   5098.56\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"SPEQLITE_TEMP_TABLE_5\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"SPEQLITE_TEMP_TABLE_6\".\"WEB_SITE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125819,
                    "execution_time": 0.04917,
                    "compile_time": 0.035702,
                    "planning_time": 0.009921,
                    "create_size": 24
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.250263,
                    "execution_time": 0.050241,
                    "compile_time": 3.117022,
                    "planning_time": 0.05095,
                    "create_size": 24
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.104424,
                    "execution_time": 0.040462,
                    "compile_time": 0.026673,
                    "planning_time": 0.005793,
                    "create_size": 24
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.465799,
                    "execution_time": 0.04126,
                    "compile_time": 3.313425,
                    "planning_time": 0.076745,
                    "create_size": 24
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAINACAAAA   350549.07  23435.84    2919.34\n1   catalog channel  catalog_pageAAAAAAAAFNPBAAAA   191474.19  14555.59  -31673.91\n2   catalog channel  catalog_pageAAAAAAAAAGLBAAAA  1308703.40  55777.44 -108476.42\n3   catalog channel  catalog_pageAAAAAAAAMILBAAAA  1283273.85  93573.96 -147715.10\n4   catalog channel  catalog_pageAAAAAAAAHMPBAAAA   243271.07  16410.53  -39890.17\n5   catalog channel  catalog_pageAAAAAAAACABCAAAA   407337.92  14694.10  -26680.45\n6   catalog channel  catalog_pageAAAAAAAAANPBAAAA   165908.91   2758.52  -47569.82\n7   catalog channel  catalog_pageAAAAAAAAAIMBAAAA   547802.31  18775.08  -58904.25\n8   catalog channel  catalog_pageAAAAAAAANKLBAAAA  1162462.29  76565.21 -221057.51\n9   catalog channel  catalog_pageAAAAAAAAFABCAAAA   411743.09  18168.18  -54027.06\n10  catalog channel  catalog_pageAAAAAAAAMKACAAAA   362282.21  14825.18    6714.10\n11  catalog channel  catalog_pageAAAAAAAAENPBAAAA   219419.71  16540.60  -27732.79\n12  catalog channel  catalog_pageAAAAAAAAFJMBAAAA   572399.96  32884.17  -73893.25\n13  catalog channel  catalog_pageAAAAAAAACMPBAAAA   189586.63   6992.72  -19507.43\n14  catalog channel  catalog_pageAAAAAAAABJLBAAAA  1150075.44  53540.48 -179826.03\n15  catalog channel  catalog_pageAAAAAAAAAOLBAAAA  1226190.13  51429.27 -171230.20\n16  catalog channel  catalog_pageAAAAAAAADIMBAAAA   666598.52  23455.80  -61762.93\n17  catalog channel  catalog_pageAAAAAAAAEMLBAAAA  1061281.49  54179.54 -169401.30\n18  catalog channel  catalog_pageAAAAAAAAONPBAAAA   166707.86  10518.69  -41658.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017429,
                    "execution_time": 0.00771,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003641
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.202034,
                    "execution_time": 0.007448,
                    "compile_time": 0.1481,
                    "planning_time": 0.038663
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAINACAAAA   350549.07  23435.84    2919.34\n1   catalog channel  catalog_pageAAAAAAAAFNPBAAAA   191474.19  14555.59  -31673.91\n2   catalog channel  catalog_pageAAAAAAAAAGLBAAAA  1308703.40  55777.44 -108476.42\n3   catalog channel  catalog_pageAAAAAAAAMILBAAAA  1283273.85  93573.96 -147715.10\n4   catalog channel  catalog_pageAAAAAAAAHMPBAAAA   243271.07  16410.53  -39890.17\n5   catalog channel  catalog_pageAAAAAAAACABCAAAA   407337.92  14694.10  -26680.45\n6   catalog channel  catalog_pageAAAAAAAAANPBAAAA   165908.91   2758.52  -47569.82\n7   catalog channel  catalog_pageAAAAAAAAAIMBAAAA   547802.31  18775.08  -58904.25\n8   catalog channel  catalog_pageAAAAAAAANKLBAAAA  1162462.29  76565.21 -221057.51\n9   catalog channel  catalog_pageAAAAAAAAFABCAAAA   411743.09  18168.18  -54027.06\n10  catalog channel  catalog_pageAAAAAAAAMKACAAAA   362282.21  14825.18    6714.10\n11  catalog channel  catalog_pageAAAAAAAAENPBAAAA   219419.71  16540.60  -27732.79\n12  catalog channel  catalog_pageAAAAAAAAFJMBAAAA   572399.96  32884.17  -73893.25\n13  catalog channel  catalog_pageAAAAAAAACMPBAAAA   189586.63   6992.72  -19507.43\n14  catalog channel  catalog_pageAAAAAAAABJLBAAAA  1150075.44  53540.48 -179826.03\n15  catalog channel  catalog_pageAAAAAAAAAOLBAAAA  1226190.13  51429.27 -171230.20\n16  catalog channel  catalog_pageAAAAAAAADIMBAAAA   666598.52  23455.80  -61762.93\n17  catalog channel  catalog_pageAAAAAAAAEMLBAAAA  1061281.49  54179.54 -169401.30\n18  catalog channel  catalog_pageAAAAAAAAONPBAAAA   166707.86  10518.69  -41658.64\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" , \"ID\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAAAACAAAA   224905.75  16673.20   12319.62\n1   catalog channel  catalog_pageAAAAAAAAAABCAAAA   471770.58  25237.83  -20212.01\n2   catalog channel  catalog_pageAAAAAAAAAAMBAAAA   610427.38  34742.09  -77985.08\n3   catalog channel  catalog_pageAAAAAAAAABACAAAA   127372.38   3664.62  -44963.49\n4   catalog channel  catalog_pageAAAAAAAAABMBAAAA   604678.47  23945.34  -12953.42\n5   catalog channel  catalog_pageAAAAAAAAACACAAAA   204734.36   4468.10  -65257.84\n6   catalog channel  catalog_pageAAAAAAAAACMBAAAA   641312.51  24605.08  -17380.87\n7   catalog channel  catalog_pageAAAAAAAAADACAAAA   223374.83  22726.58  -62546.25\n8   catalog channel  catalog_pageAAAAAAAAADLBAAAA  1334156.65  62737.66 -153923.42\n9   catalog channel  catalog_pageAAAAAAAAADMBAAAA   539037.39  26120.81 -117699.84\n10  catalog channel  catalog_pageAAAAAAAAAEACAAAA   164149.79   9462.64  -36209.49\n11  catalog channel  catalog_pageAAAAAAAAAELBAAAA  1224670.97  51610.38 -136980.84\n12  catalog channel  catalog_pageAAAAAAAAAEMBAAAA   651763.59  31659.12   -1595.50\n13  catalog channel  catalog_pageAAAAAAAAAFACAAAA   289566.94  14566.65  -42930.03\n14  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  1186281.72  75872.93 -149659.77\n15  catalog channel  catalog_pageAAAAAAAAAFMBAAAA   623985.48  46220.03  -53414.98\n16  catalog channel  catalog_pageAAAAAAAAAGACAAAA   427005.46  10357.47  -36716.61\n17  catalog channel  catalog_pageAAAAAAAAAGLBAAAA  1308703.40  55777.44 -108476.42\n18  catalog channel  catalog_pageAAAAAAAAAGMBAAAA   607362.51  24800.41  -23882.61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032647,
                    "execution_time": 0.008734,
                    "compile_time": 0.013805,
                    "planning_time": 0.003957
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.224983,
                    "execution_time": 0.010116,
                    "compile_time": 3.172619,
                    "planning_time": 0.039236
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAAAACAAAA   224905.75  16673.20   12319.62\n1   catalog channel  catalog_pageAAAAAAAAAABCAAAA   471770.58  25237.83  -20212.01\n2   catalog channel  catalog_pageAAAAAAAAAAMBAAAA   610427.38  34742.09  -77985.08\n3   catalog channel  catalog_pageAAAAAAAAABACAAAA   127372.38   3664.62  -44963.49\n4   catalog channel  catalog_pageAAAAAAAAABMBAAAA   604678.47  23945.34  -12953.42\n5   catalog channel  catalog_pageAAAAAAAAACACAAAA   204734.36   4468.10  -65257.84\n6   catalog channel  catalog_pageAAAAAAAAACMBAAAA   641312.51  24605.08  -17380.87\n7   catalog channel  catalog_pageAAAAAAAAADACAAAA   223374.83  22726.58  -62546.25\n8   catalog channel  catalog_pageAAAAAAAAADLBAAAA  1334156.65  62737.66 -153923.42\n9   catalog channel  catalog_pageAAAAAAAAADMBAAAA   539037.39  26120.81 -117699.84\n10  catalog channel  catalog_pageAAAAAAAAAEACAAAA   164149.79   9462.64  -36209.49\n11  catalog channel  catalog_pageAAAAAAAAAELBAAAA  1224670.97  51610.38 -136980.84\n12  catalog channel  catalog_pageAAAAAAAAAEMBAAAA   651763.59  31659.12   -1595.50\n13  catalog channel  catalog_pageAAAAAAAAAFACAAAA   289566.94  14566.65  -42930.03\n14  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  1186281.72  75872.93 -149659.77\n15  catalog channel  catalog_pageAAAAAAAAAFMBAAAA   623985.48  46220.03  -53414.98\n16  catalog channel  catalog_pageAAAAAAAAAGACAAAA   427005.46  10357.47  -36716.61\n17  catalog channel  catalog_pageAAAAAAAAAGLBAAAA  1308703.40  55777.44 -108476.42\n18  catalog channel  catalog_pageAAAAAAAAAGMBAAAA   607362.51  24800.41  -23882.61\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \nLIMIT 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" , \"ID\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAAAACAAAA   224905.75  16673.20   12319.62\n1   catalog channel  catalog_pageAAAAAAAAAABCAAAA   471770.58  25237.83  -20212.01\n2   catalog channel  catalog_pageAAAAAAAAAAMBAAAA   610427.38  34742.09  -77985.08\n3   catalog channel  catalog_pageAAAAAAAAABACAAAA   127372.38   3664.62  -44963.49\n4   catalog channel  catalog_pageAAAAAAAAABMBAAAA   604678.47  23945.34  -12953.42\n5   catalog channel  catalog_pageAAAAAAAAACACAAAA   204734.36   4468.10  -65257.84\n6   catalog channel  catalog_pageAAAAAAAAACMBAAAA   641312.51  24605.08  -17380.87\n7   catalog channel  catalog_pageAAAAAAAAADACAAAA   223374.83  22726.58  -62546.25\n8   catalog channel  catalog_pageAAAAAAAAADLBAAAA  1334156.65  62737.66 -153923.42\n9   catalog channel  catalog_pageAAAAAAAAADMBAAAA   539037.39  26120.81 -117699.84\n10  catalog channel  catalog_pageAAAAAAAAAEACAAAA   164149.79   9462.64  -36209.49\n11  catalog channel  catalog_pageAAAAAAAAAELBAAAA  1224670.97  51610.38 -136980.84\n12  catalog channel  catalog_pageAAAAAAAAAEMBAAAA   651763.59  31659.12   -1595.50\n13  catalog channel  catalog_pageAAAAAAAAAFACAAAA   289566.94  14566.65  -42930.03\n14  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  1186281.72  75872.93 -149659.77\n15  catalog channel  catalog_pageAAAAAAAAAFMBAAAA   623985.48  46220.03  -53414.98\n16  catalog channel  catalog_pageAAAAAAAAAGACAAAA   427005.46  10357.47  -36716.61\n17  catalog channel  catalog_pageAAAAAAAAAGLBAAAA  1308703.40  55777.44 -108476.42\n18  catalog channel  catalog_pageAAAAAAAAAGMBAAAA   607362.51  24800.41  -23882.61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018143,
                    "execution_time": 0.008206,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003844
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019227,
                    "execution_time": 0.009078,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003867
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*            channel                            id       sales  returns1     profit\n0   catalog channel  catalog_pageAAAAAAAAAAACAAAA   224905.75  16673.20   12319.62\n1   catalog channel  catalog_pageAAAAAAAAAABCAAAA   471770.58  25237.83  -20212.01\n2   catalog channel  catalog_pageAAAAAAAAAAMBAAAA   610427.38  34742.09  -77985.08\n3   catalog channel  catalog_pageAAAAAAAAABACAAAA   127372.38   3664.62  -44963.49\n4   catalog channel  catalog_pageAAAAAAAAABMBAAAA   604678.47  23945.34  -12953.42\n5   catalog channel  catalog_pageAAAAAAAAACACAAAA   204734.36   4468.10  -65257.84\n6   catalog channel  catalog_pageAAAAAAAAACMBAAAA   641312.51  24605.08  -17380.87\n7   catalog channel  catalog_pageAAAAAAAAADACAAAA   223374.83  22726.58  -62546.25\n8   catalog channel  catalog_pageAAAAAAAAADLBAAAA  1334156.65  62737.66 -153923.42\n9   catalog channel  catalog_pageAAAAAAAAADMBAAAA   539037.39  26120.81 -117699.84\n10  catalog channel  catalog_pageAAAAAAAAAEACAAAA   164149.79   9462.64  -36209.49\n11  catalog channel  catalog_pageAAAAAAAAAELBAAAA  1224670.97  51610.38 -136980.84\n12  catalog channel  catalog_pageAAAAAAAAAEMBAAAA   651763.59  31659.12   -1595.50\n13  catalog channel  catalog_pageAAAAAAAAAFACAAAA   289566.94  14566.65  -42930.03\n14  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  1186281.72  75872.93 -149659.77\n15  catalog channel  catalog_pageAAAAAAAAAFMBAAAA   623985.48  46220.03  -53414.98\n16  catalog channel  catalog_pageAAAAAAAAAGACAAAA   427005.46  10357.47  -36716.61\n17  catalog channel  catalog_pageAAAAAAAAAGLBAAAA  1308703.40  55777.44 -108476.42\n18  catalog channel  catalog_pageAAAAAAAAAGMBAAAA   607362.51  24800.41  -23882.61\n...*/"
    }
]