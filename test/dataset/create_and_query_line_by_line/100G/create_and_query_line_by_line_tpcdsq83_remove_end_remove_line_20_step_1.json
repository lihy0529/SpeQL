[
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n join item on sr_item_sk = i_item_sk\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n join item on cr_item_sk = i_item_sk\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n join item on wr_item_sk = i_item_sk\n join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n/*CURSOR_IDENTIFIER*/ \ngroup by i_item_id)\nselect * from sr_items \njoin cr_items on sr_items.item_id = cr_items.item_id\njoin wr_items on cr_items.item_id = wr_items.item_id;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103264,
                    "execution_time": 0.039566,
                    "compile_time": 0.000241,
                    "planning_time": 0.023608,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.109584,
                    "execution_time": 0.04017,
                    "compile_time": 0.000231,
                    "planning_time": 0.028407,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.21939,
                    "execution_time": 0.053784,
                    "compile_time": 0.000272,
                    "planning_time": 0.023717,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.219235,
                    "execution_time": 0.054448,
                    "compile_time": 0.000221,
                    "planning_time": 0.022964,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.126476,
                    "execution_time": 0.032074,
                    "compile_time": 0.043189,
                    "planning_time": 0.025929,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.45373,
                    "execution_time": 0.03364,
                    "compile_time": 3.301144,
                    "planning_time": 0.088039,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.169814,
                    "execution_time": 0.042963,
                    "compile_time": 0.071998,
                    "planning_time": 0.028258,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.453135,
                    "execution_time": 0.043136,
                    "compile_time": 3.292099,
                    "planning_time": 0.088631,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.357862,
                    "execution_time": 0.092833,
                    "compile_time": 0.147226,
                    "planning_time": 0.033024,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.496887,
                    "execution_time": 0.338617,
                    "compile_time": 6.966665,
                    "planning_time": 0.098696,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095682,
                    "execution_time": 0.042949,
                    "compile_time": 0.000284,
                    "planning_time": 0.027074,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.204295,
                    "execution_time": 0.041815,
                    "compile_time": 0.047817,
                    "planning_time": 0.088249,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.383056,
                    "execution_time": 0.264203,
                    "compile_time": 0.015382,
                    "planning_time": 0.036016,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.843279,
                    "execution_time": 0.305929,
                    "compile_time": 3.366841,
                    "planning_time": 0.098366,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095999,
                    "execution_time": 0.041514,
                    "compile_time": 0.00029,
                    "planning_time": 0.028271,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.158327,
                    "execution_time": 0.041097,
                    "compile_time": 0.000296,
                    "planning_time": 0.09074,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.156635,
                    "execution_time": 0.074438,
                    "compile_time": 0.000483,
                    "planning_time": 0.034481,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.245475,
                    "execution_time": 0.096879,
                    "compile_time": 0.000503,
                    "planning_time": 0.097838,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.336981,
                    "execution_time": 0.074084,
                    "compile_time": 0.207187,
                    "planning_time": 0.007027,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.774503,
                    "execution_time": 0.080233,
                    "compile_time": 13.566878,
                    "planning_time": 0.064498,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_10\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAABNFMAAAA           98  AAAAAAAABNFMAAAA           25  AAAAAAAABNFMAAAA           57\n1   AAAAAAAACHJNAAAA          100  AAAAAAAACHJNAAAA           36  AAAAAAAACHJNAAAA           10\n2   AAAAAAAAMEFACAAA           49  AAAAAAAAMEFACAAA           11  AAAAAAAAMEFACAAA            7\n3   AAAAAAAAEPGADAAA          104  AAAAAAAAEPGADAAA           41  AAAAAAAAEPGADAAA           19\n4   AAAAAAAACCFNBAAA           48  AAAAAAAACCFNBAAA           76  AAAAAAAACCFNBAAA            8\n5   AAAAAAAAOFJBAAAA            7  AAAAAAAAOFJBAAAA            3  AAAAAAAAOFJBAAAA           30\n6   AAAAAAAAOIKFAAAA           31  AAAAAAAAOIKFAAAA           13  AAAAAAAAOIKFAAAA           27\n7   AAAAAAAANFGDBAAA          112  AAAAAAAANFGDBAAA           57  AAAAAAAANFGDBAAA           25\n8   AAAAAAAAODFECAAA           34  AAAAAAAAODFECAAA           27  AAAAAAAAODFECAAA            2\n9   AAAAAAAAHHFDAAAA           88  AAAAAAAAHHFDAAAA           65  AAAAAAAAHHFDAAAA            8\n10  AAAAAAAAEIJKAAAA          124  AAAAAAAAEIJKAAAA           57  AAAAAAAAEIJKAAAA           20\n11  AAAAAAAAINBAAAAA           23  AAAAAAAAINBAAAAA           19  AAAAAAAAINBAAAAA           42\n12  AAAAAAAAMHEACAAA           12  AAAAAAAAMHEACAAA           74  AAAAAAAAMHEACAAA            3\n13  AAAAAAAACIEHBAAA            9  AAAAAAAACIEHBAAA           10  AAAAAAAACIEHBAAA           47\n14  AAAAAAAAJPDJBAAA           94  AAAAAAAAJPDJBAAA           59  AAAAAAAAJPDJBAAA            8\n15  AAAAAAAACONACAAA           84  AAAAAAAACONACAAA           91  AAAAAAAACONACAAA           14\n16  AAAAAAAAMLHIAAAA           75  AAAAAAAAMLHIAAAA           57  AAAAAAAAMLHIAAAA           93\n17  AAAAAAAAGKABCAAA           20  AAAAAAAAGKABCAAA           42  AAAAAAAAGKABCAAA           15\n18  AAAAAAAAKIGICAAA           92  AAAAAAAAKIGICAAA            7  AAAAAAAAKIGICAAA           62\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.062405,
                    "execution_time": 0.008217,
                    "compile_time": 0.043603,
                    "planning_time": 0.003974
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.366056,
                    "execution_time": 0.007841,
                    "compile_time": 3.307489,
                    "planning_time": 0.039656
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_10\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAABNFMAAAA           98  AAAAAAAABNFMAAAA           25  AAAAAAAABNFMAAAA           57\n1   AAAAAAAACHJNAAAA          100  AAAAAAAACHJNAAAA           36  AAAAAAAACHJNAAAA           10\n2   AAAAAAAAMEFACAAA           49  AAAAAAAAMEFACAAA           11  AAAAAAAAMEFACAAA            7\n3   AAAAAAAAEPGADAAA          104  AAAAAAAAEPGADAAA           41  AAAAAAAAEPGADAAA           19\n4   AAAAAAAACCFNBAAA           48  AAAAAAAACCFNBAAA           76  AAAAAAAACCFNBAAA            8\n5   AAAAAAAAOFJBAAAA            7  AAAAAAAAOFJBAAAA            3  AAAAAAAAOFJBAAAA           30\n6   AAAAAAAAOIKFAAAA           31  AAAAAAAAOIKFAAAA           13  AAAAAAAAOIKFAAAA           27\n7   AAAAAAAANFGDBAAA          112  AAAAAAAANFGDBAAA           57  AAAAAAAANFGDBAAA           25\n8   AAAAAAAAODFECAAA           34  AAAAAAAAODFECAAA           27  AAAAAAAAODFECAAA            2\n9   AAAAAAAAHHFDAAAA           88  AAAAAAAAHHFDAAAA           65  AAAAAAAAHHFDAAAA            8\n10  AAAAAAAAEIJKAAAA          124  AAAAAAAAEIJKAAAA           57  AAAAAAAAEIJKAAAA           20\n11  AAAAAAAAINBAAAAA           23  AAAAAAAAINBAAAAA           19  AAAAAAAAINBAAAAA           42\n12  AAAAAAAAMHEACAAA           12  AAAAAAAAMHEACAAA           74  AAAAAAAAMHEACAAA            3\n13  AAAAAAAACIEHBAAA            9  AAAAAAAACIEHBAAA           10  AAAAAAAACIEHBAAA           47\n14  AAAAAAAAJPDJBAAA           94  AAAAAAAAJPDJBAAA           59  AAAAAAAAJPDJBAAA            8\n15  AAAAAAAACONACAAA           84  AAAAAAAACONACAAA           91  AAAAAAAACONACAAA           14\n16  AAAAAAAAMLHIAAAA           75  AAAAAAAAMLHIAAAA           57  AAAAAAAAMLHIAAAA           93\n17  AAAAAAAAGKABCAAA           20  AAAAAAAAGKABCAAA           42  AAAAAAAAGKABCAAA           15\n18  AAAAAAAAKIGICAAA           92  AAAAAAAAKIGICAAA            7  AAAAAAAAKIGICAAA           62\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\nselect *\nfrom sr_items\njoin cr_items on sr_items.item_id = cr_items.item_id\njoin wr_items on sr_items.item_id = wr_items.item_id;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.127647,
                    "execution_time": 0.071884,
                    "compile_time": 0.000331,
                    "planning_time": 0.006453,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.286974,
                    "execution_time": 0.070675,
                    "compile_time": 0.104772,
                    "planning_time": 0.062718,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAANNKFCAAA          156  AAAAAAAANNKFCAAA          3.0  AAAAAAAANNKFCAAA           42\n1   AAAAAAAAFPIAAAAA            9  AAAAAAAAFPIAAAAA         51.0  AAAAAAAAFPIAAAAA           29\n2   AAAAAAAAEBOGAAAA           63  AAAAAAAAEBOGAAAA          2.0  AAAAAAAAEBOGAAAA           24\n3   AAAAAAAAADJJCAAA           53  AAAAAAAAADJJCAAA        136.0  AAAAAAAAADJJCAAA           16\n4   AAAAAAAAAJBADAAA           12  AAAAAAAAAJBADAAA         90.0  AAAAAAAAAJBADAAA            9\n5   AAAAAAAAIDHHBAAA           68  AAAAAAAAIDHHBAAA         35.0  AAAAAAAAIDHHBAAA           52\n6   AAAAAAAABHCJAAAA           15  AAAAAAAABHCJAAAA         17.0  AAAAAAAABHCJAAAA           59\n7   AAAAAAAAEPMGAAAA           70  AAAAAAAAEPMGAAAA         36.0  AAAAAAAAEPMGAAAA           53\n8   AAAAAAAADIFPAAAA            2  AAAAAAAADIFPAAAA         43.0  AAAAAAAADIFPAAAA            4\n9   AAAAAAAAMHKECAAA          107  AAAAAAAAMHKECAAA          9.0  AAAAAAAAMHKECAAA            6\n10  AAAAAAAAEADICAAA          222  AAAAAAAAEADICAAA          5.0  AAAAAAAAEADICAAA           37\n11  AAAAAAAAHPCNAAAA           95  AAAAAAAAHPCNAAAA         28.0  AAAAAAAAHPCNAAAA           52\n12  AAAAAAAAELFOAAAA           37  AAAAAAAAELFOAAAA          5.0  AAAAAAAAELFOAAAA           49\n13  AAAAAAAAGPMCCAAA           41  AAAAAAAAGPMCCAAA          2.0  AAAAAAAAGPMCCAAA            2\n14  AAAAAAAAOJFICAAA          149  AAAAAAAAOJFICAAA         86.0  AAAAAAAAOJFICAAA           24\n15  AAAAAAAAEPPMAAAA           70  AAAAAAAAEPPMAAAA         70.0  AAAAAAAAEPPMAAAA            3\n16  AAAAAAAAAAJPBAAA           24  AAAAAAAAAAJPBAAA         42.0  AAAAAAAAAAJPBAAA           52\n17  AAAAAAAAJEAGAAAA           23  AAAAAAAAJEAGAAAA        102.0  AAAAAAAAJEAGAAAA           31\n18  AAAAAAAAHEIIBAAA           30  AAAAAAAAHEIIBAAA         53.0  AAAAAAAAHEIIBAAA           54\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018407,
                    "execution_time": 0.008062,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.003952
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.128255,
                    "execution_time": 0.007946,
                    "compile_time": 0.074141,
                    "planning_time": 0.039666
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAANNKFCAAA          156  AAAAAAAANNKFCAAA          3.0  AAAAAAAANNKFCAAA           42\n1   AAAAAAAAFPIAAAAA            9  AAAAAAAAFPIAAAAA         51.0  AAAAAAAAFPIAAAAA           29\n2   AAAAAAAAEBOGAAAA           63  AAAAAAAAEBOGAAAA          2.0  AAAAAAAAEBOGAAAA           24\n3   AAAAAAAAADJJCAAA           53  AAAAAAAAADJJCAAA        136.0  AAAAAAAAADJJCAAA           16\n4   AAAAAAAAAJBADAAA           12  AAAAAAAAAJBADAAA         90.0  AAAAAAAAAJBADAAA            9\n5   AAAAAAAAIDHHBAAA           68  AAAAAAAAIDHHBAAA         35.0  AAAAAAAAIDHHBAAA           52\n6   AAAAAAAABHCJAAAA           15  AAAAAAAABHCJAAAA         17.0  AAAAAAAABHCJAAAA           59\n7   AAAAAAAAEPMGAAAA           70  AAAAAAAAEPMGAAAA         36.0  AAAAAAAAEPMGAAAA           53\n8   AAAAAAAADIFPAAAA            2  AAAAAAAADIFPAAAA         43.0  AAAAAAAADIFPAAAA            4\n9   AAAAAAAAMHKECAAA          107  AAAAAAAAMHKECAAA          9.0  AAAAAAAAMHKECAAA            6\n10  AAAAAAAAEADICAAA          222  AAAAAAAAEADICAAA          5.0  AAAAAAAAEADICAAA           37\n11  AAAAAAAAHPCNAAAA           95  AAAAAAAAHPCNAAAA         28.0  AAAAAAAAHPCNAAAA           52\n12  AAAAAAAAELFOAAAA           37  AAAAAAAAELFOAAAA          5.0  AAAAAAAAELFOAAAA           49\n13  AAAAAAAAGPMCCAAA           41  AAAAAAAAGPMCCAAA          2.0  AAAAAAAAGPMCCAAA            2\n14  AAAAAAAAOJFICAAA          149  AAAAAAAAOJFICAAA         86.0  AAAAAAAAOJFICAAA           24\n15  AAAAAAAAEPPMAAAA           70  AAAAAAAAEPPMAAAA         70.0  AAAAAAAAEPPMAAAA            3\n16  AAAAAAAAAAJPBAAA           24  AAAAAAAAAAJPBAAA         42.0  AAAAAAAAAAJPBAAA           52\n17  AAAAAAAAJEAGAAAA           23  AAAAAAAAJEAGAAAA        102.0  AAAAAAAAJEAGAAAA           31\n18  AAAAAAAAHEIIBAAA           30  AAAAAAAAHEIIBAAA         53.0  AAAAAAAAHEIIBAAA           54\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n join item on sr_item_sk = i_item_sk\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n join item on cr_item_sk = i_item_sk\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n join item on wr_item_sk = i_item_sk\n join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n/*CURSOR_IDENTIFIER*/\n group by i_item_id)\nselect sr_items.item_id, sr_item_qty, cr_item_qty, wr_item_qty\nfrom sr_items\nfull outer join cr_items on sr_items.item_id = cr_items.item_id\nfull outer join wr_items on sr_items.item_id = wr_items.item_id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" FULL JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" FULL JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.146698,
                    "execution_time": 0.051578,
                    "compile_time": 0.055584,
                    "planning_time": 0.003565,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.972153,
                    "execution_time": 0.053293,
                    "compile_time": 6.81326,
                    "planning_time": 0.060496,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAANFAABAAA           61           55           46\n1   AAAAAAAAPJPEAAAA           77           73           10\n2   AAAAAAAAKFHGBAAA           22           50           55\n3   AAAAAAAAPFGNBAAA           64           83           24\n4   AAAAAAAAGEBEBAAA           37           33            6\n5   AAAAAAAAICEECAAA           67            3           14\n6   AAAAAAAAMCPGCAAA           24           51           11\n7   AAAAAAAAOEFECAAA           77            1           18\n8   AAAAAAAAOIFCAAAA           66           59           55\n9   AAAAAAAAIPPDCAAA           12           35            5\n10  AAAAAAAACEHMAAAA          168            7           37\n11  AAAAAAAAMJJIAAAA          226           85           30\n12  AAAAAAAAEGPGBAAA           18            1            1\n13  AAAAAAAAAAEOBAAA           73            8           52\n14  AAAAAAAAMKGICAAA           26           42           13\n15  AAAAAAAAEDPOCAAA           42            7           10\n16  AAAAAAAAEBIFBAAA           18           71           13\n17  AAAAAAAANINNCAAA           66          119            8\n18  AAAAAAAAPEDECAAA           67           72           82\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031136,
                    "execution_time": 0.007646,
                    "compile_time": 0.013746,
                    "planning_time": 0.003588
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.12534,
                    "execution_time": 0.008443,
                    "compile_time": 3.067477,
                    "planning_time": 0.039021
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAANFAABAAA           61           55           46\n1   AAAAAAAAPJPEAAAA           77           73           10\n2   AAAAAAAAKFHGBAAA           22           50           55\n3   AAAAAAAAPFGNBAAA           64           83           24\n4   AAAAAAAAGEBEBAAA           37           33            6\n5   AAAAAAAAICEECAAA           67            3           14\n6   AAAAAAAAMCPGCAAA           24           51           11\n7   AAAAAAAAOEFECAAA           77            1           18\n8   AAAAAAAAOIFCAAAA           66           59           55\n9   AAAAAAAAIPPDCAAA           12           35            5\n10  AAAAAAAACEHMAAAA          168            7           37\n11  AAAAAAAAMJJIAAAA          226           85           30\n12  AAAAAAAAEGPGBAAA           18            1            1\n13  AAAAAAAAAAEOBAAA           73            8           52\n14  AAAAAAAAMKGICAAA           26           42           13\n15  AAAAAAAAEDPOCAAA           42            7           10\n16  AAAAAAAAEBIFBAAA           18           71           13\n17  AAAAAAAANINNCAAA           66          119            8\n18  AAAAAAAAPEDECAAA           67           72           82\n...*/"
    },
    {
        "input": "with /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\nselect \n    coalesce(sr_items.item_id, cr_items.item_id, wr_items.item_id) as item_id,\n    coalesce(sr_item_qty, 0) as sr_item_qty, \n    coalesce(cr_item_qty, 0) as cr_item_qty, \n    coalesce(wr_item_qty, 0) as wr_item_qty\nfrom sr_items\nfull outer join cr_items on sr_items.item_id = cr_items.item_id\nfull outer join wr_items on coalesce(sr_items.item_id, cr_items.item_id) = wr_items.item_id;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT COALESCE ( \"SR_ITEMS\".\"ITEM_ID\" , \"CR_ITEMS\".\"ITEM_ID\" , \"WR_ITEMS\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SR_ITEMS\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"CR_ITEMS\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"WR_ITEMS\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" FULL JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" FULL JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"WR_ITEMS\".\"ITEM_ID\" = COALESCE ( \"SR_ITEMS\".\"ITEM_ID\" , \"CR_ITEMS\".\"ITEM_ID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" = COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.265119,
                    "execution_time": 0.078488,
                    "compile_time": 0.054469,
                    "planning_time": 0.007716,
                    "create_size": 882
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.923975,
                    "execution_time": 0.081577,
                    "compile_time": 6.610781,
                    "planning_time": 0.101562,
                    "create_size": 882
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAHKMCAAAA           67            5            0\n1   AAAAAAAAONKABAAA          153            3           30\n2   AAAAAAAALGIBCAAA          159            0            0\n3   AAAAAAAANICDCAAA            4            0            9\n4   AAAAAAAAAKGDAAAA          129           14           91\n5   AAAAAAAAPOJNBAAA           50            0            0\n6   AAAAAAAAJPDPBAAA           75           29            0\n7   AAAAAAAAAPOHCAAA           10           32            0\n8   AAAAAAAACGDCAAAA          110           32            0\n9   AAAAAAAAAIMMAAAA           24            7            0\n10  AAAAAAAAAAMOAAAA           64            0           39\n11  AAAAAAAAKLFBBAAA           38           15            0\n12  AAAAAAAAMMNDBAAA           15           21            0\n13  AAAAAAAALDDEBAAA           51           82            0\n14  AAAAAAAAKGPGBAAA           67            0            0\n15  AAAAAAAAOPLEAAAA          120           15            0\n16  AAAAAAAAMOEIAAAA           50            0            0\n17  AAAAAAAACOHHBAAA           67            0           79\n18  AAAAAAAAKMBKBAAA           50            7           24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017757,
                    "execution_time": 0.007759,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003709
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.103818,
                    "execution_time": 0.007855,
                    "compile_time": 0.048327,
                    "planning_time": 0.038924
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" = COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAHKMCAAAA           67            5            0\n1   AAAAAAAAONKABAAA          153            3           30\n2   AAAAAAAALGIBCAAA          159            0            0\n3   AAAAAAAANICDCAAA            4            0            9\n4   AAAAAAAAAKGDAAAA          129           14           91\n5   AAAAAAAAPOJNBAAA           50            0            0\n6   AAAAAAAAJPDPBAAA           75           29            0\n7   AAAAAAAAAPOHCAAA           10           32            0\n8   AAAAAAAACGDCAAAA          110           32            0\n9   AAAAAAAAAIMMAAAA           24            7            0\n10  AAAAAAAAAAMOAAAA           64            0           39\n11  AAAAAAAAKLFBBAAA           38           15            0\n12  AAAAAAAAMMNDBAAA           15           21            0\n13  AAAAAAAALDDEBAAA           51           82            0\n14  AAAAAAAAKGPGBAAA           67            0            0\n15  AAAAAAAAOPLEAAAA          120           15            0\n16  AAAAAAAAMOEIAAAA           50            0            0\n17  AAAAAAAACOHHBAAA           67            0           79\n18  AAAAAAAAKMBKBAAA           50            7           24\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n      join item on sr_item_sk = i_item_sk\n      join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n      join item on cr_item_sk = i_item_sk\n      join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n      join item on wr_item_sk = i_item_sk\n      join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id)\nselect sr_items.item_id, sr_items.sr_item_qty, cr_items.cr_item_qty, wr_items.wr_item_qty\nfrom sr_items\nleft join cr_items on sr_items.item_id = cr_items.item_id\nleft join wr_items on sr_items.item_id = wr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" LEFT JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(coalesce(sr_item_qty, 0)+coalesce(cr_item_qty, 0)+coalesce(wr_item_qty, 0))/3.0 * 100 as sr_dev\nfrom sr_items\nleft join cr_items on sr_items.item_id = cr_items.item_id\nleft join wr_items on sr_items.item_id = wr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SR_ITEMS\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"CR_ITEMS\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"WR_ITEMS\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" LEFT JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.31809,
                    "execution_time": 0.071856,
                    "compile_time": 0.124352,
                    "planning_time": 0.007913,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.478092,
                    "execution_time": 0.088218,
                    "compile_time": 10.203243,
                    "planning_time": 0.066184,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_DEV\" AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev\n0   AAAAAAAAIJMEBAAA          165    0.00\n1   AAAAAAAAAIOLBAAA           15   33.33\n2   AAAAAAAACIBBCAAA           81    0.00\n3   AAAAAAAAIDLECAAA          108    0.00\n4   AAAAAAAAEBHPCAAA          164    0.00\n5   AAAAAAAAKJFLAAAA           86    0.00\n6   AAAAAAAAMONMBAAA          102   33.33\n7   AAAAAAAACJPNBAAA           67   33.33\n8   AAAAAAAALLNGCAAA           96    0.00\n9   AAAAAAAACLEMCAAA           12    0.00\n10  AAAAAAAAIANMCAAA           13    0.00\n11  AAAAAAAAICGDAAAA           24   33.33\n12  AAAAAAAAJCAIAAAA           62   33.33\n13  AAAAAAAACOGJAAAA           49    0.00\n14  AAAAAAAANPOHAAAA           18    0.00\n15  AAAAAAAABBJKBAAA          161    0.00\n16  AAAAAAAAJKPBCAAA           66    0.00\n17  AAAAAAAABMFBAAAA          100    0.00\n18  AAAAAAAAMCODAAAA           99    0.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.071924,
                    "execution_time": 0.007677,
                    "compile_time": 0.054757,
                    "planning_time": 0.003359
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.328211,
                    "execution_time": 0.008699,
                    "compile_time": 3.270339,
                    "planning_time": 0.038478
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_DEV\" AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev\n0   AAAAAAAAIJMEBAAA          165    0.00\n1   AAAAAAAAAIOLBAAA           15   33.33\n2   AAAAAAAACIBBCAAA           81    0.00\n3   AAAAAAAAIDLECAAA          108    0.00\n4   AAAAAAAAEBHPCAAA          164    0.00\n5   AAAAAAAAKJFLAAAA           86    0.00\n6   AAAAAAAAMONMBAAA          102   33.33\n7   AAAAAAAACJPNBAAA           67   33.33\n8   AAAAAAAALLNGCAAA           96    0.00\n9   AAAAAAAACLEMCAAA           12    0.00\n10  AAAAAAAAIANMCAAA           13    0.00\n11  AAAAAAAAICGDAAAA           24   33.33\n12  AAAAAAAAJCAIAAAA           62   33.33\n13  AAAAAAAACOGJAAAA           49    0.00\n14  AAAAAAAANPOHAAAA           18    0.00\n15  AAAAAAAABBJKBAAA          161    0.00\n16  AAAAAAAAJKPBCAAA           66    0.00\n17  AAAAAAAABMFBAAAA          100    0.00\n18  AAAAAAAAMCODAAAA           99    0.00\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_items.sr_item_qty\n       ,sr_items.sr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_items.cr_item_qty\n       ,cr_items.cr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_items.wr_item_qty\n       ,wr_items.wr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 average\n from sr_items\n      , cr_items\n      , wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081523,
                    "execution_time": 0.042874,
                    "compile_time": 0.000248,
                    "planning_time": 0.002948,
                    "create_size": 328
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.314888,
                    "execution_time": 0.041936,
                    "compile_time": 0.173689,
                    "planning_time": 0.058405,
                    "create_size": 320
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.072291,
                    "execution_time": 0.040389,
                    "compile_time": 0.000239,
                    "planning_time": 0.002895,
                    "create_size": 156
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.130588,
                    "execution_time": 0.039051,
                    "compile_time": 0.00024,
                    "planning_time": 0.058014,
                    "create_size": 160
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAFOJDAAAA          102     0.0            4     0.0           51     0.0  52.3333\n1   AAAAAAAAMKKFAAAA           11     0.0            4     0.0           51     0.0  22.0000\n2   AAAAAAAAFANABAAA           19     0.0            4     0.0           51     0.0  24.6666\n3   AAAAAAAAKMHMAAAA           83     0.0            4     0.0           51     0.0  46.0000\n4   AAAAAAAAAIAIBAAA           96     0.0            4     0.0           51     0.0  50.3333\n5   AAAAAAAAKFFDCAAA           39     0.0            4     0.0           51     0.0  31.3333\n6   AAAAAAAAOKJJCAAA           59     0.0            4     0.0           51     0.0  38.0000\n7   AAAAAAAAEIEBAAAA           89     0.0            4     0.0           51     0.0  48.0000\n8   AAAAAAAAAJCIAAAA           59     0.0            4     0.0           51     0.0  38.0000\n9   AAAAAAAAEEJLAAAA           79     0.0            4     0.0           51     0.0  44.6666\n10  AAAAAAAAENENAAAA           87     0.0            4     0.0           51     0.0  47.3333\n11  AAAAAAAAEIKJBAAA           41     0.0            4     0.0           51     0.0  32.0000\n12  AAAAAAAAFEPGBAAA          176     0.0            4     0.0           51     0.0  77.0000\n13  AAAAAAAAPPJJBAAA           34     0.0            4     0.0           51     0.0  29.6666\n14  AAAAAAAACLNLBAAA           81     0.0            4     0.0           51     0.0  45.3333\n15  AAAAAAAAKEONCAAA           51     0.0            4     0.0           51     0.0  35.3333\n16  AAAAAAAAAHMDAAAA           17     0.0            4     0.0           51     0.0  24.0000\n17  AAAAAAAACDFEAAAA           82     0.0            4     0.0           51     0.0  45.6666\n18  AAAAAAAADEJIBAAA           41     0.0            4     0.0           51     0.0  32.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.096218,
                    "execution_time": 0.025235,
                    "compile_time": 0.058349,
                    "planning_time": 0.008898
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 38.394911,
                    "execution_time": 0.025149,
                    "compile_time": 3.300638,
                    "planning_time": 35.058353
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAFOJDAAAA          102     0.0            4     0.0           51     0.0  52.3333\n1   AAAAAAAAMKKFAAAA           11     0.0            4     0.0           51     0.0  22.0000\n2   AAAAAAAAFANABAAA           19     0.0            4     0.0           51     0.0  24.6666\n3   AAAAAAAAKMHMAAAA           83     0.0            4     0.0           51     0.0  46.0000\n4   AAAAAAAAAIAIBAAA           96     0.0            4     0.0           51     0.0  50.3333\n5   AAAAAAAAKFFDCAAA           39     0.0            4     0.0           51     0.0  31.3333\n6   AAAAAAAAOKJJCAAA           59     0.0            4     0.0           51     0.0  38.0000\n7   AAAAAAAAEIEBAAAA           89     0.0            4     0.0           51     0.0  48.0000\n8   AAAAAAAAAJCIAAAA           59     0.0            4     0.0           51     0.0  38.0000\n9   AAAAAAAAEEJLAAAA           79     0.0            4     0.0           51     0.0  44.6666\n10  AAAAAAAAENENAAAA           87     0.0            4     0.0           51     0.0  47.3333\n11  AAAAAAAAEIKJBAAA           41     0.0            4     0.0           51     0.0  32.0000\n12  AAAAAAAAFEPGBAAA          176     0.0            4     0.0           51     0.0  77.0000\n13  AAAAAAAAPPJJBAAA           34     0.0            4     0.0           51     0.0  29.6666\n14  AAAAAAAACLNLBAAA           81     0.0            4     0.0           51     0.0  45.3333\n15  AAAAAAAAKEONCAAA           51     0.0            4     0.0           51     0.0  35.3333\n16  AAAAAAAAAHMDAAAA           17     0.0            4     0.0           51     0.0  24.0000\n17  AAAAAAAACDFEAAAA           82     0.0            4     0.0           51     0.0  45.6666\n18  AAAAAAAADEJIBAAA           41     0.0            4     0.0           51     0.0  32.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAIJMEBAAA          165     0.0          130     0.0           11     0.0  102.0000\n1   AAAAAAAAAIOLBAAA           15     0.0          130     0.0           11     0.0   52.0000\n2   AAAAAAAACIBBCAAA           81     0.0          130     0.0           11     0.0   74.0000\n3   AAAAAAAAIDLECAAA          108     0.0          130     0.0           11     0.0   83.0000\n4   AAAAAAAAEBHPCAAA          164     0.0          130     0.0           11     0.0  101.6666\n5   AAAAAAAAKJFLAAAA           86     0.0          130     0.0           11     0.0   75.6666\n6   AAAAAAAAMONMBAAA          102     0.0          130     0.0           11     0.0   81.0000\n7   AAAAAAAACJPNBAAA           67     0.0          130     0.0           11     0.0   69.3333\n8   AAAAAAAALLNGCAAA           96     0.0          130     0.0           11     0.0   79.0000\n9   AAAAAAAACLEMCAAA           12     0.0          130     0.0           11     0.0   51.0000\n10  AAAAAAAAIANMCAAA           13     0.0          130     0.0           11     0.0   51.3333\n11  AAAAAAAAICGDAAAA           24     0.0          130     0.0           11     0.0   55.0000\n12  AAAAAAAAJCAIAAAA           62     0.0          130     0.0           11     0.0   67.6666\n13  AAAAAAAACOGJAAAA           49     0.0          130     0.0           11     0.0   63.3333\n14  AAAAAAAANPOHAAAA           18     0.0          130     0.0           11     0.0   53.0000\n15  AAAAAAAABBJKBAAA          161     0.0          130     0.0           11     0.0  100.6666\n16  AAAAAAAAJKPBCAAA           66     0.0          130     0.0           11     0.0   69.0000\n17  AAAAAAAABMFBAAAA          100     0.0          130     0.0           11     0.0   80.3333\n18  AAAAAAAAMCODAAAA           99     0.0          130     0.0           11     0.0   80.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.042757,
                    "execution_time": 0.025517,
                    "compile_time": 0.000137,
                    "planning_time": 0.008319
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.15925,
                    "execution_time": 0.02532,
                    "compile_time": 0.121747,
                    "planning_time": 0.008519
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAIJMEBAAA          165     0.0          130     0.0           11     0.0  102.0000\n1   AAAAAAAAAIOLBAAA           15     0.0          130     0.0           11     0.0   52.0000\n2   AAAAAAAACIBBCAAA           81     0.0          130     0.0           11     0.0   74.0000\n3   AAAAAAAAIDLECAAA          108     0.0          130     0.0           11     0.0   83.0000\n4   AAAAAAAAEBHPCAAA          164     0.0          130     0.0           11     0.0  101.6666\n5   AAAAAAAAKJFLAAAA           86     0.0          130     0.0           11     0.0   75.6666\n6   AAAAAAAAMONMBAAA          102     0.0          130     0.0           11     0.0   81.0000\n7   AAAAAAAACJPNBAAA           67     0.0          130     0.0           11     0.0   69.3333\n8   AAAAAAAALLNGCAAA           96     0.0          130     0.0           11     0.0   79.0000\n9   AAAAAAAACLEMCAAA           12     0.0          130     0.0           11     0.0   51.0000\n10  AAAAAAAAIANMCAAA           13     0.0          130     0.0           11     0.0   51.3333\n11  AAAAAAAAICGDAAAA           24     0.0          130     0.0           11     0.0   55.0000\n12  AAAAAAAAJCAIAAAA           62     0.0          130     0.0           11     0.0   67.6666\n13  AAAAAAAACOGJAAAA           49     0.0          130     0.0           11     0.0   63.3333\n14  AAAAAAAANPOHAAAA           18     0.0          130     0.0           11     0.0   53.0000\n15  AAAAAAAABBJKBAAA          161     0.0          130     0.0           11     0.0  100.6666\n16  AAAAAAAAJKPBCAAA           66     0.0          130     0.0           11     0.0   69.0000\n17  AAAAAAAABMFBAAAA          100     0.0          130     0.0           11     0.0   80.3333\n18  AAAAAAAAMCODAAAA           99     0.0          130     0.0           11     0.0   80.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAGKGAAAAA           20     0.0           56     0.0            1     0.0  25.6666\n1   AAAAAAAAKBKHAAAA          127     0.0           56     0.0            1     0.0  61.3333\n2   AAAAAAAAIIJPAAAA           97     0.0           56     0.0            1     0.0  51.3333\n3   AAAAAAAAAHBDCAAA           10     0.0           56     0.0            1     0.0  22.3333\n4   AAAAAAAALGJIAAAA          123     0.0           56     0.0            1     0.0  60.0000\n5   AAAAAAAAOGFKAAAA           53     0.0           56     0.0            1     0.0  36.6666\n6   AAAAAAAABNFMAAAA           98     0.0           56     0.0            1     0.0  51.6666\n7   AAAAAAAACHJNAAAA          100     0.0           56     0.0            1     0.0  52.3333\n8   AAAAAAAAIBFPAAAA          171     0.0           56     0.0            1     0.0  76.0000\n9   AAAAAAAADBKJCAAA           67     0.0           56     0.0            1     0.0  41.3333\n10  AAAAAAAAJHOBAAAA           10     0.0           56     0.0            1     0.0  22.3333\n11  AAAAAAAABLJGBAAA          113     0.0           56     0.0            1     0.0  56.6666\n12  AAAAAAAABLCKBAAA           51     0.0           56     0.0            1     0.0  36.0000\n13  AAAAAAAAHJEJCAAA           29     0.0           56     0.0            1     0.0  28.6666\n14  AAAAAAAAKDNNCAAA          197     0.0           56     0.0            1     0.0  84.6666\n15  AAAAAAAAHMDOBAAA           15     0.0           56     0.0            1     0.0  24.0000\n16  AAAAAAAAMEFACAAA           49     0.0           56     0.0            1     0.0  35.3333\n17  AAAAAAAANKDDCAAA           95     0.0           56     0.0            1     0.0  50.6666\n18  AAAAAAAAGMPJCAAA          111     0.0           56     0.0            1     0.0  56.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043181,
                    "execution_time": 0.025147,
                    "compile_time": 0.000156,
                    "planning_time": 0.008728
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.045745,
                    "execution_time": 0.026399,
                    "compile_time": 0.000162,
                    "planning_time": 0.008565
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAGKGAAAAA           20     0.0           56     0.0            1     0.0  25.6666\n1   AAAAAAAAKBKHAAAA          127     0.0           56     0.0            1     0.0  61.3333\n2   AAAAAAAAIIJPAAAA           97     0.0           56     0.0            1     0.0  51.3333\n3   AAAAAAAAAHBDCAAA           10     0.0           56     0.0            1     0.0  22.3333\n4   AAAAAAAALGJIAAAA          123     0.0           56     0.0            1     0.0  60.0000\n5   AAAAAAAAOGFKAAAA           53     0.0           56     0.0            1     0.0  36.6666\n6   AAAAAAAABNFMAAAA           98     0.0           56     0.0            1     0.0  51.6666\n7   AAAAAAAACHJNAAAA          100     0.0           56     0.0            1     0.0  52.3333\n8   AAAAAAAAIBFPAAAA          171     0.0           56     0.0            1     0.0  76.0000\n9   AAAAAAAADBKJCAAA           67     0.0           56     0.0            1     0.0  41.3333\n10  AAAAAAAAJHOBAAAA           10     0.0           56     0.0            1     0.0  22.3333\n11  AAAAAAAABLJGBAAA          113     0.0           56     0.0            1     0.0  56.6666\n12  AAAAAAAABLCKBAAA           51     0.0           56     0.0            1     0.0  36.0000\n13  AAAAAAAAHJEJCAAA           29     0.0           56     0.0            1     0.0  28.6666\n14  AAAAAAAAKDNNCAAA          197     0.0           56     0.0            1     0.0  84.6666\n15  AAAAAAAAHMDOBAAA           15     0.0           56     0.0            1     0.0  24.0000\n16  AAAAAAAAMEFACAAA           49     0.0           56     0.0            1     0.0  35.3333\n17  AAAAAAAANKDDCAAA           95     0.0           56     0.0            1     0.0  50.6666\n18  AAAAAAAAGMPJCAAA          111     0.0           56     0.0            1     0.0  56.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAADFENAAAA           31     0.0           67     0.0          1.0     0.0  33.0000\n1   AAAAAAAADFENAAAA           31     0.0           67     0.0         12.0     0.0  36.6666\n2   AAAAAAAADFENAAAA           31     0.0           67     0.0          2.0     0.0  33.3333\n3   AAAAAAAADFENAAAA           31     NaN           67     NaN          NaN     NaN      NaN\n4   AAAAAAAADFENAAAA           31     0.0           67     0.0         13.0     0.0  37.0000\n5   AAAAAAAADFENAAAA           31     0.0           67     0.0         21.0     0.0  39.6666\n6   AAAAAAAADFENAAAA           31     0.0           67     0.0         69.0     0.0  55.6666\n7   AAAAAAAADFENAAAA           31     0.0           67     0.0         27.0     0.0  41.6666\n8   AAAAAAAADFENAAAA           31     0.0           67     0.0         49.0     0.0  49.0000\n9   AAAAAAAADFENAAAA           31     0.0           67     0.0          1.0     0.0  33.0000\n10  AAAAAAAADFENAAAA           31     0.0           67     0.0         23.0     0.0  40.3333\n11  AAAAAAAADFENAAAA           31     0.0           67     0.0          5.0     0.0  34.3333\n12  AAAAAAAADFENAAAA           31     0.0           67     0.0         55.0     0.0  51.0000\n13  AAAAAAAADFENAAAA           31     0.0           67     0.0         12.0     0.0  36.6666\n14  AAAAAAAADFENAAAA           31     0.0           67     0.0         45.0     0.0  47.6666\n15  AAAAAAAADFENAAAA           31     0.0           67     0.0         27.0     0.0  41.6666\n16  AAAAAAAADFENAAAA           31     NaN           67     NaN          NaN     NaN      NaN\n17  AAAAAAAADFENAAAA           31     0.0           67     0.0         22.0     0.0  40.0000\n18  AAAAAAAADFENAAAA           31     0.0           67     0.0         36.0     0.0  44.6666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.042534,
                    "execution_time": 0.022805,
                    "compile_time": 0.000136,
                    "planning_time": 0.009003
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.832262,
                    "execution_time": 0.024437,
                    "compile_time": 3.747023,
                    "planning_time": 0.046002
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAADFENAAAA           31     0.0           67     0.0          1.0     0.0  33.0000\n1   AAAAAAAADFENAAAA           31     0.0           67     0.0         12.0     0.0  36.6666\n2   AAAAAAAADFENAAAA           31     0.0           67     0.0          2.0     0.0  33.3333\n3   AAAAAAAADFENAAAA           31     NaN           67     NaN          NaN     NaN      NaN\n4   AAAAAAAADFENAAAA           31     0.0           67     0.0         13.0     0.0  37.0000\n5   AAAAAAAADFENAAAA           31     0.0           67     0.0         21.0     0.0  39.6666\n6   AAAAAAAADFENAAAA           31     0.0           67     0.0         69.0     0.0  55.6666\n7   AAAAAAAADFENAAAA           31     0.0           67     0.0         27.0     0.0  41.6666\n8   AAAAAAAADFENAAAA           31     0.0           67     0.0         49.0     0.0  49.0000\n9   AAAAAAAADFENAAAA           31     0.0           67     0.0          1.0     0.0  33.0000\n10  AAAAAAAADFENAAAA           31     0.0           67     0.0         23.0     0.0  40.3333\n11  AAAAAAAADFENAAAA           31     0.0           67     0.0          5.0     0.0  34.3333\n12  AAAAAAAADFENAAAA           31     0.0           67     0.0         55.0     0.0  51.0000\n13  AAAAAAAADFENAAAA           31     0.0           67     0.0         12.0     0.0  36.6666\n14  AAAAAAAADFENAAAA           31     0.0           67     0.0         45.0     0.0  47.6666\n15  AAAAAAAADFENAAAA           31     0.0           67     0.0         27.0     0.0  41.6666\n16  AAAAAAAADFENAAAA           31     NaN           67     NaN          NaN     NaN      NaN\n17  AAAAAAAADFENAAAA           31     0.0           67     0.0         22.0     0.0  40.0000\n18  AAAAAAAADFENAAAA           31     0.0           67     0.0         36.0     0.0  44.6666\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.415099,
                    "execution_time": 0.081732,
                    "compile_time": 0.264915,
                    "planning_time": 0.009793,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.286544,
                    "execution_time": 0.085761,
                    "compile_time": 13.064321,
                    "planning_time": 0.066658,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAEBHPCAAA          164     0.0           50     0.0          7.0     0.0  73.6666\n1   AAAAAAAANPOHAAAA           18     0.0            2     0.0          2.0     0.0   7.3333\n2   AAAAAAAANJBMCAAA           50     0.0            8     0.0         50.0     0.0  36.0000\n3   AAAAAAAADCINCAAA           86     0.0            8     0.0         13.0     0.0  35.6666\n4   AAAAAAAAMGKFBAAA           87     NaN           63     NaN          NaN     NaN      NaN\n5   AAAAAAAAJCHBAAAA           98     0.0          114     0.0         60.0     0.0  90.6666\n6   AAAAAAAAGBJNCAAA           76     0.0           18     0.0         12.0     0.0  35.3333\n7   AAAAAAAAICNGCAAA           50     0.0           16     0.0          6.0     0.0  24.0000\n8   AAAAAAAAGMLMCAAA            4     0.0           14     0.0         58.0     0.0  25.3333\n9   AAAAAAAAEEHCAAAA           62     0.0           13     0.0         46.0     0.0  40.3333\n10  AAAAAAAAJLNHAAAA            6     0.0           33     0.0         64.0     0.0  34.3333\n11  AAAAAAAAKLHMAAAA            1     0.0          223     0.0         18.0     0.0  80.6666\n12  AAAAAAAAIJFECAAA           60     0.0           49     0.0         12.0     0.0  40.3333\n13  AAAAAAAALMCIBAAA          150     0.0           40     0.0          2.0     0.0  64.0000\n14  AAAAAAAAGGEAAAAA            2     0.0            7     0.0         35.0     0.0  14.6666\n15  AAAAAAAAAMKLCAAA           83     0.0           21     0.0         40.0     0.0  48.0000\n16  AAAAAAAAOIODCAAA           92     0.0            5     0.0          7.0     0.0  34.6666\n17  AAAAAAAAEBIPAAAA           40     0.0           12     0.0          8.0     0.0  20.0000\n18  AAAAAAAAOALNCAAA            8     0.0           59     0.0         18.0     0.0  28.3333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032242,
                    "execution_time": 0.007828,
                    "compile_time": 0.014032,
                    "planning_time": 0.004129
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.140575,
                    "execution_time": 0.008735,
                    "compile_time": 3.082502,
                    "planning_time": 0.039965
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAEBHPCAAA          164     0.0           50     0.0          7.0     0.0  73.6666\n1   AAAAAAAANPOHAAAA           18     0.0            2     0.0          2.0     0.0   7.3333\n2   AAAAAAAANJBMCAAA           50     0.0            8     0.0         50.0     0.0  36.0000\n3   AAAAAAAADCINCAAA           86     0.0            8     0.0         13.0     0.0  35.6666\n4   AAAAAAAAMGKFBAAA           87     NaN           63     NaN          NaN     NaN      NaN\n5   AAAAAAAAJCHBAAAA           98     0.0          114     0.0         60.0     0.0  90.6666\n6   AAAAAAAAGBJNCAAA           76     0.0           18     0.0         12.0     0.0  35.3333\n7   AAAAAAAAICNGCAAA           50     0.0           16     0.0          6.0     0.0  24.0000\n8   AAAAAAAAGMLMCAAA            4     0.0           14     0.0         58.0     0.0  25.3333\n9   AAAAAAAAEEHCAAAA           62     0.0           13     0.0         46.0     0.0  40.3333\n10  AAAAAAAAJLNHAAAA            6     0.0           33     0.0         64.0     0.0  34.3333\n11  AAAAAAAAKLHMAAAA            1     0.0          223     0.0         18.0     0.0  80.6666\n12  AAAAAAAAIJFECAAA           60     0.0           49     0.0         12.0     0.0  40.3333\n13  AAAAAAAALMCIBAAA          150     0.0           40     0.0          2.0     0.0  64.0000\n14  AAAAAAAAGGEAAAAA            2     0.0            7     0.0         35.0     0.0  14.6666\n15  AAAAAAAAAMKLCAAA           83     0.0           21     0.0         40.0     0.0  48.0000\n16  AAAAAAAAOIODCAAA           92     0.0            5     0.0          7.0     0.0  34.6666\n17  AAAAAAAAEBIPAAAA           40     0.0           12     0.0          8.0     0.0  20.0000\n18  AAAAAAAAOALNCAAA            8     0.0           59     0.0         18.0     0.0  28.3333\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAGBAAA          194     0.0            9     0.0           14     0.0   72.3333\n1   AAAAAAAAAAAHAAAA           30     0.0            5     0.0           18     0.0   17.6666\n2   AAAAAAAAAAAJBAAA           30     0.0           27     0.0           12     0.0   23.0000\n3   AAAAAAAAAAAKAAAA          118     0.0            6     0.0           73     0.0   65.6666\n4   AAAAAAAAAAAOCAAA           33     0.0            4     0.0           57     0.0   31.3333\n5   AAAAAAAAAABBDAAA           46     0.0           27     0.0           60     0.0   44.3333\n6   AAAAAAAAAABGBAAA          105     0.0          184     0.0           42     0.0  110.3333\n7   AAAAAAAAAABPBAAA           23     0.0          115     0.0            5     0.0   47.6666\n8   AAAAAAAAAACCBAAA           75     0.0            5     0.0           23     0.0   34.3333\n9   AAAAAAAAAACEBAAA           30     0.0          100     0.0            7     0.0   45.6666\n10  AAAAAAAAAACLAAAA           91     0.0           55     0.0           20     0.0   55.3333\n11  AAAAAAAAAADFAAAA           58     0.0           21     0.0            4     0.0   27.6666\n12  AAAAAAAAAADFCAAA           80     0.0           52     0.0           14     0.0   48.6666\n13  AAAAAAAAAADHBAAA           33     0.0           19     0.0           60     0.0   37.3333\n14  AAAAAAAAAADIAAAA           76     0.0           53     0.0            3     0.0   44.0000\n15  AAAAAAAAAADKAAAA            9     0.0          105     0.0           23     0.0   45.6666\n16  AAAAAAAAAADLAAAA           14     0.0           62     0.0           13     0.0   29.6666\n17  AAAAAAAAAADLCAAA           75     0.0            8     0.0           45     0.0   42.6666\n18  AAAAAAAAAADMCAAA           14     0.0           81     0.0           69     0.0   54.6666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.05913,
                    "execution_time": 0.01053,
                    "compile_time": 0.037699,
                    "planning_time": 0.004403
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.982207,
                    "execution_time": 0.011448,
                    "compile_time": 4.927318,
                    "planning_time": 0.039722
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAGBAAA          194     0.0            9     0.0           14     0.0   72.3333\n1   AAAAAAAAAAAHAAAA           30     0.0            5     0.0           18     0.0   17.6666\n2   AAAAAAAAAAAJBAAA           30     0.0           27     0.0           12     0.0   23.0000\n3   AAAAAAAAAAAKAAAA          118     0.0            6     0.0           73     0.0   65.6666\n4   AAAAAAAAAAAOCAAA           33     0.0            4     0.0           57     0.0   31.3333\n5   AAAAAAAAAABBDAAA           46     0.0           27     0.0           60     0.0   44.3333\n6   AAAAAAAAAABGBAAA          105     0.0          184     0.0           42     0.0  110.3333\n7   AAAAAAAAAABPBAAA           23     0.0          115     0.0            5     0.0   47.6666\n8   AAAAAAAAAACCBAAA           75     0.0            5     0.0           23     0.0   34.3333\n9   AAAAAAAAAACEBAAA           30     0.0          100     0.0            7     0.0   45.6666\n10  AAAAAAAAAACLAAAA           91     0.0           55     0.0           20     0.0   55.3333\n11  AAAAAAAAAADFAAAA           58     0.0           21     0.0            4     0.0   27.6666\n12  AAAAAAAAAADFCAAA           80     0.0           52     0.0           14     0.0   48.6666\n13  AAAAAAAAAADHBAAA           33     0.0           19     0.0           60     0.0   37.3333\n14  AAAAAAAAAADIAAAA           76     0.0           53     0.0            3     0.0   44.0000\n15  AAAAAAAAAADKAAAA            9     0.0          105     0.0           23     0.0   45.6666\n16  AAAAAAAAAADLAAAA           14     0.0           62     0.0           13     0.0   29.6666\n17  AAAAAAAAAADLCAAA           75     0.0            8     0.0           45     0.0   42.6666\n18  AAAAAAAAAADMCAAA           14     0.0           81     0.0           69     0.0   54.6666\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n         ,sr_item_qty\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" , \"SR_ITEM_QTY\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAGBAAA          194     0.0            9     0.0           14     0.0   72.3333\n1   AAAAAAAAAAAHAAAA           30     0.0            5     0.0           18     0.0   17.6666\n2   AAAAAAAAAAAJBAAA           30     0.0           27     0.0           12     0.0   23.0000\n3   AAAAAAAAAAAKAAAA          118     0.0            6     0.0           73     0.0   65.6666\n4   AAAAAAAAAAAOCAAA           33     0.0            4     0.0           57     0.0   31.3333\n5   AAAAAAAAAABBDAAA           46     0.0           27     0.0           60     0.0   44.3333\n6   AAAAAAAAAABGBAAA          105     0.0          184     0.0           42     0.0  110.3333\n7   AAAAAAAAAABPBAAA           23     0.0          115     0.0            5     0.0   47.6666\n8   AAAAAAAAAACCBAAA           75     0.0            5     0.0           23     0.0   34.3333\n9   AAAAAAAAAACEBAAA           30     0.0          100     0.0            7     0.0   45.6666\n10  AAAAAAAAAACLAAAA           91     0.0           55     0.0           20     0.0   55.3333\n11  AAAAAAAAAADFAAAA           58     0.0           21     0.0            4     0.0   27.6666\n12  AAAAAAAAAADFCAAA           80     0.0           52     0.0           14     0.0   48.6666\n13  AAAAAAAAAADHBAAA           33     0.0           19     0.0           60     0.0   37.3333\n14  AAAAAAAAAADIAAAA           76     0.0           53     0.0            3     0.0   44.0000\n15  AAAAAAAAAADKAAAA            9     0.0          105     0.0           23     0.0   45.6666\n16  AAAAAAAAAADLAAAA           14     0.0           62     0.0           13     0.0   29.6666\n17  AAAAAAAAAADLCAAA           75     0.0            8     0.0           45     0.0   42.6666\n18  AAAAAAAAAADMCAAA           14     0.0           81     0.0           69     0.0   54.6666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038072,
                    "execution_time": 0.010723,
                    "compile_time": 0.016702,
                    "planning_time": 0.004405
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.301692,
                    "execution_time": 0.011267,
                    "compile_time": 3.250211,
                    "planning_time": 0.040311
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAGBAAA          194     0.0            9     0.0           14     0.0   72.3333\n1   AAAAAAAAAAAHAAAA           30     0.0            5     0.0           18     0.0   17.6666\n2   AAAAAAAAAAAJBAAA           30     0.0           27     0.0           12     0.0   23.0000\n3   AAAAAAAAAAAKAAAA          118     0.0            6     0.0           73     0.0   65.6666\n4   AAAAAAAAAAAOCAAA           33     0.0            4     0.0           57     0.0   31.3333\n5   AAAAAAAAAABBDAAA           46     0.0           27     0.0           60     0.0   44.3333\n6   AAAAAAAAAABGBAAA          105     0.0          184     0.0           42     0.0  110.3333\n7   AAAAAAAAAABPBAAA           23     0.0          115     0.0            5     0.0   47.6666\n8   AAAAAAAAAACCBAAA           75     0.0            5     0.0           23     0.0   34.3333\n9   AAAAAAAAAACEBAAA           30     0.0          100     0.0            7     0.0   45.6666\n10  AAAAAAAAAACLAAAA           91     0.0           55     0.0           20     0.0   55.3333\n11  AAAAAAAAAADFAAAA           58     0.0           21     0.0            4     0.0   27.6666\n12  AAAAAAAAAADFCAAA           80     0.0           52     0.0           14     0.0   48.6666\n13  AAAAAAAAAADHBAAA           33     0.0           19     0.0           60     0.0   37.3333\n14  AAAAAAAAAADIAAAA           76     0.0           53     0.0            3     0.0   44.0000\n15  AAAAAAAAAADKAAAA            9     0.0          105     0.0           23     0.0   45.6666\n16  AAAAAAAAAADLAAAA           14     0.0           62     0.0           13     0.0   29.6666\n17  AAAAAAAAAADLCAAA           75     0.0            8     0.0           45     0.0   42.6666\n18  AAAAAAAAAADMCAAA           14     0.0           81     0.0           69     0.0   54.6666\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n         ,sr_item_qty\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" , \"SR_ITEM_QTY\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAGBAAA          194     0.0            9     0.0           14     0.0   72.3333\n1   AAAAAAAAAAAHAAAA           30     0.0            5     0.0           18     0.0   17.6666\n2   AAAAAAAAAAAJBAAA           30     0.0           27     0.0           12     0.0   23.0000\n3   AAAAAAAAAAAKAAAA          118     0.0            6     0.0           73     0.0   65.6666\n4   AAAAAAAAAAAOCAAA           33     0.0            4     0.0           57     0.0   31.3333\n5   AAAAAAAAAABBDAAA           46     0.0           27     0.0           60     0.0   44.3333\n6   AAAAAAAAAABGBAAA          105     0.0          184     0.0           42     0.0  110.3333\n7   AAAAAAAAAABPBAAA           23     0.0          115     0.0            5     0.0   47.6666\n8   AAAAAAAAAACCBAAA           75     0.0            5     0.0           23     0.0   34.3333\n9   AAAAAAAAAACEBAAA           30     0.0          100     0.0            7     0.0   45.6666\n10  AAAAAAAAAACLAAAA           91     0.0           55     0.0           20     0.0   55.3333\n11  AAAAAAAAAADFAAAA           58     0.0           21     0.0            4     0.0   27.6666\n12  AAAAAAAAAADFCAAA           80     0.0           52     0.0           14     0.0   48.6666\n13  AAAAAAAAAADHBAAA           33     0.0           19     0.0           60     0.0   37.3333\n14  AAAAAAAAAADIAAAA           76     0.0           53     0.0            3     0.0   44.0000\n15  AAAAAAAAAADKAAAA            9     0.0          105     0.0           23     0.0   45.6666\n16  AAAAAAAAAADLAAAA           14     0.0           62     0.0           13     0.0   29.6666\n17  AAAAAAAAAADLCAAA           75     0.0            8     0.0           45     0.0   42.6666\n18  AAAAAAAAAADMCAAA           14     0.0           81     0.0           69     0.0   54.6666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020859,
                    "execution_time": 0.010139,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004367
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021935,
                    "execution_time": 0.010901,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004433
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev   average\n0   AAAAAAAAAAAGBAAA          194     0.0            9     0.0           14     0.0   72.3333\n1   AAAAAAAAAAAHAAAA           30     0.0            5     0.0           18     0.0   17.6666\n2   AAAAAAAAAAAJBAAA           30     0.0           27     0.0           12     0.0   23.0000\n3   AAAAAAAAAAAKAAAA          118     0.0            6     0.0           73     0.0   65.6666\n4   AAAAAAAAAAAOCAAA           33     0.0            4     0.0           57     0.0   31.3333\n5   AAAAAAAAAABBDAAA           46     0.0           27     0.0           60     0.0   44.3333\n6   AAAAAAAAAABGBAAA          105     0.0          184     0.0           42     0.0  110.3333\n7   AAAAAAAAAABPBAAA           23     0.0          115     0.0            5     0.0   47.6666\n8   AAAAAAAAAACCBAAA           75     0.0            5     0.0           23     0.0   34.3333\n9   AAAAAAAAAACEBAAA           30     0.0          100     0.0            7     0.0   45.6666\n10  AAAAAAAAAACLAAAA           91     0.0           55     0.0           20     0.0   55.3333\n11  AAAAAAAAAADFAAAA           58     0.0           21     0.0            4     0.0   27.6666\n12  AAAAAAAAAADFCAAA           80     0.0           52     0.0           14     0.0   48.6666\n13  AAAAAAAAAADHBAAA           33     0.0           19     0.0           60     0.0   37.3333\n14  AAAAAAAAAADIAAAA           76     0.0           53     0.0            3     0.0   44.0000\n15  AAAAAAAAAADKAAAA            9     0.0          105     0.0           23     0.0   45.6666\n16  AAAAAAAAAADLAAAA           14     0.0           62     0.0           13     0.0   29.6666\n17  AAAAAAAAAADLCAAA           75     0.0            8     0.0           45     0.0   42.6666\n18  AAAAAAAAAADMCAAA           14     0.0           81     0.0           69     0.0   54.6666\n...*/"
    }
]