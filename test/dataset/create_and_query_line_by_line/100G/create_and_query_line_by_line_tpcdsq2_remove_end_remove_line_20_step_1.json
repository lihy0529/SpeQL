[
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from  web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n from wswscs\n where wswscs.d_week_seq in (select distinct d_week_seq from date_dim)) wswscs1\n join \n (select wswscs.d_week_seq d_week_seq2\n        ,sum(sun_sales) sun_sales2\n        ,sum(mon_sales) mon_sales2\n        ,sum(tue_sales) tue_sales2\n        ,sum(wed_sales) wed_sales2\n        ,sum(thu_sales) thu_sales2\n        ,sum(fri_sales) fri_sales2\n        ,sum(sat_sales) sat_sales2\n from wswscs\n group by wswscs.d_week_seq) wswscs2\n on wswscs1.d_week_seq1 = wswscs2.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"WSWSCS2\" AS ( SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\" GROUP BY \"WSWSCS\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS2\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS2\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS2\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS2\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS2\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS2\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS2\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" JOIN \"WSWSCS2\" AS \"WSWSCS2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS2\".\"D_WEEK_SEQ2\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.434297,
                    "execution_time": 0.364756,
                    "compile_time": 0.00036,
                    "planning_time": 0.037473,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.217063,
                    "execution_time": 3.086319,
                    "compile_time": 0.006269,
                    "planning_time": 0.040904,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.11493,
                    "execution_time": 0.035489,
                    "compile_time": 0.031289,
                    "planning_time": 0.023115,
                    "create_size": 80
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.261115,
                    "execution_time": 0.035866,
                    "compile_time": 3.112721,
                    "planning_time": 0.085184,
                    "create_size": 80
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08824,
                    "execution_time": 0.056857,
                    "compile_time": 0.000242,
                    "planning_time": 0.005415,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.146277,
                    "execution_time": 0.058058,
                    "compile_time": 0.001337,
                    "planning_time": 0.060543,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ2\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.177487,
                    "execution_time": 0.07758,
                    "compile_time": 0.057457,
                    "planning_time": 0.011403,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.225594,
                    "execution_time": 0.07827,
                    "compile_time": 9.042128,
                    "planning_time": 0.066485,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5137     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5188     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5210     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5222     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5324     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5206     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5323     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5208     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5246     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018577,
                    "execution_time": 0.008311,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.00387
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055573,
                    "execution_time": 0.008815,
                    "compile_time": 0.000895,
                    "planning_time": 0.039207
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ2\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" IS NULL",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5137     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5188     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5210     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5222     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5324     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5206     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5323     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5208     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5246     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n        ,sum(sun_sales) over () sun_sales2\n        ,sum(mon_sales) over () mon_sales2\n        ,sum(tue_sales) over () tue_sales2\n        ,sum(wed_sales) over () wed_sales2\n        ,sum(thu_sales) over () thu_sales2\n        ,sum(fri_sales) over () fri_sales2\n        ,sum(sat_sales) over () sat_sales2\n  from wswscs) sub\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"SUB\" AS ( SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSWSCS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSWSCS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSWSCS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSWSCS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSWSCS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSWSCS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSWSCS\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\" ) SELECT \"SUB\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SUB\".\"SUN_SALES1\" / \"SUB\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SUB\".\"MON_SALES1\" / \"SUB\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SUB\".\"TUE_SALES1\" / \"SUB\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SUB\".\"WED_SALES1\" / \"SUB\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SUB\".\"THU_SALES1\" / \"SUB\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SUB\".\"FRI_SALES1\" / \"SUB\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SUB\".\"SAT_SALES1\" / \"SUB\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SUB\" AS \"SUB\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.30011,
                    "execution_time": 2.052857,
                    "compile_time": 0.000282,
                    "planning_time": 0.028878,
                    "create_size": 2432
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.291693,
                    "execution_time": 1.976007,
                    "compile_time": 0.003272,
                    "planning_time": 0.090346,
                    "create_size": 2432
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_5\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.714838,
                    "execution_time": 0.651836,
                    "compile_time": 0.000342,
                    "planning_time": 0.031418,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.781037,
                    "execution_time": 0.651135,
                    "compile_time": 0.003593,
                    "planning_time": 0.093221,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.239655,
                    "execution_time": 0.042188,
                    "compile_time": 0.159301,
                    "planning_time": 0.006834,
                    "create_size": 54
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.20336,
                    "execution_time": 0.042928,
                    "compile_time": 7.055287,
                    "planning_time": 0.064517,
                    "create_size": 54
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5162    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n1          5205    0.00    0.01    0.01    0.01    0.01    0.00    0.00\n2          5183    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n3          5228    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n4          5338    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n5          5285    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n6          5234    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n7          5161    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n8          5187    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n9          5294    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n10         5248    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n11         5181    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n12         5192    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n13         5267    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n14         5344    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n15         5291    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n16         5364    0.01    0.01    0.01    0.01    0.01    0.01    0.00\n17         5260    0.00    0.01    0.01    0.00    0.01    0.01    0.01\n18         5268    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035431,
                    "execution_time": 0.007325,
                    "compile_time": 0.015016,
                    "planning_time": 0.00579
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.11847,
                    "execution_time": 0.007819,
                    "compile_time": 3.059357,
                    "planning_time": 0.041506
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5162    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n1          5205    0.00    0.01    0.01    0.01    0.01    0.00    0.00\n2          5183    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n3          5228    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n4          5338    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n5          5285    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n6          5234    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n7          5161    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n8          5187    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n9          5294    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n10         5248    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n11         5181    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n12         5192    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n13         5267    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n14         5344    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n15         5291    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n16         5364    0.01    0.01    0.01    0.01    0.01    0.01    0.00\n17         5260    0.00    0.01    0.01    0.00    0.01    0.01    0.01\n18         5268    0.01    0.01    0.01    0.01    0.01    0.01    0.01\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n/*CURSOR_IDENTIFIER*/\n        ,sum(sun_sales) over () sun_sales2\n        ,sum(mon_sales) over () mon_sales2\n        ,sum(tue_sales) over () tue_sales2\n        ,sum(wed_sales) over () wed_sales2\n        ,sum(thu_sales) over () thu_sales2\n        ,sum(fri_sales) over () fri_sales2\n        ,sum(sat_sales) over () sat_sales2\n  from wswscs) sub",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSWSCS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSWSCS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSWSCS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSWSCS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSWSCS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSWSCS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSWSCS\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.802538,
                    "execution_time": 3.511345,
                    "compile_time": 0.00026,
                    "planning_time": 0.032041,
                    "create_size": 3456
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.470009,
                    "execution_time": 6.207413,
                    "compile_time": 0.000269,
                    "planning_time": 0.031734,
                    "create_size": 3456
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_8\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.050982,
                    "execution_time": 0.987596,
                    "compile_time": 0.000371,
                    "planning_time": 0.030659,
                    "create_size": 1243
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.119699,
                    "execution_time": 0.989199,
                    "compile_time": 0.001452,
                    "planning_time": 0.096154,
                    "create_size": 1243
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    d_week_seq1    sun_sales1    mon_sales1    tue_sales1    wed_sales1    thu_sales1    fri_sales1    sat_sales1    sun_sales2    mon_sales2    tue_sales2    wed_sales2    thu_sales2    fri_sales2    sat_sales2\n0          5166  1.765372e+08  1.732488e+08  5.973312e+08  6.035998e+08  6.023401e+08  3.181569e+08  3.753968e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n1          5292  1.740202e+08  1.734082e+08  1.760825e+08  1.716718e+08  1.763191e+08  1.718736e+08  1.747522e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n2          5215  5.994834e+08  5.986980e+08  5.995469e+08  5.971273e+08  5.984447e+08  5.994849e+08  6.014213e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n3          5218  3.776181e+08  1.755404e+08  6.035997e+08  5.923913e+08  6.024938e+08  6.008514e+08  3.136983e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n4          5237  1.743532e+08  1.727710e+08  1.740217e+08  1.738079e+08  1.747750e+08  1.728114e+08  1.751907e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n5          5359  3.949464e+08  3.950856e+08  3.960908e+08  3.969271e+08  3.944682e+08  3.938054e+08  3.917250e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n6          5120  1.715054e+08  1.756898e+08  1.729732e+08  1.743377e+08  1.750762e+08  1.728366e+08  1.735681e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n7          5213  6.006452e+08  6.018794e+08  6.020553e+08  5.977252e+08  5.987460e+08  6.021676e+08  5.969261e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n8          5274  1.773647e+08  1.742937e+08  1.741004e+08  1.760779e+08  1.726436e+08  1.721136e+08  1.717493e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n9          5170  1.780803e+08  1.693866e+08  1.736000e+08  1.724778e+08  1.709826e+08  1.745307e+08  1.736504e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n10         5151  3.947741e+08  3.963980e+08  3.931111e+08  3.967338e+08  3.951457e+08  3.930205e+08  3.949377e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n11         5193  1.709632e+08  1.733635e+08  1.709679e+08  1.754807e+08  1.757974e+08  1.727278e+08  1.746153e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n12         5259  3.951849e+08  3.953944e+08  3.942044e+08  3.910675e+08  3.938340e+08  3.973176e+08  3.922948e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n13         5318  6.014213e+08  5.997731e+08  5.952298e+08  5.920403e+08  5.984960e+08  6.015265e+08  5.969219e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n14         5126  1.713238e+08  1.738139e+08  1.730092e+08  1.752732e+08  1.705281e+08  1.735490e+08  1.732044e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n15         5319  5.979120e+08  6.023842e+08  5.870320e+08  5.973985e+08  6.057246e+08  5.977225e+08  5.955226e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n16         5160  5.982219e+08  5.978201e+08  5.983844e+08  5.944940e+08  6.008752e+08  6.047841e+08  5.987947e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.08711,
                    "execution_time": 0.011244,
                    "compile_time": 0.059471,
                    "planning_time": 0.007321
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.203548,
                    "execution_time": 0.011102,
                    "compile_time": 3.136467,
                    "planning_time": 0.04327
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    d_week_seq1    sun_sales1    mon_sales1    tue_sales1    wed_sales1    thu_sales1    fri_sales1    sat_sales1    sun_sales2    mon_sales2    tue_sales2    wed_sales2    thu_sales2    fri_sales2    sat_sales2\n0          5166  1.765372e+08  1.732488e+08  5.973312e+08  6.035998e+08  6.023401e+08  3.181569e+08  3.753968e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n1          5292  1.740202e+08  1.734082e+08  1.760825e+08  1.716718e+08  1.763191e+08  1.718736e+08  1.747522e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n2          5215  5.994834e+08  5.986980e+08  5.995469e+08  5.971273e+08  5.984447e+08  5.994849e+08  6.014213e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n3          5218  3.776181e+08  1.755404e+08  6.035997e+08  5.923913e+08  6.024938e+08  6.008514e+08  3.136983e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n4          5237  1.743532e+08  1.727710e+08  1.740217e+08  1.738079e+08  1.747750e+08  1.728114e+08  1.751907e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n5          5359  3.949464e+08  3.950856e+08  3.960908e+08  3.969271e+08  3.944682e+08  3.938054e+08  3.917250e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n6          5120  1.715054e+08  1.756898e+08  1.729732e+08  1.743377e+08  1.750762e+08  1.728366e+08  1.735681e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n7          5213  6.006452e+08  6.018794e+08  6.020553e+08  5.977252e+08  5.987460e+08  6.021676e+08  5.969261e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n8          5274  1.773647e+08  1.742937e+08  1.741004e+08  1.760779e+08  1.726436e+08  1.721136e+08  1.717493e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n9          5170  1.780803e+08  1.693866e+08  1.736000e+08  1.724778e+08  1.709826e+08  1.745307e+08  1.736504e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n10         5151  3.947741e+08  3.963980e+08  3.931111e+08  3.967338e+08  3.951457e+08  3.930205e+08  3.949377e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n11         5193  1.709632e+08  1.733635e+08  1.709679e+08  1.754807e+08  1.757974e+08  1.727278e+08  1.746153e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n12         5259  3.951849e+08  3.953944e+08  3.942044e+08  3.910675e+08  3.938340e+08  3.973176e+08  3.922948e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n13         5318  6.014213e+08  5.997731e+08  5.952298e+08  5.920403e+08  5.984960e+08  6.015265e+08  5.969219e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n14         5126  1.713238e+08  1.738139e+08  1.730092e+08  1.752732e+08  1.705281e+08  1.735490e+08  1.732044e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n15         5319  5.979120e+08  6.023842e+08  5.870320e+08  5.973985e+08  6.057246e+08  5.977225e+08  5.955226e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n16         5160  5.982219e+08  5.978201e+08  5.983844e+08  5.944940e+08  6.008752e+08  6.047841e+08  5.987947e+08  7.839769e+10  7.821635e+10  7.821469e+10  7.828756e+10  7.830526e+10  7.817399e+10  7.835856e+10\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from  web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select wswscs.d_week_seq d_week_seq1\n       ,round(sun_sales/sun_sales2,2)\n       ,round(mon_sales/mon_sales2,2)\n       ,round(tue_sales/tue_sales2,2)\n       ,round(wed_sales/wed_sales2,2)\n       ,round(thu_sales/thu_sales2,2)\n       ,round(fri_sales/fri_sales2,2)\n       ,round(sat_sales/sat_sales2,2)\n from wswscs\n -- Assuming that sun_sales2, mon_sales2, etc., are supposed to be compared against some other dataset\n join (\n     select d_week_seq as week_seq2,\n            sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales2,\n            sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales2,\n            sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales2,\n            sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales2,\n            sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales2,\n            sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales2,\n            sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales2\n      from wscs\n          ,date_dim\n      where d_date_sk = sold_date_sk\n      group by d_week_seq\n ) as other_aggregates\n on wswscs.d_week_seq = other_aggregates.week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSCS\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WSCS\" AS \"WSCS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WSCS\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"OTHER_AGGREGATES\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"WEEK_SEQ2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES2\" FROM \"WSCS\" AS \"WSCS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WSCS\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"OTHER_AGGREGATES\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"OTHER_AGGREGATES\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"OTHER_AGGREGATES\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"OTHER_AGGREGATES\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"OTHER_AGGREGATES\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"OTHER_AGGREGATES\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"OTHER_AGGREGATES\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"OTHER_AGGREGATES\" AS \"OTHER_AGGREGATES\" ON \"OTHER_AGGREGATES\".\"WEEK_SEQ2\" = \"WSWSCS\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.381065,
                    "execution_time": 1.08432,
                    "compile_time": 0.064604,
                    "planning_time": 0.024239,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.603996,
                    "execution_time": 1.249007,
                    "compile_time": 3.058451,
                    "planning_time": 0.086371,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.223908,
                    "execution_time": 0.054204,
                    "compile_time": 0.085947,
                    "planning_time": 0.023045,
                    "create_size": 576
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.460129,
                    "execution_time": 0.054177,
                    "compile_time": 6.253608,
                    "planning_time": 0.083519,
                    "create_size": 576
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.644784,
                    "execution_time": 0.448783,
                    "compile_time": 0.151032,
                    "planning_time": 0.010959,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.12934,
                    "execution_time": 8.401684,
                    "compile_time": 6.622077,
                    "planning_time": 0.067404,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"WEEK_SEQ2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.401816,
                    "execution_time": 0.359031,
                    "compile_time": 0.000363,
                    "planning_time": 0.010646,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.991187,
                    "execution_time": 0.892056,
                    "compile_time": 0.00038,
                    "planning_time": 0.06681,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"WEEK_SEQ2\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.193613,
                    "execution_time": 0.066185,
                    "compile_time": 0.092259,
                    "planning_time": 0.008098,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.169869,
                    "execution_time": 0.203886,
                    "compile_time": 6.867794,
                    "planning_time": 0.065591,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5157     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5156     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5174     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5307     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5368     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5239     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5374     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018881,
                    "execution_time": 0.008735,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003884
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054921,
                    "execution_time": 0.008542,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039346
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"WEEK_SEQ2\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5157     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5156     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5174     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5307     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5368     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5239     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5374     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2) as ratio_sun_sales\n       ,round(mon_sales1/mon_sales2,2) as ratio_mon_sales\n       ,round(tue_sales1/tue_sales2,2) as ratio_tue_sales\n       ,round(wed_sales1/wed_sales2,2) as ratio_wed_sales\n       ,round(thu_sales1/thu_sales2,2) as ratio_thu_sales\n       ,round(fri_sales1/fri_sales2,2) as ratio_fri_sales\n       ,round(sat_sales1/sat_sales2,2) as ratio_sat_sales\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq\n  ), \n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq\n )\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.087549,
                    "execution_time": 0.052466,
                    "compile_time": 0.000229,
                    "planning_time": 0.002675,
                    "create_size": 384
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.142873,
                    "execution_time": 0.049528,
                    "compile_time": 0.000251,
                    "planning_time": 0.059683,
                    "create_size": 384
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.271355,
                    "execution_time": 0.075157,
                    "compile_time": 0.127453,
                    "planning_time": 0.010972,
                    "create_size": 198
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.388335,
                    "execution_time": 0.113699,
                    "compile_time": 9.147584,
                    "planning_time": 0.069003,
                    "create_size": 198
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SUN_SALES\" AS \"RATIO_SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_MON_SALES\" AS \"RATIO_MON_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_TUE_SALES\" AS \"RATIO_TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_WED_SALES\" AS \"RATIO_WED_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_THU_SALES\" AS \"RATIO_THU_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_FRI_SALES\" AS \"RATIO_FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SAT_SALES\" AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  ratio_sun_sales  ratio_mon_sales  ratio_tue_sales  ratio_wed_sales  ratio_thu_sales  ratio_fri_sales  ratio_sat_sales\n0          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n1          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n2          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n3          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n4          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n5          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n6          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n7          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n8          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n9          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n10         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n11         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n12         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n13         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n14         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n15         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n16         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n17         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n18         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017339,
                    "execution_time": 0.007156,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004005
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055463,
                    "execution_time": 0.00806,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.039689
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SUN_SALES\" AS \"RATIO_SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_MON_SALES\" AS \"RATIO_MON_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_TUE_SALES\" AS \"RATIO_TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_WED_SALES\" AS \"RATIO_WED_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_THU_SALES\" AS \"RATIO_THU_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_FRI_SALES\" AS \"RATIO_FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SAT_SALES\" AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*    d_week_seq1  ratio_sun_sales  ratio_mon_sales  ratio_tue_sales  ratio_wed_sales  ratio_thu_sales  ratio_fri_sales  ratio_sat_sales\n0          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n1          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n2          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n3          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n4          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n5          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n6          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n7          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n8          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n9          5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n10         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n11         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n12         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n13         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n14         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n15         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n16         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n17         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n18         5130              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs\n  where wswscs.d_week_seq IS NOT NULL) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n  where wswscs.d_week_seq IS NOT NULL) x \n where y.d_week_seq1 = x.d_week_seq2\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"WSWSCS\".\"D_WEEK_SEQ\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.159851,
                    "execution_time": 0.067845,
                    "compile_time": 0.054569,
                    "planning_time": 0.009546,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.117419,
                    "execution_time": 0.243655,
                    "compile_time": 6.776284,
                    "planning_time": 0.065757,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5217     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5296     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5358     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5139     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5297     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5130     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5363     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5321     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5183     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5228     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5338     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5234     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5285     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5161     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5187     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5294     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5181     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5267     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017894,
                    "execution_time": 0.007987,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003873
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05416,
                    "execution_time": 0.008508,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.0394
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" IS NULL",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5217     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5296     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5358     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5139     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5297     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5130     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5363     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5321     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5183     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5228     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5338     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5234     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5285     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5161     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5187     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5294     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5181     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5267     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs\n  join date_dim on date_dim.d_week_seq = wswscs.d_week_seq and\n  d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n  join date_dim on date_dim.d_week_seq = wswscs.d_week_seq and\n  d_year = 2001) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001 ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.07857,
                    "execution_time": 0.031436,
                    "compile_time": 0.000229,
                    "planning_time": 0.024063,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.252568,
                    "execution_time": 0.033831,
                    "compile_time": 0.108924,
                    "planning_time": 0.085146,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.663642,
                    "execution_time": 0.155962,
                    "compile_time": 0.017229,
                    "planning_time": 0.010503,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.359617,
                    "execution_time": 0.177596,
                    "compile_time": 3.635701,
                    "planning_time": 0.065928,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n1          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n2          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n3          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n4          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n5          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n6          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n7          5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n8          5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n9          5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n10         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n11         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n12         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n13         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n14         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n15         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n16         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n17         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n18         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017845,
                    "execution_time": 0.00789,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00389
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05449,
                    "execution_time": 0.008278,
                    "compile_time": 5e-05,
                    "planning_time": 0.039656
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" CROSS JOIN UNNEST ( \"SPEQLITE_TEMP_TABLE_9\" ) AS _T0 ( \"WSWSCS_2\" ) JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n1          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n2          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n3          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n4          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n5          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n6          5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n7          5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n8          5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n9          5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n10         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n11         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n12         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n13         5297    1.01    1.03    0.97    1.00    1.00    1.03    1.00\n14         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n15         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n16         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n17         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n18         5297    0.29    0.30    0.29    0.29    0.29    0.29    0.29\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)), -- Changed 'catalog_sales' to 'web_sales'\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        date_dim.d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        date_dim.d_year = 2002) x  -- Added complete second subquery\n /*CURSOR_IDENTIFIER*/\n where d_week_seq1 = d_week_seq2\n order by d_week_seq1;",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.158539,
                    "execution_time": 0.036758,
                    "compile_time": 0.059261,
                    "planning_time": 0.036677,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.340385,
                    "execution_time": 0.036903,
                    "compile_time": 7.168597,
                    "planning_time": 0.10116,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020091,
                    "execution_time": 0.00874,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.005247
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057557,
                    "execution_time": 0.008471,
                    "compile_time": 0.001832,
                    "planning_time": 0.040745
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101444,
                    "execution_time": 0.034488,
                    "compile_time": 0.000321,
                    "planning_time": 0.038532,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.202006,
                    "execution_time": 0.034807,
                    "compile_time": 0.018442,
                    "planning_time": 0.120771,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018646,
                    "execution_time": 0.007257,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004942
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054419,
                    "execution_time": 0.007553,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040508
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim\n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\nwhere d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101299,
                    "execution_time": 0.033834,
                    "compile_time": 0.00034,
                    "planning_time": 0.038391,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.209562,
                    "execution_time": 0.032778,
                    "compile_time": 0.044251,
                    "planning_time": 0.103002,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018641,
                    "execution_time": 0.0073,
                    "compile_time": 5e-05,
                    "planning_time": 0.005069
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054274,
                    "execution_time": 0.007765,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040257
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018684,
                    "execution_time": 0.007839,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004823
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05375,
                    "execution_time": 0.007565,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039949
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01964,
                    "execution_time": 0.007918,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005138
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018833,
                    "execution_time": 0.007667,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004952
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs)\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.578528,
                    "execution_time": 0.109667,
                    "compile_time": 0.05705,
                    "planning_time": 0.031985,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.56558,
                    "execution_time": 0.137799,
                    "compile_time": 6.951387,
                    "planning_time": 0.093371,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296    1.00    1.02    0.99    1.03    1.02    0.94    1.01\n1          5296    1.06    1.06    0.96    1.01    1.02    1.03    0.99\n2          5296    1.05    1.04    0.97    0.98    1.01    0.99    1.03\n3          5296    1.04    1.05    1.04    1.01    1.04    0.99    1.04\n4          5296    1.02    1.08    1.02    0.98    1.01    1.00    1.03\n5          5296    0.30    0.30    0.28    0.29    0.29    0.29    0.29\n6          5296    1.02    1.03    1.03    0.98    1.05    1.00    1.01\n7          5296    1.07    1.01    0.99    0.97    1.00    1.00    1.04\n8          5296    0.45    0.46    0.43    0.44    0.43    0.44    0.45\n9          5296    1.02    1.05     NaN    0.98    1.04    0.96    1.01\n10         5296    0.44    0.45    0.43    0.43    0.44    0.42    0.43\n11         5296    0.29    0.30    0.29    0.29    0.30    0.29    0.29\n12         5296    1.04    1.06    0.96    0.97    0.99    0.99    0.98\n13         5296    1.04    1.07    0.97    0.97    1.00    1.02    1.01\n14         5296    1.01    1.03    1.00    0.98    1.01    1.03    1.05\n15         5296    0.47    0.45    0.44    0.43    0.45    0.43    0.44\n16         5296    1.05    1.05    1.00    0.97    1.04    1.00    1.01\n17         5296    1.03    1.02    0.96    1.00    1.03    1.02    1.00\n18         5296    0.45    0.45    1.00    0.97    1.03    0.44    0.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01797,
                    "execution_time": 0.007424,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004148
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055301,
                    "execution_time": 0.007656,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.039846
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN UNNEST ( \"SPEQLITE_TEMP_TABLE_1\" ) AS _T0 ( \"WSWSCS_2\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296    1.00    1.02    0.99    1.03    1.02    0.94    1.01\n1          5296    1.06    1.06    0.96    1.01    1.02    1.03    0.99\n2          5296    1.05    1.04    0.97    0.98    1.01    0.99    1.03\n3          5296    1.04    1.05    1.04    1.01    1.04    0.99    1.04\n4          5296    1.02    1.08    1.02    0.98    1.01    1.00    1.03\n5          5296    0.30    0.30    0.28    0.29    0.29    0.29    0.29\n6          5296    1.02    1.03    1.03    0.98    1.05    1.00    1.01\n7          5296    1.07    1.01    0.99    0.97    1.00    1.00    1.04\n8          5296    0.45    0.46    0.43    0.44    0.43    0.44    0.45\n9          5296    1.02    1.05     NaN    0.98    1.04    0.96    1.01\n10         5296    0.44    0.45    0.43    0.43    0.44    0.42    0.43\n11         5296    0.29    0.30    0.29    0.29    0.30    0.29    0.29\n12         5296    1.04    1.06    0.96    0.97    0.99    0.99    0.98\n13         5296    1.04    1.07    0.97    0.97    1.00    1.02    1.01\n14         5296    1.01    1.03    1.00    0.98    1.01    1.03    1.05\n15         5296    0.47    0.45    0.44    0.43    0.45    0.43    0.44\n16         5296    1.05    1.05    1.00    0.97    1.04    1.00    1.01\n17         5296    1.03    1.02    0.96    1.00    1.03    1.02    1.00\n18         5296    0.45    0.45    1.00    0.97    1.03    0.44    0.43\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq)/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.517723,
                    "execution_time": 0.207499,
                    "compile_time": 0.000485,
                    "planning_time": 0.035983,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.927334,
                    "execution_time": 0.229225,
                    "compile_time": 0.320394,
                    "planning_time": 0.101893,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n1          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n2          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n3          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n4          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n5          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n6          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n7          5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n8          5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n9          5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n10         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n11         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n12         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n13         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n14         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n15         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n16         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n17         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n18         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019028,
                    "execution_time": 0.008217,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004124
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056013,
                    "execution_time": 0.008173,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040023
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN UNNEST ( \"SPEQLITE_TEMP_TABLE_9\" ) AS _T0 ( \"WSWSCS_2\" ) JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n1          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n2          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n3          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n4          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n5          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n6          5274    0.45    0.33    0.44    0.45    0.43    0.44    0.44\n7          5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n8          5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n9          5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n10         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n11         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n12         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n13         5274    0.30    0.29    0.45    0.44    0.43    0.32    0.29\n14         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n15         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n16         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n17         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n18         5274    0.45    0.44    0.44    0.44    0.44    0.43    0.43\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n    d_year = 2001\n/*CURSOR_IDENTIFIER*/\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001 ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n1          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n2          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n3          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n4          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n5          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n6          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n7          5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n8          5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n9          5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n10         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n11         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n12         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n13         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n14         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n15         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n16         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n17         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n18         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017432,
                    "execution_time": 0.007659,
                    "compile_time": 5e-05,
                    "planning_time": 0.00372
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052866,
                    "execution_time": 0.007615,
                    "compile_time": 5e-05,
                    "planning_time": 0.038958
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" CROSS JOIN UNNEST ( \"SPEQLITE_TEMP_TABLE_9\" ) AS _T0 ( \"WSWSCS_2\" ) JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n1          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n2          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n3          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n4          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n5          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n6          5318    1.01    1.00    1.00    0.99    1.00    1.01    1.00\n7          5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n8          5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n9          5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n10         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n11         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n12         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n13         5318    3.51    3.48    3.35    3.39    3.46    3.54    3.49\n14         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n15         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n16         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n17         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n18         5318    0.99    1.00    1.00    0.98    1.00    1.00    1.00\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002 LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n1          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n2          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n3          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n4          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n5          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n6          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n7          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n8          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n9          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n10         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n11         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n12         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n13         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n14         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n15         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n16         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n17         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n18         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.081919,
                    "execution_time": 0.010335,
                    "compile_time": 0.033772,
                    "planning_time": 0.030859
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.19316,
                    "execution_time": 0.011001,
                    "compile_time": 3.079115,
                    "planning_time": 0.082493
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN UNNEST ( \"SPEQLITE_TEMP_TABLE_9\" ) AS _T0 ( \"WSWSCS_2\" ) JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n1          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n2          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n3          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n4          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n5          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n6          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n7          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n8          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n9          5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n10         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n11         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n12         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n13         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n14         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n15         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n16         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n17         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n18         5291    0.45    0.44    0.43    0.43    0.44    0.44    0.44\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.13574,
                    "execution_time": 0.06008,
                    "compile_time": 0.000404,
                    "planning_time": 0.038031,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.365592,
                    "execution_time": 0.061075,
                    "compile_time": 0.16601,
                    "planning_time": 0.101002,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n1          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n2          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n3          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n4          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n5          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n6          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n7          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n8          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n9          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n10         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n11         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n12         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n13         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n14         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n15         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n16         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n17         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n18         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017486,
                    "execution_time": 0.007316,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003943
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053594,
                    "execution_time": 0.007618,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039116
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n1          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n2          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n3          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n4          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n5          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n6          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n7          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n8          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n9          5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n10         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n11         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n12         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n13         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n14         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n15         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n16         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n17         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n18         5292     1.0     1.0     1.0    0.97    1.02    0.99    1.01\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n1          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n2          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n3          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n4          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n5          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n6          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n7          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n8          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n9          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n10         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n11         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n12         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n13         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n14         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n15         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n16         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n17         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n18         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020351,
                    "execution_time": 0.00943,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.004247
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05551,
                    "execution_time": 0.009034,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.040023
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n1          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n2          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n3          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n4          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n5          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n6          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n7          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n8          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n9          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n10         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n11         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n12         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n13         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n14         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n15         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n16         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n17         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n18         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n1          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n2          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n3          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n4          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n5          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n6          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n7          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n8          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n9          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n10         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n11         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n12         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n13         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n14         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n15         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n16         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n17         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n18         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01943,
                    "execution_time": 0.008787,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004201
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021233,
                    "execution_time": 0.009114,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004164
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n1          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n2          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n3          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n4          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n5          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n6          5270    3.46    1.83    1.88    1.59    3.47    3.49    3.37\n7          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n8          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n9          5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n10         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n11         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n12         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n13         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n14         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n15         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n16         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n17         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n18         5271    1.02    1.00    1.02    1.00    1.01    0.99    1.00\n...*/"
    }
]