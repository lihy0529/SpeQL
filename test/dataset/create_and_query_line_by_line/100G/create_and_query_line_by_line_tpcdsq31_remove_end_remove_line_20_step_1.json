[
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.514689,
                    "execution_time": 0.266125,
                    "compile_time": 0.079756,
                    "planning_time": 0.02155,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.908968,
                    "execution_time": 0.285105,
                    "compile_time": 3.382488,
                    "planning_time": 0.083356,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.148535,
                    "execution_time": 0.04378,
                    "compile_time": 0.031796,
                    "planning_time": 0.023455,
                    "create_size": 576
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.249226,
                    "execution_time": 0.045921,
                    "compile_time": 3.065591,
                    "planning_time": 0.083484,
                    "create_size": 576
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.413523,
                    "execution_time": 2.219811,
                    "compile_time": 0.086492,
                    "planning_time": 0.028782,
                    "create_size": 385
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.209307,
                    "execution_time": 5.41075,
                    "compile_time": 8.628979,
                    "planning_time": 0.090243,
                    "create_size": 385
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.67576,
                    "execution_time": 0.590452,
                    "compile_time": 0.000444,
                    "planning_time": 0.029622,
                    "create_size": 220
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.010021,
                    "execution_time": 1.877838,
                    "compile_time": 4.976974,
                    "planning_time": 0.096414,
                    "create_size": 220
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Amelia County    1998              0.3864                0.0393                 1.0              165.2831\n1   Amelia County    1998              0.3864                1.0797                 1.0                6.0236\n2   Amelia County    1998              0.3864                0.9625                 1.0                6.7569\n3   Amelia County    1998              0.3864                1.0251                 1.0                6.3444\n4   Amelia County    1998              0.3864                1.8429                 1.0                3.5291\n5   Amelia County    1998              0.3864                3.3106                 1.0                1.9645\n6   Amelia County    1998              0.3864                1.8351                 1.0                3.5440\n7   Amelia County    1998              0.3864                3.1143                 1.0                2.0883\n8   Amelia County    1998              0.3864                1.0596                 1.0                6.1379\n9   Amelia County    1998              0.3864                1.9617                 1.0                3.3153\n10  Amelia County    1998              0.3864                0.9554                 1.0                6.8072\n11  Amelia County    1998              0.3864                3.2401                 1.0                2.0072\n12  Amelia County    1998              0.3864                1.1425                 1.0                5.6923\n13  Amelia County    1998              0.3864                1.7416                 1.0                3.7343\n14  Amelia County    1998              0.3864                1.7497                 1.0                3.7169\n15  Amelia County    1998              0.3864                1.0000                 1.0                6.5039\n16  Amelia County    1998              0.3864                1.0880                 1.0                5.9773\n17  Amelia County    1998              0.3864                3.1112                 1.0                2.0904\n18  Amelia County    1998              0.3864                1.0531                 1.0                6.1758\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.179193,
                    "execution_time": 0.048556,
                    "compile_time": 0.114858,
                    "planning_time": 0.010958
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.270946,
                    "execution_time": 0.165342,
                    "compile_time": 6.143373,
                    "planning_time": 0.047281
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Amelia County    1998              0.3864                0.0393                 1.0              165.2831\n1   Amelia County    1998              0.3864                1.0797                 1.0                6.0236\n2   Amelia County    1998              0.3864                0.9625                 1.0                6.7569\n3   Amelia County    1998              0.3864                1.0251                 1.0                6.3444\n4   Amelia County    1998              0.3864                1.8429                 1.0                3.5291\n5   Amelia County    1998              0.3864                3.3106                 1.0                1.9645\n6   Amelia County    1998              0.3864                1.8351                 1.0                3.5440\n7   Amelia County    1998              0.3864                3.1143                 1.0                2.0883\n8   Amelia County    1998              0.3864                1.0596                 1.0                6.1379\n9   Amelia County    1998              0.3864                1.9617                 1.0                3.3153\n10  Amelia County    1998              0.3864                0.9554                 1.0                6.8072\n11  Amelia County    1998              0.3864                3.2401                 1.0                2.0072\n12  Amelia County    1998              0.3864                1.1425                 1.0                5.6923\n13  Amelia County    1998              0.3864                1.7416                 1.0                3.7343\n14  Amelia County    1998              0.3864                1.7497                 1.0                3.7169\n15  Amelia County    1998              0.3864                1.0000                 1.0                6.5039\n16  Amelia County    1998              0.3864                1.0880                 1.0                5.9773\n17  Amelia County    1998              0.3864                3.1112                 1.0                2.0904\n18  Amelia County    1998              0.3864                1.0531                 1.0                6.1758\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Amelia County    1998                 1.0                0.9625               2.454               13.1329\n1     Amelia County    1998                 1.0                1.0251               2.454               12.3310\n2     Amelia County    1998                 1.0                1.0880               2.454               11.6176\n3     Amelia County    1998                 1.0                1.1425               2.454               11.0637\n4     Amelia County    1998                 1.0                0.9554               2.454               13.2306\n5   Waushara County    1998                 1.0                0.8749               2.454               13.3452\n6   Waushara County    1998                 1.0                1.0151               2.454               11.5013\n7   Waushara County    1998                 1.0                1.1966               2.454                9.7569\n8   Waushara County    1998                 1.0                0.8917               2.454               13.0925\n9   Waushara County    1998                 1.0                1.0350               2.454               11.2802\n10   Baltimore city    1998                 1.0                0.8291               2.454               14.9788\n11   Baltimore city    1998                 1.0                1.0012               2.454               12.4049\n12   Baltimore city    1998                 1.0                1.0471               2.454               11.8612\n13   Baltimore city    1998                 1.0                0.8924               2.454               13.9167\n14   Baltimore city    1998                 1.0                0.9806               2.454               12.6660\n15   Hancock County    1998                 1.0                1.0077               2.454                1.2354\n16   Hancock County    1998                 1.0                0.9877               2.454                1.2604\n17   Hancock County    1998                 1.0                1.0059               2.454                1.2376\n18   Hancock County    1998                 1.0                1.0361               2.454                1.2016\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.109712,
                    "execution_time": 0.050643,
                    "compile_time": 0.041745,
                    "planning_time": 0.011289
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.330598,
                    "execution_time": 0.067566,
                    "compile_time": 3.223463,
                    "planning_time": 0.047414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0     Amelia County    1998                 1.0                0.9625               2.454               13.1329\n1     Amelia County    1998                 1.0                1.0251               2.454               12.3310\n2     Amelia County    1998                 1.0                1.0880               2.454               11.6176\n3     Amelia County    1998                 1.0                1.1425               2.454               11.0637\n4     Amelia County    1998                 1.0                0.9554               2.454               13.2306\n5   Waushara County    1998                 1.0                0.8749               2.454               13.3452\n6   Waushara County    1998                 1.0                1.0151               2.454               11.5013\n7   Waushara County    1998                 1.0                1.1966               2.454                9.7569\n8   Waushara County    1998                 1.0                0.8917               2.454               13.0925\n9   Waushara County    1998                 1.0                1.0350               2.454               11.2802\n10   Baltimore city    1998                 1.0                0.8291               2.454               14.9788\n11   Baltimore city    1998                 1.0                1.0012               2.454               12.4049\n12   Baltimore city    1998                 1.0                1.0471               2.454               11.8612\n13   Baltimore city    1998                 1.0                0.8924               2.454               13.9167\n14   Baltimore city    1998                 1.0                0.9806               2.454               12.6660\n15   Hancock County    1998                 1.0                1.0077               2.454                1.2354\n16   Hancock County    1998                 1.0                0.9877               2.454                1.2604\n17   Hancock County    1998                 1.0                1.0059               2.454                1.2376\n18   Hancock County    1998                 1.0                1.0361               2.454                1.2016\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0       San Juan County    1998              0.6471                0.9400              1.1749                0.8429\n1       Muskegon County    1998              0.6471                1.1523              1.1749                2.8047\n2        Lincoln County    1998              0.6471                1.0101              1.1749                0.1336\n3        Hancock County    1998              0.6471                1.0361              1.1749                0.3032\n4           Dade County    1998              0.6471                1.1062              1.1749                1.5537\n5        Greenup County    1998              0.6471                1.0561              1.1749                2.7476\n6          Milam County    1998              0.6471                1.0792              1.1749                2.7568\n7           Lyon County    1998              0.6471                0.9373              1.1749                0.6088\n8         McLean County    1998              0.6471                0.9970              1.1749                1.0427\n9        Chester County    1998              0.6471                1.0868              1.1749                0.9639\n10      Hardeman County    1998              0.6471                1.0104              1.1749                1.5153\n11          Door County    1998              0.6471                0.9267              1.1749                3.2699\n12       Clayton County    1998              0.6471                1.0827              1.1749                1.5343\n13       Haskell County    1998              0.6471                1.0559              1.1749                1.0476\n14      Delaware County    1998              0.6471                1.0410              1.1749                0.5107\n15          Rice County    1998              0.6471                1.0369              1.1749                1.5453\n16       Choctaw County    1998              0.6471                1.0937              1.1749                1.0265\n17         Macon County    1998              0.6471                1.0582              1.1749                0.4854\n18        Porter County    1998              0.6471                0.9236              1.1749                3.2810\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.127177,
                    "execution_time": 0.048255,
                    "compile_time": 0.0599,
                    "planning_time": 0.012081
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.828505,
                    "execution_time": 0.048669,
                    "compile_time": 5.716258,
                    "planning_time": 0.04861
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0       San Juan County    1998              0.6471                0.9400              1.1749                0.8429\n1       Muskegon County    1998              0.6471                1.1523              1.1749                2.8047\n2        Lincoln County    1998              0.6471                1.0101              1.1749                0.1336\n3        Hancock County    1998              0.6471                1.0361              1.1749                0.3032\n4           Dade County    1998              0.6471                1.1062              1.1749                1.5537\n5        Greenup County    1998              0.6471                1.0561              1.1749                2.7476\n6          Milam County    1998              0.6471                1.0792              1.1749                2.7568\n7           Lyon County    1998              0.6471                0.9373              1.1749                0.6088\n8         McLean County    1998              0.6471                0.9970              1.1749                1.0427\n9        Chester County    1998              0.6471                1.0868              1.1749                0.9639\n10      Hardeman County    1998              0.6471                1.0104              1.1749                1.5153\n11          Door County    1998              0.6471                0.9267              1.1749                3.2699\n12       Clayton County    1998              0.6471                1.0827              1.1749                1.5343\n13       Haskell County    1998              0.6471                1.0559              1.1749                1.0476\n14      Delaware County    1998              0.6471                1.0410              1.1749                0.5107\n15          Rice County    1998              0.6471                1.0369              1.1749                1.5453\n16       Choctaw County    1998              0.6471                1.0937              1.1749                1.0265\n17         Macon County    1998              0.6471                1.0582              1.1749                0.4854\n18        Porter County    1998              0.6471                0.9236              1.1749                3.2810\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Cumberland County    1998                 1.0                0.9588              0.7604                1.8717\n1   Cumberland County    1998                 1.0                0.9588              0.7604                1.8280\n2   Cumberland County    1998                 1.0                0.9588              0.7604                1.1171\n3   Cumberland County    1998                 1.0                0.9588              0.7604                3.0748\n4   Cumberland County    1998                 1.0                0.9588              0.7604                1.8444\n5   Cumberland County    1998                 1.0                0.9588              0.7604                3.0375\n6   Cumberland County    1998                 1.0                0.9588              0.7604                1.0356\n7   Cumberland County    1998                 1.0                0.9588              0.7604                1.0287\n8   Cumberland County    1998                 1.0                0.9588              0.7604                3.0762\n9   Cumberland County    1998                 1.0                0.9588              0.7604                1.0459\n10  Cumberland County    1998                 1.0                0.9588              0.7604                0.0758\n11  Cumberland County    1998                 1.0                0.9588              0.7604                1.0576\n12  Cumberland County    1998                 1.0                0.9588              0.7604                1.0580\n13  Cumberland County    1998                 1.0                0.9588              0.7604                1.9320\n14  Cumberland County    1998                 1.0                0.9588              0.7604                1.0428\n15  Cumberland County    1998                 1.0                0.9588              0.7604                1.0028\n16  Cumberland County    1998                 1.0                0.9588              0.7604                1.0000\n17  Cumberland County    1998                 1.0                0.9588              0.7604                3.0325\n18  Cumberland County    1998                 1.0                0.9588              0.7604                1.8360\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.096203,
                    "execution_time": 0.053068,
                    "compile_time": 0.016191,
                    "planning_time": 0.012323
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.30065,
                    "execution_time": 0.051624,
                    "compile_time": 3.188994,
                    "planning_time": 0.048858
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Cumberland County    1998                 1.0                0.9588              0.7604                1.8717\n1   Cumberland County    1998                 1.0                0.9588              0.7604                1.8280\n2   Cumberland County    1998                 1.0                0.9588              0.7604                1.1171\n3   Cumberland County    1998                 1.0                0.9588              0.7604                3.0748\n4   Cumberland County    1998                 1.0                0.9588              0.7604                1.8444\n5   Cumberland County    1998                 1.0                0.9588              0.7604                3.0375\n6   Cumberland County    1998                 1.0                0.9588              0.7604                1.0356\n7   Cumberland County    1998                 1.0                0.9588              0.7604                1.0287\n8   Cumberland County    1998                 1.0                0.9588              0.7604                3.0762\n9   Cumberland County    1998                 1.0                0.9588              0.7604                1.0459\n10  Cumberland County    1998                 1.0                0.9588              0.7604                0.0758\n11  Cumberland County    1998                 1.0                0.9588              0.7604                1.0576\n12  Cumberland County    1998                 1.0                0.9588              0.7604                1.0580\n13  Cumberland County    1998                 1.0                0.9588              0.7604                1.9320\n14  Cumberland County    1998                 1.0                0.9588              0.7604                1.0428\n15  Cumberland County    1998                 1.0                0.9588              0.7604                1.0028\n16  Cumberland County    1998                 1.0                0.9588              0.7604                1.0000\n17  Cumberland County    1998                 1.0                0.9588              0.7604                3.0325\n18  Cumberland County    1998                 1.0                0.9588              0.7604                1.8360\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Denton County    1998              0.9482                1.1119              1.0545                1.7641\n1        Denton County    1998              0.9482                1.1119              1.0545                1.7112\n2        Denton County    1998              0.9482                1.1119              1.0545                1.9107\n3        Denton County    1998              0.9482                1.1119              1.0545                1.8933\n4        Denton County    1998              0.9482                1.1119              1.0545                1.9187\n5   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3261\n6   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3644\n7   Grand Forks County    1998              0.9482                0.8369              1.0545                2.4276\n8   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3378\n9   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3068\n10         Wise County    1998              0.9482                1.0969              1.0545                1.9167\n11         Wise County    1998              0.9482                1.0969              1.0545                1.8261\n12         Wise County    1998              0.9482                1.0969              1.0545                1.8742\n13         Wise County    1998              0.9482                1.0969              1.0545                1.9203\n14         Wise County    1998              0.9482                1.0969              1.0545                1.9355\n15    Ochiltree County    1998              0.9482                1.0190              1.0545                1.7832\n16    Ochiltree County    1998              0.9482                1.0190              1.0545                1.8347\n17    Ochiltree County    1998              0.9482                1.0190              1.0545                1.6056\n18    Ochiltree County    1998              0.9482                1.0190              1.0545                1.9806\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.076384,
                    "execution_time": 0.04855,
                    "compile_time": 0.000317,
                    "planning_time": 0.013018
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.207045,
                    "execution_time": 0.048751,
                    "compile_time": 0.081608,
                    "planning_time": 0.049577
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Denton County    1998              0.9482                1.1119              1.0545                1.7641\n1        Denton County    1998              0.9482                1.1119              1.0545                1.7112\n2        Denton County    1998              0.9482                1.1119              1.0545                1.9107\n3        Denton County    1998              0.9482                1.1119              1.0545                1.8933\n4        Denton County    1998              0.9482                1.1119              1.0545                1.9187\n5   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3261\n6   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3644\n7   Grand Forks County    1998              0.9482                0.8369              1.0545                2.4276\n8   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3378\n9   Grand Forks County    1998              0.9482                0.8369              1.0545                2.3068\n10         Wise County    1998              0.9482                1.0969              1.0545                1.9167\n11         Wise County    1998              0.9482                1.0969              1.0545                1.8261\n12         Wise County    1998              0.9482                1.0969              1.0545                1.8742\n13         Wise County    1998              0.9482                1.0969              1.0545                1.9203\n14         Wise County    1998              0.9482                1.0969              1.0545                1.9355\n15    Ochiltree County    1998              0.9482                1.0190              1.0545                1.7832\n16    Ochiltree County    1998              0.9482                1.0190              1.0545                1.8347\n17    Ochiltree County    1998              0.9482                1.0190              1.0545                1.6056\n18    Ochiltree County    1998              0.9482                1.0190              1.0545                1.9806\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Scotts Bluff County    1998              1.1749                1.1076                 1.0                1.8243\n1                Butts County    1998              1.1749                0.8654                 1.0                1.9576\n2              Decatur County    1998              1.1749                1.0295                 1.0                1.8289\n3         Tallahatchie County    1998              1.1749                1.0632                 1.0                1.5902\n4   Yukon-Koyukuk Census Area    1998              1.1749                1.0786                 1.0                1.8968\n5               Tippah County    1998              1.1749                1.0657                 1.0                2.0110\n6              Baltimore city    1998              1.1749                0.8924                 1.0                2.2954\n7              Wasatch County    1998              1.1749                0.9408                 1.0                1.8672\n8          Mecklenburg County    1998              1.1749                0.9748                 1.0                1.6583\n9             Lipscomb County    1998              1.1749                1.0256                 1.0                1.8680\n10                Coal County    1998              1.1749                1.0371                 1.0                1.7883\n11            Crockett County    1998              1.1749                1.0700                 1.0                1.8828\n12              Miller County    1998              1.1749                1.1063                 1.0                1.9242\n13             Beckham County    1998              1.1749                1.0295                 1.0                1.7494\n14               Troup County    1998              1.1749                0.8110                 1.0                1.9360\n15              Murray County    1998              1.1749                1.1521                 1.0                1.7470\n16                Dale County    1998              1.1749                0.8358                 1.0                2.1290\n17              Tulare County    1998              1.1749                1.0779                 1.0                1.8828\n18         Northampton County    1998              1.1749                0.9915                 1.0                1.9768\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.17494,
                    "execution_time": 0.050496,
                    "compile_time": 0.10194,
                    "planning_time": 0.014012
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.683933,
                    "execution_time": 0.050385,
                    "compile_time": 6.570365,
                    "planning_time": 0.050157
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Scotts Bluff County    1998              1.1749                1.1076                 1.0                1.8243\n1                Butts County    1998              1.1749                0.8654                 1.0                1.9576\n2              Decatur County    1998              1.1749                1.0295                 1.0                1.8289\n3         Tallahatchie County    1998              1.1749                1.0632                 1.0                1.5902\n4   Yukon-Koyukuk Census Area    1998              1.1749                1.0786                 1.0                1.8968\n5               Tippah County    1998              1.1749                1.0657                 1.0                2.0110\n6              Baltimore city    1998              1.1749                0.8924                 1.0                2.2954\n7              Wasatch County    1998              1.1749                0.9408                 1.0                1.8672\n8          Mecklenburg County    1998              1.1749                0.9748                 1.0                1.6583\n9             Lipscomb County    1998              1.1749                1.0256                 1.0                1.8680\n10                Coal County    1998              1.1749                1.0371                 1.0                1.7883\n11            Crockett County    1998              1.1749                1.0700                 1.0                1.8828\n12              Miller County    1998              1.1749                1.1063                 1.0                1.9242\n13             Beckham County    1998              1.1749                1.0295                 1.0                1.7494\n14               Troup County    1998              1.1749                0.8110                 1.0                1.9360\n15              Murray County    1998              1.1749                1.1521                 1.0                1.7470\n16                Dale County    1998              1.1749                0.8358                 1.0                2.1290\n17              Tulare County    1998              1.1749                1.0779                 1.0                1.8828\n18         Northampton County    1998              1.1749                0.9915                 1.0                1.9768\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.739647,
                    "execution_time": 0.602903,
                    "compile_time": 0.036592,
                    "planning_time": 0.030165,
                    "create_size": 275
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.424515,
                    "execution_time": 0.744904,
                    "compile_time": 3.514642,
                    "planning_time": 0.092318,
                    "create_size": 275
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Scotts Bluff County    1998              1.0100                1.1076              1.4448                1.8243\n1   Scotts Bluff County    1998              0.4657                1.1076              1.4448                1.8243\n2   Scotts Bluff County    1998              0.8331                1.1076              1.4448                1.8243\n3   Scotts Bluff County    1998              0.8379                1.1076              1.4448                1.8243\n4   Scotts Bluff County    1998              0.3571                1.1076              1.4448                1.8243\n5   Scotts Bluff County    1998              0.4604                1.1076              1.4448                1.8243\n6   Scotts Bluff County    1998             16.7577                1.1076              1.4448                1.8243\n7   Scotts Bluff County    1998              0.3344                1.1076              1.4448                1.8243\n8   Scotts Bluff County    1998              0.8662                1.1076              1.4448                1.8243\n9   Scotts Bluff County    1998              0.4750                1.1076              1.4448                1.8243\n10  Scotts Bluff County    1998              0.9248                1.1076              1.4448                1.8243\n11  Scotts Bluff County    1998              0.2602                1.1076              1.4448                1.8243\n12  Scotts Bluff County    1998              1.1130                1.1076              1.4448                1.8243\n13  Scotts Bluff County    1998              0.5001                1.1076              1.4448                1.8243\n14  Scotts Bluff County    1998              0.7364                1.1076              1.4448                1.8243\n15  Scotts Bluff County    1998              0.3160                1.1076              1.4448                1.8243\n16  Scotts Bluff County    1998              0.7982                1.1076              1.4448                1.8243\n17  Scotts Bluff County    1998              0.5589                1.1076              1.4448                1.8243\n18  Scotts Bluff County    1998              0.8469                1.1076              1.4448                1.8243\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.151193,
                    "execution_time": 0.050326,
                    "compile_time": 0.077311,
                    "planning_time": 0.015008
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.321242,
                    "execution_time": 0.051608,
                    "compile_time": 6.194261,
                    "planning_time": 0.051468
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Scotts Bluff County    1998              1.0100                1.1076              1.4448                1.8243\n1   Scotts Bluff County    1998              0.4657                1.1076              1.4448                1.8243\n2   Scotts Bluff County    1998              0.8331                1.1076              1.4448                1.8243\n3   Scotts Bluff County    1998              0.8379                1.1076              1.4448                1.8243\n4   Scotts Bluff County    1998              0.3571                1.1076              1.4448                1.8243\n5   Scotts Bluff County    1998              0.4604                1.1076              1.4448                1.8243\n6   Scotts Bluff County    1998             16.7577                1.1076              1.4448                1.8243\n7   Scotts Bluff County    1998              0.3344                1.1076              1.4448                1.8243\n8   Scotts Bluff County    1998              0.8662                1.1076              1.4448                1.8243\n9   Scotts Bluff County    1998              0.4750                1.1076              1.4448                1.8243\n10  Scotts Bluff County    1998              0.9248                1.1076              1.4448                1.8243\n11  Scotts Bluff County    1998              0.2602                1.1076              1.4448                1.8243\n12  Scotts Bluff County    1998              1.1130                1.1076              1.4448                1.8243\n13  Scotts Bluff County    1998              0.5001                1.1076              1.4448                1.8243\n14  Scotts Bluff County    1998              0.7364                1.1076              1.4448                1.8243\n15  Scotts Bluff County    1998              0.3160                1.1076              1.4448                1.8243\n16  Scotts Bluff County    1998              0.7982                1.1076              1.4448                1.8243\n17  Scotts Bluff County    1998              0.5589                1.1076              1.4448                1.8243\n18  Scotts Bluff County    1998              0.8469                1.1076              1.4448                1.8243\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.777903,
                    "execution_time": 0.591337,
                    "compile_time": 0.085206,
                    "planning_time": 0.028426,
                    "create_size": 330
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.198603,
                    "execution_time": 0.621134,
                    "compile_time": 6.406747,
                    "planning_time": 0.093826,
                    "create_size": 330
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Denton County    1998             26.7900                1.1119                 1.0                1.8933\n1        Denton County    1998              3.2341                1.1119                 1.0                1.8933\n2        Denton County    1998              3.0358                1.1119                 1.0                1.8933\n3        Denton County    1998              4.2973                1.1119                 1.0                1.8933\n4        Denton County    1998              3.2073                1.1119                 1.0                1.8933\n5        Denton County    1998              2.8305                1.1119                 1.0                1.8933\n6   Grand Forks County    1998             85.9393                0.8369                 1.0                2.4276\n7   Grand Forks County    1998              2.2628                0.8369                 1.0                2.4276\n8   Grand Forks County    1998              2.5577                0.8369                 1.0                2.4276\n9   Grand Forks County    1998              2.4342                0.8369                 1.0                2.4276\n10  Grand Forks County    1998              2.3971                0.8369                 1.0                2.4276\n11  Grand Forks County    1998              2.8660                0.8369                 1.0                2.4276\n12         Wise County    1998             10.1506                1.0969                 1.0                1.9203\n13         Wise County    1998              1.1891                1.0969                 1.0                1.9203\n14         Wise County    1998              1.5832                1.0969                 1.0                1.9203\n15         Wise County    1998              1.2739                1.0969                 1.0                1.9203\n16         Wise County    1998              1.1971                1.0969                 1.0                1.9203\n17         Wise County    1998              1.3271                1.0969                 1.0                1.9203\n18    Ochiltree County    1998              2.8208                1.0190                 1.0                1.7832\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.16511,
                    "execution_time": 0.049996,
                    "compile_time": 0.08277,
                    "planning_time": 0.016143
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.805511,
                    "execution_time": 0.053428,
                    "compile_time": 6.69161,
                    "planning_time": 0.052757
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Denton County    1998             26.7900                1.1119                 1.0                1.8933\n1        Denton County    1998              3.2341                1.1119                 1.0                1.8933\n2        Denton County    1998              3.0358                1.1119                 1.0                1.8933\n3        Denton County    1998              4.2973                1.1119                 1.0                1.8933\n4        Denton County    1998              3.2073                1.1119                 1.0                1.8933\n5        Denton County    1998              2.8305                1.1119                 1.0                1.8933\n6   Grand Forks County    1998             85.9393                0.8369                 1.0                2.4276\n7   Grand Forks County    1998              2.2628                0.8369                 1.0                2.4276\n8   Grand Forks County    1998              2.5577                0.8369                 1.0                2.4276\n9   Grand Forks County    1998              2.4342                0.8369                 1.0                2.4276\n10  Grand Forks County    1998              2.3971                0.8369                 1.0                2.4276\n11  Grand Forks County    1998              2.8660                0.8369                 1.0                2.4276\n12         Wise County    1998             10.1506                1.0969                 1.0                1.9203\n13         Wise County    1998              1.1891                1.0969                 1.0                1.9203\n14         Wise County    1998              1.5832                1.0969                 1.0                1.9203\n15         Wise County    1998              1.2739                1.0969                 1.0                1.9203\n16         Wise County    1998              1.1971                1.0969                 1.0                1.9203\n17         Wise County    1998              1.3271                1.0969                 1.0                1.9203\n18    Ochiltree County    1998              2.8208                1.0190                 1.0                1.7832\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.710063,
                    "execution_time": 0.603416,
                    "compile_time": 0.000429,
                    "planning_time": 0.028788,
                    "create_size": 385
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.800761,
                    "execution_time": 0.629753,
                    "compile_time": 0.000421,
                    "planning_time": 0.09183,
                    "create_size": 385
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   El Paso County    1998               1.124                1.0133              0.7457                1.7105\n1   El Paso County    1998               1.124                1.0133              0.4523                1.7105\n2   El Paso County    1998               1.124                1.0133              6.8555                1.7105\n3   El Paso County    1998               1.124                1.0133              0.8240                1.7105\n4   El Paso County    1998               1.124                1.0133              2.6981                1.7105\n5   El Paso County    1998               1.124                1.0133              1.4634                1.7105\n6   El Paso County    1998               1.124                1.0133              6.9487                1.7105\n7   El Paso County    1998               1.124                1.0133              0.7922                1.7105\n8   El Paso County    1998               1.124                1.0133              0.3198                1.7105\n9   El Paso County    1998               1.124                1.0133              0.6600                1.7105\n10  El Paso County    1998               1.124                1.0133              0.4455                1.7105\n11  El Paso County    1998               1.124                1.0133              1.1474                1.7105\n12  El Paso County    1998               1.124                1.0133              0.8532                1.7105\n13  El Paso County    1998               1.124                1.0133              1.1607                1.7105\n14  El Paso County    1998               1.124                1.0133              0.4346                1.7105\n15  El Paso County    1998               1.124                1.0133              0.3303                1.7105\n16  El Paso County    1998               1.124                1.0133              0.4204                1.7105\n17  El Paso County    1998               1.124                1.0133              1.3817                1.7105\n18  El Paso County    1998               1.124                1.0133              0.9582                1.7105\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.101213,
                    "execution_time": 0.061821,
                    "compile_time": 0.000522,
                    "planning_time": 0.018302
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.325054,
                    "execution_time": 0.065861,
                    "compile_time": 7.189852,
                    "planning_time": 0.055156
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   El Paso County    1998               1.124                1.0133              0.7457                1.7105\n1   El Paso County    1998               1.124                1.0133              0.4523                1.7105\n2   El Paso County    1998               1.124                1.0133              6.8555                1.7105\n3   El Paso County    1998               1.124                1.0133              0.8240                1.7105\n4   El Paso County    1998               1.124                1.0133              2.6981                1.7105\n5   El Paso County    1998               1.124                1.0133              1.4634                1.7105\n6   El Paso County    1998               1.124                1.0133              6.9487                1.7105\n7   El Paso County    1998               1.124                1.0133              0.7922                1.7105\n8   El Paso County    1998               1.124                1.0133              0.3198                1.7105\n9   El Paso County    1998               1.124                1.0133              0.6600                1.7105\n10  El Paso County    1998               1.124                1.0133              0.4455                1.7105\n11  El Paso County    1998               1.124                1.0133              1.1474                1.7105\n12  El Paso County    1998               1.124                1.0133              0.8532                1.7105\n13  El Paso County    1998               1.124                1.0133              1.1607                1.7105\n14  El Paso County    1998               1.124                1.0133              0.4346                1.7105\n15  El Paso County    1998               1.124                1.0133              0.3303                1.7105\n16  El Paso County    1998               1.124                1.0133              0.4204                1.7105\n17  El Paso County    1998               1.124                1.0133              1.3817                1.7105\n18  El Paso County    1998               1.124                1.0133              0.9582                1.7105\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0      Renville County    1998              1.0899                0.9655              0.3528                2.0562\n1          King County    1998              0.9234                1.0388              0.4413                1.7141\n2   Sweet Grass County    1998              0.7345                1.1552              0.7792                1.7542\n3         Cecil County    1998              0.6512                1.0674              1.4488                1.6388\n4        Traill County    1998              1.0823                1.1548              0.8984                1.7186\n5         Tripp County    1998              1.0385                0.9049              0.8959                1.9498\n6   Southampton County    1998              0.9492                1.0053              0.8672                2.1208\n7       Bolivar County    1998              1.1833                0.9380              0.8611                2.1143\n8         Dewey County    1998              1.0821                0.9433              0.3524                1.9356\n9         Fairfax city    1998              1.0761                0.9213              0.8662                2.0229\n10        Vance County    1998              0.7024                0.9162              1.2154                2.1131\n11    Currituck County    1998              0.8928                1.1984              0.9308                1.8002\n12    Culberson County    1998              0.7615                0.9655              1.1511                1.8935\n13       Sitka Borough    1998              0.6849                0.8516              1.0470                1.9803\n14        Ferry County    1998              0.9111                0.9509              0.7117                1.6232\n15        Modoc County    1998              0.8460                0.9702              1.1604                1.7929\n16    Abbeville County    1998              1.1542                0.8096              1.1717                1.8518\n17       Potter County    1998              1.1726                1.0060              0.2645                1.8767\n18    Charlotte County    1998              1.1744                1.0670              0.3891                1.7358\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.096745,
                    "execution_time": 0.058105,
                    "compile_time": 0.000481,
                    "planning_time": 0.019102
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.819646,
                    "execution_time": 0.059052,
                    "compile_time": 6.683063,
                    "planning_time": 0.056095
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0      Renville County    1998              1.0899                0.9655              0.3528                2.0562\n1          King County    1998              0.9234                1.0388              0.4413                1.7141\n2   Sweet Grass County    1998              0.7345                1.1552              0.7792                1.7542\n3         Cecil County    1998              0.6512                1.0674              1.4488                1.6388\n4        Traill County    1998              1.0823                1.1548              0.8984                1.7186\n5         Tripp County    1998              1.0385                0.9049              0.8959                1.9498\n6   Southampton County    1998              0.9492                1.0053              0.8672                2.1208\n7       Bolivar County    1998              1.1833                0.9380              0.8611                2.1143\n8         Dewey County    1998              1.0821                0.9433              0.3524                1.9356\n9         Fairfax city    1998              1.0761                0.9213              0.8662                2.0229\n10        Vance County    1998              0.7024                0.9162              1.2154                2.1131\n11    Currituck County    1998              0.8928                1.1984              0.9308                1.8002\n12    Culberson County    1998              0.7615                0.9655              1.1511                1.8935\n13       Sitka Borough    1998              0.6849                0.8516              1.0470                1.9803\n14        Ferry County    1998              0.9111                0.9509              0.7117                1.6232\n15        Modoc County    1998              0.8460                0.9702              1.1604                1.7929\n16    Abbeville County    1998              1.1542                0.8096              1.1717                1.8518\n17       Potter County    1998              1.1726                1.0060              0.2645                1.8767\n18    Charlotte County    1998              1.1744                1.0670              0.3891                1.7358\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.73371,
                    "execution_time": 3.924014,
                    "compile_time": 0.096577,
                    "planning_time": 0.0209,
                    "create_size": 6912
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 18.854877,
                    "execution_time": 7.613954,
                    "compile_time": 10.458488,
                    "planning_time": 0.082459,
                    "create_size": 6912
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Jefferson Davis County    1998              1.1973                1.0882              0.7965                2.0960\n1             Bowie County    1998              0.7162                0.9392              1.0144                1.9772\n2            Austin County    1998              1.7020                1.0694              0.5901                2.0011\n3           Goodhue County    1998              0.8247                0.9078              0.9310                1.7683\n4              Hood County    1998              0.9216                1.1974              0.7698                1.8075\n5         Val Verde County    1998              1.0814                0.9958              0.8238                1.7319\n6            Teller County    1998              0.9826                1.0869              0.9235                1.7286\n7          Shoshone County    1998              0.7257                0.7967              0.8779                2.4620\n8           Stanley County    1998              0.7331                1.1558              0.9924                1.8069\n9          Saguache County    1998              1.2062                0.9812              0.6090                1.7180\n10     Bristol Bay Borough    1998              1.0312                0.9930              0.6587                1.8116\n11           Phelps County    1998              0.9575                0.8989              0.3983                2.1378\n12         Campbell County    1998              0.8751                1.0446              0.1793                1.8820\n13           Ransom County    1998              0.7683                1.1462              1.1645                1.7110\n14           Andrew County    1998              1.1662                1.1195              0.7807                1.8731\n15             Gila County    1998              0.9129                0.9989              0.8577                1.6401\n16        Crow Wing County    1998              0.8564                0.9721              0.9411                1.9135\n17         Hamilton County    1998              0.9610                1.0081              0.0830                1.8017\n18           Harvey County    1998              0.9060                0.9877              0.6584                1.9202\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.056151,
                    "execution_time": 0.008332,
                    "compile_time": 0.037718,
                    "planning_time": 0.003785
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.144779,
                    "execution_time": 0.008413,
                    "compile_time": 3.08776,
                    "planning_time": 0.03923
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Jefferson Davis County    1998              1.1973                1.0882              0.7965                2.0960\n1             Bowie County    1998              0.7162                0.9392              1.0144                1.9772\n2            Austin County    1998              1.7020                1.0694              0.5901                2.0011\n3           Goodhue County    1998              0.8247                0.9078              0.9310                1.7683\n4              Hood County    1998              0.9216                1.1974              0.7698                1.8075\n5         Val Verde County    1998              1.0814                0.9958              0.8238                1.7319\n6            Teller County    1998              0.9826                1.0869              0.9235                1.7286\n7          Shoshone County    1998              0.7257                0.7967              0.8779                2.4620\n8           Stanley County    1998              0.7331                1.1558              0.9924                1.8069\n9          Saguache County    1998              1.2062                0.9812              0.6090                1.7180\n10     Bristol Bay Borough    1998              1.0312                0.9930              0.6587                1.8116\n11           Phelps County    1998              0.9575                0.8989              0.3983                2.1378\n12         Campbell County    1998              0.8751                1.0446              0.1793                1.8820\n13           Ransom County    1998              0.7683                1.1462              1.1645                1.7110\n14           Andrew County    1998              1.1662                1.1195              0.7807                1.8731\n15             Gila County    1998              0.9129                0.9989              0.8577                1.6401\n16        Crow Wing County    1998              0.8564                0.9721              0.9411                1.9135\n17         Hamilton County    1998              0.9610                1.0081              0.0830                1.8017\n18           Harvey County    1998              0.9060                0.9877              0.6584                1.9202\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.470045,
                    "execution_time": 0.100857,
                    "compile_time": 0.213452,
                    "planning_time": 0.026742,
                    "create_size": 468
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.261733,
                    "execution_time": 0.110983,
                    "compile_time": 12.940095,
                    "planning_time": 0.08274,
                    "create_size": 495
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*               ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n1           Henry County    1998              0.9918                0.9759                 1.0                1.8763\n2       Sagadahoc County    1998              1.1036                1.0323                 1.0                1.8260\n3      Rockbridge County    1998              0.8794                1.0190                 1.0                1.8844\n4       Limestone County    1998              0.7703                1.0174                 1.0                1.8878\n5          Graham County    1998              0.9633                0.9618                 1.0                2.1149\n6        Campbell County    1998              0.8751                1.0446                 1.0                1.8820\n7           Logan County    1998              0.9960                0.9806                 1.0                1.8902\n8          Blanco County    1998              1.1382                1.0852                 1.0                1.6979\n9          Placer County    1998              0.6820                1.1816                 1.0                1.9371\n10        Kendall County    1998              1.1968                1.0141                 1.0                1.6853\n11          Cedar County    1998              1.1975                0.9899                 1.0                1.9844\n12           Gulf County    1998              0.8668                0.9458                 1.0                2.0013\n13       La Salle Parish    1998              0.9812                1.1307                 1.0                1.9485\n14    Buena Vista County    1998              1.4169                1.1613                 1.0                1.6727\n15          Gregg County    1998              1.3913                0.9412                 1.0                1.8482\n16         Nelson County    1998              1.0903                1.0621                 1.0                1.8430\n17       Eastland County    1998              1.5970                1.0699                 1.0                1.7215\n18        Garrett County    1998              1.1575                1.0085                 1.0                1.7048\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017694,
                    "execution_time": 0.007932,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003676
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.081583,
                    "execution_time": 0.007708,
                    "compile_time": 0.026795,
                    "planning_time": 0.039354
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*               ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n1           Henry County    1998              0.9918                0.9759                 1.0                1.8763\n2       Sagadahoc County    1998              1.1036                1.0323                 1.0                1.8260\n3      Rockbridge County    1998              0.8794                1.0190                 1.0                1.8844\n4       Limestone County    1998              0.7703                1.0174                 1.0                1.8878\n5          Graham County    1998              0.9633                0.9618                 1.0                2.1149\n6        Campbell County    1998              0.8751                1.0446                 1.0                1.8820\n7           Logan County    1998              0.9960                0.9806                 1.0                1.8902\n8          Blanco County    1998              1.1382                1.0852                 1.0                1.6979\n9          Placer County    1998              0.6820                1.1816                 1.0                1.9371\n10        Kendall County    1998              1.1968                1.0141                 1.0                1.6853\n11          Cedar County    1998              1.1975                0.9899                 1.0                1.9844\n12           Gulf County    1998              0.8668                0.9458                 1.0                2.0013\n13       La Salle Parish    1998              0.9812                1.1307                 1.0                1.9485\n14    Buena Vista County    1998              1.4169                1.1613                 1.0                1.6727\n15          Gregg County    1998              1.3913                0.9412                 1.0                1.8482\n16         Nelson County    1998              1.0903                1.0621                 1.0                1.8430\n17       Eastland County    1998              1.5970                1.0699                 1.0                1.7215\n18        Garrett County    1998              1.1575                1.0085                 1.0                1.7048\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3 LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n1   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n2   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n3   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n4   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n5   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n6   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n7   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n8   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n9   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n10  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n11  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n12  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n13  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n14  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n15  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n16  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n17  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n18  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.063773,
                    "execution_time": 0.015545,
                    "compile_time": 0.041349,
                    "planning_time": 0.005623
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.190638,
                    "execution_time": 0.015671,
                    "compile_time": 3.116153,
                    "planning_time": 0.040906
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3"
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n1   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n2   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n3   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n4   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n5   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n6   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n7   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n8   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n9   Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n10  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n11  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n12  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n13  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n14  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n15  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n16  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n17  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n18  Colleton County    1998              0.9539                0.9062                 1.0                1.7808\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.453596,
                    "execution_time": 3.776642,
                    "compile_time": 0.042102,
                    "planning_time": 0.005846,
                    "create_size": 6912
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.539713,
                    "execution_time": 3.757339,
                    "compile_time": 3.070713,
                    "planning_time": 0.061561,
                    "create_size": 6912
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n1   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n2   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n3   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n4   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n5   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n6   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n7   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n8   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n9   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n10  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n11  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n12  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n13  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n14  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n15  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n16  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n17  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n18  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017858,
                    "execution_time": 0.008021,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.00365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053422,
                    "execution_time": 0.008159,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038949
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n1   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n2   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n3   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n4   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n5   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n6   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n7   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n8   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n9   Highland County    1998              1.2552                1.1498                 1.0                1.6725\n10  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n11  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n12  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n13  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n14  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n15  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n16  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n17  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n18  Highland County    1998              1.2552                1.1498                 1.0                1.6725\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and (case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end IS NOT NULL) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.385287,
                    "execution_time": 0.108162,
                    "compile_time": 0.206646,
                    "planning_time": 0.032212,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.426036,
                    "execution_time": 0.11627,
                    "compile_time": 13.171941,
                    "planning_time": 0.088967,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Lipscomb County    1998              0.6886                1.0256              2.0298                1.8680\n1     East Carroll Parish    1998              1.1641                1.2210              1.7288                1.7047\n2           Juneau County    1998              1.0124                1.0469              1.6810                1.8442\n3          Gooding County    1998              1.9478                1.0814              1.3859                1.8337\n4          Prowers County    1998              0.9815                1.0970              1.8637                1.6594\n5        Kandiyohi County    1998              1.1465                1.0916              1.7342                1.8020\n6          Lexington city    1998              0.8275                1.1324              1.6262                1.7514\n7           Haakon County    1998              1.0897                1.0152              1.7856                1.9030\n8           Massac County    1998              0.9657                0.9958              2.6463                1.8237\n9   West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n10           Troup County    1998              0.8932                0.8110              2.0582                1.9360\n11         Wyandot County    1998              0.9272                1.1468              1.9216                1.9217\n12         Grayson County    1998              0.8843                1.0089              1.9268                1.8631\n13            Cass County    1998              0.9838                1.0559              1.7939                1.8457\n14         Loudoun County    1998              1.2363                0.9973              1.7165                1.6452\n15         Wakulla County    1998              1.4810                0.9549              1.5668                1.9935\n16       Red River Parish    1998              1.3291                1.0954              1.9115                1.9274\n17         Jackson County    1998              0.9780                1.0376              1.8122                1.8294\n18          Holmes County    1998              1.0423                1.0528              1.6355                1.8149\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017591,
                    "execution_time": 0.00776,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003701
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054784,
                    "execution_time": 0.008052,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039279
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Lipscomb County    1998              0.6886                1.0256              2.0298                1.8680\n1     East Carroll Parish    1998              1.1641                1.2210              1.7288                1.7047\n2           Juneau County    1998              1.0124                1.0469              1.6810                1.8442\n3          Gooding County    1998              1.9478                1.0814              1.3859                1.8337\n4          Prowers County    1998              0.9815                1.0970              1.8637                1.6594\n5        Kandiyohi County    1998              1.1465                1.0916              1.7342                1.8020\n6          Lexington city    1998              0.8275                1.1324              1.6262                1.7514\n7           Haakon County    1998              1.0897                1.0152              1.7856                1.9030\n8           Massac County    1998              0.9657                0.9958              2.6463                1.8237\n9   West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n10           Troup County    1998              0.8932                0.8110              2.0582                1.9360\n11         Wyandot County    1998              0.9272                1.1468              1.9216                1.9217\n12         Grayson County    1998              0.8843                1.0089              1.9268                1.8631\n13            Cass County    1998              0.9838                1.0559              1.7939                1.8457\n14         Loudoun County    1998              1.2363                0.9973              1.7165                1.6452\n15         Wakulla County    1998              1.4810                0.9549              1.5668                1.9935\n16       Red River Parish    1998              1.3291                1.0954              1.9115                1.9274\n17         Jackson County    1998              0.9780                1.0376              1.8122                1.8294\n18          Holmes County    1998              1.0423                1.0528              1.6355                1.8149\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.37878,
                    "execution_time": 0.093241,
                    "compile_time": 0.206904,
                    "planning_time": 0.032953,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.991962,
                    "execution_time": 0.097122,
                    "compile_time": 9.748614,
                    "planning_time": 0.091013,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Jefferson Davis County    1998              1.1973                1.0882              1.8421                2.0960\n1         Winnebago County    1998              1.1604                1.0137              1.6792                1.8049\n2            Acadia Parish    1998              1.0168                0.9528              1.8568                1.8080\n3        Silver Bow County    1998              1.1945                0.9930              2.2535                1.8923\n4          Red Lake County    1998              1.0695                0.8673              1.4469                2.1693\n5        Shenandoah County    1998              1.2241                1.0682              1.9338                1.5933\n6        Stillwater County    1998              1.5276                0.9654              1.4840                1.6802\n7         Lafayette Parish    1998              1.2499                1.2495              1.7238                1.7420\n8           Nodaway County    1998              0.9879                0.9861              1.9301                1.7879\n9         Caledonia County    1998              1.3088                1.0361              1.6229                1.8218\n10          Colbert County    1998              1.0974                1.0575              1.7807                1.7649\n11       Fall River County    1998              0.9820                0.9678              1.9063                1.8055\n12          Bennett County    1998              1.1084                1.0691              1.8026                1.7499\n13        Calcasieu Parish    1998              1.7105                1.1084              1.3613                2.1673\n14            Wayne County    1998              1.0288                1.0200              1.8380                1.8484\n15     Virginia Beach city    1998              1.4031                1.1509              1.8384                1.7246\n16          Haines Borough    1998              1.2341                0.9604              1.4373                1.7085\n17     Grays Harbor County    1998              1.1007                0.9593              1.8719                1.8528\n18            Tulsa County    1998              1.3779                1.1261              1.4259                1.6204\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016591,
                    "execution_time": 0.006904,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003649
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055043,
                    "execution_time": 0.007878,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039213
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Jefferson Davis County    1998              1.1973                1.0882              1.8421                2.0960\n1         Winnebago County    1998              1.1604                1.0137              1.6792                1.8049\n2            Acadia Parish    1998              1.0168                0.9528              1.8568                1.8080\n3        Silver Bow County    1998              1.1945                0.9930              2.2535                1.8923\n4          Red Lake County    1998              1.0695                0.8673              1.4469                2.1693\n5        Shenandoah County    1998              1.2241                1.0682              1.9338                1.5933\n6        Stillwater County    1998              1.5276                0.9654              1.4840                1.6802\n7         Lafayette Parish    1998              1.2499                1.2495              1.7238                1.7420\n8           Nodaway County    1998              0.9879                0.9861              1.9301                1.7879\n9         Caledonia County    1998              1.3088                1.0361              1.6229                1.8218\n10          Colbert County    1998              1.0974                1.0575              1.7807                1.7649\n11       Fall River County    1998              0.9820                0.9678              1.9063                1.8055\n12          Bennett County    1998              1.1084                1.0691              1.8026                1.7499\n13        Calcasieu Parish    1998              1.7105                1.1084              1.3613                2.1673\n14            Wayne County    1998              1.0288                1.0200              1.8380                1.8484\n15     Virginia Beach city    1998              1.4031                1.1509              1.8384                1.7246\n16          Haines Borough    1998              1.2341                0.9604              1.4373                1.7085\n17     Grays Harbor County    1998              1.1007                0.9593              1.8719                1.8528\n18            Tulsa County    1998              1.3779                1.1261              1.4259                1.6204\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and (case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end) \n       > (case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end)\n    and (case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end) > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.316977,
                    "execution_time": 0.089034,
                    "compile_time": 0.154581,
                    "planning_time": 0.034525,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.769501,
                    "execution_time": 0.093993,
                    "compile_time": 9.531144,
                    "planning_time": 0.091221,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0                Eaton County    1998              1.6293                0.9894              1.6302                1.8985\n1                 Coal County    1998              1.4873                1.0371              1.2369                1.7883\n2   Yukon-Koyukuk Census Area    1998              1.1123                1.0786              1.9103                1.8968\n3               Solano County    1998              1.1503                1.1197              1.3136                1.8041\n4           Pushmataha County    1998              0.9998                0.9985              1.3503                1.8138\n5              De Kalb County    1998              1.3762                1.2131              1.5713                1.4815\n6               Bowman County    1998              1.6572                0.9831              1.3722                1.7178\n7              Berrien County    1998              1.1123                0.9774              1.8789                1.5767\n8             Brewster County    1998              0.9495                0.9188              1.5540                1.8952\n9        Pointe Coupee Parish    1998              1.4803                0.8944              1.5973                1.7941\n10           McCulloch County    1998              1.3051                1.0506              2.0229                1.7125\n11             Licking County    1998              1.0693                1.0654              2.1743                1.8221\n12                Ward County    1998              1.0115                0.9813              1.8849                1.8934\n13           Robertson County    1998              1.0567                1.0316              1.8772                1.7885\n14             Ontario County    1998              1.0952                0.8932              1.9117                1.6762\n15              Dickey County    1998              1.3605                0.9442              1.6458                1.9940\n16           Brookings County    1998              1.2133                1.1770              1.3907                1.7723\n17              Jerome County    1998              1.1476                0.8463              1.7239                1.8921\n18             Wagoner County    1998              1.5241                1.0076              1.5670                1.7802\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017226,
                    "execution_time": 0.007566,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003579
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053309,
                    "execution_time": 0.007808,
                    "compile_time": 5e-05,
                    "planning_time": 0.039268
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0                Eaton County    1998              1.6293                0.9894              1.6302                1.8985\n1                 Coal County    1998              1.4873                1.0371              1.2369                1.7883\n2   Yukon-Koyukuk Census Area    1998              1.1123                1.0786              1.9103                1.8968\n3               Solano County    1998              1.1503                1.1197              1.3136                1.8041\n4           Pushmataha County    1998              0.9998                0.9985              1.3503                1.8138\n5              De Kalb County    1998              1.3762                1.2131              1.5713                1.4815\n6               Bowman County    1998              1.6572                0.9831              1.3722                1.7178\n7              Berrien County    1998              1.1123                0.9774              1.8789                1.5767\n8             Brewster County    1998              0.9495                0.9188              1.5540                1.8952\n9        Pointe Coupee Parish    1998              1.4803                0.8944              1.5973                1.7941\n10           McCulloch County    1998              1.3051                1.0506              2.0229                1.7125\n11             Licking County    1998              1.0693                1.0654              2.1743                1.8221\n12                Ward County    1998              1.0115                0.9813              1.8849                1.8934\n13           Robertson County    1998              1.0567                1.0316              1.8772                1.7885\n14             Ontario County    1998              1.0952                0.8932              1.9117                1.6762\n15              Dickey County    1998              1.3605                0.9442              1.6458                1.9940\n16           Brookings County    1998              1.2133                1.1770              1.3907                1.7723\n17              Jerome County    1998              1.1476                0.8463              1.7239                1.8921\n18             Wagoner County    1998              1.5241                1.0076              1.5670                1.7802\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.277242,
                    "execution_time": 0.107345,
                    "compile_time": 0.098207,
                    "planning_time": 0.035999,
                    "create_size": 1008
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.997274,
                    "execution_time": 0.115175,
                    "compile_time": 6.74804,
                    "planning_time": 0.09339,
                    "create_size": 1008
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Lenoir County    1998              0.9542                0.9406              2.0243                1.9826\n1            Troup County    1998              0.8932                0.8110              2.0582                1.9360\n2   West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3          Loudoun County    1998              1.2363                0.9973              1.7165                1.6452\n4        Abbeville County    1998              1.1542                0.8096              2.3822                1.8518\n5           Lorain County    1998              1.0086                0.9817              1.8992                1.7244\n6          De Kalb County    1998              1.3762                1.2131              1.5713                1.4815\n7         Montrose County    1998              1.0655                1.0436              1.8929                1.8529\n8           Person County    1998              0.9237                0.9143              2.4127                1.9821\n9          Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n10          Moffat County    1998              1.0325                0.9208              2.3681                1.8754\n11         Pondera County    1998              1.2350                1.0282              1.8155                1.6418\n12          Navajo County    1998              1.1270                1.0098              2.0736                1.6183\n13        Minidoka County    1998              1.1607                0.8467              2.0482                2.0179\n14   District of Columbia    1998              1.2345                1.0811              1.9920                1.8610\n15           Hayes County    1998              1.4254                0.9424              2.1193                1.8703\n16         Covington city    1998              1.1000                1.0903              1.8956                1.5659\n17        Eastland County    1998              1.5970                1.0699              1.9422                1.7215\n18       Penobscot County    1998              1.1459                1.0372              1.9940                1.8945\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017496,
                    "execution_time": 0.007749,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003673
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055419,
                    "execution_time": 0.00856,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039406
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Lenoir County    1998              0.9542                0.9406              2.0243                1.9826\n1            Troup County    1998              0.8932                0.8110              2.0582                1.9360\n2   West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3          Loudoun County    1998              1.2363                0.9973              1.7165                1.6452\n4        Abbeville County    1998              1.1542                0.8096              2.3822                1.8518\n5           Lorain County    1998              1.0086                0.9817              1.8992                1.7244\n6          De Kalb County    1998              1.3762                1.2131              1.5713                1.4815\n7         Montrose County    1998              1.0655                1.0436              1.8929                1.8529\n8           Person County    1998              0.9237                0.9143              2.4127                1.9821\n9          Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n10          Moffat County    1998              1.0325                0.9208              2.3681                1.8754\n11         Pondera County    1998              1.2350                1.0282              1.8155                1.6418\n12          Navajo County    1998              1.1270                1.0098              2.0736                1.6183\n13        Minidoka County    1998              1.1607                0.8467              2.0482                2.0179\n14   District of Columbia    1998              1.2345                1.0811              1.9920                1.8610\n15           Hayes County    1998              1.4254                0.9424              2.1193                1.8703\n16         Covington city    1998              1.1000                1.0903              1.8956                1.5659\n17        Eastland County    1998              1.5970                1.0699              1.9422                1.7215\n18       Penobscot County    1998              1.1459                1.0372              1.9940                1.8945\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" LIMIT 21",
                "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Judith Basin County    1998              0.8239                0.8143              2.0735                1.8695\n1            Barnwell County    1998              0.8587                0.8412              2.0388                1.9937\n2      West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3        Rappahannock County    1998              0.8764                0.8756              2.2304                1.8380\n4            Sandoval County    1998              0.8775                0.8524              2.0501                2.0048\n5            Burleigh County    1998              0.8783                0.8668              2.2698                1.9636\n6             Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n7               Troup County    1998              0.8932                0.8110              2.0582                1.9360\n8          Rensselaer County    1998              0.8989                0.8459              2.5948                2.1620\n9   Northwest Arctic Borough    1998              0.9041                0.8828              2.0438                1.8802\n10              Anson County    1998              0.9114                0.9055              2.3051                2.0271\n11               Maui County    1998              0.9209                0.9125              2.0039                1.8472\n12            Haywood County    1998              0.9211                0.9125              2.3465                1.9611\n13             Person County    1998              0.9237                0.9143              2.4127                1.9821\n14             Sawyer County    1998              0.9257                0.8605              2.3551                1.9929\n15              Casey County    1998              0.9305                0.9299              2.0736                1.8056\n16           Callaway County    1998              0.9330                0.9312              1.9771                1.7246\n17          El Dorado County    1998              0.9344                0.9011              1.9603                1.9588\n18           Nicollet County    1998              0.9437                0.9315              2.3327                2.0250\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.034481,
                    "execution_time": 0.00959,
                    "compile_time": 0.014869,
                    "planning_time": 0.003889
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.913818,
                    "execution_time": 0.010242,
                    "compile_time": 4.861681,
                    "planning_time": 0.039274
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST"
            }
        ],
        "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Judith Basin County    1998              0.8239                0.8143              2.0735                1.8695\n1            Barnwell County    1998              0.8587                0.8412              2.0388                1.9937\n2      West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3        Rappahannock County    1998              0.8764                0.8756              2.2304                1.8380\n4            Sandoval County    1998              0.8775                0.8524              2.0501                2.0048\n5            Burleigh County    1998              0.8783                0.8668              2.2698                1.9636\n6             Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n7               Troup County    1998              0.8932                0.8110              2.0582                1.9360\n8          Rensselaer County    1998              0.8989                0.8459              2.5948                2.1620\n9   Northwest Arctic Borough    1998              0.9041                0.8828              2.0438                1.8802\n10              Anson County    1998              0.9114                0.9055              2.3051                2.0271\n11               Maui County    1998              0.9209                0.9125              2.0039                1.8472\n12            Haywood County    1998              0.9211                0.9125              2.3465                1.9611\n13             Person County    1998              0.9237                0.9143              2.4127                1.9821\n14             Sawyer County    1998              0.9257                0.8605              2.3551                1.9929\n15              Casey County    1998              0.9305                0.9299              2.0736                1.8056\n16           Callaway County    1998              0.9330                0.9312              1.9771                1.7246\n17          El Dorado County    1998              0.9344                0.9011              1.9603                1.9588\n18           Nicollet County    1998              0.9437                0.9315              2.3327                2.0250\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" LIMIT 21",
                "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Judith Basin County    1998              0.8239                0.8143              2.0735                1.8695\n1            Barnwell County    1998              0.8587                0.8412              2.0388                1.9937\n2      West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3        Rappahannock County    1998              0.8764                0.8756              2.2304                1.8380\n4            Sandoval County    1998              0.8775                0.8524              2.0501                2.0048\n5            Burleigh County    1998              0.8783                0.8668              2.2698                1.9636\n6             Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n7               Troup County    1998              0.8932                0.8110              2.0582                1.9360\n8          Rensselaer County    1998              0.8989                0.8459              2.5948                2.1620\n9   Northwest Arctic Borough    1998              0.9041                0.8828              2.0438                1.8802\n10              Anson County    1998              0.9114                0.9055              2.3051                2.0271\n11               Maui County    1998              0.9209                0.9125              2.0039                1.8472\n12            Haywood County    1998              0.9211                0.9125              2.3465                1.9611\n13             Person County    1998              0.9237                0.9143              2.4127                1.9821\n14             Sawyer County    1998              0.9257                0.8605              2.3551                1.9929\n15              Casey County    1998              0.9305                0.9299              2.0736                1.8056\n16           Callaway County    1998              0.9330                0.9312              1.9771                1.7246\n17          El Dorado County    1998              0.9344                0.9011              1.9603                1.9588\n18           Nicollet County    1998              0.9437                0.9315              2.3327                2.0250\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018974,
                    "execution_time": 0.009244,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003808
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019728,
                    "execution_time": 0.009384,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.00405
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Judith Basin County    1998              0.8239                0.8143              2.0735                1.8695\n1            Barnwell County    1998              0.8587                0.8412              2.0388                1.9937\n2      West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3        Rappahannock County    1998              0.8764                0.8756              2.2304                1.8380\n4            Sandoval County    1998              0.8775                0.8524              2.0501                2.0048\n5            Burleigh County    1998              0.8783                0.8668              2.2698                1.9636\n6             Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n7               Troup County    1998              0.8932                0.8110              2.0582                1.9360\n8          Rensselaer County    1998              0.8989                0.8459              2.5948                2.1620\n9   Northwest Arctic Borough    1998              0.9041                0.8828              2.0438                1.8802\n10              Anson County    1998              0.9114                0.9055              2.3051                2.0271\n11               Maui County    1998              0.9209                0.9125              2.0039                1.8472\n12            Haywood County    1998              0.9211                0.9125              2.3465                1.9611\n13             Person County    1998              0.9237                0.9143              2.4127                1.9821\n14             Sawyer County    1998              0.9257                0.8605              2.3551                1.9929\n15              Casey County    1998              0.9305                0.9299              2.0736                1.8056\n16           Callaway County    1998              0.9330                0.9312              1.9771                1.7246\n17          El Dorado County    1998              0.9344                0.9011              1.9603                1.9588\n18           Nicollet County    1998              0.9437                0.9315              2.3327                2.0250\n...*/"
    }
]