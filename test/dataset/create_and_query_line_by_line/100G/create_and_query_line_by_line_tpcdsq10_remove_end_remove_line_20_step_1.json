[
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  c.C_CURRENT_CDEMO_SK as cd_gender,\n  c.C_CURRENT_CDEMO_SK as cd_marital_status,\n  c.C_CURRENT_CDEMO_SK as cd_education_status,\n  count(*) as cnt1,\n  c.C_CURRENT_CDEMO_SK as cd_purchase_estimate,\n  count(*) as cnt2,\n  c.C_CURRENT_CDEMO_SK as cd_credit_rating,\n  count(*) as cnt3,\n  c.C_CURRENT_CDEMO_SK as cd_dep_count,\n  count(*) as cnt4,\n  c.C_CURRENT_CDEMO_SK as cd_dep_employed_count,\n  count(*) as cnt5,\n  c.C_CURRENT_CDEMO_SK as cd_dep_college_count,\n  count(*) as cnt6\n from\n  customer c\n where\n  c.C_CURRENT_ADDR_SK IS NOT NULL and\n  exists (select *\n          from customer\n          where c.C_CUSTOMER_SK = C_CUSTOMER_SK) and\n   (exists (select *\n            from customer\n            where c.C_CUSTOMER_SK = C_CUSTOMER_SK) or \n    exists (select * \n            from customer\n            where c.C_CUSTOMER_SK = C_CUSTOMER_SK))\ngroup by c.C_CURRENT_CDEMO_SK\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_SK\" ) SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"_U_0\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) AND NOT \"C\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.317921,
                    "execution_time": 0.22586,
                    "compile_time": 0.000239,
                    "planning_time": 0.023585,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.385517,
                    "execution_time": 1.397717,
                    "compile_time": 4.75946,
                    "planning_time": 0.031937,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.637993,
                    "execution_time": 0.97075,
                    "compile_time": 0.000879,
                    "planning_time": 0.032389,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.456234,
                    "execution_time": 1.590672,
                    "compile_time": 5.144879,
                    "planning_time": 0.093009,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    cd_gender  cd_marital_status  cd_education_status  cnt1  cd_purchase_estimate  cnt2  cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0     1828646            1828646              1828646     1               1828646     1           1828646     1       1828646     1                1828646     1               1828646     1\n1      500715             500715               500715     2                500715     2            500715     2        500715     2                 500715     2                500715     2\n2     1041540            1041540              1041540     2               1041540     2           1041540     2       1041540     2                1041540     2               1041540     2\n3      115450             115450               115450     2                115450     2            115450     2        115450     2                 115450     2                115450     2\n4     1122374            1122374              1122374     2               1122374     2           1122374     2       1122374     2                1122374     2               1122374     2\n5     1868611            1868611              1868611     3               1868611     3           1868611     3       1868611     3                1868611     3               1868611     3\n6      920394             920394               920394     1                920394     1            920394     1        920394     1                 920394     1                920394     1\n7     1195922            1195922              1195922     3               1195922     3           1195922     3       1195922     3                1195922     3               1195922     3\n8      642795             642795               642795     1                642795     1            642795     1        642795     1                 642795     1                642795     1\n9     1445245            1445245              1445245     3               1445245     3           1445245     3       1445245     3                1445245     3               1445245     3\n10     747245             747245               747245     2                747245     2            747245     2        747245     2                 747245     2                747245     2\n11    1024087            1024087              1024087     1               1024087     1           1024087     1       1024087     1                1024087     1               1024087     1\n12     164675             164675               164675     1                164675     1            164675     1        164675     1                 164675     1                164675     1\n13    1662184            1662184              1662184     3               1662184     3           1662184     3       1662184     3                1662184     3               1662184     3\n14     660964             660964               660964     1                660964     1            660964     1        660964     1                 660964     1                660964     1\n15     976744             976744               976744     1                976744     1            976744     1        976744     1                 976744     1                976744     1\n16     190012             190012               190012     1                190012     1            190012     1        190012     1                 190012     1                190012     1\n17      50835              50835                50835     1                 50835     1             50835     1         50835     1                  50835     1                 50835     1\n18     212649             212649               212649     5                212649     5            212649     5        212649     5                 212649     5                212649     5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020154,
                    "execution_time": 0.008327,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004997
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.119545,
                    "execution_time": 0.008117,
                    "compile_time": 3.062135,
                    "planning_time": 0.040238
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) AND NOT \"C\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    cd_gender  cd_marital_status  cd_education_status  cnt1  cd_purchase_estimate  cnt2  cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0     1828646            1828646              1828646     1               1828646     1           1828646     1       1828646     1                1828646     1               1828646     1\n1      500715             500715               500715     2                500715     2            500715     2        500715     2                 500715     2                500715     2\n2     1041540            1041540              1041540     2               1041540     2           1041540     2       1041540     2                1041540     2               1041540     2\n3      115450             115450               115450     2                115450     2            115450     2        115450     2                 115450     2                115450     2\n4     1122374            1122374              1122374     2               1122374     2           1122374     2       1122374     2                1122374     2               1122374     2\n5     1868611            1868611              1868611     3               1868611     3           1868611     3       1868611     3                1868611     3               1868611     3\n6      920394             920394               920394     1                920394     1            920394     1        920394     1                 920394     1                920394     1\n7     1195922            1195922              1195922     3               1195922     3           1195922     3       1195922     3                1195922     3               1195922     3\n8      642795             642795               642795     1                642795     1            642795     1        642795     1                 642795     1                642795     1\n9     1445245            1445245              1445245     3               1445245     3           1445245     3       1445245     3                1445245     3               1445245     3\n10     747245             747245               747245     2                747245     2            747245     2        747245     2                 747245     2                747245     2\n11    1024087            1024087              1024087     1               1024087     1           1024087     1       1024087     1                1024087     1               1024087     1\n12     164675             164675               164675     1                164675     1            164675     1        164675     1                 164675     1                164675     1\n13    1662184            1662184              1662184     3               1662184     3           1662184     3       1662184     3                1662184     3               1662184     3\n14     660964             660964               660964     1                660964     1            660964     1        660964     1                 660964     1                660964     1\n15     976744             976744               976744     1                976744     1            976744     1        976744     1                 976744     1                976744     1\n16     190012             190012               190012     1                190012     1            190012     1        190012     1                 190012     1                190012     1\n17      50835              50835                50835     1                 50835     1             50835     1         50835     1                  50835     1                 50835     1\n18     212649             212649               212649     5                212649     5            212649     5        212649     5                 212649     5                212649     5\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\nfrom\n  customer c, customer_address ca, customer_demographics cd\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca.ca_county in ('Chautauqua County', 'Cherokee County', 'Bell County', 'Washington County', 'Clarke County') and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 2000 and\n                d.d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales ws, date_dim d\n            where c.c_customer_sk = ws.ws_bill_customer_sk and\n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 2000 and\n                  d.d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales cs, date_dim d\n            where c.c_customer_sk = cs.cs_ship_customer_sk and\n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 2000 and\n                  d.d_moy between 2 and 2+3))\ngroup by \n  cd_gender, \n  cd_marital_status, \n  cd_education_status, \n  cd_purchase_estimate, \n  cd_credit_rating, \n  cd_dep_count, \n  cd_dep_employed_count, \n  cd_dep_college_count \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 5 AND \"D\".\"D_MOY\" >= 2 AND \"D\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 5 AND \"D\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.222427,
                    "execution_time": 0.064129,
                    "compile_time": 0.00031,
                    "planning_time": 0.02774,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.237239,
                    "execution_time": 3.970758,
                    "compile_time": 9.09454,
                    "planning_time": 0.033621,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.903778,
                    "execution_time": 0.80381,
                    "compile_time": 0.000345,
                    "planning_time": 0.025525,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.067612,
                    "execution_time": 7.573589,
                    "compile_time": 3.386272,
                    "planning_time": 0.027009,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.530284,
                    "execution_time": 0.356725,
                    "compile_time": 0.071507,
                    "planning_time": 0.027667,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.954791,
                    "execution_time": 3.504426,
                    "compile_time": 4.346804,
                    "planning_time": 0.027449,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.633279,
                    "execution_time": 0.529783,
                    "compile_time": 0.000349,
                    "planning_time": 0.028275,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.383643,
                    "execution_time": 5.277873,
                    "compile_time": 0.000349,
                    "planning_time": 0.029076,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.487063,
                    "execution_time": 0.145507,
                    "compile_time": 0.193678,
                    "planning_time": 0.047644,
                    "create_size": 527
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.00799,
                    "execution_time": 7.731589,
                    "compile_time": 11.113672,
                    "planning_time": 0.048329,
                    "create_size": 527
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 M             Primary     1                  7000     1        High Risk     1             1     1                      1     1                     2     1\n1          F                 M             College     2                  5500     2         Low Risk     2             0     2                      3     2                     6     2\n2          F                 M             College     1                   500     1             Good     1             0     1                      4     1                     3     1\n3          M                 S     Advanced Degree     1                  5000     1         Low Risk     1             2     1                      2     1                     2     1\n4          F                 D             College     2                  9000     2             Good     2             5     2                      2     2                     3     2\n5          F                 U         2 yr Degree     1                   500     1        High Risk     1             3     1                      6     1                     1     1\n6          M                 W         2 yr Degree     1                  2000     1         Low Risk     1             5     1                      0     1                     4     1\n7          F                 S             Unknown     1                  3000     1          Unknown     1             5     1                      1     1                     1     1\n8          M                 W             Primary     1                  9000     1          Unknown     1             0     1                      4     1                     2     1\n9          M                 S         4 yr Degree     1                  3000     1        High Risk     1             0     1                      5     1                     0     1\n10         M                 M         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     6     1\n11         M                 S             Primary     1                  2500     1         Low Risk     1             0     1                      0     1                     1     1\n12         F                 S             Primary     1                  3500     1          Unknown     1             1     1                      0     1                     3     1\n13         M                 S     Advanced Degree     1                   500     1          Unknown     1             2     1                      5     1                     2     1\n14         F                 D         2 yr Degree     1                  4000     1         Low Risk     1             1     1                      6     1                     6     1\n15         F                 S           Secondary     1                  7000     1        High Risk     1             2     1                      0     1                     6     1\n16         M                 S           Secondary     1                  7500     1          Unknown     1             2     1                      6     1                     1     1\n17         M                 M             Unknown     1                  9000     1         Low Risk     1             4     1                      0     1                     4     1\n18         F                 W         2 yr Degree     1                  7500     1        High Risk     1             2     1                      4     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04993,
                    "execution_time": 0.008188,
                    "compile_time": 0.029625,
                    "planning_time": 0.005072
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.3046,
                    "execution_time": 0.008167,
                    "compile_time": 3.247341,
                    "planning_time": 0.039991
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 M             Primary     1                  7000     1        High Risk     1             1     1                      1     1                     2     1\n1          F                 M             College     2                  5500     2         Low Risk     2             0     2                      3     2                     6     2\n2          F                 M             College     1                   500     1             Good     1             0     1                      4     1                     3     1\n3          M                 S     Advanced Degree     1                  5000     1         Low Risk     1             2     1                      2     1                     2     1\n4          F                 D             College     2                  9000     2             Good     2             5     2                      2     2                     3     2\n5          F                 U         2 yr Degree     1                   500     1        High Risk     1             3     1                      6     1                     1     1\n6          M                 W         2 yr Degree     1                  2000     1         Low Risk     1             5     1                      0     1                     4     1\n7          F                 S             Unknown     1                  3000     1          Unknown     1             5     1                      1     1                     1     1\n8          M                 W             Primary     1                  9000     1          Unknown     1             0     1                      4     1                     2     1\n9          M                 S         4 yr Degree     1                  3000     1        High Risk     1             0     1                      5     1                     0     1\n10         M                 M         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     6     1\n11         M                 S             Primary     1                  2500     1         Low Risk     1             0     1                      0     1                     1     1\n12         F                 S             Primary     1                  3500     1          Unknown     1             1     1                      0     1                     3     1\n13         M                 S     Advanced Degree     1                   500     1          Unknown     1             2     1                      5     1                     2     1\n14         F                 D         2 yr Degree     1                  4000     1         Low Risk     1             1     1                      6     1                     6     1\n15         F                 S           Secondary     1                  7000     1        High Risk     1             2     1                      0     1                     6     1\n16         M                 S           Secondary     1                  7500     1          Unknown     1             2     1                      6     1                     1     1\n17         M                 M             Unknown     1                  9000     1         Low Risk     1             4     1                      0     1                     4     1\n18         F                 W         2 yr Degree     1                  7500     1        High Risk     1             2     1                      4     1                     2     1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.226821,
                    "execution_time": 0.063569,
                    "compile_time": 0.00031,
                    "planning_time": 0.027778,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.296532,
                    "execution_time": 0.074851,
                    "compile_time": 0.000313,
                    "planning_time": 0.088095,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.898424,
                    "execution_time": 0.795241,
                    "compile_time": 0.000353,
                    "planning_time": 0.02878,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.968119,
                    "execution_time": 0.804202,
                    "compile_time": 0.000347,
                    "planning_time": 0.08842,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.44502,
                    "execution_time": 0.343641,
                    "compile_time": 0.000337,
                    "planning_time": 0.026825,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.506483,
                    "execution_time": 0.345129,
                    "compile_time": 0.000327,
                    "planning_time": 0.087554,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.625248,
                    "execution_time": 0.525489,
                    "compile_time": 0.000335,
                    "planning_time": 0.025957,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.725254,
                    "execution_time": 0.5641,
                    "compile_time": 0.000317,
                    "planning_time": 0.087309,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.291451,
                    "execution_time": 0.141747,
                    "compile_time": 0.000657,
                    "planning_time": 0.049746,
                    "create_size": 527
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.997179,
                    "execution_time": 0.143666,
                    "compile_time": 4.63504,
                    "planning_time": 0.116504,
                    "create_size": 527
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S     Advanced Degree     1                  8500     1          Unknown     1             2     1                      1     1                     6     1\n1          M                 M             College     1                  9000     1             Good     1             6     1                      1     1                     5     1\n2          F                 W         4 yr Degree     1                  7500     1          Unknown     1             3     1                      1     1                     6     1\n3          M                 S             College     1                  9500     1         Low Risk     1             1     1                      5     1                     2     1\n4          F                 W             Unknown     1                  3000     1        High Risk     1             4     1                      3     1                     2     1\n5          M                 S         4 yr Degree     1                  2000     1         Low Risk     1             2     1                      6     1                     6     1\n6          M                 W             Primary     1                  6000     1          Unknown     1             5     1                      1     1                     1     1\n7          F                 U     Advanced Degree     1                  8500     1             Good     1             1     1                      4     1                     1     1\n8          F                 U         4 yr Degree     1                  5000     1        High Risk     1             1     1                      3     1                     4     1\n9          M                 U             Unknown     1                   500     1             Good     1             4     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                  8000     1          Unknown     1             6     1                      3     1                     0     1\n11         M                 W         4 yr Degree     1                  7500     1        High Risk     1             1     1                      6     1                     0     1\n12         M                 S         2 yr Degree     1                  4000     1             Good     1             6     1                      3     1                     1     1\n13         F                 S         4 yr Degree     1                   500     1        High Risk     1             4     1                      3     1                     6     1\n14         F                 D           Secondary     1                  6000     1        High Risk     1             5     1                      0     1                     5     1\n15         F                 D           Secondary     1                  1500     1             Good     1             5     1                      1     1                     3     1\n16         M                 S         2 yr Degree     1                  6500     1          Unknown     1             4     1                      4     1                     1     1\n17         M                 U             Primary     1                  2500     1         Low Risk     1             0     1                      3     1                     5     1\n18         M                 D           Secondary     1                  2500     1             Good     1             0     1                      3     1                     6     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020132,
                    "execution_time": 0.007961,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005035
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.130228,
                    "execution_time": 0.008128,
                    "compile_time": 0.074675,
                    "planning_time": 0.040414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S     Advanced Degree     1                  8500     1          Unknown     1             2     1                      1     1                     6     1\n1          M                 M             College     1                  9000     1             Good     1             6     1                      1     1                     5     1\n2          F                 W         4 yr Degree     1                  7500     1          Unknown     1             3     1                      1     1                     6     1\n3          M                 S             College     1                  9500     1         Low Risk     1             1     1                      5     1                     2     1\n4          F                 W             Unknown     1                  3000     1        High Risk     1             4     1                      3     1                     2     1\n5          M                 S         4 yr Degree     1                  2000     1         Low Risk     1             2     1                      6     1                     6     1\n6          M                 W             Primary     1                  6000     1          Unknown     1             5     1                      1     1                     1     1\n7          F                 U     Advanced Degree     1                  8500     1             Good     1             1     1                      4     1                     1     1\n8          F                 U         4 yr Degree     1                  5000     1        High Risk     1             1     1                      3     1                     4     1\n9          M                 U             Unknown     1                   500     1             Good     1             4     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                  8000     1          Unknown     1             6     1                      3     1                     0     1\n11         M                 W         4 yr Degree     1                  7500     1        High Risk     1             1     1                      6     1                     0     1\n12         M                 S         2 yr Degree     1                  4000     1             Good     1             6     1                      3     1                     1     1\n13         F                 S         4 yr Degree     1                   500     1        High Risk     1             4     1                      3     1                     6     1\n14         F                 D           Secondary     1                  6000     1        High Risk     1             5     1                      0     1                     5     1\n15         F                 D           Secondary     1                  1500     1             Good     1             5     1                      1     1                     3     1\n16         M                 S         2 yr Degree     1                  6500     1          Unknown     1             4     1                      4     1                     1     1\n17         M                 U             Primary     1                  2500     1         Low Risk     1             0     1                      3     1                     5     1\n18         M                 D           Secondary     1                  2500     1             Good     1             0     1                      3     1                     6     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" AS \"D_DATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DOW\" AS \"D_DOW\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DOM\" AS \"D_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.31123,
                    "execution_time": 0.106433,
                    "compile_time": 0.063518,
                    "planning_time": 0.007062,
                    "create_size": 992
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.574121,
                    "execution_time": 0.115651,
                    "compile_time": 3.258243,
                    "planning_time": 0.06309,
                    "create_size": 992
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.872449,
                    "execution_time": 0.770983,
                    "compile_time": 0.000321,
                    "planning_time": 0.027617,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.939309,
                    "execution_time": 0.76818,
                    "compile_time": 0.000332,
                    "planning_time": 0.09622,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.448602,
                    "execution_time": 0.345447,
                    "compile_time": 0.000343,
                    "planning_time": 0.027932,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.514114,
                    "execution_time": 0.351233,
                    "compile_time": 0.000317,
                    "planning_time": 0.088634,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.616848,
                    "execution_time": 0.515549,
                    "compile_time": 0.000342,
                    "planning_time": 0.026904,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.689189,
                    "execution_time": 0.527119,
                    "compile_time": 0.000338,
                    "planning_time": 0.086572,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.29798,
                    "execution_time": 0.150302,
                    "compile_time": 0.000655,
                    "planning_time": 0.048342,
                    "create_size": 527
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.368563,
                    "execution_time": 0.151722,
                    "compile_time": 0.000618,
                    "planning_time": 0.117071,
                    "create_size": 527
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  5000     1        High Risk     1             6     1                      1     1                     0     1\n1          F                 M           Secondary     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n2          M                 W           Secondary     1                  2500     1         Low Risk     1             3     1                      5     1                     6     1\n3          F                 S             Primary     1                  5500     1             Good     1             2     1                      1     1                     5     1\n4          M                 M             College     1                  3000     1             Good     1             0     1                      6     1                     6     1\n5          M                 S         4 yr Degree     1                  1000     1         Low Risk     1             3     1                      5     1                     2     1\n6          M                 M           Secondary     1                 10000     1        High Risk     1             2     1                      2     1                     4     1\n7          F                 U             College     1                  7000     1        High Risk     1             4     1                      2     1                     2     1\n8          M                 S             Unknown     1                  5000     1         Low Risk     1             1     1                      3     1                     1     1\n9          M                 W           Secondary     1                  4500     1         Low Risk     1             1     1                      4     1                     1     1\n10         M                 M             Primary     1                  5500     1        High Risk     1             5     1                      2     1                     2     1\n11         F                 M           Secondary     1                  1000     1          Unknown     1             0     1                      0     1                     4     1\n12         M                 D           Secondary     1                   500     1             Good     1             3     1                      4     1                     1     1\n13         F                 S           Secondary     1                  1000     1          Unknown     1             2     1                      0     1                     4     1\n14         F                 U             Unknown     1                  2500     1             Good     1             2     1                      2     1                     4     1\n15         M                 D         4 yr Degree     1                   500     1         Low Risk     1             5     1                      3     1                     4     1\n16         F                 M         2 yr Degree     1                  5000     1             Good     1             5     1                      4     1                     5     1\n17         M                 D             Unknown     1                  9500     1          Unknown     1             2     1                      1     1                     6     1\n18         F                 U     Advanced Degree     1                  7500     1          Unknown     1             3     1                      5     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0195,
                    "execution_time": 0.007599,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.00482
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055477,
                    "execution_time": 0.007964,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040405
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  5000     1        High Risk     1             6     1                      1     1                     0     1\n1          F                 M           Secondary     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n2          M                 W           Secondary     1                  2500     1         Low Risk     1             3     1                      5     1                     6     1\n3          F                 S             Primary     1                  5500     1             Good     1             2     1                      1     1                     5     1\n4          M                 M             College     1                  3000     1             Good     1             0     1                      6     1                     6     1\n5          M                 S         4 yr Degree     1                  1000     1         Low Risk     1             3     1                      5     1                     2     1\n6          M                 M           Secondary     1                 10000     1        High Risk     1             2     1                      2     1                     4     1\n7          F                 U             College     1                  7000     1        High Risk     1             4     1                      2     1                     2     1\n8          M                 S             Unknown     1                  5000     1         Low Risk     1             1     1                      3     1                     1     1\n9          M                 W           Secondary     1                  4500     1         Low Risk     1             1     1                      4     1                     1     1\n10         M                 M             Primary     1                  5500     1        High Risk     1             5     1                      2     1                     2     1\n11         F                 M           Secondary     1                  1000     1          Unknown     1             0     1                      0     1                     4     1\n12         M                 D           Secondary     1                   500     1             Good     1             3     1                      4     1                     1     1\n13         F                 S           Secondary     1                  1000     1          Unknown     1             2     1                      0     1                     4     1\n14         F                 U             Unknown     1                  2500     1             Good     1             2     1                      2     1                     4     1\n15         M                 D         4 yr Degree     1                   500     1         Low Risk     1             5     1                      3     1                     4     1\n16         F                 M         2 yr Degree     1                  5000     1             Good     1             5     1                      4     1                     5     1\n17         M                 D             Unknown     1                  9500     1          Unknown     1             2     1                      1     1                     6     1\n18         F                 U     Advanced Degree     1                  7500     1          Unknown     1             3     1                      5     1                     1     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 M             Primary     1                  9500     1         Low Risk     1             5     1                      0     1                     1     1\n1          F                 M     Advanced Degree     1                  9000     1        High Risk     1             5     1                      0     1                     1     1\n2          F                 W             Primary     1                  2000     1        High Risk     1             0     1                      3     1                     4     1\n3          F                 W         4 yr Degree     1                  6500     1        High Risk     1             6     1                      4     1                     4     1\n4          F                 S             Primary     1                  1000     1             Good     1             2     1                      2     1                     3     1\n5          M                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     5     1\n6          F                 U         4 yr Degree     1                  8000     1             Good     1             1     1                      5     1                     2     1\n7          M                 U           Secondary     1                  5000     1         Low Risk     1             1     1                      6     1                     6     1\n8          M                 W         2 yr Degree     1                  7500     1         Low Risk     1             6     1                      1     1                     4     1\n9          M                 U           Secondary     1                  2500     1        High Risk     1             0     1                      2     1                     4     1\n10         M                 M             College     1                  6500     1        High Risk     1             6     1                      2     1                     4     1\n11         M                 U             Unknown     1                  8000     1             Good     1             6     1                      5     1                     3     1\n12         F                 M             Primary     1                  8000     1         Low Risk     1             3     1                      6     1                     5     1\n13         F                 W         2 yr Degree     1                  8000     1        High Risk     1             1     1                      3     1                     1     1\n14         F                 M         2 yr Degree     1                 10000     1         Low Risk     1             2     1                      0     1                     4     1\n15         M                 S             College     1                  1000     1        High Risk     1             4     1                      0     1                     5     1\n16         M                 D             Primary     1                  4500     1             Good     1             6     1                      2     1                     4     1\n17         F                 S         4 yr Degree     1                  3000     1          Unknown     1             5     1                      6     1                     1     1\n18         F                 U     Advanced Degree     1                  4500     1             Good     1             2     1                      6     1                     6     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019667,
                    "execution_time": 0.008077,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004862
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054814,
                    "execution_time": 0.007991,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039861
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 M             Primary     1                  9500     1         Low Risk     1             5     1                      0     1                     1     1\n1          F                 M     Advanced Degree     1                  9000     1        High Risk     1             5     1                      0     1                     1     1\n2          F                 W             Primary     1                  2000     1        High Risk     1             0     1                      3     1                     4     1\n3          F                 W         4 yr Degree     1                  6500     1        High Risk     1             6     1                      4     1                     4     1\n4          F                 S             Primary     1                  1000     1             Good     1             2     1                      2     1                     3     1\n5          M                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     5     1\n6          F                 U         4 yr Degree     1                  8000     1             Good     1             1     1                      5     1                     2     1\n7          M                 U           Secondary     1                  5000     1         Low Risk     1             1     1                      6     1                     6     1\n8          M                 W         2 yr Degree     1                  7500     1         Low Risk     1             6     1                      1     1                     4     1\n9          M                 U           Secondary     1                  2500     1        High Risk     1             0     1                      2     1                     4     1\n10         M                 M             College     1                  6500     1        High Risk     1             6     1                      2     1                     4     1\n11         M                 U             Unknown     1                  8000     1             Good     1             6     1                      5     1                     3     1\n12         F                 M             Primary     1                  8000     1         Low Risk     1             3     1                      6     1                     5     1\n13         F                 W         2 yr Degree     1                  8000     1        High Risk     1             1     1                      3     1                     1     1\n14         F                 M         2 yr Degree     1                 10000     1         Low Risk     1             2     1                      0     1                     4     1\n15         M                 S             College     1                  1000     1        High Risk     1             4     1                      0     1                     5     1\n16         M                 D             Primary     1                  4500     1             Good     1             6     1                      2     1                     4     1\n17         F                 S         4 yr Degree     1                  3000     1          Unknown     1             5     1                      6     1                     1     1\n18         F                 U     Advanced Degree     1                  4500     1             Good     1             2     1                      6     1                     6     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 U           Secondary     1                  8500     1             Good     1             3     1                      4     1                     4     1\n1          F                 W             Primary     1                  4500     1             Good     1             3     1                      2     1                     2     1\n2          F                 M     Advanced Degree     1                  5500     1          Unknown     1             0     1                      1     1                     2     1\n3          M                 W             Primary     1                  3500     1          Unknown     1             4     1                      0     1                     6     1\n4          F                 M     Advanced Degree     1                  7000     1         Low Risk     1             1     1                      2     1                     4     1\n5          F                 M         2 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     0     1\n6          M                 S     Advanced Degree     1                  5500     1             Good     1             3     1                      5     1                     3     1\n7          F                 M             Primary     1                   500     1        High Risk     1             6     1                      3     1                     6     1\n8          F                 S             Unknown     1                  1000     1        High Risk     1             4     1                      1     1                     4     1\n9          F                 U         2 yr Degree     1                  4500     1          Unknown     1             4     1                      4     1                     2     1\n10         F                 M     Advanced Degree     1                  4000     1        High Risk     1             0     1                      2     1                     4     1\n11         F                 M         4 yr Degree     1                  7000     1         Low Risk     1             3     1                      1     1                     3     1\n12         F                 W             College     1                  4000     1        High Risk     1             4     1                      2     1                     6     1\n13         M                 W         2 yr Degree     1                  9000     1          Unknown     1             3     1                      3     1                     1     1\n14         M                 U             Unknown     1                  1000     1        High Risk     1             2     1                      4     1                     0     1\n15         M                 D           Secondary     1                  6500     1        High Risk     1             0     1                      2     1                     4     1\n16         F                 U             College     1                  2500     1             Good     1             4     1                      0     1                     2     1\n17         F                 D           Secondary     1                  8500     1          Unknown     1             2     1                      4     1                     3     1\n18         M                 D             Unknown     1                 10000     1         Low Risk     1             5     1                      1     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019501,
                    "execution_time": 0.007935,
                    "compile_time": 5e-05,
                    "planning_time": 0.00476
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019447,
                    "execution_time": 0.007645,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00501
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 U           Secondary     1                  8500     1             Good     1             3     1                      4     1                     4     1\n1          F                 W             Primary     1                  4500     1             Good     1             3     1                      2     1                     2     1\n2          F                 M     Advanced Degree     1                  5500     1          Unknown     1             0     1                      1     1                     2     1\n3          M                 W             Primary     1                  3500     1          Unknown     1             4     1                      0     1                     6     1\n4          F                 M     Advanced Degree     1                  7000     1         Low Risk     1             1     1                      2     1                     4     1\n5          F                 M         2 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     0     1\n6          M                 S     Advanced Degree     1                  5500     1             Good     1             3     1                      5     1                     3     1\n7          F                 M             Primary     1                   500     1        High Risk     1             6     1                      3     1                     6     1\n8          F                 S             Unknown     1                  1000     1        High Risk     1             4     1                      1     1                     4     1\n9          F                 U         2 yr Degree     1                  4500     1          Unknown     1             4     1                      4     1                     2     1\n10         F                 M     Advanced Degree     1                  4000     1        High Risk     1             0     1                      2     1                     4     1\n11         F                 M         4 yr Degree     1                  7000     1         Low Risk     1             3     1                      1     1                     3     1\n12         F                 W             College     1                  4000     1        High Risk     1             4     1                      2     1                     6     1\n13         M                 W         2 yr Degree     1                  9000     1          Unknown     1             3     1                      3     1                     1     1\n14         M                 U             Unknown     1                  1000     1        High Risk     1             2     1                      4     1                     0     1\n15         M                 D           Secondary     1                  6500     1        High Risk     1             0     1                      2     1                     4     1\n16         F                 U             College     1                  2500     1             Good     1             4     1                      0     1                     2     1\n17         F                 D           Secondary     1                  8500     1          Unknown     1             2     1                      4     1                     3     1\n18         M                 D             Unknown     1                 10000     1         Low Risk     1             5     1                      1     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 U           Secondary     1                  8500     1             Good     1             3     1                      4     1                     4     1\n1          F                 W             Primary     1                  4500     1             Good     1             3     1                      2     1                     2     1\n2          F                 M     Advanced Degree     1                  5500     1          Unknown     1             0     1                      1     1                     2     1\n3          M                 W             Primary     1                  3500     1          Unknown     1             4     1                      0     1                     6     1\n4          F                 M     Advanced Degree     1                  7000     1         Low Risk     1             1     1                      2     1                     4     1\n5          F                 M         2 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     0     1\n6          M                 S     Advanced Degree     1                  5500     1             Good     1             3     1                      5     1                     3     1\n7          F                 M             Primary     1                   500     1        High Risk     1             6     1                      3     1                     6     1\n8          F                 S             Unknown     1                  1000     1        High Risk     1             4     1                      1     1                     4     1\n9          F                 U         2 yr Degree     1                  4500     1          Unknown     1             4     1                      4     1                     2     1\n10         F                 M     Advanced Degree     1                  4000     1        High Risk     1             0     1                      2     1                     4     1\n11         F                 M         4 yr Degree     1                  7000     1         Low Risk     1             3     1                      1     1                     3     1\n12         F                 W             College     1                  4000     1        High Risk     1             4     1                      2     1                     6     1\n13         M                 W         2 yr Degree     1                  9000     1          Unknown     1             3     1                      3     1                     1     1\n14         M                 U             Unknown     1                  1000     1        High Risk     1             2     1                      4     1                     0     1\n15         M                 D           Secondary     1                  6500     1        High Risk     1             0     1                      2     1                     4     1\n16         F                 U             College     1                  2500     1             Good     1             4     1                      0     1                     2     1\n17         F                 D           Secondary     1                  8500     1          Unknown     1             2     1                      4     1                     3     1\n18         M                 D             Unknown     1                 10000     1         Low Risk     1             5     1                      1     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019896,
                    "execution_time": 0.008499,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004703
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019528,
                    "execution_time": 0.007725,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004971
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 U           Secondary     1                  8500     1             Good     1             3     1                      4     1                     4     1\n1          F                 W             Primary     1                  4500     1             Good     1             3     1                      2     1                     2     1\n2          F                 M     Advanced Degree     1                  5500     1          Unknown     1             0     1                      1     1                     2     1\n3          M                 W             Primary     1                  3500     1          Unknown     1             4     1                      0     1                     6     1\n4          F                 M     Advanced Degree     1                  7000     1         Low Risk     1             1     1                      2     1                     4     1\n5          F                 M         2 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     0     1\n6          M                 S     Advanced Degree     1                  5500     1             Good     1             3     1                      5     1                     3     1\n7          F                 M             Primary     1                   500     1        High Risk     1             6     1                      3     1                     6     1\n8          F                 S             Unknown     1                  1000     1        High Risk     1             4     1                      1     1                     4     1\n9          F                 U         2 yr Degree     1                  4500     1          Unknown     1             4     1                      4     1                     2     1\n10         F                 M     Advanced Degree     1                  4000     1        High Risk     1             0     1                      2     1                     4     1\n11         F                 M         4 yr Degree     1                  7000     1         Low Risk     1             3     1                      1     1                     3     1\n12         F                 W             College     1                  4000     1        High Risk     1             4     1                      2     1                     6     1\n13         M                 W         2 yr Degree     1                  9000     1          Unknown     1             3     1                      3     1                     1     1\n14         M                 U             Unknown     1                  1000     1        High Risk     1             2     1                      4     1                     0     1\n15         M                 D           Secondary     1                  6500     1        High Risk     1             0     1                      2     1                     4     1\n16         F                 U             College     1                  2500     1             Good     1             4     1                      0     1                     2     1\n17         F                 D           Secondary     1                  8500     1          Unknown     1             2     1                      4     1                     3     1\n18         M                 D             Unknown     1                 10000     1         Low Risk     1             5     1                      1     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  5000     1        High Risk     1             6     1                      1     1                     0     1\n1          F                 M           Secondary     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n2          M                 W           Secondary     1                  2500     1         Low Risk     1             3     1                      5     1                     6     1\n3          F                 S             Primary     1                  5500     1             Good     1             2     1                      1     1                     5     1\n4          M                 M             College     1                  3000     1             Good     1             0     1                      6     1                     6     1\n5          M                 S         4 yr Degree     1                  1000     1         Low Risk     1             3     1                      5     1                     2     1\n6          M                 M           Secondary     1                 10000     1        High Risk     1             2     1                      2     1                     4     1\n7          F                 U             College     1                  7000     1        High Risk     1             4     1                      2     1                     2     1\n8          M                 S             Unknown     1                  5000     1         Low Risk     1             1     1                      3     1                     1     1\n9          M                 W           Secondary     1                  4500     1         Low Risk     1             1     1                      4     1                     1     1\n10         M                 M             Primary     1                  5500     1        High Risk     1             5     1                      2     1                     2     1\n11         F                 M           Secondary     1                  1000     1          Unknown     1             0     1                      0     1                     4     1\n12         M                 D           Secondary     1                   500     1             Good     1             3     1                      4     1                     1     1\n13         F                 S           Secondary     1                  1000     1          Unknown     1             2     1                      0     1                     4     1\n14         F                 U             Unknown     1                  2500     1             Good     1             2     1                      2     1                     4     1\n15         M                 D         4 yr Degree     1                   500     1         Low Risk     1             5     1                      3     1                     4     1\n16         F                 M         2 yr Degree     1                  5000     1             Good     1             5     1                      4     1                     5     1\n17         M                 D             Unknown     1                  9500     1          Unknown     1             2     1                      1     1                     6     1\n18         F                 U     Advanced Degree     1                  7500     1          Unknown     1             3     1                      5     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019791,
                    "execution_time": 0.007615,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004723
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020636,
                    "execution_time": 0.008645,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.005053
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  5000     1        High Risk     1             6     1                      1     1                     0     1\n1          F                 M           Secondary     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n2          M                 W           Secondary     1                  2500     1         Low Risk     1             3     1                      5     1                     6     1\n3          F                 S             Primary     1                  5500     1             Good     1             2     1                      1     1                     5     1\n4          M                 M             College     1                  3000     1             Good     1             0     1                      6     1                     6     1\n5          M                 S         4 yr Degree     1                  1000     1         Low Risk     1             3     1                      5     1                     2     1\n6          M                 M           Secondary     1                 10000     1        High Risk     1             2     1                      2     1                     4     1\n7          F                 U             College     1                  7000     1        High Risk     1             4     1                      2     1                     2     1\n8          M                 S             Unknown     1                  5000     1         Low Risk     1             1     1                      3     1                     1     1\n9          M                 W           Secondary     1                  4500     1         Low Risk     1             1     1                      4     1                     1     1\n10         M                 M             Primary     1                  5500     1        High Risk     1             5     1                      2     1                     2     1\n11         F                 M           Secondary     1                  1000     1          Unknown     1             0     1                      0     1                     4     1\n12         M                 D           Secondary     1                   500     1             Good     1             3     1                      4     1                     1     1\n13         F                 S           Secondary     1                  1000     1          Unknown     1             2     1                      0     1                     4     1\n14         F                 U             Unknown     1                  2500     1             Good     1             2     1                      2     1                     4     1\n15         M                 D         4 yr Degree     1                   500     1         Low Risk     1             5     1                      3     1                     4     1\n16         F                 M         2 yr Degree     1                  5000     1             Good     1             5     1                      4     1                     5     1\n17         M                 D             Unknown     1                  9500     1          Unknown     1             2     1                      1     1                     6     1\n18         F                 U     Advanced Degree     1                  7500     1          Unknown     1             3     1                      5     1                     1     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\ncd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  2000     1          Unknown     1             6     1                      1     1                     3     1\n1          M                 M           Secondary     1                  9000     1          Unknown     1             6     1                      2     1                     0     1\n2          M                 M           Secondary     1                  8000     1             Good     1             4     1                      4     1                     2     1\n3          F                 U         2 yr Degree     1                  8500     1        High Risk     1             6     1                      4     1                     4     1\n4          F                 D             College     1                  9000     1          Unknown     1             2     1                      0     1                     2     1\n5          F                 S             Primary     1                  8500     1             Good     1             5     1                      5     1                     1     1\n6          M                 U             Primary     1                  7500     1        High Risk     1             4     1                      6     1                     6     1\n7          M                 U     Advanced Degree     1                  3500     1        High Risk     1             3     1                      1     1                     2     1\n8          F                 W         4 yr Degree     1                  7000     1        High Risk     1             2     1                      4     1                     0     1\n9          F                 D         2 yr Degree     1                  4500     1          Unknown     1             1     1                      5     1                     2     1\n10         F                 S             Unknown     1                  8500     1         Low Risk     1             3     1                      3     1                     5     1\n11         F                 D             Primary     1                  8500     1          Unknown     1             3     1                      4     1                     1     1\n12         M                 M           Secondary     1                  7000     1        High Risk     1             0     1                      5     1                     3     1\n13         F                 S             Primary     1                  3500     1          Unknown     1             5     1                      4     1                     4     1\n14         F                 S         2 yr Degree     1                  1000     1        High Risk     1             4     1                      0     1                     5     1\n15         F                 U             Unknown     1                  3000     1        High Risk     1             6     1                      4     1                     0     1\n16         F                 D             Unknown     1                  4000     1          Unknown     1             1     1                      2     1                     6     1\n17         F                 S         2 yr Degree     1                  7500     1         Low Risk     1             1     1                      5     1                     4     1\n18         M                 M     Advanced Degree     1                  1500     1         Low Risk     1             2     1                      5     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020098,
                    "execution_time": 0.007823,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004996
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020648,
                    "execution_time": 0.007848,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005102
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  2000     1          Unknown     1             6     1                      1     1                     3     1\n1          M                 M           Secondary     1                  9000     1          Unknown     1             6     1                      2     1                     0     1\n2          M                 M           Secondary     1                  8000     1             Good     1             4     1                      4     1                     2     1\n3          F                 U         2 yr Degree     1                  8500     1        High Risk     1             6     1                      4     1                     4     1\n4          F                 D             College     1                  9000     1          Unknown     1             2     1                      0     1                     2     1\n5          F                 S             Primary     1                  8500     1             Good     1             5     1                      5     1                     1     1\n6          M                 U             Primary     1                  7500     1        High Risk     1             4     1                      6     1                     6     1\n7          M                 U     Advanced Degree     1                  3500     1        High Risk     1             3     1                      1     1                     2     1\n8          F                 W         4 yr Degree     1                  7000     1        High Risk     1             2     1                      4     1                     0     1\n9          F                 D         2 yr Degree     1                  4500     1          Unknown     1             1     1                      5     1                     2     1\n10         F                 S             Unknown     1                  8500     1         Low Risk     1             3     1                      3     1                     5     1\n11         F                 D             Primary     1                  8500     1          Unknown     1             3     1                      4     1                     1     1\n12         M                 M           Secondary     1                  7000     1        High Risk     1             0     1                      5     1                     3     1\n13         F                 S             Primary     1                  3500     1          Unknown     1             5     1                      4     1                     4     1\n14         F                 S         2 yr Degree     1                  1000     1        High Risk     1             4     1                      0     1                     5     1\n15         F                 U             Unknown     1                  3000     1        High Risk     1             6     1                      4     1                     0     1\n16         F                 D             Unknown     1                  4000     1          Unknown     1             1     1                      2     1                     6     1\n17         F                 S         2 yr Degree     1                  7500     1         Low Risk     1             1     1                      5     1                     4     1\n18         M                 M     Advanced Degree     1                  1500     1         Low Risk     1             2     1                      5     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  2000     1          Unknown     1             6     1                      1     1                     3     1\n1          M                 M           Secondary     1                  9000     1          Unknown     1             6     1                      2     1                     0     1\n2          M                 M           Secondary     1                  8000     1             Good     1             4     1                      4     1                     2     1\n3          F                 U         2 yr Degree     1                  8500     1        High Risk     1             6     1                      4     1                     4     1\n4          F                 D             College     1                  9000     1          Unknown     1             2     1                      0     1                     2     1\n5          F                 S             Primary     1                  8500     1             Good     1             5     1                      5     1                     1     1\n6          M                 U             Primary     1                  7500     1        High Risk     1             4     1                      6     1                     6     1\n7          M                 U     Advanced Degree     1                  3500     1        High Risk     1             3     1                      1     1                     2     1\n8          F                 W         4 yr Degree     1                  7000     1        High Risk     1             2     1                      4     1                     0     1\n9          F                 D         2 yr Degree     1                  4500     1          Unknown     1             1     1                      5     1                     2     1\n10         F                 S             Unknown     1                  8500     1         Low Risk     1             3     1                      3     1                     5     1\n11         F                 D             Primary     1                  8500     1          Unknown     1             3     1                      4     1                     1     1\n12         M                 M           Secondary     1                  7000     1        High Risk     1             0     1                      5     1                     3     1\n13         F                 S             Primary     1                  3500     1          Unknown     1             5     1                      4     1                     4     1\n14         F                 S         2 yr Degree     1                  1000     1        High Risk     1             4     1                      0     1                     5     1\n15         F                 U             Unknown     1                  3000     1        High Risk     1             6     1                      4     1                     0     1\n16         F                 D             Unknown     1                  4000     1          Unknown     1             1     1                      2     1                     6     1\n17         F                 S         2 yr Degree     1                  7500     1         Low Risk     1             1     1                      5     1                     4     1\n18         M                 M     Advanced Degree     1                  1500     1         Low Risk     1             2     1                      5     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019581,
                    "execution_time": 0.007806,
                    "compile_time": 5e-05,
                    "planning_time": 0.004772
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01964,
                    "execution_time": 0.007762,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004996
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  2000     1          Unknown     1             6     1                      1     1                     3     1\n1          M                 M           Secondary     1                  9000     1          Unknown     1             6     1                      2     1                     0     1\n2          M                 M           Secondary     1                  8000     1             Good     1             4     1                      4     1                     2     1\n3          F                 U         2 yr Degree     1                  8500     1        High Risk     1             6     1                      4     1                     4     1\n4          F                 D             College     1                  9000     1          Unknown     1             2     1                      0     1                     2     1\n5          F                 S             Primary     1                  8500     1             Good     1             5     1                      5     1                     1     1\n6          M                 U             Primary     1                  7500     1        High Risk     1             4     1                      6     1                     6     1\n7          M                 U     Advanced Degree     1                  3500     1        High Risk     1             3     1                      1     1                     2     1\n8          F                 W         4 yr Degree     1                  7000     1        High Risk     1             2     1                      4     1                     0     1\n9          F                 D         2 yr Degree     1                  4500     1          Unknown     1             1     1                      5     1                     2     1\n10         F                 S             Unknown     1                  8500     1         Low Risk     1             3     1                      3     1                     5     1\n11         F                 D             Primary     1                  8500     1          Unknown     1             3     1                      4     1                     1     1\n12         M                 M           Secondary     1                  7000     1        High Risk     1             0     1                      5     1                     3     1\n13         F                 S             Primary     1                  3500     1          Unknown     1             5     1                      4     1                     4     1\n14         F                 S         2 yr Degree     1                  1000     1        High Risk     1             4     1                      0     1                     5     1\n15         F                 U             Unknown     1                  3000     1        High Risk     1             6     1                      4     1                     0     1\n16         F                 D             Unknown     1                  4000     1          Unknown     1             1     1                      2     1                     6     1\n17         F                 S         2 yr Degree     1                  7500     1         Low Risk     1             1     1                      5     1                     4     1\n18         M                 M     Advanced Degree     1                  1500     1         Low Risk     1             2     1                      5     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 S             Primary     1                  2000     1          Unknown     1             2     1                      5     1                     5     1\n1          F                 U     Advanced Degree     1                  3000     1             Good     1             0     1                      2     1                     1     1\n2          F                 S           Secondary     1                  4500     1          Unknown     1             0     1                      4     1                     4     1\n3          F                 W             Primary     1                  5000     1             Good     1             3     1                      4     1                     4     1\n4          F                 D             Unknown     1                  5000     1          Unknown     1             4     1                      1     1                     0     1\n5          F                 D         4 yr Degree     1                  7500     1         Low Risk     1             5     1                      6     1                     5     1\n6          F                 W             Primary     1                  5500     1          Unknown     1             2     1                      4     1                     1     1\n7          F                 W         4 yr Degree     1                  7500     1        High Risk     1             6     1                      6     1                     3     1\n8          F                 M             Unknown     1                  5000     1             Good     1             0     1                      2     1                     4     1\n9          F                 D           Secondary     1                  4000     1          Unknown     1             6     1                      4     1                     2     1\n10         F                 U         4 yr Degree     1                  8000     1             Good     1             1     1                      5     1                     2     1\n11         F                 D     Advanced Degree     1                  4500     1        High Risk     1             2     1                      0     1                     2     1\n12         F                 W         4 yr Degree     1                   500     1        High Risk     1             1     1                      0     1                     5     1\n13         F                 S         4 yr Degree     1                  3000     1        High Risk     1             6     1                      4     1                     2     1\n14         F                 M     Advanced Degree     1                  9000     1        High Risk     1             5     1                      0     1                     1     1\n15         F                 W         4 yr Degree     1                  1500     1         Low Risk     1             2     1                      1     1                     5     1\n16         F                 S             Primary     1                  1000     1             Good     1             2     1                      2     1                     3     1\n17         F                 D         4 yr Degree     1                  3500     1         Low Risk     1             3     1                      1     1                     1     1\n18         F                 M     Advanced Degree     1                  1000     1          Unknown     1             0     1                      0     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.064909,
                    "execution_time": 0.015811,
                    "compile_time": 0.037041,
                    "planning_time": 0.005086
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.346381,
                    "execution_time": 0.011326,
                    "compile_time": 5.293263,
                    "planning_time": 0.04041
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 S             Primary     1                  2000     1          Unknown     1             2     1                      5     1                     5     1\n1          F                 U     Advanced Degree     1                  3000     1             Good     1             0     1                      2     1                     1     1\n2          F                 S           Secondary     1                  4500     1          Unknown     1             0     1                      4     1                     4     1\n3          F                 W             Primary     1                  5000     1             Good     1             3     1                      4     1                     4     1\n4          F                 D             Unknown     1                  5000     1          Unknown     1             4     1                      1     1                     0     1\n5          F                 D         4 yr Degree     1                  7500     1         Low Risk     1             5     1                      6     1                     5     1\n6          F                 W             Primary     1                  5500     1          Unknown     1             2     1                      4     1                     1     1\n7          F                 W         4 yr Degree     1                  7500     1        High Risk     1             6     1                      6     1                     3     1\n8          F                 M             Unknown     1                  5000     1             Good     1             0     1                      2     1                     4     1\n9          F                 D           Secondary     1                  4000     1          Unknown     1             6     1                      4     1                     2     1\n10         F                 U         4 yr Degree     1                  8000     1             Good     1             1     1                      5     1                     2     1\n11         F                 D     Advanced Degree     1                  4500     1        High Risk     1             2     1                      0     1                     2     1\n12         F                 W         4 yr Degree     1                   500     1        High Risk     1             1     1                      0     1                     5     1\n13         F                 S         4 yr Degree     1                  3000     1        High Risk     1             6     1                      4     1                     2     1\n14         F                 M     Advanced Degree     1                  9000     1        High Risk     1             5     1                      0     1                     1     1\n15         F                 W         4 yr Degree     1                  1500     1         Low Risk     1             2     1                      1     1                     5     1\n16         F                 S             Primary     1                  1000     1             Good     1             2     1                      2     1                     3     1\n17         F                 D         4 yr Degree     1                  3500     1         Low Risk     1             3     1                      1     1                     1     1\n18         F                 M     Advanced Degree     1                  1000     1          Unknown     1             0     1                      0     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D           Secondary     1                  2000     1          Unknown     1             1     1                      6     1                     6     1\n1          F                 D             College     1                  1000     1          Unknown     1             1     1                      4     1                     2     1\n2          F                 D     Advanced Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n3          F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      0     1                     4     1\n4          F                 D         4 yr Degree     1                  6500     1         Low Risk     1             0     1                      4     1                     1     1\n5          F                 D         4 yr Degree     2                  2000     2          Unknown     2             0     2                      2     2                     6     2\n6          F                 D             College     1                  8000     1        High Risk     1             3     1                      6     1                     0     1\n7          F                 D         4 yr Degree     1                  5000     1          Unknown     1             4     1                      4     1                     0     1\n8          F                 D         4 yr Degree     1                  7000     1         Low Risk     1             3     1                      1     1                     4     1\n9          F                 D         2 yr Degree     1                  6000     1             Good     1             5     1                      0     1                     0     1\n10         F                 D             Unknown     1                  3000     1        High Risk     1             3     1                      1     1                     5     1\n11         F                 D     Advanced Degree     1                  8500     1          Unknown     1             1     1                      2     1                     3     1\n12         F                 D         2 yr Degree     1                  3500     1        High Risk     1             4     1                      4     1                     1     1\n13         F                 D             Unknown     1                  9000     1        High Risk     1             1     1                      5     1                     4     1\n14         F                 D             Unknown     1                  2000     1             Good     1             2     1                      4     1                     0     1\n15         F                 D           Secondary     1                  2500     1        High Risk     1             6     1                      3     1                     6     1\n16         F                 D         4 yr Degree     1                  8000     1          Unknown     1             6     1                      5     1                     0     1\n17         F                 D             Primary     2                  6000     2        High Risk     2             3     2                      5     2                     1     2\n18         F                 D     Advanced Degree     1                  8000     1          Unknown     1             5     1                      3     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.051886,
                    "execution_time": 0.011437,
                    "compile_time": 0.028437,
                    "planning_time": 0.00505
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.677431,
                    "execution_time": 0.012407,
                    "compile_time": 4.619967,
                    "planning_time": 0.040606
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D           Secondary     1                  2000     1          Unknown     1             1     1                      6     1                     6     1\n1          F                 D             College     1                  1000     1          Unknown     1             1     1                      4     1                     2     1\n2          F                 D     Advanced Degree     1                   500     1             Good     1             2     1                      3     1                     0     1\n3          F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      0     1                     4     1\n4          F                 D         4 yr Degree     1                  6500     1         Low Risk     1             0     1                      4     1                     1     1\n5          F                 D         4 yr Degree     2                  2000     2          Unknown     2             0     2                      2     2                     6     2\n6          F                 D             College     1                  8000     1        High Risk     1             3     1                      6     1                     0     1\n7          F                 D         4 yr Degree     1                  5000     1          Unknown     1             4     1                      4     1                     0     1\n8          F                 D         4 yr Degree     1                  7000     1         Low Risk     1             3     1                      1     1                     4     1\n9          F                 D         2 yr Degree     1                  6000     1             Good     1             5     1                      0     1                     0     1\n10         F                 D             Unknown     1                  3000     1        High Risk     1             3     1                      1     1                     5     1\n11         F                 D     Advanced Degree     1                  8500     1          Unknown     1             1     1                      2     1                     3     1\n12         F                 D         2 yr Degree     1                  3500     1        High Risk     1             4     1                      4     1                     1     1\n13         F                 D             Unknown     1                  9000     1        High Risk     1             1     1                      5     1                     4     1\n14         F                 D             Unknown     1                  2000     1             Good     1             2     1                      4     1                     0     1\n15         F                 D           Secondary     1                  2500     1        High Risk     1             6     1                      3     1                     6     1\n16         F                 D         4 yr Degree     1                  8000     1          Unknown     1             6     1                      5     1                     0     1\n17         F                 D             Primary     2                  6000     2        High Risk     2             3     2                      5     2                     1     2\n18         F                 D     Advanced Degree     1                  8000     1          Unknown     1             5     1                      3     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  9000     1          Unknown     1             1     1                      0     1                     3     1\n1          F                 D         2 yr Degree     1                  9000     1             Good     1             0     1                      6     1                     5     1\n2          F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n3          F                 D         2 yr Degree     1                  9500     1        High Risk     1             5     1                      5     1                     5     1\n4          F                 D         2 yr Degree     1                  7500     1        High Risk     1             6     1                      4     1                     5     1\n5          F                 D         2 yr Degree     1                  7500     1        High Risk     1             3     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                  5500     1        High Risk     1             1     1                      4     1                     6     1\n7          F                 D         2 yr Degree     1                  6000     1        High Risk     1             3     1                      0     1                     0     1\n8          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n9          F                 D         2 yr Degree     1                  4500     1         Low Risk     1             4     1                      4     1                     2     1\n10         F                 D         2 yr Degree     1                  5000     1          Unknown     1             4     1                      3     1                     0     1\n11         F                 D         2 yr Degree     1                  8000     1         Low Risk     1             4     1                      5     1                     4     1\n12         F                 D         2 yr Degree     1                  7000     1             Good     1             5     1                      4     1                     6     1\n13         F                 D         2 yr Degree     1                  8000     1         Low Risk     1             0     1                      1     1                     6     1\n14         F                 D         2 yr Degree     1                  2500     1        High Risk     1             0     1                      2     1                     6     1\n15         F                 D         2 yr Degree     1                 10000     1        High Risk     1             4     1                      6     1                     4     1\n16         F                 D         2 yr Degree     1                  5000     1             Good     1             5     1                      6     1                     3     1\n17         F                 D         2 yr Degree     1                  2500     1        High Risk     1             1     1                      5     1                     5     1\n18         F                 D         2 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     0     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040866,
                    "execution_time": 0.011534,
                    "compile_time": 0.016582,
                    "planning_time": 0.005426
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.304796,
                    "execution_time": 0.011565,
                    "compile_time": 4.252166,
                    "planning_time": 0.040223
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  9000     1          Unknown     1             1     1                      0     1                     3     1\n1          F                 D         2 yr Degree     1                  9000     1             Good     1             0     1                      6     1                     5     1\n2          F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n3          F                 D         2 yr Degree     1                  9500     1        High Risk     1             5     1                      5     1                     5     1\n4          F                 D         2 yr Degree     1                  7500     1        High Risk     1             6     1                      4     1                     5     1\n5          F                 D         2 yr Degree     1                  7500     1        High Risk     1             3     1                      0     1                     6     1\n6          F                 D         2 yr Degree     1                  5500     1        High Risk     1             1     1                      4     1                     6     1\n7          F                 D         2 yr Degree     1                  6000     1        High Risk     1             3     1                      0     1                     0     1\n8          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n9          F                 D         2 yr Degree     1                  4500     1         Low Risk     1             4     1                      4     1                     2     1\n10         F                 D         2 yr Degree     1                  5000     1          Unknown     1             4     1                      3     1                     0     1\n11         F                 D         2 yr Degree     1                  8000     1         Low Risk     1             4     1                      5     1                     4     1\n12         F                 D         2 yr Degree     1                  7000     1             Good     1             5     1                      4     1                     6     1\n13         F                 D         2 yr Degree     1                  8000     1         Low Risk     1             0     1                      1     1                     6     1\n14         F                 D         2 yr Degree     1                  2500     1        High Risk     1             0     1                      2     1                     6     1\n15         F                 D         2 yr Degree     1                 10000     1        High Risk     1             4     1                      6     1                     4     1\n16         F                 D         2 yr Degree     1                  5000     1             Good     1             5     1                      6     1                     3     1\n17         F                 D         2 yr Degree     1                  2500     1        High Risk     1             1     1                      5     1                     5     1\n18         F                 D         2 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     0     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n1          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n2          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n4          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n5          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n6          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n9          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n11         F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n15         F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n16         F                 D         2 yr Degree     1                  1000     1        High Risk     1             6     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                  1000     1         Low Risk     1             0     1                      2     1                     0     1\n18         F                 D         2 yr Degree     1                  1000     1         Low Risk     1             3     1                      4     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04165,
                    "execution_time": 0.012011,
                    "compile_time": 0.01688,
                    "planning_time": 0.005493
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.906641,
                    "execution_time": 0.01233,
                    "compile_time": 4.854136,
                    "planning_time": 0.040275
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n1          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n2          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n4          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n5          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n6          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n9          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n11         F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n15         F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n16         F                 D         2 yr Degree     1                  1000     1        High Risk     1             6     1                      1     1                     2     1\n17         F                 D         2 yr Degree     1                  1000     1         Low Risk     1             0     1                      2     1                     0     1\n18         F                 D         2 yr Degree     1                  1000     1         Low Risk     1             3     1                      4     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             3     1                      2     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041328,
                    "execution_time": 0.012849,
                    "compile_time": 0.015576,
                    "planning_time": 0.005604
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.916748,
                    "execution_time": 0.012659,
                    "compile_time": 4.863616,
                    "planning_time": 0.040695
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             3     1                      2     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) as cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041162,
                    "execution_time": 0.012516,
                    "compile_time": 0.015951,
                    "planning_time": 0.005622
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.891909,
                    "execution_time": 0.013546,
                    "compile_time": 4.838165,
                    "planning_time": 0.04071
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/"
    },
    {
        "input": "select /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.C_CURRENT_ADDR_SK = ca.CA_ADDRESS_SK and\n  ca.CA_COUNTY in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd.CD_DEMO_SK = c.C_CURRENT_CDEMO_SK and \n  exists (select *\n          from store_sales ss, date_dim dd\n          where c.C_CUSTOMER_SK = ss.SS_CUSTOMER_SK and\n                ss.SS_SOLD_DATE_SK = dd.D_DATE_SK and\n                dd.D_YEAR = 2000 and\n                dd.D_MOY between 2 and 2+3) and\n   (exists (select *\n            from web_sales ws, date_dim dd\n            where c.C_CUSTOMER_SK = ws.WS_BILL_CUSTOMER_SK and\n                  ws.WS_SOLD_DATE_SK = dd.D_DATE_SK and\n                  dd.D_YEAR = 2000 and\n                  dd.D_MOY between 2 and 2+3) or \n    exists (select * \n            from catalog_sales cs, date_dim dd\n            where c.C_CUSTOMER_SK = cs.CS_SHIP_CUSTOMER_SK and\n                  cs.CS_SOLD_DATE_SK = dd.D_DATE_SK and\n                  dd.D_YEAR = 2000 and\n                  dd.D_MOY between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DD\" AS ( SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 5 AND \"DD\".\"D_MOY\" >= 2 AND \"DD\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DD\" AS \"DD\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DD\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 5 AND \"DD\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.225168,
                    "execution_time": 0.059697,
                    "compile_time": 0.000315,
                    "planning_time": 0.034285,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.305241,
                    "execution_time": 0.082035,
                    "compile_time": 0.000325,
                    "planning_time": 0.090399,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.887649,
                    "execution_time": 0.78662,
                    "compile_time": 0.000335,
                    "planning_time": 0.025388,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.962757,
                    "execution_time": 0.799088,
                    "compile_time": 0.000334,
                    "planning_time": 0.08567,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.450707,
                    "execution_time": 0.349584,
                    "compile_time": 0.000317,
                    "planning_time": 0.026851,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.167858,
                    "execution_time": 1.003452,
                    "compile_time": 0.000335,
                    "planning_time": 0.089133,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.63481,
                    "execution_time": 0.532042,
                    "compile_time": 0.000331,
                    "planning_time": 0.027483,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.393299,
                    "execution_time": 1.22302,
                    "compile_time": 0.000335,
                    "planning_time": 0.095489,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ON \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ON \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.297446,
                    "execution_time": 0.148866,
                    "compile_time": 0.000659,
                    "planning_time": 0.048442,
                    "create_size": 527
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.82487,
                    "execution_time": 2.602919,
                    "compile_time": 0.000629,
                    "planning_time": 0.119926,
                    "create_size": 527
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039192,
                    "execution_time": 0.012014,
                    "compile_time": 0.0142,
                    "planning_time": 0.005794
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.869992,
                    "execution_time": 0.012189,
                    "compile_time": 4.816427,
                    "planning_time": 0.041387
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ON \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ON \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024837,
                    "execution_time": 0.011767,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.005668
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060293,
                    "execution_time": 0.011956,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.040925
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023425,
                    "execution_time": 0.010496,
                    "compile_time": 0.000107,
                    "planning_time": 0.005832
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.066557,
                    "execution_time": 0.010922,
                    "compile_time": 0.042813,
                    "planning_time": 0.005645
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1        High Risk     1             2     1                      1     1                     6     1\n1          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      1     1                     1     1\n2          F                 D         2 yr Degree     1                   500     1        High Risk     1             4     1                      2     1                     0     1\n3          F                 D         2 yr Degree     1                   500     1        High Risk     1             6     1                      5     1                     6     1\n4          F                 D         2 yr Degree     1                   500     1         Low Risk     1             1     1                      2     1                     2     1\n5          F                 D         2 yr Degree     1                   500     1         Low Risk     1             3     1                      3     1                     2     1\n6          F                 D         2 yr Degree     1                   500     1         Low Risk     1             5     1                      5     1                     2     1\n7          F                 D         2 yr Degree     1                   500     1         Low Risk     1             6     1                      5     1                     5     1\n8          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      0     1                     4     1\n9          F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      2     1                     4     1\n10         F                 D         2 yr Degree     1                   500     1          Unknown     1             0     1                      5     1                     1     1\n11         F                 D         2 yr Degree     1                   500     1          Unknown     1             1     1                      5     1                     3     1\n12         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      5     1                     1     1\n13         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n14         F                 D         2 yr Degree     1                   500     1          Unknown     1             5     1                      3     1                     6     1\n15         F                 D         2 yr Degree     1                   500     1          Unknown     1             6     1                      2     1                     1     1\n16         F                 D         2 yr Degree     1                  1000     1             Good     1             3     1                      5     1                     1     1\n17         F                 D         2 yr Degree     1                  1000     1             Good     1             5     1                      6     1                     6     1\n18         F                 D         2 yr Degree     1                  1000     1        High Risk     1             2     1                      6     1                     3     1\n...*/"
    }
]