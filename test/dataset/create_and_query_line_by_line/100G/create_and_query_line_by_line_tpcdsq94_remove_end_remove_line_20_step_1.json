[
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0      6000000         9.178347e+10     -1.840949e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.513288,
                    "execution_time": 0.437637,
                    "compile_time": 0.036667,
                    "planning_time": 0.029641
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.13065,
                    "execution_time": 4.57854,
                    "compile_time": 3.45169,
                    "planning_time": 0.087921
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\"",
                "rewrite": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\""
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0      6000000         9.178347e+10     -1.840949e+10*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere 1=1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
            }
        ],
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-04-01' AS DATE) CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\"",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-04-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0       411202         4.964378e+10     -9.996473e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.309412,
                    "execution_time": 0.242302,
                    "compile_time": 0.000283,
                    "planning_time": 0.05163
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.008862,
                    "execution_time": 1.277185,
                    "compile_time": 4.592525,
                    "planning_time": 0.120489
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-04-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0       411202         4.964378e+10     -9.996473e+09*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         6828         8.373338e+08      -163071174.0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.035039,
                    "execution_time": 0.95203,
                    "compile_time": 0.016055,
                    "planning_time": 0.052033
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.606159,
                    "execution_time": 0.953442,
                    "compile_time": 3.498228,
                    "planning_time": 0.135496
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-04-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         6828         8.373338e+08      -163071174.0*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         6828          34887510.21       -6793595.43*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.021837,
                    "execution_time": 0.937422,
                    "compile_time": 0.017473,
                    "planning_time": 0.052131
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.421258,
                    "execution_time": 0.948771,
                    "compile_time": 3.331755,
                    "planning_time": 0.123195
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-04-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         6828          34887510.21       -6793595.43*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.199714,
                    "execution_time": 0.053892,
                    "compile_time": 0.077802,
                    "planning_time": 0.052895
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.90632,
                    "execution_time": 1.122533,
                    "compile_time": 6.640445,
                    "planning_time": 0.123581
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"WS1\".\"WS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"WS1\".\"WS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"WS1\".\"WS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-04-01' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws1.WS_ORDER_NUMBER) as \"order count\"\n  ,sum(ws1.WS_EXT_SHIP_COST) as \"total shipping cost\"\n  ,sum(ws1.WS_NET_PROFIT) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim dd\n  ,customer_address ca\n  ,web_site ws\nwhere\n    dd.d_date between '2000-04-01' and \n           dateadd(day,60,cast('2000-04-01' as date))\nand ws1.WS_SHIP_DATE_SK = dd.d_date_sk\nand ws1.WS_SHIP_ADDR_SK = ca.ca_address_sk\nand ca.ca_state = 'ND'\nand ws1.WS_WEB_SITE_SK = ws.web_site_sk\nand ws.web_company_name = 'pri'\nand exists (select 1\n            from web_sales ws2\n            where ws1.WS_ORDER_NUMBER = ws2.WS_ORDER_NUMBER \n              and ws2.WS_SALES_PRICE > 100)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WS2\" WHERE \"WS2\".\"WS_SALES_PRICE\" > 100 GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"CA\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CA\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DD\" ON \"DD\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DD\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DD\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WS\" ON \"WS\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WS\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WS2\" WHERE \"WS2\".\"WS_SALES_PRICE\" > 100 GROUP BY \"WS2\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.595317,
                    "execution_time": 0.456452,
                    "compile_time": 0.042034,
                    "planning_time": 0.025702,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.946146,
                    "execution_time": 0.468837,
                    "compile_time": 3.305985,
                    "planning_time": 0.090722,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS1.WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS1.WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS1.WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM AS DD , CUSTOMER_ADDRESS AS CA , WEB_SITE AS WS WHERE DD.D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = DD.D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA.CA_ADDRESS_SK AND CA.CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WS.WEB_SITE_SK AND WS.WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT 1 FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS2.WS_SALES_PRICE > 100 ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1580            2534007.3        -246623.68*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.214475,
                    "execution_time": 1.064977,
                    "compile_time": 0.061767,
                    "planning_time": 0.076319
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.86058,
                    "execution_time": 1.308152,
                    "compile_time": 6.38867,
                    "planning_time": 0.146346
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"CA\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CA\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DD\" ON \"DD\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DD\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DD\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WS\" ON \"WS\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WS\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1580            2534007.3        -246623.68*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select 1\n            from web_sales ws2\n            where ws1.WS_ORDER_NUMBER = ws2.WS_ORDER_NUMBER\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.637549,
                    "execution_time": 0.541841,
                    "compile_time": 0.000262,
                    "planning_time": 0.024796,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.711532,
                    "execution_time": 0.547341,
                    "compile_time": 0.000255,
                    "planning_time": 0.087563,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT 1 FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.249063,
                    "execution_time": 0.155228,
                    "compile_time": 0.000327,
                    "planning_time": 0.076231
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.68937,
                    "execution_time": 0.156611,
                    "compile_time": 4.363752,
                    "planning_time": 0.146709
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n)/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.248363,
                    "execution_time": 0.154316,
                    "compile_time": 0.000312,
                    "planning_time": 0.077012
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.329018,
                    "execution_time": 0.16068,
                    "compile_time": 0.000326,
                    "planning_time": 0.151156
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"WS2\".\"WS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"WS1\".\"WS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.476709,
                    "execution_time": 0.363564,
                    "compile_time": 0.000408,
                    "planning_time": 0.091965
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.820375,
                    "execution_time": 0.375071,
                    "compile_time": 9.25374,
                    "planning_time": 0.165842
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1846           2850330.25        -513132.66*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_sales ws3\n               where ws1.ws_order_number = ws3.ws_order_number\n                 and ws1.ws_item_sk = ws3.ws_item_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"WS2\".\"WS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"WS3\".\"WS_ORDER_NUMBER\" AS \"_U_4\" , \"WS3\".\"WS_ITEM_SK\" AS \"_U_5\" FROM \"WEB_SALES\" AS \"WS3\" GROUP BY \"WS3\".\"WS_ORDER_NUMBER\" , \"WS3\".\"WS_ITEM_SK\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"WS1\".\"WS_ORDER_NUMBER\" AND \"_U_3\".\"_U_5\" = \"WS1\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"WS1\".\"WS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM WEB_SALES AS WS3 WHERE WS1.WS_ORDER_NUMBER = WS3.WS_ORDER_NUMBER AND WS1.WS_ITEM_SK = WS3.WS_ITEM_SK ) LIMIT 21",
                "preview": "\n/*   order count total shipping cost total net profit\n0            0                None             None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.002205,
                    "execution_time": 0.84097,
                    "compile_time": 0.000507,
                    "planning_time": 0.1367
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.674004,
                    "execution_time": 0.867211,
                    "compile_time": 9.567647,
                    "planning_time": 0.207132
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count total shipping cost total net profit\n0            0                None             None*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws1.WS_ORDER_NUMBER) as \"order count\"\n  ,sum(ws1.WS_EXT_SHIP_COST) as \"total shipping cost\"\n  ,sum(ws1.WS_NET_PROFIT) as \"total net profit\"\nfrom\n   web_sales ws1\nwhere\n    exists (select *\n            from web_sales ws2\n            where ws1.WS_ORDER_NUMBER = ws2.WS_ORDER_NUMBER\n              and ws1.WS_WAREHOUSE_SK <> ws2.WS_WAREHOUSE_SK)\nand not exists(select * from web_returns wr1\n               where ws1.WS_ORDER_NUMBER = wr1.WR_ORDER_NUMBER)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"WS2\".\"WS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"WR1\".\"WR_ORDER_NUMBER\" AS \"_U_4\" FROM \"WEB_RETURNS\" AS \"WR1\" GROUP BY \"WR1\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"WS1\".\"WS_ORDER_NUMBER\" WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"WS1\".\"WS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS1.WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS1.WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS1.WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 WHERE EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM WEB_RETURNS AS WR1 WHERE WS1.WS_ORDER_NUMBER = WR1.WR_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0      1758828         2.535756e+10     -5.090335e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.97495,
                    "execution_time": 1.868731,
                    "compile_time": 0.000336,
                    "planning_time": 0.087313
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.863987,
                    "execution_time": 1.869369,
                    "compile_time": 8.813615,
                    "planning_time": 0.155409
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0      1758828         2.535756e+10     -5.090335e+09*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_returns wr1\n               where ws1.ws_order_number = wr1.wr_order_number)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"WS2\".\"WS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"WR1\".\"WR_ORDER_NUMBER\" AS \"_U_4\" FROM \"WEB_RETURNS\" AS \"WR1\" GROUP BY \"WR1\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"WS1\".\"WS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM WEB_RETURNS AS WR1 WHERE WS1.WS_ORDER_NUMBER = WR1.WR_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0          534            848869.63        -170817.62*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.432408,
                    "execution_time": 0.278045,
                    "compile_time": 0.000494,
                    "planning_time": 0.130245
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.155791,
                    "execution_time": 0.27935,
                    "compile_time": 4.640094,
                    "planning_time": 0.209457
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0          534            848869.63        -170817.62*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_returns wr1\n               where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"WS2\".\"WS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"WR1\".\"WR_ORDER_NUMBER\" AS \"_U_4\" FROM \"WEB_RETURNS\" AS \"WR1\" GROUP BY \"WR1\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"WS1\".\"WS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL ORDER BY COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM WEB_RETURNS AS WR1 WHERE WS1.WS_ORDER_NUMBER = WR1.WR_ORDER_NUMBER ) ORDER BY COUNT ( DISTINCT WS_ORDER_NUMBER ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0          534            848869.63        -170817.62*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.429187,
                    "execution_time": 0.279921,
                    "compile_time": 0.000457,
                    "planning_time": 0.126381
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.700656,
                    "execution_time": 0.277908,
                    "compile_time": 0.194562,
                    "planning_time": 0.204576
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0          534            848869.63        -170817.62*/"
    },
    {
        "input": "-- start template query94.tpl query 17 in stream 0\nselect /* TPC-DS query94.tpl 0.17 */  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2000-4-01' and \n           dateadd(day,60,cast('2000-4-01' as date))\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state = 'ND'\nand ws1.ws_web_site_sk = web_site_sk\nand web_company_name = 'pri'\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_returns wr1\n               where ws1.ws_order_number = wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"WS2\".\"WS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"WS2\".\"WS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"WEB_SALES\" AS \"WS2\" GROUP BY \"WS2\".\"WS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"WR1\".\"WR_ORDER_NUMBER\" AS \"_U_4\" FROM \"WEB_RETURNS\" AS \"WR1\" GROUP BY \"WR1\".\"WR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"WS1\".\"WS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"WS1\".\"WS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"WEB_SALES\" AS \"WS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"WS1\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"WS1\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WS1\".\"WS_SHIP_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'ND' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-04-01' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WS1\".\"WS_SHIP_DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SITE\".\"WEB_COMPANY_NAME\" = 'pri' AND \"WEB_SITE\".\"WEB_SITE_SK\" = \"WS1\".\"WS_WEB_SITE_SK\" WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"WS1\".\"WS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL ORDER BY COUNT ( DISTINCT \"WS1\".\"WS_ORDER_NUMBER\" ) NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT WS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( WS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( WS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM WEB_SALES AS WS1 , DATE_DIM , CUSTOMER_ADDRESS , WEB_SITE WHERE D_DATE BETWEEN '2000-04-01' AND DATEADD ( DAY , 60 , CAST ( '2000-04-01' AS DATE ) ) AND WS1.WS_SHIP_DATE_SK = D_DATE_SK AND WS1.WS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'ND' AND WS1.WS_WEB_SITE_SK = WEB_SITE_SK AND WEB_COMPANY_NAME = 'pri' AND EXISTS ( SELECT * FROM WEB_SALES AS WS2 WHERE WS1.WS_ORDER_NUMBER = WS2.WS_ORDER_NUMBER AND WS1.WS_WAREHOUSE_SK <> WS2.WS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM WEB_RETURNS AS WR1 WHERE WS1.WS_ORDER_NUMBER = WR1.WR_ORDER_NUMBER ) ORDER BY COUNT ( DISTINCT WS_ORDER_NUMBER ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0          534            848869.63        -170817.62*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.428593,
                    "execution_time": 0.277443,
                    "compile_time": 0.000449,
                    "planning_time": 0.128212
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.427463,
                    "execution_time": 0.277947,
                    "compile_time": 0.000448,
                    "planning_time": 0.126815
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0          534            848869.63        -170817.62*/"
    }
]