[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inventory.inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      \n      \n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > dateadd(day, 5, d1.d_date)\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > TS_OR_DS_ADD ( 'DAY' , 5 , D_DATE , TIMESTAMP ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ , SUM ( CASE WHEN P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS NO_PROMO , SUM ( CASE WHEN NOT P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS PROMO , COUNT ( * ) AS TOTAL_CNT FROM CATALOG_SALES JOIN INVENTORY ON ( CS_ITEM_SK = INV_ITEM_SK ) JOIN WAREHOUSE ON ( W_WAREHOUSE_SK = INV_WAREHOUSE_SK ) JOIN ITEM ON ( I_ITEM_SK = CS_ITEM_SK ) JOIN CUSTOMER_DEMOGRAPHICS ON ( CS_BILL_CDEMO_SK = CD_DEMO_SK ) JOIN HOUSEHOLD_DEMOGRAPHICS ON ( CS_BILL_HDEMO_SK = HD_DEMO_SK ) JOIN DATE_DIM AS D1 ON ( CS_SOLD_DATE_SK = D1.D_DATE_SK ) JOIN DATE_DIM AS D2 ON ( INV_DATE_SK = D2.D_DATE_SK ) JOIN DATE_DIM AS D3 ON ( CS_SHIP_DATE_SK = D3.D_DATE_SK ) LEFT OUTER JOIN PROMOTION ON ( CS_PROMO_SK = P_PROMO_SK ) LEFT OUTER JOIN CATALOG_RETURNS ON ( CR_ITEM_SK = CS_ITEM_SK AND CR_ORDER_NUMBER = CS_ORDER_NUMBER ) WHERE D1.D_WEEK_SEQ = D2.D_WEEK_SEQ AND INV_QUANTITY_ON_HAND < CS_QUANTITY AND D3.D_DATE > DATEADD ( DAY , 5 , D1.D_DATE ) AND HD_BUY_POTENTIAL = '1001-5000' AND D1.D_YEAR = 2000 GROUP BY I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                          i_item_desc     w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                         Ready skills cannot discern in a cuts. Local minutes used to embarrass forever unhappy, worthy words. Only little classes s          Rooms cook         5218         0      1          1\n1                                                                                                                                                Much labour girls think. Violent, vast words include          Rooms cook         5218         0      1          1\n2                                                                                                                          Accessible, sure opportunities used to help; too good films would not see      National, comple        5218         0      1          1\n3                                                               Earnings could remember economic shares. Theories take only by a walls. Natural, correct eyes could touch further. Strings result lat     National, comple        5218         0      1          1\n4                                                                                                                                                    Arrangements reserve jewish, ashamed opinions. K     National, comple        5218         0      1          1\n5                                                                       Hours guarantee here soon possible employees. Married, funny tables could find committees. Important, interesting levels can      National, comple        5218         0      1          1\n6                                                       Girls would not end better. Free, religious situations deny secondary christians. Very military bits used to clean however exceptionally larg     National, comple        5218         0      2          2\n7                                                  Sets will not raise as cautious others. Double, technological effects would hurt once significant, federal foods; large, friendly men want women.      National, comple        5218         0      1          1\n8               Rocks would include never rocks. Rich, national workers affect mammals. Alone commercial parties take still through the bills. Much related angles provide ahead hard reserves. Near   Friendly, suitable         5218         0      1          1\n9                                                                                                                                                                           Inevitably busy voters re  Friendly, suitable         5218         0      1          1\n10                                                                                                                                                                                            Special  Friendly, suitable         5218         0      2          2\n11                                                                                                          Also christian kids ought to ask sometimes. Proud, central articles ought to go nearly sy  Friendly, suitable         5218         0      1          1\n12                                                                                                                                                                                        Royal eyes    New proceedings fo        5218         0      1          1\n13                                                                                                          Changes set even on a subsidies. Exactly severe soldiers must not prevent now then free h   New proceedings fo        5218         0      1          1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 4.832322,
                    "execution_time": 4.630256,
                    "compile_time": 0.000665,
                    "planning_time": 0.168054
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 22.961337,
                    "execution_time": 4.58667,
                    "compile_time": 18.074363,
                    "planning_time": 0.257244
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > TS_OR_DS_ADD('DAY', 5, D_DATE, TIMESTAMP) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*                                                                                                                                                                                          i_item_desc     w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                         Ready skills cannot discern in a cuts. Local minutes used to embarrass forever unhappy, worthy words. Only little classes s          Rooms cook         5218         0      1          1\n1                                                                                                                                                Much labour girls think. Violent, vast words include          Rooms cook         5218         0      1          1\n2                                                                                                                          Accessible, sure opportunities used to help; too good films would not see      National, comple        5218         0      1          1\n3                                                               Earnings could remember economic shares. Theories take only by a walls. Natural, correct eyes could touch further. Strings result lat     National, comple        5218         0      1          1\n4                                                                                                                                                    Arrangements reserve jewish, ashamed opinions. K     National, comple        5218         0      1          1\n5                                                                       Hours guarantee here soon possible employees. Married, funny tables could find committees. Important, interesting levels can      National, comple        5218         0      1          1\n6                                                       Girls would not end better. Free, religious situations deny secondary christians. Very military bits used to clean however exceptionally larg     National, comple        5218         0      2          2\n7                                                  Sets will not raise as cautious others. Double, technological effects would hurt once significant, federal foods; large, friendly men want women.      National, comple        5218         0      1          1\n8               Rocks would include never rocks. Rich, national workers affect mammals. Alone commercial parties take still through the bills. Much related angles provide ahead hard reserves. Near   Friendly, suitable         5218         0      1          1\n9                                                                                                                                                                           Inevitably busy voters re  Friendly, suitable         5218         0      1          1\n10                                                                                                                                                                                            Special  Friendly, suitable         5218         0      2          2\n11                                                                                                          Also christian kids ought to ask sometimes. Proud, central articles ought to go nearly sy  Friendly, suitable         5218         0      1          1\n12                                                                                                                                                                                        Royal eyes    New proceedings fo        5218         0      1          1\n13                                                                                                          Changes set even on a subsidies. Exactly severe soldiers must not prevent now then free h   New proceedings fo        5218         0      1          1\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk = inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk = p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                             i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                                                                                                          Particular ea           Doors canno        5218         0      1          1\n1                                                                            Less particular times trust only excellent honours; unknown, universal places deflect mentally. In general democratic eggs   Local, mass universi        5218         0      1          1\n2                                                                                                                             Also rich members may maintain also sure old criteria. Horizontally long s        Quite effectiv        5218         0      1          1\n3   Foreign, continuous girls describe at least effects. Supposed provisions might not need others; directly awkward costs should rid at least; different vegetables may stay; general, dead institution           Rooms cook         5218         0      1          1\n4                                                                                                                                                                                                      R   Friendly, suitable         5218         0      1          1\n5                                                           European forces would appreciate with a hours. Never chinese points shall frighten in a papers. Real years split only just national others.      New, net purposes        5218         0      1          1\n6                                                                                                                                                     Capital, loyal teachers used to provide better. Fu         Important dem        5218         0      1          1\n7                                                                                                                    Financial, extraordinary clothes will retire briefly. Babies must use already other         Important dem        5218         0      1          1\n8                                                                                                                                                           Specific knees could think rates. Other talk         Important dem        5218         0      1          1\n9                                         Sorry, other odds produce often strong lands; high, objective shareholders would stay almost merely sure deaths. Other, difficult hands may not pay at a state   Conventional childr        5219         0      1          1\n10                                                                       Elaborate consultants absorb never fat, british molecules. Ages send global barriers. Males feel in a words. English times migh   Conventional childr        5219         0      1          1\n11                             Backwards top indicators could demonstrate following boys; straightforward, certain miles let there british times. Teenage, current remains spell by the visits. Like con   Conventional childr        5219         0      1          1\n12                                                                                                                                                                                   Appropriate countri   Conventional childr        5219         0      1          1\n13                                                                                                                                                                                                  Less  Important issues liv        5219         0      1          1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 25.175301,
                    "execution_time": 25.005913,
                    "compile_time": 0.000651,
                    "planning_time": 0.136163
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 24.809535,
                    "execution_time": 24.533501,
                    "compile_time": 0.000637,
                    "planning_time": 0.240031
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": "\n/*                                                                                                                                                                                             i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                                                                                                          Particular ea           Doors canno        5218         0      1          1\n1                                                                            Less particular times trust only excellent honours; unknown, universal places deflect mentally. In general democratic eggs   Local, mass universi        5218         0      1          1\n2                                                                                                                             Also rich members may maintain also sure old criteria. Horizontally long s        Quite effectiv        5218         0      1          1\n3   Foreign, continuous girls describe at least effects. Supposed provisions might not need others; directly awkward costs should rid at least; different vegetables may stay; general, dead institution           Rooms cook         5218         0      1          1\n4                                                                                                                                                                                                      R   Friendly, suitable         5218         0      1          1\n5                                                           European forces would appreciate with a hours. Never chinese points shall frighten in a papers. Real years split only just national others.      New, net purposes        5218         0      1          1\n6                                                                                                                                                     Capital, loyal teachers used to provide better. Fu         Important dem        5218         0      1          1\n7                                                                                                                    Financial, extraordinary clothes will retire briefly. Babies must use already other         Important dem        5218         0      1          1\n8                                                                                                                                                           Specific knees could think rates. Other talk         Important dem        5218         0      1          1\n9                                         Sorry, other odds produce often strong lands; high, objective shareholders would stay almost merely sure deaths. Other, difficult hands may not pay at a state   Conventional childr        5219         0      1          1\n10                                                                       Elaborate consultants absorb never fat, british molecules. Ages send global barriers. Males feel in a words. English times migh   Conventional childr        5219         0      1          1\n11                             Backwards top indicators could demonstrate following boys; straightforward, certain miles let there british times. Teenage, current remains spell by the visits. Like con   Conventional childr        5219         0      1          1\n12                                                                                                                                                                                   Appropriate countri   Conventional childr        5219         0      1          1\n13                                                                                                                                                                                                  Less  Important issues liv        5219         0      1          1\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 24.823584,
                    "execution_time": 24.424647,
                    "compile_time": 0.001128,
                    "planning_time": 0.137345,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 25.455726,
                    "execution_time": 24.881021,
                    "compile_time": 0.161804,
                    "planning_time": 0.136438,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                                                                                   Principles might appear often large                              5218         0      1          1\n1                                                                                                                                              Too long patterns like very long concentrations. Much so                              5218         0      1          1\n2                                                                           Likely, interested centres know shoulders. Long words simplify entirely spots. Sorry centuries might not point with the oth  Important issues liv        5218         0      1          1\n3                                                                                                        Clear, turkish experiments ought to participate at a parents; thus determined requests should   Local, mass universi        5218         0      1          1\n4   African, insufficient states will not present then. Kinds would excuse; maybe british changes will see with a publications. Also possible methods play already european substances. Proper things m      Plain, reluctant        5218         0      1          1\n5    Voters run just scottish, national differences. Careful, premier opportunities reduce by a depths. Sure single origins enjoy. Daughters would not spin always easily small abilities. Signals beat           Rooms cook         5218         0      1          1\n6                                                         Much little hotels may not carry everywhere operations. Various parts might not begin by a lines. Points change well deaf children. New, past  Bad cards must make.        5218         0      1          1\n7                                                                                                                                                                           Other, different definition                              5218         0      1          1\n8                                                                              Severely local boundaries prove existing fathers. Then nice proposals should not achieve in a children. All large roads                               5218         0      1          1\n9                       Reasons make about hands; junior flowers pretend. Far true years would not pay best real healthy times. Political troops may not capitalise more incidentally identical years.            Doors canno        5218         0      1          1\n10                                                            Never chemical members could not feel animals. Fine, new lines approve complete, british points. Standards stop injuries. Grim, little bo           Rooms cook         5218         0      1          1\n11                                                                                                                                                                                   Advantages keep si                              5218         0      1          1\n12                                                                                                                                                                Religious cells take simply. Director        Quite effectiv        5218         0      1          1\n13                                                                                                                                   Left, far bars know frequently environments. Young, live writers m      Plain, reluctant        5218         0      1          1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.076093,
                    "execution_time": 0.00832,
                    "compile_time": 0.057262,
                    "planning_time": 0.003961
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.44223,
                    "execution_time": 0.008007,
                    "compile_time": 3.383894,
                    "planning_time": 0.039594
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                                                                                   Principles might appear often large                              5218         0      1          1\n1                                                                                                                                              Too long patterns like very long concentrations. Much so                              5218         0      1          1\n2                                                                           Likely, interested centres know shoulders. Long words simplify entirely spots. Sorry centuries might not point with the oth  Important issues liv        5218         0      1          1\n3                                                                                                        Clear, turkish experiments ought to participate at a parents; thus determined requests should   Local, mass universi        5218         0      1          1\n4   African, insufficient states will not present then. Kinds would excuse; maybe british changes will see with a publications. Also possible methods play already european substances. Proper things m      Plain, reluctant        5218         0      1          1\n5    Voters run just scottish, national differences. Careful, premier opportunities reduce by a depths. Sure single origins enjoy. Daughters would not spin always easily small abilities. Signals beat           Rooms cook         5218         0      1          1\n6                                                         Much little hotels may not carry everywhere operations. Various parts might not begin by a lines. Points change well deaf children. New, past  Bad cards must make.        5218         0      1          1\n7                                                                                                                                                                           Other, different definition                              5218         0      1          1\n8                                                                              Severely local boundaries prove existing fathers. Then nice proposals should not achieve in a children. All large roads                               5218         0      1          1\n9                       Reasons make about hands; junior flowers pretend. Far true years would not pay best real healthy times. Political troops may not capitalise more incidentally identical years.            Doors canno        5218         0      1          1\n10                                                            Never chemical members could not feel animals. Fine, new lines approve complete, british points. Standards stop injuries. Grim, little bo           Rooms cook         5218         0      1          1\n11                                                                                                                                                                                   Advantages keep si                              5218         0      1          1\n12                                                                                                                                                                Religious cells take simply. Director        Quite effectiv        5218         0      1          1\n13                                                                                                                                   Left, far bars know frequently environments. Young, live writers m      Plain, reluctant        5218         0      1          1\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC , \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" LIMIT 21",
                "preview": "\n/*   i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0               Bad cards must make.        5263         0     11         11\n1                        Doors canno        5262         0      9          9\n2                      Important dem        5270         0      9          9\n3               Local, mass universi        5251         0      9          9\n4                  New, net purposes        5263         0      9          9\n5                   Plain, reluctant        5265         0      9          9\n6                        Rooms cook         5270         0      9          9\n7                Conventional childr        5254         0      8          8\n8                Conventional childr        5265         0      8          8\n9                        Doors canno        5270         0      8          8\n10               Friendly, suitable         5263         0      8          8\n11                     Important dem        5267         0      8          8\n12                  National, comple        5267         0      8          8\n13                  Plain, reluctant        5263         0      8          8\n14                  Please central m        5266         0      8          8\n15                       Rooms cook         5264         0      8          8\n16              Bad cards must make.        5266         0      7          7\n17               Conventional childr        5269         0      7          7\n18                       Doors canno        5267         0      7          7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.050446,
                    "execution_time": 0.0244,
                    "compile_time": 0.015186,
                    "planning_time": 0.004405
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.795001,
                    "execution_time": 0.025731,
                    "compile_time": 4.740569,
                    "planning_time": 0.039657
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST, \"I_ITEM_DESC\" NULLS LAST, \"W_WAREHOUSE_NAME\" NULLS LAST, \"D_WEEK_SEQ\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0               Bad cards must make.        5263         0     11         11\n1                        Doors canno        5262         0      9          9\n2                      Important dem        5270         0      9          9\n3               Local, mass universi        5251         0      9          9\n4                  New, net purposes        5263         0      9          9\n5                   Plain, reluctant        5265         0      9          9\n6                        Rooms cook         5270         0      9          9\n7                Conventional childr        5254         0      8          8\n8                Conventional childr        5265         0      8          8\n9                        Doors canno        5270         0      8          8\n10               Friendly, suitable         5263         0      8          8\n11                     Important dem        5267         0      8          8\n12                  National, comple        5267         0      8          8\n13                  Plain, reluctant        5263         0      8          8\n14                  Please central m        5266         0      8          8\n15                       Rooms cook         5264         0      8          8\n16              Bad cards must make.        5266         0      7          7\n17               Conventional childr        5269         0      7          7\n18                       Doors canno        5267         0      7          7\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC , \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" LIMIT 21",
                "preview": "\n/*   i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0               Bad cards must make.        5263         0     11         11\n1                        Doors canno        5262         0      9          9\n2                      Important dem        5270         0      9          9\n3               Local, mass universi        5251         0      9          9\n4                  New, net purposes        5263         0      9          9\n5                   Plain, reluctant        5265         0      9          9\n6                        Rooms cook         5270         0      9          9\n7                Conventional childr        5254         0      8          8\n8                Conventional childr        5265         0      8          8\n9                        Doors canno        5270         0      8          8\n10               Friendly, suitable         5263         0      8          8\n11                     Important dem        5267         0      8          8\n12                  National, comple        5267         0      8          8\n13                  Plain, reluctant        5263         0      8          8\n14                  Please central m        5266         0      8          8\n15                       Rooms cook         5264         0      8          8\n16              Bad cards must make.        5266         0      7          7\n17               Conventional childr        5269         0      7          7\n18                       Doors canno        5267         0      7          7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035292,
                    "execution_time": 0.024469,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004361
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.036323,
                    "execution_time": 0.025212,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004402
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST, \"I_ITEM_DESC\" NULLS LAST, \"W_WAREHOUSE_NAME\" NULLS LAST, \"D_WEEK_SEQ\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0               Bad cards must make.        5263         0     11         11\n1                        Doors canno        5262         0      9          9\n2                      Important dem        5270         0      9          9\n3               Local, mass universi        5251         0      9          9\n4                  New, net purposes        5263         0      9          9\n5                   Plain, reluctant        5265         0      9          9\n6                        Rooms cook         5270         0      9          9\n7                Conventional childr        5254         0      8          8\n8                Conventional childr        5265         0      8          8\n9                        Doors canno        5270         0      8          8\n10               Friendly, suitable         5263         0      8          8\n11                     Important dem        5267         0      8          8\n12                  National, comple        5267         0      8          8\n13                  Plain, reluctant        5263         0      8          8\n14                  Please central m        5266         0      8          8\n15                       Rooms cook         5264         0      8          8\n16              Bad cards must make.        5266         0      7          7\n17               Conventional childr        5269         0      7          7\n18                       Doors canno        5267         0      7          7\n...*/"
    }
]