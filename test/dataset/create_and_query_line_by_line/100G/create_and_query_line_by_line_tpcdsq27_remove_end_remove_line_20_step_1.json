[
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        'unknown' as s_state, 0 as g_state,\n        0 as agg1,\n        0 as agg2,\n        0 as agg3,\n        0 as agg4\n from item\n where /*CURSOR_IDENTIFIER*/\n       1=1 -- Placeholder condition to fix syntax error\n)\nselect * from results;",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , 'unknown' AS \"S_STATE\" , 0 AS \"G_STATE\" , 0 AS \"AGG1\" , 0 AS \"AGG2\" , 0 AS \"AGG3\" , 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , 'unknown' AS \"S_STATE\" , 0 AS \"G_STATE\" , 0 AS \"AGG1\" , 0 AS \"AGG2\" , 0 AS \"AGG3\" , 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\" LIMIT 21",
                "preview": "\n/*           i_item_id  s_state  g_state  agg1  agg2  agg3  agg4\n0   AAAAAAAAKMAAAAAA  unknown        0     0     0     0     0\n1   AAAAAAAADMBAAAAA  unknown        0     0     0     0     0\n2   AAAAAAAAKBCAAAAA  unknown        0     0     0     0     0\n3   AAAAAAAAECCAAAAA  unknown        0     0     0     0     0\n4   AAAAAAAAMFCAAAAA  unknown        0     0     0     0     0\n5   AAAAAAAAOGCAAAAA  unknown        0     0     0     0     0\n6   AAAAAAAAIHCAAAAA  unknown        0     0     0     0     0\n7   AAAAAAAAMICAAAAA  unknown        0     0     0     0     0\n8   AAAAAAAAMJCAAAAA  unknown        0     0     0     0     0\n9   AAAAAAAAOJCAAAAA  unknown        0     0     0     0     0\n10  AAAAAAAACPCAAAAA  unknown        0     0     0     0     0\n11  AAAAAAAAIPCAAAAA  unknown        0     0     0     0     0\n12  AAAAAAAAABDAAAAA  unknown        0     0     0     0     0\n13  AAAAAAAAGCDAAAAA  unknown        0     0     0     0     0\n14  AAAAAAAALCDAAAAA  unknown        0     0     0     0     0\n15  AAAAAAAAAFDAAAAA  unknown        0     0     0     0     0\n16  AAAAAAAAKJDAAAAA  unknown        0     0     0     0     0\n17  AAAAAAAAEKDAAAAA  unknown        0     0     0     0     0\n18  AAAAAAAAGNDAAAAA  unknown        0     0     0     0     0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.096716,
                    "execution_time": 0.003632,
                    "compile_time": 0.062775,
                    "planning_time": 0.023848
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.401088,
                    "execution_time": 0.003932,
                    "compile_time": 3.309583,
                    "planning_time": 0.078521
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", 'unknown' AS \"S_STATE\", 0 AS \"G_STATE\", 0 AS \"AGG1\", 0 AS \"AGG2\", 0 AS \"AGG3\", 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", 'unknown' AS \"S_STATE\", 0 AS \"G_STATE\", 0 AS \"AGG1\", 0 AS \"AGG2\", 0 AS \"AGG3\", 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": "\n/*           i_item_id  s_state  g_state  agg1  agg2  agg3  agg4\n0   AAAAAAAAKMAAAAAA  unknown        0     0     0     0     0\n1   AAAAAAAADMBAAAAA  unknown        0     0     0     0     0\n2   AAAAAAAAKBCAAAAA  unknown        0     0     0     0     0\n3   AAAAAAAAECCAAAAA  unknown        0     0     0     0     0\n4   AAAAAAAAMFCAAAAA  unknown        0     0     0     0     0\n5   AAAAAAAAOGCAAAAA  unknown        0     0     0     0     0\n6   AAAAAAAAIHCAAAAA  unknown        0     0     0     0     0\n7   AAAAAAAAMICAAAAA  unknown        0     0     0     0     0\n8   AAAAAAAAMJCAAAAA  unknown        0     0     0     0     0\n9   AAAAAAAAOJCAAAAA  unknown        0     0     0     0     0\n10  AAAAAAAACPCAAAAA  unknown        0     0     0     0     0\n11  AAAAAAAAIPCAAAAA  unknown        0     0     0     0     0\n12  AAAAAAAAABDAAAAA  unknown        0     0     0     0     0\n13  AAAAAAAAGCDAAAAA  unknown        0     0     0     0     0\n14  AAAAAAAALCDAAAAA  unknown        0     0     0     0     0\n15  AAAAAAAAAFDAAAAA  unknown        0     0     0     0     0\n16  AAAAAAAAKJDAAAAA  unknown        0     0     0     0     0\n17  AAAAAAAAEKDAAAAA  unknown        0     0     0     0     0\n18  AAAAAAAAGNDAAAAA  unknown        0     0     0     0     0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity as agg1,\n        ss_list_price as agg2,\n        ss_coupon_amt as agg3,\n        ss_sales_price as agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n) /*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.914447,
                    "execution_time": 0.219905,
                    "compile_time": 0.042385,
                    "planning_time": 0.058576,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.533229,
                    "execution_time": 0.293258,
                    "compile_time": 12.467202,
                    "planning_time": 0.139656,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPNHLAAAA      SD        0    37  144.46    47.41    1.44\n1   AAAAAAAACIHGAAAA      SD        0    90   32.20   611.71   14.16\n2   AAAAAAAALIJBCAAA      SD        0    85   23.70     0.00   18.96\n3   AAAAAAAACBMNAAAA      SD        0    14   21.19     0.00   15.25\n4   AAAAAAAAKJKBCAAA      SD        0    44   40.89     0.00    6.95\n5   AAAAAAAAHNMFAAAA      SD        0    50    8.81     0.00    0.00\n6   AAAAAAAACFNOBAAA      SD        0    98   51.49  3302.01   39.64\n7   AAAAAAAAFGHEAAAA      SD        0    94   32.38     0.00   15.86\n8   AAAAAAAAKDIFCAAA      SD        0    39   71.12   187.22   17.78\n9   AAAAAAAAEHJLAAAA      SD        0    50   52.62     0.00    8.94\n10  AAAAAAAAAOOFBAAA      SD        0    29  138.17     0.00  117.44\n11  AAAAAAAAOHFAAAAA      SD        0     3  117.92     0.00  109.66\n12  AAAAAAAALLBLAAAA      SD        0    55   47.44     0.00   26.56\n13  AAAAAAAAHPCLCAAA      SD        0    14    2.23     0.00    2.05\n14  AAAAAAAABIPABAAA      SD        0    55   60.12     0.00   31.26\n15  AAAAAAAAFKGDBAAA      SD        0    94  123.29     0.00   46.85\n16  AAAAAAAAHCNCBAAA      SD        0    15    3.29     0.00    3.09\n17  AAAAAAAAIAHLAAAA      SD        0    85    2.79     0.00    0.50\n18  AAAAAAAANKHABAAA      SD        0    83  180.61     0.00  142.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.084559,
                    "execution_time": 0.008038,
                    "compile_time": 0.06623,
                    "planning_time": 0.003877
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.361627,
                    "execution_time": 0.008171,
                    "compile_time": 3.304527,
                    "planning_time": 0.038919
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPNHLAAAA      SD        0    37  144.46    47.41    1.44\n1   AAAAAAAACIHGAAAA      SD        0    90   32.20   611.71   14.16\n2   AAAAAAAALIJBCAAA      SD        0    85   23.70     0.00   18.96\n3   AAAAAAAACBMNAAAA      SD        0    14   21.19     0.00   15.25\n4   AAAAAAAAKJKBCAAA      SD        0    44   40.89     0.00    6.95\n5   AAAAAAAAHNMFAAAA      SD        0    50    8.81     0.00    0.00\n6   AAAAAAAACFNOBAAA      SD        0    98   51.49  3302.01   39.64\n7   AAAAAAAAFGHEAAAA      SD        0    94   32.38     0.00   15.86\n8   AAAAAAAAKDIFCAAA      SD        0    39   71.12   187.22   17.78\n9   AAAAAAAAEHJLAAAA      SD        0    50   52.62     0.00    8.94\n10  AAAAAAAAAOOFBAAA      SD        0    29  138.17     0.00  117.44\n11  AAAAAAAAOHFAAAAA      SD        0     3  117.92     0.00  109.66\n12  AAAAAAAALLBLAAAA      SD        0    55   47.44     0.00   26.56\n13  AAAAAAAAHPCLCAAA      SD        0    14    2.23     0.00    2.05\n14  AAAAAAAABIPABAAA      SD        0    55   60.12     0.00   31.26\n15  AAAAAAAAFKGDBAAA      SD        0    94  123.29     0.00   46.85\n16  AAAAAAAAHCNCBAAA      SD        0    15    3.29     0.00    3.09\n17  AAAAAAAAIAHLAAAA      SD        0    85    2.79     0.00    0.50\n18  AAAAAAAANKHABAAA      SD        0    83  180.61     0.00  142.68\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n ) \n/*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAOHJEBAAA      MI        0    26   87.42     0.00   18.35\n1   AAAAAAAALMIDAAAA      MI        0    20  103.38     0.00   17.57\n2   AAAAAAAALLIABAAA      MI        0    86  121.43     0.00   75.28\n3   AAAAAAAAGEBDCAAA      MI        0     4   34.59     0.00   25.94\n4   AAAAAAAAHIBLBAAA      MI        0    41    7.24    42.77    2.82\n5   AAAAAAAAKEPEBAAA      MI        0     7  132.39     0.00   21.18\n6   AAAAAAAAKCIHBAAA      MI        0    25    1.62     0.00    1.16\n7   AAAAAAAALMNBAAAA      MI        0    15  106.27     0.00   69.07\n8   AAAAAAAAEOAICAAA      MI        0     7  129.81     0.00   81.78\n9   AAAAAAAAIFNDAAAA      MI        0    13   47.09     0.00    0.47\n10  AAAAAAAAJANNCAAA      MI        0    61   85.41     0.00    0.00\n11  AAAAAAAAGGIGAAAA      MI        0    69   65.10     0.00   26.69\n12  AAAAAAAAHKHLCAAA      MI        0     6   33.34     0.00   33.00\n13  AAAAAAAACBIDAAAA      MI        0    13  101.54     0.00   30.46\n14  AAAAAAAAMCHDCAAA      MI        0    87  152.03     0.00  124.66\n15  AAAAAAAAMKIBBAAA      MI        0    93  122.88     0.00  104.44\n16  AAAAAAAAKKACAAAA      MI        0    66   56.39     0.00   40.03\n17  AAAAAAAABEFPAAAA      MI        0    34   40.37  1173.89   36.73\n18  AAAAAAAADPKDAAAA      MI        0     9   90.40     0.00   81.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017883,
                    "execution_time": 0.007973,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003649
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053235,
                    "execution_time": 0.008716,
                    "compile_time": 5e-05,
                    "planning_time": 0.038361
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAOHJEBAAA      MI        0    26   87.42     0.00   18.35\n1   AAAAAAAALMIDAAAA      MI        0    20  103.38     0.00   17.57\n2   AAAAAAAALLIABAAA      MI        0    86  121.43     0.00   75.28\n3   AAAAAAAAGEBDCAAA      MI        0     4   34.59     0.00   25.94\n4   AAAAAAAAHIBLBAAA      MI        0    41    7.24    42.77    2.82\n5   AAAAAAAAKEPEBAAA      MI        0     7  132.39     0.00   21.18\n6   AAAAAAAAKCIHBAAA      MI        0    25    1.62     0.00    1.16\n7   AAAAAAAALMNBAAAA      MI        0    15  106.27     0.00   69.07\n8   AAAAAAAAEOAICAAA      MI        0     7  129.81     0.00   81.78\n9   AAAAAAAAIFNDAAAA      MI        0    13   47.09     0.00    0.47\n10  AAAAAAAAJANNCAAA      MI        0    61   85.41     0.00    0.00\n11  AAAAAAAAGGIGAAAA      MI        0    69   65.10     0.00   26.69\n12  AAAAAAAAHKHLCAAA      MI        0     6   33.34     0.00   33.00\n13  AAAAAAAACBIDAAAA      MI        0    13  101.54     0.00   30.46\n14  AAAAAAAAMCHDCAAA      MI        0    87  152.03     0.00  124.66\n15  AAAAAAAAMKIBBAAA      MI        0    93  122.88     0.00  104.44\n16  AAAAAAAAKKACAAAA      MI        0    66   56.39     0.00   40.03\n17  AAAAAAAABEFPAAAA      MI        0    34   40.37  1173.89   36.73\n18  AAAAAAAADPKDAAAA      MI        0     9   90.40     0.00   81.36\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n/*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAOHJEBAAA      MI        0    26   87.42     0.00   18.35\n1   AAAAAAAALMIDAAAA      MI        0    20  103.38     0.00   17.57\n2   AAAAAAAALLIABAAA      MI        0    86  121.43     0.00   75.28\n3   AAAAAAAAGEBDCAAA      MI        0     4   34.59     0.00   25.94\n4   AAAAAAAAHIBLBAAA      MI        0    41    7.24    42.77    2.82\n5   AAAAAAAAKEPEBAAA      MI        0     7  132.39     0.00   21.18\n6   AAAAAAAAKCIHBAAA      MI        0    25    1.62     0.00    1.16\n7   AAAAAAAALMNBAAAA      MI        0    15  106.27     0.00   69.07\n8   AAAAAAAAEOAICAAA      MI        0     7  129.81     0.00   81.78\n9   AAAAAAAAIFNDAAAA      MI        0    13   47.09     0.00    0.47\n10  AAAAAAAAJANNCAAA      MI        0    61   85.41     0.00    0.00\n11  AAAAAAAAGGIGAAAA      MI        0    69   65.10     0.00   26.69\n12  AAAAAAAAHKHLCAAA      MI        0     6   33.34     0.00   33.00\n13  AAAAAAAACBIDAAAA      MI        0    13  101.54     0.00   30.46\n14  AAAAAAAAMCHDCAAA      MI        0    87  152.03     0.00  124.66\n15  AAAAAAAAMKIBBAAA      MI        0    93  122.88     0.00  104.44\n16  AAAAAAAAKKACAAAA      MI        0    66   56.39     0.00   40.03\n17  AAAAAAAABEFPAAAA      MI        0    34   40.37  1173.89   36.73\n18  AAAAAAAADPKDAAAA      MI        0     9   90.40     0.00   81.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.052946,
                    "execution_time": 0.008061,
                    "compile_time": 0.035105,
                    "planning_time": 0.003649
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018834,
                    "execution_time": 0.008694,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003771
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAOHJEBAAA      MI        0    26   87.42     0.00   18.35\n1   AAAAAAAALMIDAAAA      MI        0    20  103.38     0.00   17.57\n2   AAAAAAAALLIABAAA      MI        0    86  121.43     0.00   75.28\n3   AAAAAAAAGEBDCAAA      MI        0     4   34.59     0.00   25.94\n4   AAAAAAAAHIBLBAAA      MI        0    41    7.24    42.77    2.82\n5   AAAAAAAAKEPEBAAA      MI        0     7  132.39     0.00   21.18\n6   AAAAAAAAKCIHBAAA      MI        0    25    1.62     0.00    1.16\n7   AAAAAAAALMNBAAAA      MI        0    15  106.27     0.00   69.07\n8   AAAAAAAAEOAICAAA      MI        0     7  129.81     0.00   81.78\n9   AAAAAAAAIFNDAAAA      MI        0    13   47.09     0.00    0.47\n10  AAAAAAAAJANNCAAA      MI        0    61   85.41     0.00    0.00\n11  AAAAAAAAGGIGAAAA      MI        0    69   65.10     0.00   26.69\n12  AAAAAAAAHKHLCAAA      MI        0     6   33.34     0.00   33.00\n13  AAAAAAAACBIDAAAA      MI        0    13  101.54     0.00   30.46\n14  AAAAAAAAMCHDCAAA      MI        0    87  152.03     0.00  124.66\n15  AAAAAAAAMKIBBAAA      MI        0    93  122.88     0.00  104.44\n16  AAAAAAAAKKACAAAA      MI        0    66   56.39     0.00   40.03\n17  AAAAAAAABEFPAAAA      MI        0    34   40.37  1173.89   36.73\n18  AAAAAAAADPKDAAAA      MI        0     9   90.40     0.00   81.36\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id\n/*CURSOR_IDENTIFIER*/ from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.188547,
                    "execution_time": 0.054783,
                    "compile_time": 0.019911,
                    "planning_time": 0.003061,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.457976,
                    "execution_time": 0.054531,
                    "compile_time": 3.226876,
                    "planning_time": 0.058005,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id\n0   AAAAAAAAADGDBAAA\n1   AAAAAAAAMPGHBAAA\n2   AAAAAAAAFIGMAAAA\n3   AAAAAAAANMNDCAAA\n4   AAAAAAAAHLNPAAAA\n5   AAAAAAAAMGPKBAAA\n6   AAAAAAAAOCFGBAAA\n7   AAAAAAAAOMIECAAA\n8   AAAAAAAAOLCICAAA\n9   AAAAAAAAOBHLCAAA\n10  AAAAAAAAEFCIAAAA\n11  AAAAAAAAIEHAAAAA\n12  AAAAAAAAOMONCAAA\n13  AAAAAAAAHAFICAAA\n14  AAAAAAAAICKAAAAA\n15  AAAAAAAAIDHABAAA\n16  AAAAAAAAIDHOAAAA\n17  AAAAAAAABPDCBAAA\n18  AAAAAAAAAILMBAAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015354,
                    "execution_time": 0.006954,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002868
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052855,
                    "execution_time": 0.007453,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.037926
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id\n0   AAAAAAAAADGDBAAA\n1   AAAAAAAAMPGHBAAA\n2   AAAAAAAAFIGMAAAA\n3   AAAAAAAANMNDCAAA\n4   AAAAAAAAHLNPAAAA\n5   AAAAAAAAMGPKBAAA\n6   AAAAAAAAOCFGBAAA\n7   AAAAAAAAOMIECAAA\n8   AAAAAAAAOLCICAAA\n9   AAAAAAAAOBHLCAAA\n10  AAAAAAAAEFCIAAAA\n11  AAAAAAAAIEHAAAAA\n12  AAAAAAAAOMONCAAA\n13  AAAAAAAAHAFICAAA\n14  AAAAAAAAICKAAAAA\n15  AAAAAAAAIDHABAAA\n16  AAAAAAAAIDHOAAAA\n17  AAAAAAAABPDCBAAA\n18  AAAAAAAAAILMBAAA\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAECMKBAAA      MI        0    63   96.96     0.00   86.29\n1   AAAAAAAAFNJHAAAA      MI        0    19  121.40     0.00  104.40\n2   AAAAAAAAMIBBAAAA      MI        0     9    3.54     0.00    2.08\n3   AAAAAAAADMNECAAA      MI        0    36    5.27     0.00    0.42\n4   AAAAAAAABMFOCAAA      MI        0    74   80.91     0.00   32.36\n5   AAAAAAAAMBEPAAAA      MI        0    92   55.11     0.00   17.08\n6   AAAAAAAAMIGECAAA      MI        0    32   19.38     0.00    0.58\n7   AAAAAAAAEFPBBAAA      MI        0    90   57.36     0.00   34.41\n8   AAAAAAAALBPABAAA      MI        0    95  175.59     0.00   38.62\n9   AAAAAAAANMLBAAAA      MI        0    72   33.65     0.00   12.11\n10  AAAAAAAAJBAFBAAA      MI        0    43   82.36     0.00   37.06\n11  AAAAAAAANCDJBAAA      MI        0    86   16.12     0.00    2.25\n12  AAAAAAAAAKADAAAA      MI        0    60   34.37     0.00   30.93\n13  AAAAAAAAMJAMCAAA      MI        0    78  113.51  2726.72   79.45\n14  AAAAAAAACHCMAAAA      MI        0    87   39.18     0.00   21.54\n15  AAAAAAAABIMBAAAA      MI        0     5   10.61     0.00    6.57\n16  AAAAAAAAIDLDAAAA      MI        0    46   80.74     0.00   26.64\n17  AAAAAAAAIOHHBAAA      MI        0    52   51.63     0.00    5.67\n18  AAAAAAAAFCBGCAAA      MI        0    54   91.29     0.00    0.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017158,
                    "execution_time": 0.007593,
                    "compile_time": 5e-05,
                    "planning_time": 0.003665
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017813,
                    "execution_time": 0.00776,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003842
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAECMKBAAA      MI        0    63   96.96     0.00   86.29\n1   AAAAAAAAFNJHAAAA      MI        0    19  121.40     0.00  104.40\n2   AAAAAAAAMIBBAAAA      MI        0     9    3.54     0.00    2.08\n3   AAAAAAAADMNECAAA      MI        0    36    5.27     0.00    0.42\n4   AAAAAAAABMFOCAAA      MI        0    74   80.91     0.00   32.36\n5   AAAAAAAAMBEPAAAA      MI        0    92   55.11     0.00   17.08\n6   AAAAAAAAMIGECAAA      MI        0    32   19.38     0.00    0.58\n7   AAAAAAAAEFPBBAAA      MI        0    90   57.36     0.00   34.41\n8   AAAAAAAALBPABAAA      MI        0    95  175.59     0.00   38.62\n9   AAAAAAAANMLBAAAA      MI        0    72   33.65     0.00   12.11\n10  AAAAAAAAJBAFBAAA      MI        0    43   82.36     0.00   37.06\n11  AAAAAAAANCDJBAAA      MI        0    86   16.12     0.00    2.25\n12  AAAAAAAAAKADAAAA      MI        0    60   34.37     0.00   30.93\n13  AAAAAAAAMJAMCAAA      MI        0    78  113.51  2726.72   79.45\n14  AAAAAAAACHCMAAAA      MI        0    87   39.18     0.00   21.54\n15  AAAAAAAABIMBAAAA      MI        0     5   10.61     0.00    6.57\n16  AAAAAAAAIDLDAAAA      MI        0    46   80.74     0.00   26.64\n17  AAAAAAAAIOHHBAAA      MI        0    52   51.63     0.00    5.67\n18  AAAAAAAAFCBGCAAA      MI        0    54   91.29     0.00    0.91\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAADBLCCAAA      MI        0    18   70.80   395.24   33.27\n1   AAAAAAAACJMIAAAA      MI        0    98   44.18   116.71    3.97\n2   AAAAAAAAIGEHAAAA      MI        0    85  127.56     0.00   35.71\n3   AAAAAAAAHDOICAAA      MI        0     5    2.34     0.00    0.18\n4   AAAAAAAAPDNMAAAA      MI        0    20   33.50     0.00   29.48\n5   AAAAAAAAGGNNAAAA      MI        0    10   19.68     0.00    4.92\n6   AAAAAAAAABOGBAAA      MI        0    94  108.39     0.00   75.87\n7   AAAAAAAAOBHIBAAA      MI        0    75   49.52  2548.84   43.57\n8   AAAAAAAAENBFAAAA      MI        0    34  106.82     0.00    6.40\n9   AAAAAAAAGOPCAAAA      MI        0    90  106.73     0.00   85.38\n10  AAAAAAAAECNNAAAA      SD        0    63    3.55     0.00    0.49\n11  AAAAAAAAEBHBAAAA      SD        0    77   63.73     0.00   46.52\n12  AAAAAAAALGMEBAAA      SD        0   100  100.86     0.00   56.48\n13  AAAAAAAAHEJLAAAA      SD        0    75   19.91   537.19   12.14\n14  AAAAAAAAIIPGBAAA      SD        0    99   66.33   372.25   41.78\n15  AAAAAAAACGJIBAAA      SD        0    33   27.50     0.00    1.92\n16  AAAAAAAAOGGBCAAA      SD        0    93   35.60     0.00    2.49\n17  AAAAAAAAAKPBAAAA      SD        0    75  108.80     0.00  101.18\n18  AAAAAAAAFMKCCAAA      SD        0    90   57.09     0.00   22.83\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01777,
                    "execution_time": 0.008222,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00358
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018215,
                    "execution_time": 0.008332,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003677
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAADBLCCAAA      MI        0    18   70.80   395.24   33.27\n1   AAAAAAAACJMIAAAA      MI        0    98   44.18   116.71    3.97\n2   AAAAAAAAIGEHAAAA      MI        0    85  127.56     0.00   35.71\n3   AAAAAAAAHDOICAAA      MI        0     5    2.34     0.00    0.18\n4   AAAAAAAAPDNMAAAA      MI        0    20   33.50     0.00   29.48\n5   AAAAAAAAGGNNAAAA      MI        0    10   19.68     0.00    4.92\n6   AAAAAAAAABOGBAAA      MI        0    94  108.39     0.00   75.87\n7   AAAAAAAAOBHIBAAA      MI        0    75   49.52  2548.84   43.57\n8   AAAAAAAAENBFAAAA      MI        0    34  106.82     0.00    6.40\n9   AAAAAAAAGOPCAAAA      MI        0    90  106.73     0.00   85.38\n10  AAAAAAAAECNNAAAA      SD        0    63    3.55     0.00    0.49\n11  AAAAAAAAEBHBAAAA      SD        0    77   63.73     0.00   46.52\n12  AAAAAAAALGMEBAAA      SD        0   100  100.86     0.00   56.48\n13  AAAAAAAAHEJLAAAA      SD        0    75   19.91   537.19   12.14\n14  AAAAAAAAIIPGBAAA      SD        0    99   66.33   372.25   41.78\n15  AAAAAAAACGJIBAAA      SD        0    33   27.50     0.00    1.92\n16  AAAAAAAAOGGBCAAA      SD        0    93   35.60     0.00    2.49\n17  AAAAAAAAAKPBAAAA      SD        0    75  108.80     0.00  101.18\n18  AAAAAAAAFMKCCAAA      SD        0    90   57.09     0.00   22.83\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\ngroup by i_item_id, s_state /*CURSOR_IDENTIFIER*/ )",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.847508,
                    "execution_time": 2.098857,
                    "compile_time": 0.302599,
                    "planning_time": 0.059771,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.449792,
                    "execution_time": 2.105768,
                    "compile_time": 6.813632,
                    "planning_time": 0.138444,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAADGKKCAAA      SD        0    27  118.30     0.00  70.53\n1   AAAAAAAALLPLBAAA      SD        0    39   60.87    34.70  16.29\n2   AAAAAAAABOGNAAAA      MI        0    71  107.73     0.00  56.52\n3   AAAAAAAABLPFCAAA      MI        0    79   87.03     0.00  59.03\n4   AAAAAAAAOIOCCAAA      SD        0    18   46.90     0.00  19.06\n5   AAAAAAAABJOCCAAA      SD        0    29   58.52     0.00  31.93\n6   AAAAAAAACGNPCAAA      SD        0    65   62.35     0.00  42.38\n7   AAAAAAAANBMMCAAA      SD        0     4   98.98     0.00  32.50\n8   AAAAAAAAPABNCAAA      SD        0    38   57.39     0.00  22.66\n9   AAAAAAAANLKPAAAA      MI        0    27   31.76     0.00   1.90\n10  AAAAAAAAEIAMBAAA      MI        0    52   65.45     0.00  41.93\n11  AAAAAAAAGCDNCAAA      MI        0    64   44.66     0.00  11.27\n12  AAAAAAAAMLNBAAAA      MI        0    93   48.43  3972.40  47.46\n13  AAAAAAAAMEKMAAAA      MI        0    78   88.35     0.00  24.73\n14  AAAAAAAAKOBOCAAA      MI        0    18     NaN     0.00    NaN\n15  AAAAAAAAFEDLCAAA      SD        0    55  142.36   197.27  12.81\n16  AAAAAAAAKGOEBAAA      SD        0    52  103.29     0.00  45.44\n17  AAAAAAAAAHFJCAAA      MI        0    85   11.86     0.00   3.67\n18  AAAAAAAABDFHAAAA      MI        0    91   98.40     0.00  37.39\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046533,
                    "execution_time": 0.007889,
                    "compile_time": 0.028728,
                    "planning_time": 0.003821
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.153464,
                    "execution_time": 0.008894,
                    "compile_time": 3.095769,
                    "planning_time": 0.039262
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"STORE\".\"S_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAADGKKCAAA      SD        0    27  118.30     0.00  70.53\n1   AAAAAAAALLPLBAAA      SD        0    39   60.87    34.70  16.29\n2   AAAAAAAABOGNAAAA      MI        0    71  107.73     0.00  56.52\n3   AAAAAAAABLPFCAAA      MI        0    79   87.03     0.00  59.03\n4   AAAAAAAAOIOCCAAA      SD        0    18   46.90     0.00  19.06\n5   AAAAAAAABJOCCAAA      SD        0    29   58.52     0.00  31.93\n6   AAAAAAAACGNPCAAA      SD        0    65   62.35     0.00  42.38\n7   AAAAAAAANBMMCAAA      SD        0     4   98.98     0.00  32.50\n8   AAAAAAAAPABNCAAA      SD        0    38   57.39     0.00  22.66\n9   AAAAAAAANLKPAAAA      MI        0    27   31.76     0.00   1.90\n10  AAAAAAAAEIAMBAAA      MI        0    52   65.45     0.00  41.93\n11  AAAAAAAAGCDNCAAA      MI        0    64   44.66     0.00  11.27\n12  AAAAAAAAMLNBAAAA      MI        0    93   48.43  3972.40  47.46\n13  AAAAAAAAMEKMAAAA      MI        0    78   88.35     0.00  24.73\n14  AAAAAAAAKOBOCAAA      MI        0    18     NaN     0.00    NaN\n15  AAAAAAAAFEDLCAAA      SD        0    55  142.36   197.27  12.81\n16  AAAAAAAAKGOEBAAA      SD        0    52  103.29     0.00  45.44\n17  AAAAAAAAAHFJCAAA      MI        0    85   11.86     0.00   3.67\n18  AAAAAAAABDFHAAAA      MI        0    91   98.40     0.00  37.39\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n/*CURSOR_IDENTIFIER*/\n   ) as t",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAAHPEAAAA      SD        0    73   27.85    70.81    2.78\n1   AAAAAAAAHELGAAAA      SD        0    25   69.48     0.00   23.08\n2   AAAAAAAADJLPCAAA      SD        0    43  126.91     0.00   60.88\n3   AAAAAAAAJBDIBAAA      SD        0    19  135.50     0.00   58.26\n4   AAAAAAAAKHAGCAAA      SD        0    29  117.97     0.00  109.71\n5   AAAAAAAAOMJHCAAA      MI        0    55  133.29     0.00   92.48\n6   AAAAAAAAHLJMBAAA      MI        0    59   88.08     0.00   63.72\n7   AAAAAAAAHILJCAAA      MI        0    52   56.27   835.07   29.69\n8   AAAAAAAAEDHPAAAA      MI        0    61   73.74   404.65   15.62\n9   AAAAAAAAKHCKAAAA      SD        0    39   62.77   852.58   49.13\n10  AAAAAAAAPOJJCAAA      SD        0    23   55.20  1039.30   47.42\n11  AAAAAAAANHDPCAAA      SD        0    56   79.00     0.00   31.62\n12  AAAAAAAAMLMBCAAA      SD        0    38   45.17     0.00   32.19\n13  AAAAAAAACCDICAAA      SD        0    27   93.07     0.00   78.60\n14  AAAAAAAADMCHBAAA      MI        0    16   82.20     0.00   28.34\n15  AAAAAAAAONAMCAAA      MI        0    45   93.05     0.00   73.50\n16  AAAAAAAAGFPGAAAA      MI        0     7   31.56     0.00   31.56\n17  AAAAAAAAOHBBCAAA      SD        0    41   42.21     0.00    6.31\n18  AAAAAAAAGOBBBAAA      MI        0    97  143.47     0.00   71.73\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017794,
                    "execution_time": 0.007704,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003979
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018161,
                    "execution_time": 0.007888,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004023
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAAHPEAAAA      SD        0    73   27.85    70.81    2.78\n1   AAAAAAAAHELGAAAA      SD        0    25   69.48     0.00   23.08\n2   AAAAAAAADJLPCAAA      SD        0    43  126.91     0.00   60.88\n3   AAAAAAAAJBDIBAAA      SD        0    19  135.50     0.00   58.26\n4   AAAAAAAAKHAGCAAA      SD        0    29  117.97     0.00  109.71\n5   AAAAAAAAOMJHCAAA      MI        0    55  133.29     0.00   92.48\n6   AAAAAAAAHLJMBAAA      MI        0    59   88.08     0.00   63.72\n7   AAAAAAAAHILJCAAA      MI        0    52   56.27   835.07   29.69\n8   AAAAAAAAEDHPAAAA      MI        0    61   73.74   404.65   15.62\n9   AAAAAAAAKHCKAAAA      SD        0    39   62.77   852.58   49.13\n10  AAAAAAAAPOJJCAAA      SD        0    23   55.20  1039.30   47.42\n11  AAAAAAAANHDPCAAA      SD        0    56   79.00     0.00   31.62\n12  AAAAAAAAMLMBCAAA      SD        0    38   45.17     0.00   32.19\n13  AAAAAAAACCDICAAA      SD        0    27   93.07     0.00   78.60\n14  AAAAAAAADMCHBAAA      MI        0    16   82.20     0.00   28.34\n15  AAAAAAAAONAMCAAA      MI        0    45   93.05     0.00   73.50\n16  AAAAAAAAGFPGAAAA      MI        0     7   31.56     0.00   31.56\n17  AAAAAAAAOHBBCAAA      SD        0    41   42.21     0.00    6.31\n18  AAAAAAAAGOBBBAAA      MI        0    97  143.47     0.00   71.73\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n/*CURSOR_IDENTIFIER*/ select i_item_id, s_state, 0 as g_state, sum(agg1) agg1, sum(agg2) agg2, sum(agg3) agg3, sum(agg4) agg4 from results group by i_item_id, s_state ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , SUM ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.807793,
                    "execution_time": 0.090288,
                    "compile_time": 0.133691,
                    "planning_time": 0.003833,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.632286,
                    "execution_time": 0.109732,
                    "compile_time": 6.872268,
                    "planning_time": 0.058522,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.14187,
                    "execution_time": 0.165445,
                    "compile_time": 0.408542,
                    "planning_time": 0.009197,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.344712,
                    "execution_time": 0.241791,
                    "compile_time": 13.508331,
                    "planning_time": 0.051152,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAANIAFCAAA      SD        0     3   36.07     0.00   17.67\n1   AAAAAAAAELMOAAAA      SD        0    45   36.36     0.00    0.72\n2   AAAAAAAAKIFNCAAA      SD        0    20   78.73     0.00   39.13\n3   AAAAAAAAOPCNCAAA      SD        0    49   70.17  1781.60   64.58\n4   AAAAAAAAGEJGBAAA      SD        0    25   71.30     0.00   59.49\n5   AAAAAAAAILPDAAAA      SD        0    76   33.40     0.00   13.59\n6   AAAAAAAAFOMDAAAA      MI        0    24   97.80  1089.99   38.80\n7   AAAAAAAANMGMAAAA      MI        0    48  104.84   345.61   46.56\n8   AAAAAAAAOJEPBAAA      MI        0    64   63.18    91.75   40.60\n9   AAAAAAAADLCMAAAA      SD        0    84   13.64     0.00    0.13\n10  AAAAAAAAFJLIBAAA      SD        0    27  114.71   198.54   23.31\n11  AAAAAAAAGHEGCAAA      SD        0    71   34.73   654.30   15.91\n12  AAAAAAAAJBCOCAAA      SD        0    36   86.03    27.56   52.24\n13  AAAAAAAADFEABAAA      MI        0    60   92.63   246.02   57.52\n14  AAAAAAAAOOCJCAAA      SD        0    46  112.10     0.00   54.92\n15  AAAAAAAANBFMAAAA      SD        0    67  163.31     0.00  106.15\n16  AAAAAAAANAHJCAAA      SD        0    63   39.90     0.00   25.53\n17  AAAAAAAAPKIEAAAA      MI        0    20   37.25     0.00   24.95\n18  AAAAAAAAKNNBBAAA      SD        0    48   74.05     0.00   52.70\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018378,
                    "execution_time": 0.008417,
                    "compile_time": 5e-05,
                    "planning_time": 0.003753
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.129677,
                    "execution_time": 0.008421,
                    "compile_time": 0.074257,
                    "planning_time": 0.038922
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAANIAFCAAA      SD        0     3   36.07     0.00   17.67\n1   AAAAAAAAELMOAAAA      SD        0    45   36.36     0.00    0.72\n2   AAAAAAAAKIFNCAAA      SD        0    20   78.73     0.00   39.13\n3   AAAAAAAAOPCNCAAA      SD        0    49   70.17  1781.60   64.58\n4   AAAAAAAAGEJGBAAA      SD        0    25   71.30     0.00   59.49\n5   AAAAAAAAILPDAAAA      SD        0    76   33.40     0.00   13.59\n6   AAAAAAAAFOMDAAAA      MI        0    24   97.80  1089.99   38.80\n7   AAAAAAAANMGMAAAA      MI        0    48  104.84   345.61   46.56\n8   AAAAAAAAOJEPBAAA      MI        0    64   63.18    91.75   40.60\n9   AAAAAAAADLCMAAAA      SD        0    84   13.64     0.00    0.13\n10  AAAAAAAAFJLIBAAA      SD        0    27  114.71   198.54   23.31\n11  AAAAAAAAGHEGCAAA      SD        0    71   34.73   654.30   15.91\n12  AAAAAAAAJBCOCAAA      SD        0    36   86.03    27.56   52.24\n13  AAAAAAAADFEABAAA      MI        0    60   92.63   246.02   57.52\n14  AAAAAAAAOOCJCAAA      SD        0    46  112.10     0.00   54.92\n15  AAAAAAAANBFMAAAA      SD        0    67  163.31     0.00  106.15\n16  AAAAAAAANAHJCAAA      SD        0    63   39.90     0.00   25.53\n17  AAAAAAAAPKIEAAAA      MI        0    20   37.25     0.00   24.95\n18  AAAAAAAAKNNBBAAA      SD        0    48   74.05     0.00   52.70\n...*/"
    },
    {
        "input": "with /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX', 'MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4)\n/*CURSOR_IDENTIFIER*/\n        from results\n        group by i_item_id\n   )",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.554767,
                    "execution_time": 0.219166,
                    "compile_time": 0.036709,
                    "planning_time": 0.058796,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.674514,
                    "execution_time": 0.228165,
                    "compile_time": 12.068214,
                    "planning_time": 0.136037,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_6\" AS \"_COL_6\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3  _col_6\n0   AAAAAAAAFADPCAAA    None        1    29   52.24   41.79   33.73\n1   AAAAAAAAAPLOAAAA    None        1    26   94.38   25.97   20.40\n2   AAAAAAAAKEHPBAAA    None        1    62   32.57  563.02   10.09\n3   AAAAAAAAONPPBAAA    None        1    12   58.46    0.00   26.54\n4   AAAAAAAAIDKLAAAA    None        1    54   53.87    3.73   47.14\n5   AAAAAAAALCGOBAAA    None        1    37   99.52    0.00   92.55\n6   AAAAAAAAIBBPAAAA    None        1    72  104.07    0.00   36.74\n7   AAAAAAAAFNNKCAAA    None        1    62   38.37   93.08   14.07\n8   AAAAAAAAEFFCAAAA    None        1    17   81.37    5.83   32.79\n9   AAAAAAAAIEOMCAAA    None        1    56   60.26  102.24   11.91\n10  AAAAAAAAMKGADAAA    None        1     7   57.27    0.00    2.86\n11  AAAAAAAAMAPHBAAA    None        1    50   46.11    0.00   13.37\n12  AAAAAAAAECGDCAAA    None        1    35  101.61    0.00   62.45\n13  AAAAAAAANJGECAAA    None        1    69   58.23  475.65   42.58\n14  AAAAAAAANPAPAAAA    None        1    43   82.51    0.00   37.50\n15  AAAAAAAAOIJBDAAA    None        1    41  107.59    0.00   79.45\n16  AAAAAAAAACHLCAAA    None        1    41   84.26    0.00   47.62\n17  AAAAAAAABOBCBAAA    None        1    24   76.05    0.00   40.89\n18  AAAAAAAAOMKLCAAA    None        1    92  102.32   22.68   53.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039363,
                    "execution_time": 0.008387,
                    "compile_time": 0.021006,
                    "planning_time": 0.003825
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.984393,
                    "execution_time": 0.00868,
                    "compile_time": 2.927895,
                    "planning_time": 0.038714
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_6\" AS \"_COL_6\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3  _col_6\n0   AAAAAAAAFADPCAAA    None        1    29   52.24   41.79   33.73\n1   AAAAAAAAAPLOAAAA    None        1    26   94.38   25.97   20.40\n2   AAAAAAAAKEHPBAAA    None        1    62   32.57  563.02   10.09\n3   AAAAAAAAONPPBAAA    None        1    12   58.46    0.00   26.54\n4   AAAAAAAAIDKLAAAA    None        1    54   53.87    3.73   47.14\n5   AAAAAAAALCGOBAAA    None        1    37   99.52    0.00   92.55\n6   AAAAAAAAIBBPAAAA    None        1    72  104.07    0.00   36.74\n7   AAAAAAAAFNNKCAAA    None        1    62   38.37   93.08   14.07\n8   AAAAAAAAEFFCAAAA    None        1    17   81.37    5.83   32.79\n9   AAAAAAAAIEOMCAAA    None        1    56   60.26  102.24   11.91\n10  AAAAAAAAMKGADAAA    None        1     7   57.27    0.00    2.86\n11  AAAAAAAAMAPHBAAA    None        1    50   46.11    0.00   13.37\n12  AAAAAAAAECGDCAAA    None        1    35  101.61    0.00   62.45\n13  AAAAAAAANJGECAAA    None        1    69   58.23  475.65   42.58\n14  AAAAAAAANPAPAAAA    None        1    43   82.51    0.00   37.50\n15  AAAAAAAAOIJBDAAA    None        1    41  107.59    0.00   79.45\n16  AAAAAAAAACHLCAAA    None        1    41   84.26    0.00   47.62\n17  AAAAAAAABOBCBAAA    None        1    24   76.05    0.00   40.89\n18  AAAAAAAAOMKLCAAA    None        1    92  102.32   22.68   53.04\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\ngroup by i_item_id /*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.510283,
                    "execution_time": 0.213039,
                    "compile_time": 0.000503,
                    "planning_time": 0.059071,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.650859,
                    "execution_time": 0.211751,
                    "compile_time": 0.06147,
                    "planning_time": 0.138052,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAAIKECCAAA    None        1    30  104.83  103.35  32.26\n1   AAAAAAAAHPOABAAA    None        1    40  117.52  118.44  31.91\n2   AAAAAAAAONIEBAAA    None        1    86   75.60    0.00  11.51\n3   AAAAAAAAACHLCAAA    None        1    41   84.26    0.00  47.62\n4   AAAAAAAAJINPBAAA    None        1    44   44.60   56.04  22.46\n5   AAAAAAAAELHNCAAA    None        1    36   72.74    0.00  25.70\n6   AAAAAAAAKJIGBAAA    None        1    46   69.75   13.74  35.14\n7   AAAAAAAAKNHFAAAA    None        1    51   54.37    0.00  20.77\n8   AAAAAAAAGIMIAAAA    None        1    34   94.23    0.00  74.23\n9   AAAAAAAAIDLGAAAA    None        1    44   30.78    0.00  18.39\n10  AAAAAAAAKLENCAAA    None        1    51   43.11  214.28  16.34\n11  AAAAAAAACHPMBAAA    None        1     2   78.75    0.00  48.03\n12  AAAAAAAAEBIHCAAA    None        1    15   77.70    0.00  21.26\n13  AAAAAAAAGLIBDAAA    None        1    25  105.06    0.00   0.84\n14  AAAAAAAALGFHCAAA    None        1    46   85.96  219.07  75.59\n15  AAAAAAAAPNJAAAAA    None        1    47   50.92    0.00  25.31\n16  AAAAAAAAOLAMBAAA    None        1    42   58.58  133.31  21.44\n17  AAAAAAAAGBDGBAAA    None        1    55   99.75   36.57  42.96\n18  AAAAAAAAFDEFCAAA    None        1    27   76.19    0.00  57.86\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018134,
                    "execution_time": 0.008043,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.0039
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.092657,
                    "execution_time": 0.008357,
                    "compile_time": 0.039042,
                    "planning_time": 0.038804
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAAIKECCAAA    None        1    30  104.83  103.35  32.26\n1   AAAAAAAAHPOABAAA    None        1    40  117.52  118.44  31.91\n2   AAAAAAAAONIEBAAA    None        1    86   75.60    0.00  11.51\n3   AAAAAAAAACHLCAAA    None        1    41   84.26    0.00  47.62\n4   AAAAAAAAJINPBAAA    None        1    44   44.60   56.04  22.46\n5   AAAAAAAAELHNCAAA    None        1    36   72.74    0.00  25.70\n6   AAAAAAAAKJIGBAAA    None        1    46   69.75   13.74  35.14\n7   AAAAAAAAKNHFAAAA    None        1    51   54.37    0.00  20.77\n8   AAAAAAAAGIMIAAAA    None        1    34   94.23    0.00  74.23\n9   AAAAAAAAIDLGAAAA    None        1    44   30.78    0.00  18.39\n10  AAAAAAAAKLENCAAA    None        1    51   43.11  214.28  16.34\n11  AAAAAAAACHPMBAAA    None        1     2   78.75    0.00  48.03\n12  AAAAAAAAEBIHCAAA    None        1    15   77.70    0.00  21.26\n13  AAAAAAAAGLIBDAAA    None        1    25  105.06    0.00   0.84\n14  AAAAAAAALGFHCAAA    None        1    46   85.96  219.07  75.59\n15  AAAAAAAAPNJAAAAA    None        1    47   50.92    0.00  25.31\n16  AAAAAAAAOLAMBAAA    None        1    42   58.58  133.31  21.44\n17  AAAAAAAAGBDGBAAA    None        1    55   99.75   36.57  42.96\n18  AAAAAAAAFDEFCAAA    None        1    27   76.19    0.00  57.86\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.762906,
                    "execution_time": 0.155814,
                    "compile_time": 0.046576,
                    "planning_time": 0.008929,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.895187,
                    "execution_time": 0.154719,
                    "compile_time": 3.111342,
                    "planning_time": 0.050636,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3    agg4\n0   AAAAAAAAAMFGCAAA      MI        0    58  129.39  838.96   74.72\n1   AAAAAAAAIJMIBAAA      SD        0    29   92.39    0.00   78.17\n2   AAAAAAAADFLECAAA      SD        0    70  142.17    0.00   54.80\n3   AAAAAAAACOIIAAAA      SD        0    79   58.79    0.00   41.15\n4   AAAAAAAAPAPOCAAA      SD        0    62   90.31  113.05   39.66\n5   AAAAAAAANNMOAAAA      SD        0    22   55.95  578.97   31.33\n6   AAAAAAAAEGDICAAA      SD        0    77   59.54    0.00   23.81\n7   AAAAAAAAAMABDAAA      SD        0    30  119.68    0.00   70.80\n8   AAAAAAAAGMOBBAAA      MI        0    59   87.58    0.00   12.26\n9   AAAAAAAAIMEGCAAA      MI        0    88  118.93    0.00   85.62\n10  AAAAAAAAMPLLBAAA      SD        0    74  111.79   33.07    8.94\n11  AAAAAAAAIECMAAAA      SD        0    72   45.00    0.00    8.47\n12  AAAAAAAAEFNHCAAA      SD        0    35   69.01    0.00   42.59\n13  AAAAAAAACKOACAAA      SD        0    63   57.93  545.94   39.39\n14  AAAAAAAAIMPPAAAA      MI        0    68   32.70    0.00   21.58\n15  AAAAAAAAIHNNCAAA      SD        0    27   16.67    0.99    5.34\n16  AAAAAAAAFEILAAAA      SD        0    20  141.95    0.00  105.03\n17  AAAAAAAAMCNGBAAA      SD        0    47   58.95  257.19   24.72\n18  AAAAAAAAFGCECAAA      SD        0    46   62.71   69.74   44.26\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017324,
                    "execution_time": 0.007644,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003706
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053724,
                    "execution_time": 0.007806,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038738
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3    agg4\n0   AAAAAAAAAMFGCAAA      MI        0    58  129.39  838.96   74.72\n1   AAAAAAAAIJMIBAAA      SD        0    29   92.39    0.00   78.17\n2   AAAAAAAADFLECAAA      SD        0    70  142.17    0.00   54.80\n3   AAAAAAAACOIIAAAA      SD        0    79   58.79    0.00   41.15\n4   AAAAAAAAPAPOCAAA      SD        0    62   90.31  113.05   39.66\n5   AAAAAAAANNMOAAAA      SD        0    22   55.95  578.97   31.33\n6   AAAAAAAAEGDICAAA      SD        0    77   59.54    0.00   23.81\n7   AAAAAAAAAMABDAAA      SD        0    30  119.68    0.00   70.80\n8   AAAAAAAAGMOBBAAA      MI        0    59   87.58    0.00   12.26\n9   AAAAAAAAIMEGCAAA      MI        0    88  118.93    0.00   85.62\n10  AAAAAAAAMPLLBAAA      SD        0    74  111.79   33.07    8.94\n11  AAAAAAAAIECMAAAA      SD        0    72   45.00    0.00    8.47\n12  AAAAAAAAEFNHCAAA      SD        0    35   69.01    0.00   42.59\n13  AAAAAAAACKOACAAA      SD        0    63   57.93  545.94   39.39\n14  AAAAAAAAIMPPAAAA      MI        0    68   32.70    0.00   21.58\n15  AAAAAAAAIHNNCAAA      SD        0    27   16.67    0.99    5.34\n16  AAAAAAAAFEILAAAA      SD        0    20  141.95    0.00  105.03\n17  AAAAAAAAMCNGBAAA      SD        0    47   58.95  257.19   24.72\n18  AAAAAAAAFGCECAAA      SD        0    46   62.71   69.74   44.26\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\nselect NULL AS i_item_id, NULL AS s_state, 2 AS g_state, sum(agg1) agg1, sum(agg2) agg2, sum(agg3) agg3, sum(agg4) agg4 from results\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 2 AS \"G_STATE\" , SUM ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 2 AS \"G_STATE\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.766714,
                    "execution_time": 0.153175,
                    "compile_time": 0.039293,
                    "planning_time": 0.012844,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.56644,
                    "execution_time": 0.153393,
                    "compile_time": 4.806705,
                    "planning_time": 0.054296,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAALGIBAAA      SD        0    82   41.30   284.79   14.93\n1   AAAAAAAACGCECAAA      MI        0    76   64.63     0.00    1.29\n2   AAAAAAAACBNADAAA      SD        0    59  104.75  2545.36   72.15\n3   AAAAAAAAOEOKCAAA      MI        0    32   99.80     0.00   85.82\n4   AAAAAAAAIPIDAAAA      SD        0    54   84.29     0.00   33.48\n5   AAAAAAAAJEKKBAAA      SD        0    70  108.52     0.00  105.26\n6   AAAAAAAAOIPHCAAA      MI        0    52  134.11     0.00  109.97\n7   AAAAAAAANDFMBAAA      MI        0     2   83.01     0.00   39.01\n8   AAAAAAAAKELPBAAA      MI        0    12   75.85   179.84   39.44\n9   AAAAAAAAJKEIAAAA      SD        0     6   62.46     0.00   30.32\n10  AAAAAAAACCGMAAAA      SD        0    85   66.94     0.00    6.71\n11  AAAAAAAAMAKBDAAA      SD        0    51   64.48     0.00   30.64\n12  AAAAAAAACILLCAAA      SD        0    21  141.98     0.00  103.64\n13  AAAAAAAAKHHHBAAA      SD        0    63   33.69     0.00   18.10\n14  AAAAAAAAEBJAAAAA      SD        0    44   34.77   270.81   17.06\n15  AAAAAAAAMEIBAAAA      SD        0    28   39.31     0.00   30.76\n16  AAAAAAAAAIDCBAAA      SD        0    53  105.90   266.29   22.58\n17  AAAAAAAANBNABAAA      MI        0    70   69.96     0.00   10.49\n18  AAAAAAAABFHFBAAA      MI        0    47   79.14     0.00   36.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017984,
                    "execution_time": 0.007795,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003851
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053245,
                    "execution_time": 0.008056,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039009
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAALGIBAAA      SD        0    82   41.30   284.79   14.93\n1   AAAAAAAACGCECAAA      MI        0    76   64.63     0.00    1.29\n2   AAAAAAAACBNADAAA      SD        0    59  104.75  2545.36   72.15\n3   AAAAAAAAOEOKCAAA      MI        0    32   99.80     0.00   85.82\n4   AAAAAAAAIPIDAAAA      SD        0    54   84.29     0.00   33.48\n5   AAAAAAAAJEKKBAAA      SD        0    70  108.52     0.00  105.26\n6   AAAAAAAAOIPHCAAA      MI        0    52  134.11     0.00  109.97\n7   AAAAAAAANDFMBAAA      MI        0     2   83.01     0.00   39.01\n8   AAAAAAAAKELPBAAA      MI        0    12   75.85   179.84   39.44\n9   AAAAAAAAJKEIAAAA      SD        0     6   62.46     0.00   30.32\n10  AAAAAAAACCGMAAAA      SD        0    85   66.94     0.00    6.71\n11  AAAAAAAAMAKBDAAA      SD        0    51   64.48     0.00   30.64\n12  AAAAAAAACILLCAAA      SD        0    21  141.98     0.00  103.64\n13  AAAAAAAAKHHHBAAA      SD        0    63   33.69     0.00   18.10\n14  AAAAAAAAEBJAAAAA      SD        0    44   34.77   270.81   17.06\n15  AAAAAAAAMEIBAAAA      SD        0    28   39.31     0.00   30.76\n16  AAAAAAAAAIDCBAAA      SD        0    53  105.90   266.29   22.58\n17  AAAAAAAANBNABAAA      MI        0    70   69.96     0.00   10.49\n18  AAAAAAAABFHFBAAA      MI        0    47   79.14     0.00   36.09\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity as agg1,\n        ss_list_price as agg2,\n        ss_coupon_amt as agg3,\n        ss_sales_price as agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3, avg(agg4) as agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3,\n         avg(agg4) as agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3,\n/*CURSOR_IDENTIFIER*/ avg(agg4) as agg4 from results)",
        "optimize": [
            "SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.287722,
                    "execution_time": 0.158839,
                    "compile_time": 0.033261,
                    "planning_time": 0.058929,
                    "create_size": 10
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.563851,
                    "execution_time": 0.160787,
                    "compile_time": 10.306703,
                    "planning_time": 0.137115,
                    "create_size": 10
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*  i_item_id s_state  g_state  agg1   agg2    agg3   agg4\n0      None    None        1    50  75.84  194.77  37.94*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033774,
                    "execution_time": 0.007968,
                    "compile_time": 0.015885,
                    "planning_time": 0.003853
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.104802,
                    "execution_time": 0.007819,
                    "compile_time": 3.04911,
                    "planning_time": 0.038837
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*  i_item_id s_state  g_state  agg1   agg2    agg3   agg4\n0      None    None        1    50  75.84  194.77  37.94*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.836195,
                    "execution_time": 0.16211,
                    "compile_time": 0.045452,
                    "planning_time": 0.013165,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.742298,
                    "execution_time": 0.166957,
                    "compile_time": 4.912193,
                    "planning_time": 0.054548,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAJEIJBAAA      MI        0    42   57.08     0.00   31.62\n1   AAAAAAAACDCHCAAA      SD        0    10   46.37     0.00   17.62\n2   AAAAAAAADNHDCAAA      MI        0    90   45.16     0.00   14.90\n3   AAAAAAAAKOIKCAAA      SD        0    45   50.53   734.31   38.07\n4   AAAAAAAAOLBFBAAA      SD        0    45   58.42     0.00   12.64\n5   AAAAAAAAMOFPBAAA      SD        0    67  137.43     0.00   59.43\n6   AAAAAAAAKGKBCAAA      MI        0     9  103.48     0.00   54.84\n7   AAAAAAAAGODAAAAA      MI        0    99   86.46   212.06    6.91\n8   AAAAAAAAOOMFBAAA      SD        0    41  105.43     0.00   67.64\n9   AAAAAAAAKBKLAAAA      MI        0    58   93.75   522.28   32.43\n10  AAAAAAAAGBGKAAAA      MI        0    59  104.13   262.68   39.15\n11  AAAAAAAACDBABAAA      MI        0    99   70.09     0.00   46.25\n12  AAAAAAAAGHMDAAAA      MI        0    66   59.13     0.00   14.19\n13  AAAAAAAAMCLPBAAA      MI        0    69  111.12     0.00   20.00\n14  AAAAAAAAIEOACAAA      SD        0    44   60.60  2702.56   50.45\n15  AAAAAAAAJELFCAAA      SD        0    16  184.87     0.00  162.68\n16  AAAAAAAAIODLBAAA      MI        0    87   92.98  5107.31   76.24\n17  AAAAAAAAMKFNAAAA      MI        0    52    3.57     0.00    1.35\n18  AAAAAAAAHJCFCAAA      MI        0    46  180.33     0.00   14.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018635,
                    "execution_time": 0.008234,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004023
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053734,
                    "execution_time": 0.007852,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039386
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAJEIJBAAA      MI        0    42   57.08     0.00   31.62\n1   AAAAAAAACDCHCAAA      SD        0    10   46.37     0.00   17.62\n2   AAAAAAAADNHDCAAA      MI        0    90   45.16     0.00   14.90\n3   AAAAAAAAKOIKCAAA      SD        0    45   50.53   734.31   38.07\n4   AAAAAAAAOLBFBAAA      SD        0    45   58.42     0.00   12.64\n5   AAAAAAAAMOFPBAAA      SD        0    67  137.43     0.00   59.43\n6   AAAAAAAAKGKBCAAA      MI        0     9  103.48     0.00   54.84\n7   AAAAAAAAGODAAAAA      MI        0    99   86.46   212.06    6.91\n8   AAAAAAAAOOMFBAAA      SD        0    41  105.43     0.00   67.64\n9   AAAAAAAAKBKLAAAA      MI        0    58   93.75   522.28   32.43\n10  AAAAAAAAGBGKAAAA      MI        0    59  104.13   262.68   39.15\n11  AAAAAAAACDBABAAA      MI        0    99   70.09     0.00   46.25\n12  AAAAAAAAGHMDAAAA      MI        0    66   59.13     0.00   14.19\n13  AAAAAAAAMCLPBAAA      MI        0    69  111.12     0.00   20.00\n14  AAAAAAAAIEOACAAA      SD        0    44   60.60  2702.56   50.45\n15  AAAAAAAAJELFCAAA      SD        0    16  184.87     0.00  162.68\n16  AAAAAAAAIODLBAAA      MI        0    87   92.98  5107.31   76.24\n17  AAAAAAAAMKFNAAAA      MI        0    52    3.57     0.00    1.35\n18  AAAAAAAAHJCFCAAA      MI        0    46  180.33     0.00   14.42\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAKCKBDAAA      MI        0    69   66.03     0.00   50.18\n1   AAAAAAAAAFOAAAAA      MI        0    94   63.83     0.00    8.29\n2   AAAAAAAAKFLFAAAA      SD        0    27   82.44     0.00   39.57\n3   AAAAAAAACCEDCAAA      MI        0    85   35.87     0.00   24.75\n4   AAAAAAAAGMNJAAAA      SD        0    67  111.40  3160.66   66.97\n5   AAAAAAAALJEDBAAA      SD        0    45   43.17    14.01    7.97\n6   AAAAAAAAKKGNBAAA      SD        0    76  100.01     0.00   95.05\n7   AAAAAAAAHDEIAAAA      MI        0    78  116.87  4211.06   81.80\n8   AAAAAAAADBAFBAAA      SD        0    44   66.89    13.61   36.95\n9   AAAAAAAAPNPJAAAA      MI        0    22   68.94     0.00    8.27\n10  AAAAAAAAMNFBDAAA      MI        0     3   35.05     0.00   17.87\n11  AAAAAAAACOCICAAA      MI        0    17  122.05   116.18   61.77\n12  AAAAAAAAKIIPCAAA      MI        0    55   60.45     0.00   36.24\n13  AAAAAAAAPEIDBAAA      SD        0    93  163.93     0.00   70.48\n14  AAAAAAAACPNKBAAA      SD        0     7  123.91     0.00    8.67\n15  AAAAAAAAKIEBDAAA      SD        0    54  106.83     0.00   57.81\n16  AAAAAAAAIMCJBAAA      SD        0    60   99.15  1583.84   35.55\n17  AAAAAAAAIFBIAAAA      SD        0    30   66.36     0.00   56.40\n18  AAAAAAAAKKEMBAAA      SD        0    13   63.44  1161.41   55.54\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01831,
                    "execution_time": 0.00785,
                    "compile_time": 5e-05,
                    "planning_time": 0.004072
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018415,
                    "execution_time": 0.007827,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004109
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAKCKBDAAA      MI        0    69   66.03     0.00   50.18\n1   AAAAAAAAAFOAAAAA      MI        0    94   63.83     0.00    8.29\n2   AAAAAAAAKFLFAAAA      SD        0    27   82.44     0.00   39.57\n3   AAAAAAAACCEDCAAA      MI        0    85   35.87     0.00   24.75\n4   AAAAAAAAGMNJAAAA      SD        0    67  111.40  3160.66   66.97\n5   AAAAAAAALJEDBAAA      SD        0    45   43.17    14.01    7.97\n6   AAAAAAAAKKGNBAAA      SD        0    76  100.01     0.00   95.05\n7   AAAAAAAAHDEIAAAA      MI        0    78  116.87  4211.06   81.80\n8   AAAAAAAADBAFBAAA      SD        0    44   66.89    13.61   36.95\n9   AAAAAAAAPNPJAAAA      MI        0    22   68.94     0.00    8.27\n10  AAAAAAAAMNFBDAAA      MI        0     3   35.05     0.00   17.87\n11  AAAAAAAACOCICAAA      MI        0    17  122.05   116.18   61.77\n12  AAAAAAAAKIIPCAAA      MI        0    55   60.45     0.00   36.24\n13  AAAAAAAAPEIDBAAA      SD        0    93  163.93     0.00   70.48\n14  AAAAAAAACPNKBAAA      SD        0     7  123.91     0.00    8.67\n15  AAAAAAAAKIEBDAAA      SD        0    54  106.83     0.00   57.81\n16  AAAAAAAAIMCJBAAA      SD        0    60   99.15  1583.84   35.55\n17  AAAAAAAAIFBIAAAA      SD        0    30   66.36     0.00   56.40\n18  AAAAAAAAKKEMBAAA      SD        0    13   63.44  1161.41   55.54\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA      MI        0    41   13.88     0.00    9.85\n1   AAAAAAAAAAAABAAA      SD        0     7   27.70     0.00   19.66\n2   AAAAAAAAAAAABAAA    None        1    24   20.79     0.00   14.75\n3   AAAAAAAAAAAACAAA      SD        0    33   51.61     0.00   28.52\n4   AAAAAAAAAAAACAAA    None        1    33   51.61     0.00   28.52\n5   AAAAAAAAAAABAAAA      MI        0    25   51.06     0.00   24.40\n6   AAAAAAAAAAABAAAA      SD        0    46   25.98     0.00   15.84\n7   AAAAAAAAAAABAAAA    None        1    32   42.70     0.00   21.55\n8   AAAAAAAAAAABBAAA      SD        0    79  128.65     0.00  118.27\n9   AAAAAAAAAAABBAAA    None        1    79  128.65     0.00  118.27\n10  AAAAAAAAAAACAAAA      SD        0    56   73.26     0.00   54.21\n11  AAAAAAAAAAACAAAA    None        1    56   73.26     0.00   54.21\n12  AAAAAAAAAAACCAAA      MI        0    72   78.76   285.18   46.30\n13  AAAAAAAAAAACCAAA      SD        0    43   71.87     0.00   22.14\n14  AAAAAAAAAAACCAAA    None        1    57   75.31   142.59   34.22\n15  AAAAAAAAAAADBAAA      MI        0    78   47.14    18.07   34.70\n16  AAAAAAAAAAADBAAA    None        1    78   47.14    18.07   34.70\n17  AAAAAAAAAAADCAAA      MI        0    63   67.69  2065.90   57.53\n18  AAAAAAAAAAADCAAA      SD        0     1  108.18     0.00   94.11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.05768,
                    "execution_time": 0.014226,
                    "compile_time": 0.044501,
                    "planning_time": 0.004225
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.461117,
                    "execution_time": 0.015725,
                    "compile_time": 6.407754,
                    "planning_time": 0.039272
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA      MI        0    41   13.88     0.00    9.85\n1   AAAAAAAAAAAABAAA      SD        0     7   27.70     0.00   19.66\n2   AAAAAAAAAAAABAAA    None        1    24   20.79     0.00   14.75\n3   AAAAAAAAAAAACAAA      SD        0    33   51.61     0.00   28.52\n4   AAAAAAAAAAAACAAA    None        1    33   51.61     0.00   28.52\n5   AAAAAAAAAAABAAAA      MI        0    25   51.06     0.00   24.40\n6   AAAAAAAAAAABAAAA      SD        0    46   25.98     0.00   15.84\n7   AAAAAAAAAAABAAAA    None        1    32   42.70     0.00   21.55\n8   AAAAAAAAAAABBAAA      SD        0    79  128.65     0.00  118.27\n9   AAAAAAAAAAABBAAA    None        1    79  128.65     0.00  118.27\n10  AAAAAAAAAAACAAAA      SD        0    56   73.26     0.00   54.21\n11  AAAAAAAAAAACAAAA    None        1    56   73.26     0.00   54.21\n12  AAAAAAAAAAACCAAA      MI        0    72   78.76   285.18   46.30\n13  AAAAAAAAAAACCAAA      SD        0    43   71.87     0.00   22.14\n14  AAAAAAAAAAACCAAA    None        1    57   75.31   142.59   34.22\n15  AAAAAAAAAAADBAAA      MI        0    78   47.14    18.07   34.70\n16  AAAAAAAAAAADBAAA    None        1    78   47.14    18.07   34.70\n17  AAAAAAAAAAADCAAA      MI        0    63   67.69  2065.90   57.53\n18  AAAAAAAAAAADCAAA      SD        0     1  108.18     0.00   94.11\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA      MI        0    41   13.88     0.00    9.85\n1   AAAAAAAAAAAABAAA      SD        0     7   27.70     0.00   19.66\n2   AAAAAAAAAAAABAAA    None        1    24   20.79     0.00   14.75\n3   AAAAAAAAAAAACAAA      SD        0    33   51.61     0.00   28.52\n4   AAAAAAAAAAAACAAA    None        1    33   51.61     0.00   28.52\n5   AAAAAAAAAAABAAAA      MI        0    25   51.06     0.00   24.40\n6   AAAAAAAAAAABAAAA      SD        0    46   25.98     0.00   15.84\n7   AAAAAAAAAAABAAAA    None        1    32   42.70     0.00   21.55\n8   AAAAAAAAAAABBAAA      SD        0    79  128.65     0.00  118.27\n9   AAAAAAAAAAABBAAA    None        1    79  128.65     0.00  118.27\n10  AAAAAAAAAAACAAAA      SD        0    56   73.26     0.00   54.21\n11  AAAAAAAAAAACAAAA    None        1    56   73.26     0.00   54.21\n12  AAAAAAAAAAACCAAA      MI        0    72   78.76   285.18   46.30\n13  AAAAAAAAAAACCAAA      SD        0    43   71.87     0.00   22.14\n14  AAAAAAAAAAACCAAA    None        1    57   75.31   142.59   34.22\n15  AAAAAAAAAAADBAAA      MI        0    78   47.14    18.07   34.70\n16  AAAAAAAAAAADBAAA    None        1    78   47.14    18.07   34.70\n17  AAAAAAAAAAADCAAA      MI        0    63   67.69  2065.90   57.53\n18  AAAAAAAAAAADCAAA      SD        0     1  108.18     0.00   94.11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025363,
                    "execution_time": 0.015115,
                    "compile_time": 7e-05,
                    "planning_time": 0.00396
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.024991,
                    "execution_time": 0.0142,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.00408
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA      MI        0    41   13.88     0.00    9.85\n1   AAAAAAAAAAAABAAA      SD        0     7   27.70     0.00   19.66\n2   AAAAAAAAAAAABAAA    None        1    24   20.79     0.00   14.75\n3   AAAAAAAAAAAACAAA      SD        0    33   51.61     0.00   28.52\n4   AAAAAAAAAAAACAAA    None        1    33   51.61     0.00   28.52\n5   AAAAAAAAAAABAAAA      MI        0    25   51.06     0.00   24.40\n6   AAAAAAAAAAABAAAA      SD        0    46   25.98     0.00   15.84\n7   AAAAAAAAAAABAAAA    None        1    32   42.70     0.00   21.55\n8   AAAAAAAAAAABBAAA      SD        0    79  128.65     0.00  118.27\n9   AAAAAAAAAAABBAAA    None        1    79  128.65     0.00  118.27\n10  AAAAAAAAAAACAAAA      SD        0    56   73.26     0.00   54.21\n11  AAAAAAAAAAACAAAA    None        1    56   73.26     0.00   54.21\n12  AAAAAAAAAAACCAAA      MI        0    72   78.76   285.18   46.30\n13  AAAAAAAAAAACCAAA      SD        0    43   71.87     0.00   22.14\n14  AAAAAAAAAAACCAAA    None        1    57   75.31   142.59   34.22\n15  AAAAAAAAAAADBAAA      MI        0    78   47.14    18.07   34.70\n16  AAAAAAAAAAADBAAA    None        1    78   47.14    18.07   34.70\n17  AAAAAAAAAAADCAAA      MI        0    63   67.69  2065.90   57.53\n18  AAAAAAAAAAADCAAA      SD        0     1  108.18     0.00   94.11\n...*/"
    }
]