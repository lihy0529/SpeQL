[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.444365,
                    "execution_time": 0.257981,
                    "compile_time": 0.048787,
                    "planning_time": 0.090844,
                    "create_size": 308
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 23.005003,
                    "execution_time": 4.471331,
                    "compile_time": 18.591678,
                    "planning_time": 0.089947,
                    "create_size": 308
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0           it is a girl      49  1147.08   49.40\n1              reason 33      53  1279.51   52.30\n2   Did not like the war      52  1127.89   51.33\n3              reason 29      49  1133.47   54.24\n4              reason 31      49  1217.31   48.99\n5    Package was damaged      51  1260.58   48.80\n6            Lost my job      52  1277.86   51.43\n7   Did not get it on ti      51  1210.75   52.22\n8              reason 55      50  1185.86   49.08\n9        Stopped working      51  1290.80   54.20\n10  Found a better exten      49  1285.78   51.47\n11             reason 32      50  1227.35   49.24\n12             reason 37      47  1180.24   52.71\n13             reason 28      51  1331.77   49.94\n14           Did not fit      50  1192.70   48.00\n15             reason 51      53  1156.05   49.24\n16  Did not like the mod      55  1323.00   50.02\n17             reason 41      50  1329.15   51.29\n18             reason 50      52  1201.27   46.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030736,
                    "execution_time": 0.007745,
                    "compile_time": 0.013456,
                    "planning_time": 0.003552
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.194744,
                    "execution_time": 0.007978,
                    "compile_time": 3.137648,
                    "planning_time": 0.039262
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0           it is a girl      49  1147.08   49.40\n1              reason 33      53  1279.51   52.30\n2   Did not like the war      52  1127.89   51.33\n3              reason 29      49  1133.47   54.24\n4              reason 31      49  1217.31   48.99\n5    Package was damaged      51  1260.58   48.80\n6            Lost my job      52  1277.86   51.43\n7   Did not get it on ti      51  1210.75   52.22\n8              reason 55      50  1185.86   49.08\n9        Stopped working      51  1290.80   54.20\n10  Found a better exten      49  1285.78   51.47\n11             reason 32      50  1227.35   49.24\n12             reason 37      47  1180.24   52.71\n13             reason 28      51  1331.77   49.94\n14           Did not fit      50  1192.70   48.00\n15             reason 51      53  1156.05   49.24\n16  Did not like the mod      55  1323.00   50.02\n17             reason 41      50  1329.15   51.29\n18             reason 50      52  1201.27   46.66\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */ substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.435339,
                    "execution_time": 0.292003,
                    "compile_time": 0.000691,
                    "planning_time": 0.09648,
                    "create_size": 280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.967594,
                    "execution_time": 0.299035,
                    "compile_time": 11.409131,
                    "planning_time": 0.200487,
                    "create_size": 280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Not working any more      22   411.96   66.33\n1              reason 45      71  1243.35   84.57\n2             Wrong size      10   279.87    9.49\n3              reason 52      12   346.64   40.23\n4              reason 48      19   212.12   31.59\n5              reason 42      21    70.62   72.79\n6              reason 35      57   807.03   18.76\n7              reason 47      16   260.30   32.28\n8          Parts missing      68  1759.73   70.98\n9              reason 53      18   356.91   55.49\n10             reason 23      23   265.31   40.31\n11  Did not like the mak      17    47.19   33.98\n12             reason 40      68   718.66   15.74\n13  Found a better price       5   261.55   25.63\n14             reason 27       9   176.97   60.34\n15  Does not work with a      16   329.97   59.25\n16             reason 44      41   657.60   57.51\n17             reason 25      29   749.05   39.05\n18             reason 46      13   417.15   57.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016628,
                    "execution_time": 0.007273,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003529
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.109585,
                    "execution_time": 0.008066,
                    "compile_time": 0.053751,
                    "planning_time": 0.039063
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Not working any more      22   411.96   66.33\n1              reason 45      71  1243.35   84.57\n2             Wrong size      10   279.87    9.49\n3              reason 52      12   346.64   40.23\n4              reason 48      19   212.12   31.59\n5              reason 42      21    70.62   72.79\n6              reason 35      57   807.03   18.76\n7              reason 47      16   260.30   32.28\n8          Parts missing      68  1759.73   70.98\n9              reason 53      18   356.91   55.49\n10             reason 23      23   265.31   40.31\n11  Did not like the mak      17    47.19   33.98\n12             reason 40      68   718.66   15.74\n13  Found a better price       5   261.55   25.63\n14             reason 27       9   176.97   60.34\n15  Does not work with a      16   329.97   59.25\n16             reason 44      41   657.60   57.51\n17             reason 25      29   749.05   39.05\n18             reason 46      13   417.15   57.37\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0              reason 37      46   618.37   39.95\n1   Did not like the war      84   592.35   34.07\n2              reason 29       3    79.66   62.98\n3            Lost my job      15   561.31   44.10\n4              reason 31      38   447.27   74.63\n5    Package was damaged       4   168.76   40.68\n6              reason 25      29   749.05   39.05\n7              reason 46      13   417.15   57.37\n8          Parts missing      68  1759.73   70.98\n9             Wrong size      10   279.87    9.49\n10    duplicate purchase      23   204.25   44.43\n11             reason 52      12   346.64   40.23\n12          it is a girl      44   385.68   93.00\n13             reason 39      53   872.01   39.22\n14             reason 28      41   914.39   47.02\n15           Did not fit      25   251.71   51.66\n16             reason 51      37   298.46   46.80\n17             reason 55      11   320.03   70.02\n18  Did not get it on ti       8   295.90   51.21\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016787,
                    "execution_time": 0.00725,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003426
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052024,
                    "execution_time": 0.007196,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038698
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0              reason 37      46   618.37   39.95\n1   Did not like the war      84   592.35   34.07\n2              reason 29       3    79.66   62.98\n3            Lost my job      15   561.31   44.10\n4              reason 31      38   447.27   74.63\n5    Package was damaged       4   168.76   40.68\n6              reason 25      29   749.05   39.05\n7              reason 46      13   417.15   57.37\n8          Parts missing      68  1759.73   70.98\n9             Wrong size      10   279.87    9.49\n10    duplicate purchase      23   204.25   44.43\n11             reason 52      12   346.64   40.23\n12          it is a girl      44   385.68   93.00\n13             reason 39      53   872.01   39.22\n14             reason 28      41   914.39   47.02\n15           Did not fit      25   251.71   51.66\n16             reason 51      37   298.46   46.80\n17             reason 55      11   320.03   70.02\n18  Did not get it on ti       8   295.90   51.21\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.424932,
                    "execution_time": 0.28324,
                    "compile_time": 0.000712,
                    "planning_time": 0.095055,
                    "create_size": 266
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.885794,
                    "execution_time": 0.283223,
                    "compile_time": 8.359752,
                    "planning_time": 0.186451,
                    "create_size": 266
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Not working any more      97   457.25   80.59\n1          Parts missing      69   930.40   64.59\n2              reason 23      75   387.39   54.98\n3              reason 53      56   405.38   37.21\n4              reason 52      60   414.02   32.67\n5   Found a better exten      60   455.62   74.15\n6              reason 32      61   299.58    4.90\n7              reason 37      83   832.44   42.49\n8              reason 28      82   603.47   39.82\n9              reason 54      68   382.00   41.49\n10             reason 24      82   903.40   81.68\n11             reason 49      71   502.47   36.53\n12             reason 51      68   436.76   27.48\n13  Did not like the mod      56    40.48   14.04\n14  Did not get it on ti      83   184.55   43.60\n15       Stopped working      68   224.77   56.84\n16             reason 41      81  1743.59   76.27\n17             reason 39      92   284.20   42.89\n18             reason 33      91   127.68   31.23\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017078,
                    "execution_time": 0.00713,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003561
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.073718,
                    "execution_time": 0.007987,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.0573
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Not working any more      97   457.25   80.59\n1          Parts missing      69   930.40   64.59\n2              reason 23      75   387.39   54.98\n3              reason 53      56   405.38   37.21\n4              reason 52      60   414.02   32.67\n5   Found a better exten      60   455.62   74.15\n6              reason 32      61   299.58    4.90\n7              reason 37      83   832.44   42.49\n8              reason 28      82   603.47   39.82\n9              reason 54      68   382.00   41.49\n10             reason 24      82   903.40   81.68\n11             reason 49      71   502.47   36.53\n12             reason 51      68   436.76   27.48\n13  Did not like the mod      56    40.48   14.04\n14  Did not get it on ti      83   184.55   43.60\n15       Stopped working      68   224.77   56.84\n16             reason 41      81  1743.59   76.27\n17             reason 39      92   284.20   42.89\n18             reason 33      91   127.68   31.23\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better price       5   261.55   25.63\n1              reason 27       9   176.97   60.34\n2   Does not work with a      16   329.97   59.25\n3              reason 44      41   657.60   57.51\n4   Not working any more      22   411.96   66.33\n5   No service location       10   240.40   30.09\n6              reason 34       2    20.02   49.10\n7              reason 38      27  1434.64   59.84\n8           its is a boy      26   261.18   30.22\n9              reason 52      12   346.64   40.23\n10             reason 25      29   749.05   39.05\n11             reason 46      13   417.15   57.37\n12             reason 45      71  1243.35   84.57\n13             reason 53      18   356.91   55.49\n14             reason 23      23   265.31   40.31\n15  Did not like the mak      17    47.19   33.98\n16             reason 40      68   718.66   15.74\n17  Not the product that      99   640.08    6.36\n18             reason 48      19   212.12   31.59\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016626,
                    "execution_time": 0.00707,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003582
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016911,
                    "execution_time": 0.00723,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003667
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better price       5   261.55   25.63\n1              reason 27       9   176.97   60.34\n2   Does not work with a      16   329.97   59.25\n3              reason 44      41   657.60   57.51\n4   Not working any more      22   411.96   66.33\n5   No service location       10   240.40   30.09\n6              reason 34       2    20.02   49.10\n7              reason 38      27  1434.64   59.84\n8           its is a boy      26   261.18   30.22\n9              reason 52      12   346.64   40.23\n10             reason 25      29   749.05   39.05\n11             reason 46      13   417.15   57.37\n12             reason 45      71  1243.35   84.57\n13             reason 53      18   356.91   55.49\n14             reason 23      23   265.31   40.31\n15  Did not like the mak      17    47.19   33.98\n16             reason 40      68   718.66   15.74\n17  Not the product that      99   640.08    6.36\n18             reason 48      19   212.12   31.59\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0          Parts missing      68  1759.73   70.98\n1           its is a boy      26   261.18   30.22\n2   Not the product that      99   640.08    6.36\n3   Did not get it on ti       8   295.90   51.21\n4        Stopped working      14   231.47   52.77\n5              reason 41      37  2667.88   64.14\n6              reason 32      18   353.43   28.26\n7   Found a better exten      31   351.63   46.40\n8              reason 55      11   320.03   70.02\n9           it is a girl      44   385.68   93.00\n10             reason 50       6   214.19   95.96\n11             reason 33      35  1164.97   92.65\n12             reason 39      53   872.01   39.22\n13             reason 29       3    79.66   62.98\n14             reason 28      41   914.39   47.02\n15             reason 51      37   298.46   46.80\n16             reason 37      46   618.37   39.95\n17  Did not like the war      84   592.35   34.07\n18             reason 49      54   418.95   46.50\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01697,
                    "execution_time": 0.007646,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003448
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017119,
                    "execution_time": 0.007342,
                    "compile_time": 5e-05,
                    "planning_time": 0.003689
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0          Parts missing      68  1759.73   70.98\n1           its is a boy      26   261.18   30.22\n2   Not the product that      99   640.08    6.36\n3   Did not get it on ti       8   295.90   51.21\n4        Stopped working      14   231.47   52.77\n5              reason 41      37  2667.88   64.14\n6              reason 32      18   353.43   28.26\n7   Found a better exten      31   351.63   46.40\n8              reason 55      11   320.03   70.02\n9           it is a girl      44   385.68   93.00\n10             reason 50       6   214.19   95.96\n11             reason 33      35  1164.97   92.65\n12             reason 39      53   872.01   39.22\n13             reason 29       3    79.66   62.98\n14             reason 28      41   914.39   47.02\n15             reason 51      37   298.46   46.80\n16             reason 37      46   618.37   39.95\n17  Did not like the war      84   592.35   34.07\n18             reason 49      54   418.95   46.50\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'CA', 'FL')\n     and ws_net_profit between 200 and 400  \n    )\n   )\n/*CURSOR_IDENTIFIER*/\ngroup by substring(r_reason_desc,1,20)",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NY' , 'CA' , 'FL' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NY' , 'CA' , 'FL' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.448731,
                    "execution_time": 0.298632,
                    "compile_time": 0.000761,
                    "planning_time": 0.100879,
                    "create_size": 301
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.726162,
                    "execution_time": 0.294126,
                    "compile_time": 5.074269,
                    "planning_time": 0.301449,
                    "create_size": 301
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better exten      42   245.30   41.03\n1              reason 32      18   353.43   28.26\n2              reason 28      41   914.39   47.02\n3              reason 29      10   125.05   39.11\n4            Lost my job      12   440.03   34.02\n5              reason 31      38   841.66   60.88\n6    Package was damaged       4   168.76   40.68\n7              reason 41      37  2667.88   64.14\n8              reason 50      48   257.90   62.47\n9              reason 37      47   846.77   46.72\n10  Did not like the war      72  1534.20   38.19\n11           Did not fit      25   251.71   51.66\n12             reason 51      33   246.69   49.92\n13  Did not like the mod      51   361.51   49.65\n14  Did not get it on ti      17   342.20   36.07\n15             reason 55      15   452.92   73.82\n16       Stopped working      21   514.34   58.94\n17          it is a girl      40   274.92   82.45\n18             reason 39      53   831.11   41.26\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017108,
                    "execution_time": 0.007268,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003664
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055778,
                    "execution_time": 0.007402,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039532
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('NY', 'CA', 'FL') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better exten      42   245.30   41.03\n1              reason 32      18   353.43   28.26\n2              reason 28      41   914.39   47.02\n3              reason 29      10   125.05   39.11\n4            Lost my job      12   440.03   34.02\n5              reason 31      38   841.66   60.88\n6    Package was damaged       4   168.76   40.68\n7              reason 41      37  2667.88   64.14\n8              reason 50      48   257.90   62.47\n9              reason 37      47   846.77   46.72\n10  Did not like the war      72  1534.20   38.19\n11           Did not fit      25   251.71   51.66\n12             reason 51      33   246.69   49.92\n13  Did not like the mod      51   361.51   49.65\n14  Did not get it on ti      17   342.20   36.07\n15             reason 55      15   452.92   73.82\n16       Stopped working      21   514.34   58.94\n17          it is a girl      40   274.92   82.45\n18             reason 39      53   831.11   41.26\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity) as avg_quantity\n       ,avg(wr_refunded_cash) as avg_refunded_cash\n       ,avg(wr_fee) as avg_fee\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n   )\n   )\nGROUP BY substring(r_reason_desc,1,20) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"AVG_QUANTITY\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"AVG_REFUNDED_CASH\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"AVG_QUANTITY\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"AVG_REFUNDED_CASH\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.541402,
                    "execution_time": 1.36503,
                    "compile_time": 0.032738,
                    "planning_time": 0.096663,
                    "create_size": 308
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.150477,
                    "execution_time": 1.369234,
                    "compile_time": 3.534189,
                    "planning_time": 0.193801,
                    "create_size": 308
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUANTITY\" AS \"AVG_QUANTITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_REFUNDED_CASH\" AS \"AVG_REFUNDED_CASH\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_FEE\" AS \"AVG_FEE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0  avg_quantity  avg_refunded_cash  avg_fee\n0              reason 32            32             874.28    42.89\n1   Found a better exten            40            1270.54    49.60\n2   Did not like the war            56             883.38    38.29\n3            Did not fit            52            1475.01    53.56\n4              reason 31            46            1229.94    43.78\n5            Lost my job            45             745.35    52.33\n6    Package was damaged            40            1367.63    41.67\n7   Did not like the mod            56            1885.58    35.98\n8   Did not get it on ti            47             976.70    52.31\n9              reason 55            42             877.67    49.31\n10             reason 41            54            1681.16    50.23\n11             reason 50            40            1459.65    51.84\n12             reason 37            45             935.80    50.81\n13             reason 28            46            2257.74    50.20\n14             reason 29            39            1053.95    45.30\n15             reason 51            52            1016.83    54.17\n16       Stopped working            56            1497.76    54.49\n17          it is a girl            48            1247.13    59.14\n18             reason 39            48             988.96    46.22\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01656,
                    "execution_time": 0.007175,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003483
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052997,
                    "execution_time": 0.007727,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039086
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"AVG_QUANTITY\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"AVG_REFUNDED_CASH\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM')) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUANTITY\" AS \"AVG_QUANTITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_REFUNDED_CASH\" AS \"AVG_REFUNDED_CASH\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_FEE\" AS \"AVG_FEE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0  avg_quantity  avg_refunded_cash  avg_fee\n0              reason 32            32             874.28    42.89\n1   Found a better exten            40            1270.54    49.60\n2   Did not like the war            56             883.38    38.29\n3            Did not fit            52            1475.01    53.56\n4              reason 31            46            1229.94    43.78\n5            Lost my job            45             745.35    52.33\n6    Package was damaged            40            1367.63    41.67\n7   Did not like the mod            56            1885.58    35.98\n8   Did not get it on ti            47             976.70    52.31\n9              reason 55            42             877.67    49.31\n10             reason 41            54            1681.16    50.23\n11             reason 50            40            1459.65    51.84\n12             reason 37            45             935.80    50.81\n13             reason 28            46            2257.74    50.20\n14             reason 29            39            1053.95    45.30\n15             reason 51            52            1016.83    54.17\n16       Stopped working            56            1497.76    54.49\n17          it is a girl            48            1247.13    59.14\n18             reason 39            48             988.96    46.22\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n   )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.579781,
                    "execution_time": 1.368891,
                    "compile_time": 0.037941,
                    "planning_time": 0.125557,
                    "create_size": 308
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.921248,
                    "execution_time": 1.370244,
                    "compile_time": 3.309115,
                    "planning_time": 0.190131,
                    "create_size": 308
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"REASON_DESC\" AS \"REASON_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Did not get it on ti      15   569.04   45.29\n1              reason 55      11   320.03   70.02\n2        Stopped working      14   231.47   52.77\n3   Did not like the mod      27   749.99   37.03\n4              reason 41      29  1817.29   45.03\n5           it is a girl      34   269.78   81.72\n6              reason 32      16   309.88   32.00\n7   Found a better exten      16   193.89   50.14\n8              reason 37      40   679.57   44.36\n9              reason 39      51   796.82   36.69\n10             reason 28      32   785.24   59.67\n11             reason 29       2   143.25   68.57\n12           Lost my job      15   561.31   44.10\n13   Package was damaged       4   168.76   40.68\n14             reason 31      38   447.27   74.63\n15             reason 33      24   698.14   86.47\n16           Did not fit      25   251.71   51.66\n17             reason 51      31   184.56   44.56\n18             reason 50       8   102.77   57.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017615,
                    "execution_time": 0.007758,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.00368
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053384,
                    "execution_time": 0.007983,
                    "compile_time": 6e-05,
                    "planning_time": 0.039145
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"REASON_DESC\" AS \"REASON_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Did not get it on ti      15   569.04   45.29\n1              reason 55      11   320.03   70.02\n2        Stopped working      14   231.47   52.77\n3   Did not like the mod      27   749.99   37.03\n4              reason 41      29  1817.29   45.03\n5           it is a girl      34   269.78   81.72\n6              reason 32      16   309.88   32.00\n7   Found a better exten      16   193.89   50.14\n8              reason 37      40   679.57   44.36\n9              reason 39      51   796.82   36.69\n10             reason 28      32   785.24   59.67\n11             reason 29       2   143.25   68.57\n12           Lost my job      15   561.31   44.10\n13   Package was damaged       4   168.76   40.68\n14             reason 31      38   447.27   74.63\n15             reason 33      24   698.14   86.47\n16           Did not fit      25   251.71   51.66\n17             reason 51      31   184.56   44.56\n18             reason 50       8   102.77   57.85\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0              reason 41      29  1817.29   45.03\n1              reason 50       8   102.77   57.85\n2              reason 37      40   679.57   44.36\n3   Did not like the war      84   592.35   34.07\n4              reason 29       2   143.25   68.57\n5              reason 36      10    79.18   60.35\n6              reason 39      51   796.82   36.69\n7              reason 28      32   785.24   59.67\n8            Did not fit      25   251.71   51.66\n9            Lost my job      15   561.31   44.10\n10   Package was damaged       4   168.76   40.68\n11             reason 31      38   447.27   74.63\n12             reason 55      11   320.03   70.02\n13  Did not like the mod      27   749.99   37.03\n14  Did not get it on ti      15   569.04   45.29\n15       Stopped working      14   231.47   52.77\n16          it is a girl      34   269.78   81.72\n17             reason 32      16   309.88   32.00\n18  Found a better exten      16   193.89   50.14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016831,
                    "execution_time": 0.00716,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003604
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052046,
                    "execution_time": 0.007425,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038491
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0              reason 41      29  1817.29   45.03\n1              reason 50       8   102.77   57.85\n2              reason 37      40   679.57   44.36\n3   Did not like the war      84   592.35   34.07\n4              reason 29       2   143.25   68.57\n5              reason 36      10    79.18   60.35\n6              reason 39      51   796.82   36.69\n7              reason 28      32   785.24   59.67\n8            Did not fit      25   251.71   51.66\n9            Lost my job      15   561.31   44.10\n10   Package was damaged       4   168.76   40.68\n11             reason 31      38   447.27   74.63\n12             reason 55      11   320.03   70.02\n13  Did not like the mod      27   749.99   37.03\n14  Did not get it on ti      15   569.04   45.29\n15       Stopped working      14   231.47   52.77\n16          it is a girl      34   269.78   81.72\n17             reason 32      16   309.88   32.00\n18  Found a better exten      16   193.89   50.14\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Did not like the mod      27   749.99   37.03\n1           it is a girl      34   269.78   81.72\n2              reason 37      40   679.57   44.36\n3   Did not like the war      84   592.35   34.07\n4            Did not fit      25   251.71   51.66\n5            Lost my job      15   561.31   44.10\n6    Package was damaged       4   168.76   40.68\n7              reason 31      38   447.27   74.63\n8              reason 55      11   320.03   70.02\n9   Did not get it on ti      15   569.04   45.29\n10       Stopped working      14   231.47   52.77\n11             reason 41      29  1817.29   45.03\n12             reason 50       8   102.77   57.85\n13             reason 39      51   796.82   36.69\n14             reason 28      32   785.24   59.67\n15             reason 29       2   143.25   68.57\n16             reason 51      31   184.56   44.56\n17             reason 32      16   309.88   32.00\n18  Found a better exten      16   193.89   50.14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017232,
                    "execution_time": 0.007586,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003589
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01747,
                    "execution_time": 0.007755,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003495
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Did not like the mod      27   749.99   37.03\n1           it is a girl      34   269.78   81.72\n2              reason 37      40   679.57   44.36\n3   Did not like the war      84   592.35   34.07\n4            Did not fit      25   251.71   51.66\n5            Lost my job      15   561.31   44.10\n6    Package was damaged       4   168.76   40.68\n7              reason 31      38   447.27   74.63\n8              reason 55      11   320.03   70.02\n9   Did not get it on ti      15   569.04   45.29\n10       Stopped working      14   231.47   52.77\n11             reason 41      29  1817.29   45.03\n12             reason 50       8   102.77   57.85\n13             reason 39      51   796.82   36.69\n14             reason 28      32   785.24   59.67\n15             reason 29       2   143.25   68.57\n16             reason 51      31   184.56   44.56\n17             reason 32      16   309.88   32.00\n18  Found a better exten      16   193.89   50.14\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.561277,
                    "execution_time": 0.359481,
                    "compile_time": 0.054914,
                    "planning_time": 0.099265,
                    "create_size": 56
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.029355,
                    "execution_time": 0.368338,
                    "compile_time": 3.41726,
                    "planning_time": 0.192063,
                    "create_size": 56
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Did not get it on ti      15   569.04   45.29\n1              reason 45      78  2062.69   77.31\n2             Wrong size      31   330.98   18.82\n3   Did not like the mod      27   749.99   37.03\n4              reason 43      14   307.07    1.56\n5          Gift exchange      18   265.39   54.92\n6              reason 53      16   298.87   55.80\n7              reason 35      56   669.43   18.51\n8   Found a better price       6   205.92   30.27\n9              reason 34       2    20.02   49.10\n10  No service location       21   613.88   55.40\n11             reason 23      14   228.87   45.38\n12             reason 44      31   509.50   58.49\n13    duplicate purchase      23   204.25   44.43\n14             reason 42      17    67.71   70.41\n15             reason 25      29   749.05   39.05\n16             reason 48      31   675.66   52.23\n17  unauthoized purchase      41   895.45   41.15\n18             reason 27      10   145.42   57.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016919,
                    "execution_time": 0.007466,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003467
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054922,
                    "execution_time": 0.007314,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039054
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Did not get it on ti      15   569.04   45.29\n1              reason 45      78  2062.69   77.31\n2             Wrong size      31   330.98   18.82\n3   Did not like the mod      27   749.99   37.03\n4              reason 43      14   307.07    1.56\n5          Gift exchange      18   265.39   54.92\n6              reason 53      16   298.87   55.80\n7              reason 35      56   669.43   18.51\n8   Found a better price       6   205.92   30.27\n9              reason 34       2    20.02   49.10\n10  No service location       21   613.88   55.40\n11             reason 23      14   228.87   45.38\n12             reason 44      31   509.50   58.49\n13    duplicate purchase      23   204.25   44.43\n14             reason 42      17    67.71   70.41\n15             reason 25      29   749.05   39.05\n16             reason 48      31   675.66   52.23\n17  unauthoized purchase      41   895.45   41.15\n18             reason 27      10   145.42   57.12\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036978,
                    "execution_time": 0.009083,
                    "compile_time": 0.017658,
                    "planning_time": 0.004116
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.748155,
                    "execution_time": 0.009614,
                    "compile_time": 4.694958,
                    "planning_time": 0.039068
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.125415,
                    "execution_time": 0.008934,
                    "compile_time": 0.113006,
                    "planning_time": 0.004063
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.008854,
                    "execution_time": 0.009124,
                    "compile_time": 5.958216,
                    "planning_time": 0.039536
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.042488,
                    "execution_time": 0.008493,
                    "compile_time": 0.030504,
                    "planning_time": 0.003884
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.226435,
                    "execution_time": 0.009418,
                    "compile_time": 6.176149,
                    "planning_time": 0.039274
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" , \"_COL_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.034433,
                    "execution_time": 0.008435,
                    "compile_time": 0.015942,
                    "planning_time": 0.004015
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.569422,
                    "execution_time": 0.009002,
                    "compile_time": 4.519506,
                    "planning_time": 0.039086
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST, \"_COL_3\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" , \"_COL_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02921,
                    "execution_time": 0.008367,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003867
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019692,
                    "execution_time": 0.009405,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.004008
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST, \"_COL_3\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit      25   251.71   51.66\n1   Did not get it on ti      15   569.04   45.29\n2   Did not like the col      15   241.56   51.19\n3   Did not like the mak      17    47.19   33.98\n4   Did not like the mod      27   749.99   37.03\n5   Did not like the war      84   592.35   34.07\n6   Does not work with a      14   278.84   61.75\n7   Found a better exten      16   193.89   50.14\n8   Found a better price       6   205.92   30.27\n9          Gift exchange      18   265.39   54.92\n10           Lost my job      15   561.31   44.10\n11  No service location       21   613.88   55.40\n12  Not the product that      99   640.08    6.36\n13  Not working any more      26   342.62   61.09\n14   Package was damaged       4   168.76   40.68\n15         Parts missing      68  1759.73   70.98\n16       Stopped working      14   231.47   52.77\n17            Wrong size      31   330.98   18.82\n18    duplicate purchase      23   204.25   44.43\n...*/"
    }
]