[
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere 1 = 1 \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "rewrite": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and '2000-2-28'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2000-02-28' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0      1269783         1.892623e+11     -3.809118e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.194635,
                    "execution_time": 0.956254,
                    "compile_time": 0.170669,
                    "planning_time": 0.052887
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 19.684293,
                    "execution_time": 12.745433,
                    "compile_time": 6.796953,
                    "planning_time": 0.123979
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0      1269783         1.892623e+11     -3.809118e+10*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        26074         3.921995e+09      -775107040.5*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.279115,
                    "execution_time": 0.152713,
                    "compile_time": 0.033225,
                    "planning_time": 0.077987
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.367559,
                    "execution_time": 4.735929,
                    "compile_time": 3.491894,
                    "planning_time": 0.123511
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        26074         3.921995e+09      -775107040.5*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0        26070         1.306369e+08      -25784485.29*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.507048,
                    "execution_time": 1.422069,
                    "compile_time": 0.015895,
                    "planning_time": 0.054085
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.080648,
                    "execution_time": 2.462288,
                    "compile_time": 3.474443,
                    "planning_time": 0.126225
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0        26070         1.306369e+08      -25784485.29*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County')\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.147092,
                    "execution_time": 0.072339,
                    "compile_time": 0.00029,
                    "planning_time": 0.056998
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.486897,
                    "execution_time": 0.195626,
                    "compile_time": 8.147281,
                    "planning_time": 0.125392
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ('Dauphin County', 'Levy County', 'Luce County', 'Jackson County') JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County')\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.144024,
                    "execution_time": 0.07122,
                    "compile_time": 0.000289,
                    "planning_time": 0.056127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.355767,
                    "execution_time": 0.071056,
                    "compile_time": 4.138797,
                    "planning_time": 0.127826
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ('Dauphin County', 'Levy County', 'Luce County', 'Jackson County', 'Daviess County') JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.143935,
                    "execution_time": 0.072868,
                    "compile_time": 0.000255,
                    "planning_time": 0.055495
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.140421,
                    "execution_time": 0.071878,
                    "compile_time": 0.000276,
                    "planning_time": 0.052501
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT(DISTINCT \"CS1\".\"CS_ORDER_NUMBER\") AS \"ORDER COUNT\", SUM(\"CS1\".\"CS_EXT_SHIP_COST\") AS \"TOTAL SHIPPING COST\", SUM(\"CS1\".\"CS_NET_PROFIT\") AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ('Dauphin County', 'Levy County', 'Luce County', 'Jackson County', 'Daviess County') JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 60, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2000-02-01' AS DATE)",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County')\n\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n) /*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.043439,
                    "execution_time": 0.958177,
                    "compile_time": 0.000266,
                    "planning_time": 0.027412,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.111324,
                    "execution_time": 0.961156,
                    "compile_time": 0.002248,
                    "planning_time": 0.087346,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.847965,
                    "execution_time": 1.733619,
                    "compile_time": 0.014625,
                    "planning_time": 0.082166
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.577755,
                    "execution_time": 1.734416,
                    "compile_time": 3.674994,
                    "planning_time": 0.153166
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         3319          16483080.95       -3607811.18*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"CS2\".\"CS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"CS1\".\"CS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         3318          16474464.77       -3613916.71*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.541849,
                    "execution_time": 0.423236,
                    "compile_time": 0.000401,
                    "planning_time": 0.096916
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.369274,
                    "execution_time": 1.774376,
                    "compile_time": 8.50897,
                    "planning_time": 0.178333
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         3318          16474464.77       -3613916.71*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n            from catalog_sales cs3\n            where cs1.cs_order_number = cs3.cs_order_number\n)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"CS2\".\"CS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"CS3\".\"CS_ORDER_NUMBER\" AS \"_U_4\" FROM \"CATALOG_SALES\" AS \"CS3\" GROUP BY \"CS3\".\"CS_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"CS1\".\"CS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM CATALOG_SALES AS CS3 WHERE CS1.CS_ORDER_NUMBER = CS3.CS_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count total shipping cost total net profit\n0            0                None             None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.297051,
                    "execution_time": 1.13564,
                    "compile_time": 0.000543,
                    "planning_time": 0.136556
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.280494,
                    "execution_time": 1.136066,
                    "compile_time": 5.895695,
                    "planning_time": 0.213141
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count total shipping cost total net profit\n0            0                None             None*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select 1 from catalog_returns cr1 where cr1.cr_order_number = cs1.cs_order_number\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"CS2\".\"CS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"CR1\".\"CR_ORDER_NUMBER\" AS \"_U_4\" FROM \"CATALOG_RETURNS\" AS \"CR1\" GROUP BY \"CR1\".\"CR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"CS1\".\"CS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT 1 FROM CATALOG_RETURNS AS CR1 WHERE CR1.CR_ORDER_NUMBER = CS1.CS_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.647561,
                    "execution_time": 0.489655,
                    "compile_time": 0.000512,
                    "planning_time": 0.133303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.612025,
                    "execution_time": 1.591625,
                    "compile_time": 4.780517,
                    "planning_time": 0.214516
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n               from catalog_returns cr1\n               where cs1.cs_order_number = cr1.cr_order_number)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"CS2\".\"CS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"CR1\".\"CR_ORDER_NUMBER\" AS \"_U_4\" FROM \"CATALOG_RETURNS\" AS \"CR1\" GROUP BY \"CR1\".\"CR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"CS1\".\"CS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM CATALOG_RETURNS AS CR1 WHERE CS1.CS_ORDER_NUMBER = CR1.CR_ORDER_NUMBER ) LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.647084,
                    "execution_time": 0.488831,
                    "compile_time": 0.000489,
                    "planning_time": 0.13415
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.735232,
                    "execution_time": 0.489148,
                    "compile_time": 0.000484,
                    "planning_time": 0.222192
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n               from catalog_returns cr1\n               where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"CS2\".\"CS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"CR1\".\"CR_ORDER_NUMBER\" AS \"_U_4\" FROM \"CATALOG_RETURNS\" AS \"CR1\" GROUP BY \"CR1\".\"CR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"CS1\".\"CS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL ORDER BY COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM CATALOG_RETURNS AS CR1 WHERE CS1.CS_ORDER_NUMBER = CR1.CR_ORDER_NUMBER ) ORDER BY COUNT ( DISTINCT CS_ORDER_NUMBER ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.651989,
                    "execution_time": 0.490632,
                    "compile_time": 0.000504,
                    "planning_time": 0.136034
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.73279,
                    "execution_time": 0.488899,
                    "compile_time": 0.000508,
                    "planning_time": 0.218642
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/"
    },
    {
        "input": "-- start template query16.tpl query 25 in stream 0\nselect /* TPC-DS query16.tpl 0.25 */  \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2000-2-01' and \n           dateadd(day, 60, cast('2000-2-01' as date))\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'AL'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Dauphin County','Levy County','Luce County','Jackson County',\n                  'Daviess County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n               from catalog_returns cr1\n               where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CS2\".\"CS_ORDER_NUMBER\" AS \"_U_1\" , ARRAY_AGG ( \"CS2\".\"CS_WAREHOUSE_SK\" ) AS \"_U_2\" FROM \"CATALOG_SALES\" AS \"CS2\" GROUP BY \"CS2\".\"CS_ORDER_NUMBER\" ) , \"_U_3\" AS ( SELECT \"CR1\".\"CR_ORDER_NUMBER\" AS \"_U_4\" FROM \"CATALOG_RETURNS\" AS \"CR1\" GROUP BY \"CR1\".\"CR_ORDER_NUMBER\" ) SELECT COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) AS \"ORDER COUNT\" , SUM ( \"CS1\".\"CS_EXT_SHIP_COST\" ) AS \"TOTAL SHIPPING COST\" , SUM ( \"CS1\".\"CS_NET_PROFIT\" ) AS \"TOTAL NET PROFIT\" FROM \"CATALOG_SALES\" AS \"CS1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CS1\".\"CS_ORDER_NUMBER\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"_U_4\" = \"CS1\".\"CS_ORDER_NUMBER\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CS1\".\"CS_CALL_CENTER_SK\" AND \"CALL_CENTER\".\"CC_COUNTY\" IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CS1\".\"CS_SHIP_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'AL' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CS1\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 60 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-02-01' AS DATE ) WHERE \"_U_3\".\"_U_4\" IS NULL AND ARRAY_ANY ( \"_U_0\".\"_U_2\" , \"_X\" -> \"CS1\".\"CS_WAREHOUSE_SK\" <> \"_X\" ) AND NOT \"_U_0\".\"_U_1\" IS NULL ORDER BY COUNT ( DISTINCT \"CS1\".\"CS_ORDER_NUMBER\" ) NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT COUNT ( DISTINCT CS_ORDER_NUMBER ) AS \"ORDER COUNT\" , SUM ( CS_EXT_SHIP_COST ) AS \"TOTAL SHIPPING COST\" , SUM ( CS_NET_PROFIT ) AS \"TOTAL NET PROFIT\" FROM CATALOG_SALES AS CS1 , DATE_DIM , CUSTOMER_ADDRESS , CALL_CENTER WHERE D_DATE BETWEEN '2000-02-01' AND DATEADD ( DAY , 60 , CAST ( '2000-02-01' AS DATE ) ) AND CS1.CS_SHIP_DATE_SK = D_DATE_SK AND CS1.CS_SHIP_ADDR_SK = CA_ADDRESS_SK AND CA_STATE = 'AL' AND CS1.CS_CALL_CENTER_SK = CC_CALL_CENTER_SK AND CC_COUNTY IN ( 'Dauphin County' , 'Levy County' , 'Luce County' , 'Jackson County' , 'Daviess County' ) AND EXISTS ( SELECT * FROM CATALOG_SALES AS CS2 WHERE CS1.CS_ORDER_NUMBER = CS2.CS_ORDER_NUMBER AND CS1.CS_WAREHOUSE_SK <> CS2.CS_WAREHOUSE_SK ) AND NOT EXISTS ( SELECT * FROM CATALOG_RETURNS AS CR1 WHERE CS1.CS_ORDER_NUMBER = CR1.CR_ORDER_NUMBER ) ORDER BY COUNT ( DISTINCT CS_ORDER_NUMBER ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.650668,
                    "execution_time": 0.489022,
                    "compile_time": 0.000487,
                    "planning_time": 0.137301
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.654059,
                    "execution_time": 0.490333,
                    "compile_time": 0.000514,
                    "planning_time": 0.139104
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   order count  total shipping cost  total net profit\n0         1275           5896899.03       -1355409.34*/"
    }
]