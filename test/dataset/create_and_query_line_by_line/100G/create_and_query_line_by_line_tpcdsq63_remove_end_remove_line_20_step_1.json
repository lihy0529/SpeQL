[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      group by i_manager_id\n      ) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SUBQUERY\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.806287,
                    "execution_time": 1.735995,
                    "compile_time": 0.000475,
                    "planning_time": 0.048367,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.912574,
                    "execution_time": 1.75859,
                    "compile_time": 0.000491,
                    "planning_time": 0.125667,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0           56.0  8.863174e+07       8.863174e+07\n1           80.0  2.767542e+07       2.767542e+07\n2            NaN  2.570081e+07       2.570081e+07\n3           29.0  1.813322e+08       1.813322e+08\n4           37.0  9.141233e+07       9.141233e+07\n5           38.0  8.955765e+07       8.955765e+07\n6           97.0  2.691308e+07       2.691308e+07\n7            1.0  1.812337e+08       1.812337e+08\n8           61.0  9.319476e+07       9.319476e+07\n9           10.0  1.834794e+08       1.834794e+08\n10          16.0  1.724141e+08       1.724141e+08\n11          88.0  2.968017e+07       2.968017e+07\n12          44.0  9.278416e+07       9.278416e+07\n13          71.0  2.927049e+07       2.927049e+07\n14          20.0  1.840254e+08       1.840254e+08\n15          31.0  1.814875e+08       1.814875e+08\n16          98.0  2.976299e+07       2.976299e+07\n17          93.0  3.155388e+07       3.155388e+07\n18          84.0  2.768726e+07       2.768726e+07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017346,
                    "execution_time": 0.007367,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004341
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054149,
                    "execution_time": 0.007623,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.0392
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    i_manager_id     sum_sales  avg_monthly_sales\n0           56.0  8.863174e+07       8.863174e+07\n1           80.0  2.767542e+07       2.767542e+07\n2            NaN  2.570081e+07       2.570081e+07\n3           29.0  1.813322e+08       1.813322e+08\n4           37.0  9.141233e+07       9.141233e+07\n5           38.0  8.955765e+07       8.955765e+07\n6           97.0  2.691308e+07       2.691308e+07\n7            1.0  1.812337e+08       1.812337e+08\n8           61.0  9.319476e+07       9.319476e+07\n9           10.0  1.834794e+08       1.834794e+08\n10          16.0  1.724141e+08       1.724141e+08\n11          88.0  2.968017e+07       2.968017e+07\n12          44.0  9.278416e+07       9.278416e+07\n13          71.0  2.927049e+07       2.927049e+07\n14          20.0  1.840254e+08       1.840254e+08\n15          31.0  1.814875e+08       1.814875e+08\n16          98.0  2.976299e+07       2.976299e+07\n17          93.0  3.155388e+07       3.155388e+07\n18          84.0  2.768726e+07       2.768726e+07\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.444058,
                    "execution_time": 0.368959,
                    "compile_time": 0.000529,
                    "planning_time": 0.049698,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.529245,
                    "execution_time": 0.369278,
                    "compile_time": 0.000528,
                    "planning_time": 0.132049,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0              7  35638341.65        35638341.65\n1             74   5640082.32         5640082.32\n2             65  19032521.93        19032521.93\n3             90   6311478.41         6311478.41\n4              9  37013230.31        37013230.31\n5             58  17997288.41        17997288.41\n6             59  18592469.50        18592469.50\n7             63  17858015.68        17858015.68\n8              5  36141828.04        36141828.04\n9             46  18512904.34        18512904.34\n10            86   5404152.37         5404152.37\n11            28  35720653.51        35720653.51\n12            83   5776102.94         5776102.94\n13            33  36666422.07        36666422.07\n14            43  17835402.74        17835402.74\n15            64  17916630.12        17916630.12\n16            92   5876775.56         5876775.56\n17            35  19014684.92        19014684.92\n18            42  16978489.72        16978489.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01864,
                    "execution_time": 0.008026,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004496
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052222,
                    "execution_time": 0.007499,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.039024
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0              7  35638341.65        35638341.65\n1             74   5640082.32         5640082.32\n2             65  19032521.93        19032521.93\n3             90   6311478.41         6311478.41\n4              9  37013230.31        37013230.31\n5             58  17997288.41        17997288.41\n6             59  18592469.50        18592469.50\n7             63  17858015.68        17858015.68\n8              5  36141828.04        36141828.04\n9             46  18512904.34        18512904.34\n10            86   5404152.37         5404152.37\n11            28  35720653.51        35720653.51\n12            83   5776102.94         5776102.94\n13            33  36666422.07        36666422.07\n14            43  17835402.74        17835402.74\n15            64  17916630.12        17916630.12\n16            92   5876775.56         5876775.56\n17            35  19014684.92        19014684.92\n18            42  16978489.72        16978489.72\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and (    i_category in ('Books','Children','Electronics')\n\n)\n      group by i_manager_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.348265,
                    "execution_time": 0.268519,
                    "compile_time": 0.000563,
                    "planning_time": 0.052536,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.612623,
                    "execution_time": 0.272059,
                    "compile_time": 0.183207,
                    "planning_time": 0.127688,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0              7  10343736.29        10343736.29\n1             74   1720063.35         1720063.35\n2             58   4989572.15         4989572.15\n3              5  11070767.03        11070767.03\n4             46   5306019.00         5306019.00\n5             86   1793620.29         1793620.29\n6              9  10719874.10        10719874.10\n7             65   5444077.08         5444077.08\n8             90   1891603.35         1891603.35\n9             28  11089639.57        11089639.57\n10            83   1834291.10         1834291.10\n11            25  11645766.45        11645766.45\n12            52   4861781.63         4861781.63\n13            99   1595479.53         1595479.53\n14            59   5480682.76         5480682.76\n15            63   5040580.89         5040580.89\n16            27  11002557.45        11002557.45\n17            13  10391252.32        10391252.32\n18            34   5472463.62         5472463.62\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017832,
                    "execution_time": 0.007929,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004311
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052987,
                    "execution_time": 0.00766,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039449
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0              7  10343736.29        10343736.29\n1             74   1720063.35         1720063.35\n2             58   4989572.15         4989572.15\n3              5  11070767.03        11070767.03\n4             46   5306019.00         5306019.00\n5             86   1793620.29         1793620.29\n6              9  10719874.10        10719874.10\n7             65   5444077.08         5444077.08\n8             90   1891603.35         1891603.35\n9             28  11089639.57        11089639.57\n10            83   1834291.10         1834291.10\n11            25  11645766.45        11645766.45\n12            52   4861781.63         4861781.63\n13            99   1595479.53         1595479.53\n14            59   5480682.76         5480682.76\n15            63   5040580.89         5040580.89\n16            27  11002557.45        11002557.45\n17            13  10391252.32        10391252.32\n18            34   5472463.62         5472463.62\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) as sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) as avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and (    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help'))\n      group by i_manager_id) as sales_data /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"SALES_DATA\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.232205,
                    "execution_time": 0.153093,
                    "compile_time": 0.000533,
                    "planning_time": 0.052723,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.316225,
                    "execution_time": 0.156955,
                    "compile_time": 0.000535,
                    "planning_time": 0.133329,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0             65   448942.87          448942.87\n1             90   176434.60          176434.60\n2             58   347660.91          347660.91\n3              7   926244.51          926244.51\n4             74   146193.62          146193.62\n5             99   122536.47          122536.47\n6             13   773112.31          773112.31\n7              9  1128479.95         1128479.95\n8             70   195951.25          195951.25\n9             25  1062172.12         1062172.12\n10            52   442940.35          442940.35\n11            28   706978.75          706978.75\n12            83   161762.98          161762.98\n13            59   539686.90          539686.90\n14            63   539915.19          539915.19\n15            43   547205.20          547205.20\n16            34   334164.89          334164.89\n17            75   196653.80          196653.80\n18            26   833320.73          833320.73\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017873,
                    "execution_time": 0.007774,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004342
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05249,
                    "execution_time": 0.007494,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039203
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0             65   448942.87          448942.87\n1             90   176434.60          176434.60\n2             58   347660.91          347660.91\n3              7   926244.51          926244.51\n4             74   146193.62          146193.62\n5             99   122536.47          122536.47\n6             13   773112.31          773112.31\n7              9  1128479.95         1128479.95\n8             70   195951.25          195951.25\n9             25  1062172.12         1062172.12\n10            52   442940.35          442940.35\n11            28   706978.75          706978.75\n12            83   161762.98          161762.98\n13            59   539686.90          539686.90\n14            63   539915.19          539915.19\n15            43   547205.20          547205.20\n16            34   334164.89          334164.89\n17            75   196653.80          196653.80\n18            26   833320.73          833320.73\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')))\n      group by i_manager_id)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.315944,
                    "execution_time": 3.155271,
                    "compile_time": 0.078102,
                    "planning_time": 0.055628,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.950576,
                    "execution_time": 3.175826,
                    "compile_time": 6.607542,
                    "planning_time": 0.134976,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0           93.0   1885814.38         1885814.38\n1           66.0   4938823.19         4938823.19\n2            3.0  11834019.17        11834019.17\n3            8.0  10488196.44        10488196.44\n4           79.0   1567127.45         1567127.45\n5           55.0   5238094.25         5238094.25\n6           91.0   1770208.21         1770208.21\n7           44.0   5471794.93         5471794.93\n8           88.0   1717528.16         1717528.16\n9           68.0   1840305.73         1840305.73\n10          11.0  10677279.60        10677279.60\n11          60.0   5406681.90         5406681.90\n12           6.0  10774879.51        10774879.51\n13          36.0   5306349.57         5306349.57\n14          51.0   5580244.57         5580244.57\n15          21.0  10417166.17        10417166.17\n16           NaN    815428.97          815428.97\n17          56.0   5281513.20         5281513.20\n18           1.0  11498985.69        11498985.69\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017947,
                    "execution_time": 0.007897,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004337
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053149,
                    "execution_time": 0.007914,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039412
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    i_manager_id    sum_sales  avg_monthly_sales\n0           93.0   1885814.38         1885814.38\n1           66.0   4938823.19         4938823.19\n2            3.0  11834019.17        11834019.17\n3            8.0  10488196.44        10488196.44\n4           79.0   1567127.45         1567127.45\n5           55.0   5238094.25         5238094.25\n6           91.0   1770208.21         1770208.21\n7           44.0   5471794.93         5471794.93\n8           88.0   1717528.16         1717528.16\n9           68.0   1840305.73         1840305.73\n10          11.0  10677279.60        10677279.60\n11          60.0   5406681.90         5406681.90\n12           6.0  10774879.51        10774879.51\n13          36.0   5306349.57         5306349.57\n14          51.0   5580244.57         5580244.57\n15          21.0  10417166.17        10417166.17\n16           NaN    815428.97          815428.97\n17          56.0   5281513.20         5281513.20\n18           1.0  11498985.69        11498985.69\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) as sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) as avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\n      group by i_manager_id\n     ) /* Added missing closing parenthesis */\n /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" ) SELECT \"_Q_0\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.295011,
                    "execution_time": 0.172052,
                    "compile_time": 0.033254,
                    "planning_time": 0.060916,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.667736,
                    "execution_time": 0.171536,
                    "compile_time": 3.325603,
                    "planning_time": 0.138018,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0             65   260632.41          260632.41\n1             90   204726.57          204726.57\n2             58   394852.86          394852.86\n3              5   998733.53          998733.53\n4             46   528215.58          528215.58\n5             86   231574.85          231574.85\n6              7  1023198.98         1023198.98\n7             74   210386.47          210386.47\n8             28  1293507.75         1293507.75\n9             83   184412.70          184412.70\n10             9  1234110.74         1234110.74\n11            33  1101954.04         1101954.04\n12            25   828798.12          828798.12\n13            52   400663.65          400663.65\n14            64   607661.05          607661.05\n15            92   115795.14          115795.14\n16            76   173701.03          173701.03\n17            34   425693.36          425693.36\n18            26  1079835.48         1079835.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017098,
                    "execution_time": 0.007221,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004236
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053332,
                    "execution_time": 0.007746,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039776
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    i_manager_id   sum_sales  avg_monthly_sales\n0             65   260632.41          260632.41\n1             90   204726.57          204726.57\n2             58   394852.86          394852.86\n3              5   998733.53          998733.53\n4             46   528215.58          528215.58\n5             86   231574.85          231574.85\n6              7  1023198.98         1023198.98\n7             74   210386.47          210386.47\n8             28  1293507.75         1293507.75\n9             83   184412.70          184412.70\n10             9  1234110.74         1234110.74\n11            33  1101954.04         1101954.04\n12            25   828798.12          828798.12\n13            52   400663.65          400663.65\n14            64   607661.05          607661.05\n15            92   115795.14          115795.14\n16            76   173701.03          173701.03\n17            34   425693.36          425693.36\n18            26  1079835.48         1079835.48\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.318272,
                    "execution_time": 0.159522,
                    "compile_time": 0.069871,
                    "planning_time": 0.05889,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.647544,
                    "execution_time": 1.966201,
                    "compile_time": 6.6107,
                    "planning_time": 0.140157,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0             65   12760.39           23693.85\n1             65   17088.98           23693.85\n2             65   32445.08           23693.85\n3             65   16400.52           23693.85\n4             65   15128.60           23693.85\n5             65   15140.86           23693.85\n6             65   14179.62           23693.85\n7             65   35286.49           23693.85\n8             65   13967.97           23693.85\n9             65   34156.60           23693.85\n10            65   54077.30           23693.85\n11            90   11970.20           17060.54\n12            90   23443.05           17060.54\n13            90   41184.49           17060.54\n14            90   14162.88           17060.54\n15            90   12607.73           17060.54\n16            90    3740.55           17060.54\n17            90   11309.50           17060.54\n18            90   24991.18           17060.54\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017446,
                    "execution_time": 0.007214,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004358
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055383,
                    "execution_time": 0.008188,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039644
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0             65   12760.39           23693.85\n1             65   17088.98           23693.85\n2             65   32445.08           23693.85\n3             65   16400.52           23693.85\n4             65   15128.60           23693.85\n5             65   15140.86           23693.85\n6             65   14179.62           23693.85\n7             65   35286.49           23693.85\n8             65   13967.97           23693.85\n9             65   34156.60           23693.85\n10            65   54077.30           23693.85\n11            90   11970.20           17060.54\n12            90   23443.05           17060.54\n13            90   41184.49           17060.54\n14            90   14162.88           17060.54\n15            90   12607.73           17060.54\n16            90    3740.55           17060.54\n17            90   11309.50           17060.54\n18            90   24991.18           17060.54\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.246015,
                    "execution_time": 0.16211,
                    "compile_time": 0.000572,
                    "planning_time": 0.054881,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.33725,
                    "execution_time": 0.173014,
                    "compile_time": 0.000588,
                    "planning_time": 0.135566,
                    "create_size": 888
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.0844,
                    "execution_time": 0.053736,
                    "compile_time": 0.000228,
                    "planning_time": 0.006002,
                    "create_size": 888
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.263629,
                    "execution_time": 0.056352,
                    "compile_time": 0.117152,
                    "planning_time": 0.06347,
                    "create_size": 888
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0             65   18372.96           23455.15\n1             65   33896.25           23455.15\n2             65   13583.03           23455.15\n3             65    3422.98           23455.15\n4             65   17407.30           23455.15\n5             65   15985.51           23455.15\n6             65   16553.23           23455.15\n7             65   15094.01           23455.15\n8             65   15016.04           23455.15\n9             65   37965.72           23455.15\n10            65   36046.12           23455.15\n11            65   58118.72           23455.15\n12            90   11970.20           17060.54\n13            90   23443.05           17060.54\n14            90   41184.49           17060.54\n15            90    3740.55           17060.54\n16            90   14162.88           17060.54\n17            90   12607.73           17060.54\n18            90   10406.25           17060.54\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017473,
                    "execution_time": 0.007273,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004277
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05327,
                    "execution_time": 0.007926,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039371
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0             65   18372.96           23455.15\n1             65   33896.25           23455.15\n2             65   13583.03           23455.15\n3             65    3422.98           23455.15\n4             65   17407.30           23455.15\n5             65   15985.51           23455.15\n6             65   16553.23           23455.15\n7             65   15094.01           23455.15\n8             65   15016.04           23455.15\n9             65   37965.72           23455.15\n10            65   36046.12           23455.15\n11            65   58118.72           23455.15\n12            90   11970.20           17060.54\n13            90   23443.05           17060.54\n14            90   41184.49           17060.54\n15            90    3740.55           17060.54\n16            90   14162.88           17060.54\n17            90   12607.73           17060.54\n18            90   10406.25           17060.54\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" LIMIT 21",
                "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1   59410.92           99108.59\n1              1  230615.77           99108.59\n2              1    3638.78           99108.59\n3              1   81478.40           99108.59\n4              1   68002.62           99108.59\n5              1   68186.57           99108.59\n6              1   73529.08           99108.59\n7              1   65792.34           99108.59\n8              1  156945.23           99108.59\n9              1   68005.44           99108.59\n10             1  153851.10           99108.59\n11             1  159846.91           99108.59\n12             2   66577.92           99299.68\n13             2    5836.71           99299.68\n14             2   83486.15           99299.68\n15             2   67221.34           99299.68\n16             2  159641.08           99299.68\n17             2  157109.79           99299.68\n18             2   69242.40           99299.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.08205,
                    "execution_time": 0.013622,
                    "compile_time": 0.057133,
                    "planning_time": 0.004365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.163622,
                    "execution_time": 0.012851,
                    "compile_time": 3.099764,
                    "planning_time": 0.039744
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1   59410.92           99108.59\n1              1  230615.77           99108.59\n2              1    3638.78           99108.59\n3              1   81478.40           99108.59\n4              1   68002.62           99108.59\n5              1   68186.57           99108.59\n6              1   73529.08           99108.59\n7              1   65792.34           99108.59\n8              1  156945.23           99108.59\n9              1   68005.44           99108.59\n10             1  153851.10           99108.59\n11             1  159846.91           99108.59\n12             2   66577.92           99299.68\n13             2    5836.71           99299.68\n14             2   83486.15           99299.68\n15             2   67221.34           99299.68\n16             2  159641.08           99299.68\n17             2  157109.79           99299.68\n18             2   69242.40           99299.68\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n        ,avg_monthly_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST , \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" LIMIT 21",
                "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1   65792.34           99108.59\n1              1   73529.08           99108.59\n2              1   68002.62           99108.59\n3              1   81478.40           99108.59\n4              1    3638.78           99108.59\n5              1   59410.92           99108.59\n6              1  230615.77           99108.59\n7              1   68005.44           99108.59\n8              1  156945.23           99108.59\n9              1  153851.10           99108.59\n10             1  159846.91           99108.59\n11             1   68186.57           99108.59\n12             2   66577.92           99299.68\n13             2   69242.40           99299.68\n14             2  225804.59           99299.68\n15             2   66969.82           99299.68\n16             2    5836.71           99299.68\n17             2  157109.79           99299.68\n18             2   57987.40           99299.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035758,
                    "execution_time": 0.008715,
                    "compile_time": 0.016833,
                    "planning_time": 0.0045
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.475158,
                    "execution_time": 0.0094,
                    "compile_time": 4.422078,
                    "planning_time": 0.040016
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1   65792.34           99108.59\n1              1   73529.08           99108.59\n2              1   68002.62           99108.59\n3              1   81478.40           99108.59\n4              1    3638.78           99108.59\n5              1   59410.92           99108.59\n6              1  230615.77           99108.59\n7              1   68005.44           99108.59\n8              1  156945.23           99108.59\n9              1  153851.10           99108.59\n10             1  159846.91           99108.59\n11             1   68186.57           99108.59\n12             2   66577.92           99299.68\n13             2   69242.40           99299.68\n14             2  225804.59           99299.68\n15             2   66969.82           99299.68\n16             2    5836.71           99299.68\n17             2  157109.79           99299.68\n18             2   57987.40           99299.68\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n        ,avg_monthly_sales\n        ,sum_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST , \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1    3638.78           99108.59\n1              1   59410.92           99108.59\n2              1   65792.34           99108.59\n3              1   68002.62           99108.59\n4              1   68005.44           99108.59\n5              1   68186.57           99108.59\n6              1   73529.08           99108.59\n7              1   81478.40           99108.59\n8              1  153851.10           99108.59\n9              1  156945.23           99108.59\n10             1  159846.91           99108.59\n11             1  230615.77           99108.59\n12             2    5836.71           99299.68\n13             2   57987.40           99299.68\n14             2   66577.92           99299.68\n15             2   66969.82           99299.68\n16             2   67221.34           99299.68\n17             2   69242.40           99299.68\n18             2   69824.57           99299.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036891,
                    "execution_time": 0.009393,
                    "compile_time": 0.01708,
                    "planning_time": 0.004624
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.474795,
                    "execution_time": 0.009019,
                    "compile_time": 3.423964,
                    "planning_time": 0.040023
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1    3638.78           99108.59\n1              1   59410.92           99108.59\n2              1   65792.34           99108.59\n3              1   68002.62           99108.59\n4              1   68005.44           99108.59\n5              1   68186.57           99108.59\n6              1   73529.08           99108.59\n7              1   81478.40           99108.59\n8              1  153851.10           99108.59\n9              1  156945.23           99108.59\n10             1  159846.91           99108.59\n11             1  230615.77           99108.59\n12             2    5836.71           99299.68\n13             2   57987.40           99299.68\n14             2   66577.92           99299.68\n15             2   66969.82           99299.68\n16             2   67221.34           99299.68\n17             2   69242.40           99299.68\n18             2   69824.57           99299.68\n...*/"
    },
    {
        "input": "-- start template query63.tpl query 27 in stream 0\nselect /* TPC-DS query63.tpl 0.27 */  * \nfrom (select i_manager_id\n             ,sum(ss_sales_price) sum_sales\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\n      from item\n          ,store_sales\n          ,date_dim\n          ,store\n      where ss_item_sk = i_item_sk\n        and ss_sold_date_sk = d_date_sk\n        and ss_store_sk = s_store_sk\n        and d_month_seq in (1223,1223+1,1223+2,1223+3,1223+4,1223+5,1223+6,1223+7,1223+8,1223+9,1223+10,1223+11)\n        and ((    i_category in ('Books','Children','Electronics')\n              and i_class in ('personal','portable','reference','self-help')\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\n           or(    i_category in ('Women','Music','Men')\n              and i_class in ('accessories','classical','fragrances','pants')\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t                 'importoamalg #1')))\ngroup by i_manager_id, d_moy) tmp1\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\norder by i_manager_id\n        ,avg_monthly_sales\n        ,sum_sales\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANAGER_ID\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1223 , 1224 , 1225 , 1226 , 1227 , 1228 , 1229 , 1230 , 1231 , 1232 , 1233 , 1234 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANAGER_ID\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"I_MANAGER_ID\" NULLS LAST , \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1    3638.78           99108.59\n1              1   59410.92           99108.59\n2              1   65792.34           99108.59\n3              1   68002.62           99108.59\n4              1   68005.44           99108.59\n5              1   68186.57           99108.59\n6              1   73529.08           99108.59\n7              1   81478.40           99108.59\n8              1  153851.10           99108.59\n9              1  156945.23           99108.59\n10             1  159846.91           99108.59\n11             1  230615.77           99108.59\n12             2    5836.71           99299.68\n13             2   57987.40           99299.68\n14             2   66577.92           99299.68\n15             2   66969.82           99299.68\n16             2   67221.34           99299.68\n17             2   69242.40           99299.68\n18             2   69824.57           99299.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019752,
                    "execution_time": 0.009333,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004628
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020088,
                    "execution_time": 0.00939,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004698
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"I_MANAGER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    i_manager_id  sum_sales  avg_monthly_sales\n0              1    3638.78           99108.59\n1              1   59410.92           99108.59\n2              1   65792.34           99108.59\n3              1   68002.62           99108.59\n4              1   68005.44           99108.59\n5              1   68186.57           99108.59\n6              1   73529.08           99108.59\n7              1   81478.40           99108.59\n8              1  153851.10           99108.59\n9              1  156945.23           99108.59\n10             1  159846.91           99108.59\n11             1  230615.77           99108.59\n12             2    5836.71           99299.68\n13             2   57987.40           99299.68\n14             2   66577.92           99299.68\n15             2   66969.82           99299.68\n16             2   67221.34           99299.68\n17             2   69242.40           99299.68\n18             2   69824.57           99299.68\n...*/"
    }
]