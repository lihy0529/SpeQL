[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price) \n from web_sales, customer, customer_address, date_dim, item group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk\ngroup by ca_zip, ca_state /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk group by ca_zip, ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792'))\n group by ca_zip, ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.273276,
                    "execution_time": 1.086363,
                    "compile_time": 0.0869,
                    "planning_time": 0.059728,
                    "create_size": 42
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.118648,
                    "execution_time": 1.179513,
                    "compile_time": 7.749415,
                    "planning_time": 0.142525,
                    "create_size": 42
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state        _col_2\n0   85669       WY  9.741997e+08\n1   85392       WY  4.784965e+08\n2   83405       CO  2.435877e+08\n3   86475       NV  1.024585e+08\n4   86197       UT  4.329344e+08\n5   85669       UT  5.647732e+08\n6   85392       AZ  1.129023e+08\n7   85460       UT  2.040317e+08\n8   80348       ID  1.626465e+08\n9   85669       NM  8.990864e+08\n10  86475       CO  1.966662e+08\n11  81792       ID  3.465722e+08\n12  86197       ID  5.449127e+08\n13  85669       NV  3.624721e+08\n14  80348       CO  1.451863e+08\n15  88274       WY  1.315444e+08\n16  85669       ID  2.683058e+09\n17  85669       CO  2.396651e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015845,
                    "execution_time": 0.006925,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003188
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.136052,
                    "execution_time": 0.007644,
                    "compile_time": 0.081867,
                    "planning_time": 0.038428
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state        _col_2\n0   85669       WY  9.741997e+08\n1   85392       WY  4.784965e+08\n2   83405       CO  2.435877e+08\n3   86475       NV  1.024585e+08\n4   86197       UT  4.329344e+08\n5   85669       UT  5.647732e+08\n6   85392       AZ  1.129023e+08\n7   85460       UT  2.040317e+08\n8   80348       ID  1.626465e+08\n9   85669       NM  8.990864e+08\n10  86475       CO  1.966662e+08\n11  81792       ID  3.465722e+08\n12  86197       ID  5.449127e+08\n13  85669       NV  3.624721e+08\n14  80348       CO  1.451863e+08\n15  88274       WY  1.315444e+08\n16  85669       ID  2.683058e+09\n17  85669       CO  2.396651e+09*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n/*CURSOR_IDENTIFIER*/\n )\n group by ca_zip, ca_state",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state        _col_2\n0   86475       CO  1.966662e+08\n1   81792       ID  3.465722e+08\n2   86197       ID  5.449127e+08\n3   85669       NV  3.624721e+08\n4   80348       CO  1.451863e+08\n5   85669       NM  8.990864e+08\n6   88274       WY  1.315444e+08\n7   85669       ID  2.683058e+09\n8   85669       CO  2.396651e+09\n9   85669       UT  5.647732e+08\n10  85392       AZ  1.129023e+08\n11  85460       UT  2.040317e+08\n12  80348       ID  1.626465e+08\n13  86197       UT  4.329344e+08\n14  85669       WY  9.741997e+08\n15  85392       WY  4.784965e+08\n16  83405       CO  2.435877e+08\n17  86475       NV  1.024585e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016438,
                    "execution_time": 0.007785,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00306
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051009,
                    "execution_time": 0.007009,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038103
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state        _col_2\n0   86475       CO  1.966662e+08\n1   81792       ID  3.465722e+08\n2   86197       ID  5.449127e+08\n3   85669       NV  3.624721e+08\n4   80348       CO  1.451863e+08\n5   85669       NM  8.990864e+08\n6   88274       WY  1.315444e+08\n7   85669       ID  2.683058e+09\n8   85669       CO  2.396651e+09\n9   85669       UT  5.647732e+08\n10  85392       AZ  1.129023e+08\n11  85460       UT  2.040317e+08\n12  80348       ID  1.626465e+08\n13  86197       UT  4.329344e+08\n14  85669       WY  9.741997e+08\n15  85392       WY  4.784965e+08\n16  83405       CO  2.435877e+08\n17  86475       NV  1.024585e+08*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)))\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.12223,
                    "execution_time": 0.035313,
                    "compile_time": 0.03664,
                    "planning_time": 0.025206,
                    "create_size": 36
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.44334,
                    "execution_time": 0.035897,
                    "compile_time": 3.291049,
                    "planning_time": 0.085987,
                    "create_size": 36
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" FROM 1 FOR 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ NULL as ca_zip, NULL as ca_state, sum(i_current_price) as ws_sales_price\n from item\n where i_item_id in (select i_item_id\n                     from item\n                     where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                     )\n and substring(NULL,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.1821,
                    "execution_time": 0.034179,
                    "compile_time": 0.092507,
                    "planning_time": 0.028734,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.546512,
                    "execution_time": 0.035123,
                    "compile_time": 6.386721,
                    "planning_time": 0.089132,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"WS_SALES_PRICE\" AS \"WS_SALES_PRICE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*  ca_zip ca_state ws_sales_price\n0   None     None           None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03159,
                    "execution_time": 0.007722,
                    "compile_time": 0.014926,
                    "planning_time": 0.003141
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.157781,
                    "execution_time": 0.007754,
                    "compile_time": 3.10248,
                    "planning_time": 0.038273
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"WS_SALES_PRICE\" AS \"WS_SALES_PRICE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*  ca_zip ca_state ws_sales_price\n0   None     None           None*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\ngroup by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" FROM 1 FOR 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales\n join customer on ws_bill_customer_sk = c_customer_sk\n join customer_address on c_current_addr_sk = ca_address_sk \n join date_dim on ws_sold_date_sk = d_date_sk\n join item on ws_item_sk = i_item_sk \n where ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.095278,
                    "execution_time": 1.97612,
                    "compile_time": 0.000631,
                    "planning_time": 0.072281,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 23.451489,
                    "execution_time": 1.991583,
                    "compile_time": 21.254685,
                    "planning_time": 0.152952,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   95709       AK  133.46\n1   99237       CA   10.93\n2   39237       AL  111.19\n3   21669       NC   64.51\n4   56787       MN   19.46\n5   59310       MN   93.95\n6   89532       ID   18.46\n7   28371       NC  206.29\n8   31675       AL   99.18\n9   39101       AL  138.17\n10  69101       MO  101.85\n11  76557       TX  387.18\n12  60913       MO    0.76\n13  52812       IA   15.20\n14  31669       TN  101.74\n15  54854       WI   22.82\n16  05454       CT  151.74\n17  36098       FL   98.51\n18  86277       ID   52.32\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016082,
                    "execution_time": 0.007184,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003156
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05415,
                    "execution_time": 0.0076,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038391
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   95709       AK  133.46\n1   99237       CA   10.93\n2   39237       AL  111.19\n3   21669       NC   64.51\n4   56787       MN   19.46\n5   59310       MN   93.95\n6   89532       ID   18.46\n7   28371       NC  206.29\n8   31675       AL   99.18\n9   39101       AL  138.17\n10  69101       MO  101.85\n11  76557       TX  387.18\n12  60913       MO    0.76\n13  52812       IA   15.20\n14  31669       TN  101.74\n15  54854       WI   22.82\n16  05454       CT  151.74\n17  36098       FL   98.51\n18  86277       ID   52.32\n...*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.885688,
                    "execution_time": 0.733415,
                    "compile_time": 0.036555,
                    "planning_time": 0.074226,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.405315,
                    "execution_time": 0.725528,
                    "compile_time": 3.476956,
                    "planning_time": 0.154036,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   58354       ND  120.28\n1   21087       VA   51.76\n2   63511       KS   80.93\n3   20162       NC   70.15\n4   20499       WV  151.93\n5   64098       MO   85.64\n6   39003       AL  161.17\n7   30534       FL   27.86\n8   89532       ID   17.12\n9   93003       AK  113.34\n10  21821       WV    3.18\n11  71757       TX   24.30\n12  85392       WY  838.52\n13  85669       WY  480.89\n14  70169       OK   44.85\n15  88014       CO   54.76\n16  63683       MO    6.51\n17  28222       WV    5.45\n18  48222       IN  103.97\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01603,
                    "execution_time": 0.007119,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003198
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053575,
                    "execution_time": 0.007269,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.03837
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   58354       ND  120.28\n1   21087       VA   51.76\n2   63511       KS   80.93\n3   20162       NC   70.15\n4   20499       WV  151.93\n5   64098       MO   85.64\n6   39003       AL  161.17\n7   30534       FL   27.86\n8   89532       ID   17.12\n9   93003       AK  113.34\n10  21821       WV    3.18\n11  71757       TX   24.30\n12  85392       WY  838.52\n13  85669       WY  480.89\n14  70169       OK   44.85\n15  88014       CO   54.76\n16  63683       MO    6.51\n17  28222       WV    5.45\n18  48222       IN  103.97\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   58354       ND  120.28\n1   21087       VA   51.76\n2   63511       KS   80.93\n3   20162       NC   70.15\n4   20499       WV  151.93\n5   64098       MO   85.64\n6   39003       AL  161.17\n7   30534       FL   27.86\n8   89532       ID   17.12\n9   93003       AK  113.34\n10  21821       WV    3.18\n11  71757       TX   24.30\n12  85392       WY  838.52\n13  85669       WY  480.89\n14  70169       OK   44.85\n15  88014       CO   54.76\n16  63683       MO    6.51\n17  28222       WV    5.45\n18  48222       IN  103.97\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01593,
                    "execution_time": 0.007224,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003054
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051792,
                    "execution_time": 0.00786,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038103
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   58354       ND  120.28\n1   21087       VA   51.76\n2   63511       KS   80.93\n3   20162       NC   70.15\n4   20499       WV  151.93\n5   64098       MO   85.64\n6   39003       AL  161.17\n7   30534       FL   27.86\n8   89532       ID   17.12\n9   93003       AK  113.34\n10  21821       WV    3.18\n11  71757       TX   24.30\n12  85392       WY  838.52\n13  85669       WY  480.89\n14  70169       OK   44.85\n15  88014       CO   54.76\n16  63683       MO    6.51\n17  28222       WV    5.45\n18  48222       IN  103.97\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n order by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" , \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0                   374.35\n1               AL   87.31\n2               NC   13.89\n3               NE   41.50\n4               NH   14.88\n5   01011       VT   30.23\n6   04111       ME   22.50\n7   08822       ME   16.67\n8   11521       NY  101.38\n9   11749       NY   51.70\n10  11904       PA   97.90\n11  13511       PA    4.33\n12  14975       NY   41.86\n13  15817       NY   80.26\n14  16060       PA  150.33\n15  16719       PA    9.40\n16  20059       VA    0.00\n17  20162       NC   70.15\n18  20162       VA    8.84\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032831,
                    "execution_time": 0.008436,
                    "compile_time": 0.014975,
                    "planning_time": 0.003611
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.259267,
                    "execution_time": 0.009296,
                    "compile_time": 3.207585,
                    "planning_time": 0.038572
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0                   374.35\n1               AL   87.31\n2               NC   13.89\n3               NE   41.50\n4               NH   14.88\n5   01011       VT   30.23\n6   04111       ME   22.50\n7   08822       ME   16.67\n8   11521       NY  101.38\n9   11749       NY   51.70\n10  11904       PA   97.90\n11  13511       PA    4.33\n12  14975       NY   41.86\n13  15817       NY   80.26\n14  16060       PA  150.33\n15  16719       PA    9.40\n16  20059       VA    0.00\n17  20162       NC   70.15\n18  20162       VA    8.84\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n order by ca_zip, ca_state\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" , \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0                   374.35\n1               AL   87.31\n2               NC   13.89\n3               NE   41.50\n4               NH   14.88\n5   01011       VT   30.23\n6   04111       ME   22.50\n7   08822       ME   16.67\n8   11521       NY  101.38\n9   11749       NY   51.70\n10  11904       PA   97.90\n11  13511       PA    4.33\n12  14975       NY   41.86\n13  15817       NY   80.26\n14  16060       PA  150.33\n15  16719       PA    9.40\n16  20059       VA    0.00\n17  20162       NC   70.15\n18  20162       VA    8.84\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017554,
                    "execution_time": 0.008236,
                    "compile_time": 0.000108,
                    "planning_time": 0.003566
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018166,
                    "execution_time": 0.008505,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.003692
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0                   374.35\n1               AL   87.31\n2               NC   13.89\n3               NE   41.50\n4               NH   14.88\n5   01011       VT   30.23\n6   04111       ME   22.50\n7   08822       ME   16.67\n8   11521       NY  101.38\n9   11749       NY   51.70\n10  11904       PA   97.90\n11  13511       PA    4.33\n12  14975       NY   41.86\n13  15817       NY   80.26\n14  16060       PA  150.33\n15  16719       PA    9.40\n16  20059       VA    0.00\n17  20162       NC   70.15\n18  20162       VA    8.84\n...*/"
    }
]