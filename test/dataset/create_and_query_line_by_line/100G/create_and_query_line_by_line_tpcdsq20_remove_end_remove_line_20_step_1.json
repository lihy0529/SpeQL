[
    {
        "input": "select /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over () as percentage_of_total_sales\n/*CURSOR_IDENTIFIER*/\nfrom item\njoin catalog_sales on cs_item_sk = i_item_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.510877,
                    "execution_time": 6.80941,
                    "compile_time": 0.000682,
                    "planning_time": 0.035998,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.824329,
                    "execution_time": 10.037789,
                    "compile_time": 0.008599,
                    "planning_time": 0.111493,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"PERCENTAGE_OF_TOTAL_SALES\" AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category          i_class  i_current_price  itemrevenue  percentage_of_total_sales\n0   AAAAAAAAADBDAAAA                                                                                                                Upper men used to give still different girls. Proposals subsidise famous nerves. C        Books   entertainments             2.21   1503804.06                     0.0004\n1   AAAAAAAABMDMAAAA                                                                            Full needs guard then hands. Central, long-term boys keep true in a letters. Earlier little territories shall not star       Sports          fishing             5.88   3605982.12                     0.0009\n2   AAAAAAAAIPLBDAAA                                                                                            Only unchanged masters can pass very; correct, present forces may play able qualities. Children ought         Books          cooking             2.86   2126174.77                     0.0005\n3   AAAAAAAAOAMJAAAA         Agricultural, past films forgive. Aware, beneficial agencies shall imagine just yellow, marginal failures. Legitimate, causal areas can contain ill acts. Distinct sales might like offic        Shoes         athletic             3.80   2134156.73                     0.0005\n4   AAAAAAAAOOMFBAAA                                                               Changing, different schools want blindly civil wives. Deep fine leaders want; rapid, reasonable days shall find as also fierce year     Children          infants             4.89   1393827.60                     0.0003\n5   AAAAAAAAIKDDCAAA                                                                                                                           Previous activities shall see technical, opposite parts; police will ma       Sports             golf             2.29   2029105.85                     0.0005\n6   AAAAAAAAAIMBCAAA                                                                                                                                  Enough quiet representatives give oddly jobs. Great pp. used to   Electronics      disk drives             6.89   2193371.19                     0.0006\n7   AAAAAAAAPOLIBAAA                                   Ill tall times argue ever prospective associations. Good, good premises open; strong others buy centres. Very top members affect on the tools. Thus able centur     Children          newborn             4.97   3277969.57                     0.0008\n8   AAAAAAAAJDEIBAAA                                                                                                                                                                   Hardly tiny stations may not se        Shoes             kids             2.38   3573885.80                     0.0009\n9   AAAAAAAABPKNBAAA                                      Neat, large messages tell to the doubts. Nurses rely previous, unable results; different, labour elections advise quite big ministers. Kilometres ought to l        Women         swimwear             0.45   3676754.30                     0.0010\n10  AAAAAAAAKAGICAAA                                        Simple years emphasise often detailed differences. Unions should include now only nice acids. Factors point either tall rooms; old sectors concede over. J        Books        parenting             2.49   2092192.51                     0.0005\n11  AAAAAAAANGMJAAAA                                                                                                                                   Yellow, great pictures should not provide arguments. Social, re        Shoes             mens             2.85   3641971.96                     0.0009\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018779,
                    "execution_time": 0.00813,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.00402
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054469,
                    "execution_time": 0.007759,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039399
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER () AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"PERCENTAGE_OF_TOTAL_SALES\" AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category          i_class  i_current_price  itemrevenue  percentage_of_total_sales\n0   AAAAAAAAADBDAAAA                                                                                                                Upper men used to give still different girls. Proposals subsidise famous nerves. C        Books   entertainments             2.21   1503804.06                     0.0004\n1   AAAAAAAABMDMAAAA                                                                            Full needs guard then hands. Central, long-term boys keep true in a letters. Earlier little territories shall not star       Sports          fishing             5.88   3605982.12                     0.0009\n2   AAAAAAAAIPLBDAAA                                                                                            Only unchanged masters can pass very; correct, present forces may play able qualities. Children ought         Books          cooking             2.86   2126174.77                     0.0005\n3   AAAAAAAAOAMJAAAA         Agricultural, past films forgive. Aware, beneficial agencies shall imagine just yellow, marginal failures. Legitimate, causal areas can contain ill acts. Distinct sales might like offic        Shoes         athletic             3.80   2134156.73                     0.0005\n4   AAAAAAAAOOMFBAAA                                                               Changing, different schools want blindly civil wives. Deep fine leaders want; rapid, reasonable days shall find as also fierce year     Children          infants             4.89   1393827.60                     0.0003\n5   AAAAAAAAIKDDCAAA                                                                                                                           Previous activities shall see technical, opposite parts; police will ma       Sports             golf             2.29   2029105.85                     0.0005\n6   AAAAAAAAAIMBCAAA                                                                                                                                  Enough quiet representatives give oddly jobs. Great pp. used to   Electronics      disk drives             6.89   2193371.19                     0.0006\n7   AAAAAAAAPOLIBAAA                                   Ill tall times argue ever prospective associations. Good, good premises open; strong others buy centres. Very top members affect on the tools. Thus able centur     Children          newborn             4.97   3277969.57                     0.0008\n8   AAAAAAAAJDEIBAAA                                                                                                                                                                   Hardly tiny stations may not se        Shoes             kids             2.38   3573885.80                     0.0009\n9   AAAAAAAABPKNBAAA                                      Neat, large messages tell to the doubts. Nurses rely previous, unable results; different, labour elections advise quite big ministers. Kilometres ought to l        Women         swimwear             0.45   3676754.30                     0.0010\n10  AAAAAAAAKAGICAAA                                        Simple years emphasise often detailed differences. Unions should include now only nice acids. Factors point either tall rooms; old sectors concede over. J        Books        parenting             2.49   2092192.51                     0.0005\n11  AAAAAAAANGMJAAAA                                                                                                                                   Yellow, great pictures should not provide arguments. Social, re        Shoes             mens             2.85   3641971.96                     0.0009\n...*/"
    },
    {
        "input": "SELECT /* TPC-DS query20.tpl 0.65 */ i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,SUM(cs_ext_sales_price) AS itemrevenue \n       ,SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER\n           (PARTITION BY i_class) AS revenueratio\n/*CURSOR_IDENTIFIER*/\nFROM catalog_sales cs\nJOIN item i ON cs.cs_item_sk = i.i_item_sk\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price;",
        "optimize": [
            "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.853994,
                    "execution_time": 6.54562,
                    "compile_time": 0.000725,
                    "planning_time": 0.036985,
                    "create_size": 1303
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.8943,
                    "execution_time": 6.518314,
                    "compile_time": 0.000719,
                    "planning_time": 0.104789,
                    "create_size": 1303
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"I\".\"I_CLASS\" AS \"I_CLASS\", \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CS\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CS\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CS\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"I\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\", \"I\".\"I_ITEM_DESC\", \"I\".\"I_CATEGORY\", \"I\".\"I_CLASS\", \"I\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  CS_ITEM_SK as i_item_id\n       ,null as i_item_desc \n       ,null as i_category \n       ,null as i_class \n       ,CS_SALES_PRICE as i_current_price\n       ,sum(CS_EXT_SALES_PRICE) as itemrevenue \n       ,sum(CS_EXT_SALES_PRICE)*100/sum(sum(CS_EXT_SALES_PRICE)) over\n           (partition by CS_ITEM_SK) as revenueratio\n from\tcatalog_sales\n group by CS_ITEM_SK, CS_SALES_PRICE\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" LIMIT 21",
                "preview": "\n/*    i_item_id i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0          22        None       None    None             1.66       129.48        0.0083\n1          22        None       None    None            73.28      3737.28        0.2413\n2          22        None       None    None            22.07       728.31        0.0470\n3          22        None       None    None           230.98     12472.92        0.8055\n4          22        None       None    None             9.86       414.12        0.0267\n5          22        None       None    None            19.32       251.16        0.0162\n6          22        None       None    None             9.17       788.62        0.0509\n7          22        None       None    None            11.11        88.88        0.0057\n8          22        None       None    None            12.94      1294.00        0.0835\n9          22        None       None    None            87.30      3317.40        0.2142\n10         22        None       None    None            28.10      3821.60        0.2468\n11         22        None       None    None            39.38       748.22        0.0483\n12         22        None       None    None           116.57      6644.49        0.4291\n13         22        None       None    None            97.37      6231.68        0.4024\n14         22        None       None    None            54.76      1916.60        0.1237\n15         22        None       None    None             2.30        73.60        0.0047\n16         22        None       None    None            76.05      5475.60        0.3536\n17         22        None       None    None            35.35      2014.95        0.1301\n18         22        None       None    None            71.43      1285.74        0.0830\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 24.609734,
                    "execution_time": 24.567228,
                    "compile_time": 0.000151,
                    "planning_time": 0.028161
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 28.775185,
                    "execution_time": 28.676841,
                    "compile_time": 0.001037,
                    "planning_time": 0.086895
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\", NULL AS \"I_ITEM_DESC\", NULL AS \"I_CATEGORY\", NULL AS \"I_CLASS\", \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\", \"CATALOG_SALES\".\"CS_SALES_PRICE\"",
                "rewrite": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\""
            }
        ],
        "preview": "\n/*    i_item_id i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0          22        None       None    None             1.66       129.48        0.0083\n1          22        None       None    None            73.28      3737.28        0.2413\n2          22        None       None    None            22.07       728.31        0.0470\n3          22        None       None    None           230.98     12472.92        0.8055\n4          22        None       None    None             9.86       414.12        0.0267\n5          22        None       None    None            19.32       251.16        0.0162\n6          22        None       None    None             9.17       788.62        0.0509\n7          22        None       None    None            11.11        88.88        0.0057\n8          22        None       None    None            12.94      1294.00        0.0835\n9          22        None       None    None            87.30      3317.40        0.2142\n10         22        None       None    None            28.10      3821.60        0.2468\n11         22        None       None    None            39.38       748.22        0.0483\n12         22        None       None    None           116.57      6644.49        0.4291\n13         22        None       None    None            97.37      6231.68        0.4024\n14         22        None       None    None            54.76      1916.60        0.1237\n15         22        None       None    None             2.30        73.60        0.0047\n16         22        None       None    None            76.05      5475.60        0.3536\n17         22        None       None    None            35.35      2014.95        0.1301\n18         22        None       None    None            71.43      1285.74        0.0830\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.431118,
                    "execution_time": 2.206931,
                    "compile_time": 0.000646,
                    "planning_time": 0.046425,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.700256,
                    "execution_time": 4.396895,
                    "compile_time": 0.001717,
                    "planning_time": 0.121069,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_3\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_3\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACNAIAAAA                                                                                                                                    Children understand conclusions. In addition appropriate plans sha  Electronics  portable             0.17   2202698.47        0.1000\n1   AAAAAAAAILLOCAAA                                                                                                          Courses will look in common poor, low courses. Always substantial rats used to fetch english  Electronics  portable             8.25   1362165.21        0.0618\n2   AAAAAAAANIOHBAAA         Perfect cells copy in part social, direct pp.. Only human costs may read merely unknown levels. Problems declare. Primary, crucial pictures remove gross plans. There afraid others ought to   Electronics  portable             6.57   3838605.02        0.1743\n3   AAAAAAAALJPIAAAA                                                                                                                                   Automatic actions stand near in a streets. Following processes add   Electronics  portable             1.39   3737086.77        0.1697\n4   AAAAAAAAAJGICAAA                                                                                                Independently technical thanks may act just great, defensive movements. Defences may go too; interests  Electronics  portable             0.39   1411658.44        0.0641\n5   AAAAAAAAIBHADAAA  Keen, various acres trust too only, real years. Concepts will take about young points. Real farmers can use vice versa fine councillors. Just frequent lights cannot list simply in a sisters. Needs  Electronics  portable             7.97   1428974.05        0.0649\n6   AAAAAAAACEEBCAAA                                                                                                               Women think potentially legitimate clients. Good women shall not ensure otherwise resid  Electronics  portable             0.83   1431776.78        0.0650\n7   AAAAAAAAFBLNBAAA                                                                    Women name at all rough, precise things. Social, national cities train possible, special jobs. Premier, desirable hospitals will w  Electronics  portable            30.62   3697017.09        0.1679\n8   AAAAAAAAKJMFBAAA                                                                                                                                                                          Important years may heed as   Electronics  portable             1.91   1595991.92        0.0724\n9   AAAAAAAALBGLCAAA                                                                 Massive connections will not confirm particles. Christian agencies release ever police. Explicit, left matters shall talk serious rat  Electronics  portable             3.46   3645202.47        0.1655\n10  AAAAAAAAAMFBBAAA                                                                                                                                                                                                    Gr  Electronics  portable             0.34   1489931.12        0.0676\n11  AAAAAAAAMKJLCAAA                                                                                                                                                    Great, old topics will not invent constant bodies;  Electronics  portable             4.81   2075780.77        0.0942\n12  AAAAAAAAOMAACAAA                                            Otherwise scottish authors replace detailed wines; unable, gentle cheeks should not acquire as urban, exact services. Also changing years would mark large  Electronics  portable            78.06   1393130.36        0.0632\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019053,
                    "execution_time": 0.007706,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.005109
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05474,
                    "execution_time": 0.007347,
                    "compile_time": 5e-05,
                    "planning_time": 0.040221
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_3\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_3\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACNAIAAAA                                                                                                                                    Children understand conclusions. In addition appropriate plans sha  Electronics  portable             0.17   2202698.47        0.1000\n1   AAAAAAAAILLOCAAA                                                                                                          Courses will look in common poor, low courses. Always substantial rats used to fetch english  Electronics  portable             8.25   1362165.21        0.0618\n2   AAAAAAAANIOHBAAA         Perfect cells copy in part social, direct pp.. Only human costs may read merely unknown levels. Problems declare. Primary, crucial pictures remove gross plans. There afraid others ought to   Electronics  portable             6.57   3838605.02        0.1743\n3   AAAAAAAALJPIAAAA                                                                                                                                   Automatic actions stand near in a streets. Following processes add   Electronics  portable             1.39   3737086.77        0.1697\n4   AAAAAAAAAJGICAAA                                                                                                Independently technical thanks may act just great, defensive movements. Defences may go too; interests  Electronics  portable             0.39   1411658.44        0.0641\n5   AAAAAAAAIBHADAAA  Keen, various acres trust too only, real years. Concepts will take about young points. Real farmers can use vice versa fine councillors. Just frequent lights cannot list simply in a sisters. Needs  Electronics  portable             7.97   1428974.05        0.0649\n6   AAAAAAAACEEBCAAA                                                                                                               Women think potentially legitimate clients. Good women shall not ensure otherwise resid  Electronics  portable             0.83   1431776.78        0.0650\n7   AAAAAAAAFBLNBAAA                                                                    Women name at all rough, precise things. Social, national cities train possible, special jobs. Premier, desirable hospitals will w  Electronics  portable            30.62   3697017.09        0.1679\n8   AAAAAAAAKJMFBAAA                                                                                                                                                                          Important years may heed as   Electronics  portable             1.91   1595991.92        0.0724\n9   AAAAAAAALBGLCAAA                                                                 Massive connections will not confirm particles. Christian agencies release ever police. Explicit, left matters shall talk serious rat  Electronics  portable             3.46   3645202.47        0.1655\n10  AAAAAAAAAMFBBAAA                                                                                                                                                                                                    Gr  Electronics  portable             0.34   1489931.12        0.0676\n11  AAAAAAAAMKJLCAAA                                                                                                                                                    Great, old topics will not invent constant bodies;  Electronics  portable             4.81   2075780.77        0.0942\n12  AAAAAAAAOMAACAAA                                            Otherwise scottish authors replace detailed wines; unable, gentle cheeks should not acquire as urban, exact services. Also changing years would mark large  Electronics  portable            78.06   1393130.36        0.0632\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) and cast('1998-05-20' as date) \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-05-20' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-05-20' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.273834,
                    "execution_time": 0.116361,
                    "compile_time": 0.000657,
                    "planning_time": 0.060307,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.344339,
                    "execution_time": 0.117998,
                    "compile_time": 0.003607,
                    "planning_time": 0.120833,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_4\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                             i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAABDMGAAAA  Statutory programs make also still overall trousers. Close, long matters might not think until a steps. More small devices should know into the quarters. Profits may   Electronics  portable             5.93      3595.63        0.0638\n1   AAAAAAAAIJPCAAAA                                  Thousands increase substantial women. All living representatives will reduce like a principles; much trying teachers replace only now   Electronics  portable             5.27     10137.88        0.1801\n2   AAAAAAAAEDPOCAAA                                                  Protective, yellow democrats shall look only. Necessary feet could allocate actively big skills. Always light states m  Electronics  portable            62.64      2725.60        0.0484\n3   AAAAAAAAIFIBDAAA                                                      Also typical ways cannot investigate new, effective months. Eyes will not call apparently for the purposes. Quite   Electronics  portable             3.39     12738.94        0.2263\n4   AAAAAAAAKCBNAAAA                                                                                                                                               Plants will decide especi  Electronics  portable             0.51      9791.73        0.1739\n5   AAAAAAAAKCGPCAAA            Studies go between the bodies. Even remarkable experts review then to a arts; also bare principles postpone in a hands. Regularly blind houses may not avoid  Electronics  portable             3.03      5289.20        0.0939\n6   AAAAAAAADPAKAAAA                                                                                                                  Materials survive quite too various friends. Difficult  Electronics  portable             1.78     19844.30        0.3525\n7   AAAAAAAALBGLCAAA                                   Massive connections will not confirm particles. Christian agencies release ever police. Explicit, left matters shall talk serious rat  Electronics  portable             3.46     10185.76        0.1809\n8   AAAAAAAAECPMBAAA                                                        Always spare aspects would modify better considerable great advertisements. At first difficult shares integrate   Electronics  portable            67.79      6022.17        0.1069\n9   AAAAAAAAMFAPAAAA                                      Harsh, quiet groups browse definitely official, changing titles. Recent, live children could need in the patterns. Responsible mot  Electronics  portable             4.08     11727.15        0.2083\n10  AAAAAAAAHAFPBAAA                                                                                                                                         Bodies justify so angry, recent  Electronics  portable             3.63      2568.62        0.0456\n11  AAAAAAAACPMBCAAA                    Great, delicate lessons go obviously then distinct relations. Rightly military parts precipitate also certain, true germans. Full efforts perform su  Electronics  portable             3.98     16825.89        0.2989\n12  AAAAAAAAOLMBCAAA          Principles may not achieve also units. Feet will go polish, appropriate parties. Tough, particular tests see more in a results. Russian, heavy needs will work  Electronics  portable             3.93      4190.47        0.0744\n13  AAAAAAAACLFEBAAA                                                                Difficult, national premises may not get at all combined plants. Necessary articles could demonstrate do  Electronics  portable             3.94      3552.39        0.0631\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018648,
                    "execution_time": 0.007352,
                    "compile_time": 5e-05,
                    "planning_time": 0.005032
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055107,
                    "execution_time": 0.007866,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040229
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST('1998-05-20' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_4\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                             i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAABDMGAAAA  Statutory programs make also still overall trousers. Close, long matters might not think until a steps. More small devices should know into the quarters. Profits may   Electronics  portable             5.93      3595.63        0.0638\n1   AAAAAAAAIJPCAAAA                                  Thousands increase substantial women. All living representatives will reduce like a principles; much trying teachers replace only now   Electronics  portable             5.27     10137.88        0.1801\n2   AAAAAAAAEDPOCAAA                                                  Protective, yellow democrats shall look only. Necessary feet could allocate actively big skills. Always light states m  Electronics  portable            62.64      2725.60        0.0484\n3   AAAAAAAAIFIBDAAA                                                      Also typical ways cannot investigate new, effective months. Eyes will not call apparently for the purposes. Quite   Electronics  portable             3.39     12738.94        0.2263\n4   AAAAAAAAKCBNAAAA                                                                                                                                               Plants will decide especi  Electronics  portable             0.51      9791.73        0.1739\n5   AAAAAAAAKCGPCAAA            Studies go between the bodies. Even remarkable experts review then to a arts; also bare principles postpone in a hands. Regularly blind houses may not avoid  Electronics  portable             3.03      5289.20        0.0939\n6   AAAAAAAADPAKAAAA                                                                                                                  Materials survive quite too various friends. Difficult  Electronics  portable             1.78     19844.30        0.3525\n7   AAAAAAAALBGLCAAA                                   Massive connections will not confirm particles. Christian agencies release ever police. Explicit, left matters shall talk serious rat  Electronics  portable             3.46     10185.76        0.1809\n8   AAAAAAAAECPMBAAA                                                        Always spare aspects would modify better considerable great advertisements. At first difficult shares integrate   Electronics  portable            67.79      6022.17        0.1069\n9   AAAAAAAAMFAPAAAA                                      Harsh, quiet groups browse definitely official, changing titles. Recent, live children could need in the patterns. Responsible mot  Electronics  portable             4.08     11727.15        0.2083\n10  AAAAAAAAHAFPBAAA                                                                                                                                         Bodies justify so angry, recent  Electronics  portable             3.63      2568.62        0.0456\n11  AAAAAAAACPMBCAAA                    Great, delicate lessons go obviously then distinct relations. Rightly military parts precipitate also certain, true germans. Full efforts perform su  Electronics  portable             3.98     16825.89        0.2989\n12  AAAAAAAAOLMBCAAA          Principles may not achieve also units. Feet will go polish, appropriate parties. Tough, particular tests see more in a results. Russian, heavy needs will work  Electronics  portable             3.93      4190.47        0.0744\n13  AAAAAAAACLFEBAAA                                                                Difficult, national premises may not get at all combined plants. Necessary articles could demonstrate do  Electronics  portable             3.94      3552.39        0.0631\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAHAAAAA                                                                                                                                                           Likely doctors give most. Awful problems att     Sports  basketball             2.16     39884.50        0.1762\n1   AAAAAAAAEIOMAAAA                              Never important hours take in a weekends; tracks could make in general unexpected millions. Tight unlikely charges used to go particularly concerning a signs. Normal, cr     Sports  basketball             4.26     31427.09        0.1389\n2   AAAAAAAAKKCHAAAA                                                                                                                            Still swiss years might face nearly championships; inevitably traditional m     Sports  basketball             4.27     33991.90        0.1502\n3   AAAAAAAADIOFBAAA                                                                                            Roman foundations can tell inside radical, other patterns. Available, northern events consider only general     Sports  basketball             2.99     51962.11        0.2296\n4   AAAAAAAAHCKOBAAA                                                                                                                                                                                         British garden     Sports  basketball            87.85     33521.29        0.1481\n5   AAAAAAAAEJMFBAAA                                                                                                                                     Goods call. Useful, educational reactions must not trigger years.      Sports  basketball             3.16     61514.13        0.2718\n6   AAAAAAAAEHKKAAAA                                   Cards can let with a grounds; better selective women listen successfully strictly previous games; great walls might trace later young, professional wages. Final par     Sports  basketball             0.42     65142.58        0.2879\n7   AAAAAAAAFHIHBAAA  Numerous books leave through a houses. Rapid, high systems avoid for a patients. Immediate sentences may not win actually initial, happy developments. Other, criminal dates stay again. Key, christi     Sports  basketball            21.97     26919.26        0.1189\n8   AAAAAAAAODBABAAA                                                                       Feet call thereafter besides only employers; open years might perform most also limited doors. Workers should not forget big gro     Sports  basketball             8.04     30450.53        0.1345\n9   AAAAAAAABMIDBAAA                     Loud possible variations would order however precious red others. Entirely important systems interview black provisions; companies will reassess furthermore even overall quantiti     Sports  basketball             6.12     20081.40        0.0887\n10  AAAAAAAAGDLBCAAA                          Negotiations should not support hot, democratic grounds. Dependent subjects may achieve hard pale, great sports; members should write so available, general tickets; professi     Sports  basketball             1.41     49382.25        0.2182\n11  AAAAAAAAABFDBAAA                                                                                                                                                                         British ways begin social eyes     Sports  basketball             3.69     29551.75        0.1306\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.482691,
                    "execution_time": 0.390622,
                    "compile_time": 0.031693,
                    "planning_time": 0.042944
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.014435,
                    "execution_time": 0.379774,
                    "compile_time": 3.5049,
                    "planning_time": 0.110005
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAHAAAAA                                                                                                                                                           Likely doctors give most. Awful problems att     Sports  basketball             2.16     39884.50        0.1762\n1   AAAAAAAAEIOMAAAA                              Never important hours take in a weekends; tracks could make in general unexpected millions. Tight unlikely charges used to go particularly concerning a signs. Normal, cr     Sports  basketball             4.26     31427.09        0.1389\n2   AAAAAAAAKKCHAAAA                                                                                                                            Still swiss years might face nearly championships; inevitably traditional m     Sports  basketball             4.27     33991.90        0.1502\n3   AAAAAAAADIOFBAAA                                                                                            Roman foundations can tell inside radical, other patterns. Available, northern events consider only general     Sports  basketball             2.99     51962.11        0.2296\n4   AAAAAAAAHCKOBAAA                                                                                                                                                                                         British garden     Sports  basketball            87.85     33521.29        0.1481\n5   AAAAAAAAEJMFBAAA                                                                                                                                     Goods call. Useful, educational reactions must not trigger years.      Sports  basketball             3.16     61514.13        0.2718\n6   AAAAAAAAEHKKAAAA                                   Cards can let with a grounds; better selective women listen successfully strictly previous games; great walls might trace later young, professional wages. Final par     Sports  basketball             0.42     65142.58        0.2879\n7   AAAAAAAAFHIHBAAA  Numerous books leave through a houses. Rapid, high systems avoid for a patients. Immediate sentences may not win actually initial, happy developments. Other, criminal dates stay again. Key, christi     Sports  basketball            21.97     26919.26        0.1189\n8   AAAAAAAAODBABAAA                                                                       Feet call thereafter besides only employers; open years might perform most also limited doors. Workers should not forget big gro     Sports  basketball             8.04     30450.53        0.1345\n9   AAAAAAAABMIDBAAA                     Loud possible variations would order however precious red others. Entirely important systems interview black provisions; companies will reassess furthermore even overall quantiti     Sports  basketball             6.12     20081.40        0.0887\n10  AAAAAAAAGDLBCAAA                          Negotiations should not support hot, democratic grounds. Dependent subjects may achieve hard pale, great sports; members should write so available, general tickets; professi     Sports  basketball             1.41     49382.25        0.2182\n11  AAAAAAAAABFDBAAA                                                                                                                                                                         British ways begin social eyes     Sports  basketball             3.69     29551.75        0.1306\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAENOFBAAA                                                                                                                                Male, main responses use. Then perfect years make later   Electronics  cameras             6.93     15991.62        0.0758\n1   AAAAAAAAGBAMAAAA                                                                               Just direct minutes go about threats. Years shall introduce in a years; primary areas conduct. Short trou  Electronics  cameras             5.08     29566.70        0.1402\n2   AAAAAAAAICPLBAAA                       Democratic recommendations must write. Needs come about. Then other prices must influence much. Burning clothes want most early pp.. Cruel, unemployed schools ou  Electronics  cameras             1.00     20398.54        0.0967\n3   AAAAAAAAKBKBAAAA                                                                                                                                          Paintings cut institutions. Different, tiny ch  Electronics  cameras             0.20     53313.63        0.2529\n4   AAAAAAAAKJMPAAAA                                                                                                                                             Distinctive things veto. As good as crucial  Electronics  cameras             8.34     28567.57        0.1355\n5   AAAAAAAAKGIDBAAA                                                                                                                              Important publications used to see then successful styles.  Electronics  cameras             5.64     48175.41        0.2286\n6   AAAAAAAADFALAAAA                                                                                                                                             Only american plants want high, new camps.   Electronics  cameras             4.90     32684.65        0.1550\n7   AAAAAAAAMNNJCAAA                                                                                                                                                                           Words may ret  Electronics  cameras             3.55     36067.04        0.1711\n8   AAAAAAAACPOMBAAA                                                                                                 European policies put under a bodies. Even social prices must catch now fellow, similar  Electronics  cameras             2.36     14778.39        0.0701\n9   AAAAAAAAFCGIBAAA                                                   Elements shall believe happy players. Difficult offices house right artistic trees; easy experts sound later more good reforms; prima  Electronics  cameras             0.97     23428.32        0.1111\n10  AAAAAAAAEBBKAAAA                                                                                                                                                                 Preliminary, open stars  Electronics  cameras             6.99     38313.40        0.1818\n11  AAAAAAAACIGJAAAA                                                                                                                     Close rumours come more customers; sympathetic languages should rai  Electronics  cameras            78.08     34359.93        0.1630\n12  AAAAAAAACJDDCAAA                                      Cattle will not propose quite key, common services. Students stay deep restrictions. Customers think generally passengers. Alternative benefits th  Electronics  cameras             1.31     43394.57        0.2059\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.442609,
                    "execution_time": 0.381576,
                    "compile_time": 0.000298,
                    "planning_time": 0.043761
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.447066,
                    "execution_time": 0.386849,
                    "compile_time": 0.000296,
                    "planning_time": 0.042774
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAENOFBAAA                                                                                                                                Male, main responses use. Then perfect years make later   Electronics  cameras             6.93     15991.62        0.0758\n1   AAAAAAAAGBAMAAAA                                                                               Just direct minutes go about threats. Years shall introduce in a years; primary areas conduct. Short trou  Electronics  cameras             5.08     29566.70        0.1402\n2   AAAAAAAAICPLBAAA                       Democratic recommendations must write. Needs come about. Then other prices must influence much. Burning clothes want most early pp.. Cruel, unemployed schools ou  Electronics  cameras             1.00     20398.54        0.0967\n3   AAAAAAAAKBKBAAAA                                                                                                                                          Paintings cut institutions. Different, tiny ch  Electronics  cameras             0.20     53313.63        0.2529\n4   AAAAAAAAKJMPAAAA                                                                                                                                             Distinctive things veto. As good as crucial  Electronics  cameras             8.34     28567.57        0.1355\n5   AAAAAAAAKGIDBAAA                                                                                                                              Important publications used to see then successful styles.  Electronics  cameras             5.64     48175.41        0.2286\n6   AAAAAAAADFALAAAA                                                                                                                                             Only american plants want high, new camps.   Electronics  cameras             4.90     32684.65        0.1550\n7   AAAAAAAAMNNJCAAA                                                                                                                                                                           Words may ret  Electronics  cameras             3.55     36067.04        0.1711\n8   AAAAAAAACPOMBAAA                                                                                                 European policies put under a bodies. Even social prices must catch now fellow, similar  Electronics  cameras             2.36     14778.39        0.0701\n9   AAAAAAAAFCGIBAAA                                                   Elements shall believe happy players. Difficult offices house right artistic trees; easy experts sound later more good reforms; prima  Electronics  cameras             0.97     23428.32        0.1111\n10  AAAAAAAAEBBKAAAA                                                                                                                                                                 Preliminary, open stars  Electronics  cameras             6.99     38313.40        0.1818\n11  AAAAAAAACIGJAAAA                                                                                                                     Close rumours come more customers; sympathetic languages should rai  Electronics  cameras            78.08     34359.93        0.1630\n12  AAAAAAAACJDDCAAA                                      Cattle will not propose quite key, common services. Students stay deep restrictions. Customers think generally passengers. Alternative benefits th  Electronics  cameras             1.31     43394.57        0.2059\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAENOFBAAA                                                                                                                                Male, main responses use. Then perfect years make later   Electronics  cameras             6.93     15991.62        0.0758\n1   AAAAAAAAGBAMAAAA                                                                               Just direct minutes go about threats. Years shall introduce in a years; primary areas conduct. Short trou  Electronics  cameras             5.08     29566.70        0.1402\n2   AAAAAAAAICPLBAAA                       Democratic recommendations must write. Needs come about. Then other prices must influence much. Burning clothes want most early pp.. Cruel, unemployed schools ou  Electronics  cameras             1.00     20398.54        0.0967\n3   AAAAAAAAKBKBAAAA                                                                                                                                          Paintings cut institutions. Different, tiny ch  Electronics  cameras             0.20     53313.63        0.2529\n4   AAAAAAAAKJMPAAAA                                                                                                                                             Distinctive things veto. As good as crucial  Electronics  cameras             8.34     28567.57        0.1355\n5   AAAAAAAAKGIDBAAA                                                                                                                              Important publications used to see then successful styles.  Electronics  cameras             5.64     48175.41        0.2286\n6   AAAAAAAADFALAAAA                                                                                                                                             Only american plants want high, new camps.   Electronics  cameras             4.90     32684.65        0.1550\n7   AAAAAAAAMNNJCAAA                                                                                                                                                                           Words may ret  Electronics  cameras             3.55     36067.04        0.1711\n8   AAAAAAAACPOMBAAA                                                                                                 European policies put under a bodies. Even social prices must catch now fellow, similar  Electronics  cameras             2.36     14778.39        0.0701\n9   AAAAAAAAFCGIBAAA                                                   Elements shall believe happy players. Difficult offices house right artistic trees; easy experts sound later more good reforms; prima  Electronics  cameras             0.97     23428.32        0.1111\n10  AAAAAAAACIGJAAAA                                                                                                                     Close rumours come more customers; sympathetic languages should rai  Electronics  cameras            78.08     34359.93        0.1630\n11  AAAAAAAAEBBKAAAA                                                                                                                                                                 Preliminary, open stars  Electronics  cameras             6.99     38313.40        0.1818\n12  AAAAAAAACJDDCAAA                                      Cattle will not propose quite key, common services. Students stay deep restrictions. Customers think generally passengers. Alternative benefits th  Electronics  cameras             1.31     43394.57        0.2059\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.440194,
                    "execution_time": 0.378935,
                    "compile_time": 0.000305,
                    "planning_time": 0.043701
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.459826,
                    "execution_time": 0.381618,
                    "compile_time": 0.017617,
                    "planning_time": 0.043507
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAENOFBAAA                                                                                                                                Male, main responses use. Then perfect years make later   Electronics  cameras             6.93     15991.62        0.0758\n1   AAAAAAAAGBAMAAAA                                                                               Just direct minutes go about threats. Years shall introduce in a years; primary areas conduct. Short trou  Electronics  cameras             5.08     29566.70        0.1402\n2   AAAAAAAAICPLBAAA                       Democratic recommendations must write. Needs come about. Then other prices must influence much. Burning clothes want most early pp.. Cruel, unemployed schools ou  Electronics  cameras             1.00     20398.54        0.0967\n3   AAAAAAAAKBKBAAAA                                                                                                                                          Paintings cut institutions. Different, tiny ch  Electronics  cameras             0.20     53313.63        0.2529\n4   AAAAAAAAKJMPAAAA                                                                                                                                             Distinctive things veto. As good as crucial  Electronics  cameras             8.34     28567.57        0.1355\n5   AAAAAAAAKGIDBAAA                                                                                                                              Important publications used to see then successful styles.  Electronics  cameras             5.64     48175.41        0.2286\n6   AAAAAAAADFALAAAA                                                                                                                                             Only american plants want high, new camps.   Electronics  cameras             4.90     32684.65        0.1550\n7   AAAAAAAAMNNJCAAA                                                                                                                                                                           Words may ret  Electronics  cameras             3.55     36067.04        0.1711\n8   AAAAAAAACPOMBAAA                                                                                                 European policies put under a bodies. Even social prices must catch now fellow, similar  Electronics  cameras             2.36     14778.39        0.0701\n9   AAAAAAAAFCGIBAAA                                                   Elements shall believe happy players. Difficult offices house right artistic trees; easy experts sound later more good reforms; prima  Electronics  cameras             0.97     23428.32        0.1111\n10  AAAAAAAACIGJAAAA                                                                                                                     Close rumours come more customers; sympathetic languages should rai  Electronics  cameras            78.08     34359.93        0.1630\n11  AAAAAAAAEBBKAAAA                                                                                                                                                                 Preliminary, open stars  Electronics  cameras             6.99     38313.40        0.1818\n12  AAAAAAAACJDDCAAA                                      Cattle will not propose quite key, common services. Students stay deep restrictions. Customers think generally passengers. Alternative benefits th  Electronics  cameras             1.31     43394.57        0.2059\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHDICCAAA                                                                              Even certain examples find from a keys; professional, important champions may know home on a processes. National hand     Sports  baseball             2.57     39491.04        0.1817\n1   AAAAAAAAAOJPCAAA                                                                                                                                                                                            Pure th     Sports  baseball             6.73     16838.45        0.0774\n2   AAAAAAAAGGMJBAAA                                                                                                                          Holy, traditional groups could deal only arts; particularly bloody cells      Sports  baseball             4.64     34955.15        0.1608\n3   AAAAAAAAJODKBAAA                                                                                               Once bizarre children get there general, foreign points. Emotions would work british, entire readers     Sports  baseball             1.79     41977.85        0.1931\n4   AAAAAAAAMNNOAAAA                                                                                                                                                                     Linear, common years should qu     Sports  baseball             1.00     77511.30        0.3566\n5   AAAAAAAAMCEICAAA                                                                                                                     Cases will listen organic, clear boundaries; helpful, outstanding pubs must le     Sports  baseball             4.85     21511.94        0.0989\n6   AAAAAAAACNBECAAA                                                                                                                                                                    Women help silent, possible pub     Sports  baseball            90.79     12080.22        0.0555\n7   AAAAAAAAPLLADAAA                                                                                                                                                                                   Healthy, volunta     Sports  baseball             3.16     30458.26        0.1401\n8   AAAAAAAADHGBCAAA                                              Most particular officials may watch entirely democrats; just great words see already areas. Results would contribute previously. Sometimes american l     Sports  baseball             5.26     32416.06        0.1491\n9   AAAAAAAAJNOJBAAA  Empirical, empty practices escape so games. Effective themes may hit grand firms. Others take often on a features. Conditions may not work somehow large troops; legal, defensive services may me     Sports  baseball             0.53     72546.88        0.3338\n10  AAAAAAAAOPKMBAAA                Coastal clergy prepare. Appropriate, weak years place later tears. Particular, political rules might gain international, close courses. More good activities play always powerful,      Sports  baseball             1.97     41616.22        0.1914\n11  AAAAAAAAJPENCAAA                      More royal procedures may use in the heads. Famous years realise somewhat eastern inches. Fully physical regions mind expectations. Materials used to provide practical days.     Sports  baseball             4.98     53987.14        0.2484\n12  AAAAAAAAALCPAAAA                                     Young, detailed agencies shall determine rapid, national stories. Men know just. Studies appear more with the companies. Annual, new colleagues hold certainly     Sports  baseball             4.85     23625.75        0.1087\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.442514,
                    "execution_time": 0.381158,
                    "compile_time": 0.000301,
                    "planning_time": 0.043874
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.446124,
                    "execution_time": 0.384217,
                    "compile_time": 0.000299,
                    "planning_time": 0.04456
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHDICCAAA                                                                              Even certain examples find from a keys; professional, important champions may know home on a processes. National hand     Sports  baseball             2.57     39491.04        0.1817\n1   AAAAAAAAAOJPCAAA                                                                                                                                                                                            Pure th     Sports  baseball             6.73     16838.45        0.0774\n2   AAAAAAAAGGMJBAAA                                                                                                                          Holy, traditional groups could deal only arts; particularly bloody cells      Sports  baseball             4.64     34955.15        0.1608\n3   AAAAAAAAJODKBAAA                                                                                               Once bizarre children get there general, foreign points. Emotions would work british, entire readers     Sports  baseball             1.79     41977.85        0.1931\n4   AAAAAAAAMNNOAAAA                                                                                                                                                                     Linear, common years should qu     Sports  baseball             1.00     77511.30        0.3566\n5   AAAAAAAAMCEICAAA                                                                                                                     Cases will listen organic, clear boundaries; helpful, outstanding pubs must le     Sports  baseball             4.85     21511.94        0.0989\n6   AAAAAAAACNBECAAA                                                                                                                                                                    Women help silent, possible pub     Sports  baseball            90.79     12080.22        0.0555\n7   AAAAAAAAPLLADAAA                                                                                                                                                                                   Healthy, volunta     Sports  baseball             3.16     30458.26        0.1401\n8   AAAAAAAADHGBCAAA                                              Most particular officials may watch entirely democrats; just great words see already areas. Results would contribute previously. Sometimes american l     Sports  baseball             5.26     32416.06        0.1491\n9   AAAAAAAAJNOJBAAA  Empirical, empty practices escape so games. Effective themes may hit grand firms. Others take often on a features. Conditions may not work somehow large troops; legal, defensive services may me     Sports  baseball             0.53     72546.88        0.3338\n10  AAAAAAAAOPKMBAAA                Coastal clergy prepare. Appropriate, weak years place later tears. Particular, political rules might gain international, close courses. More good activities play always powerful,      Sports  baseball             1.97     41616.22        0.1914\n11  AAAAAAAAJPENCAAA                      More royal procedures may use in the heads. Famous years realise somewhat eastern inches. Fully physical regions mind expectations. Materials used to provide practical days.     Sports  baseball             4.98     53987.14        0.2484\n12  AAAAAAAAALCPAAAA                                     Young, detailed agencies shall determine rapid, national stories. Men know just. Studies appear more with the companies. Annual, new colleagues hold certainly     Sports  baseball             4.85     23625.75        0.1087\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAJJGICAAA  Conservative values make in a armies. Urban, small options come notable kinds. Pupils ought to contemplate medical, generous offences. Prominent circumstances give. Medium parts used to fit a  Electronics  cameras             1.79     31526.21        0.1495\n1   AAAAAAAACLABDAAA                                                                                                                                     Most current concepts used to restrict usually inc nice year  Electronics  cameras             6.45     19293.61        0.0915\n2   AAAAAAAADAHFBAAA                                                                                                                                                                                       Important   Electronics  cameras             7.77      8538.13        0.0405\n3   AAAAAAAAIFGOBAAA                    Then economic terms might create previously only rights; electric, minute benefits assist both new sorts. Families take delicate, able difficulties. Patterns clear identical  Electronics  cameras             8.72     27464.48        0.1303\n4   AAAAAAAAMELABAAA                                                                                                        Years will not recover famous principles. Months change natural fans. Clean inc numbers s  Electronics  cameras             8.65     29251.32        0.1388\n5   AAAAAAAAEOPICAAA       Concerned soldiers could not drive maybe cards. New, bright institutions will not claim new, warm threats. Polish, short authorities go largely past drugs. Children give however too heav  Electronics  cameras             3.53     80869.92        0.3837\n6   AAAAAAAAELEADAAA                                                                                                                                                  Too electronic women cost now more than other a  Electronics  cameras             5.95     47726.96        0.2264\n7   AAAAAAAAAJBHCAAA                                                                                          Otherwise large specialists can paint only possible, useful rebels. Nearly comparable miles call old, o  Electronics  cameras             1.62     18332.84        0.0869\n8   AAAAAAAAEANADAAA     Great, alternative elections combat; other, sure years help main numbers. Only unemployed diseases prove directly royal, valuable islands. Cigarettes should not contribute; available, wide  Electronics  cameras             0.81     26508.91        0.1257\n9   AAAAAAAAGMIFAAAA           Miles wait late. Just slight minutes study certain sums. Democratic patients fall secondly so much as happy types. Unfair beds weigh mathematical, other minutes. Very current men shi  Electronics  cameras             1.95     20433.54        0.0969\n10  AAAAAAAAIIOLAAAA                                                                         In particular old benefits see seriously perfect factors. Shallow facilities may survive. Eyes should turn. Formal, old   Electronics  cameras             0.54     43514.85        0.2064\n11  AAAAAAAACAPBCAAA                                                                                                                 Boys establish individually green needs; less small patterns shall not get small  Electronics  cameras             6.72     33929.20        0.1609\n12  AAAAAAAAGMDGBAAA                                                                                                                                                   Environmental members bring just. Technical ty  Electronics  cameras             2.21     33957.39        0.1611\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.142238,
                    "execution_time": 0.082373,
                    "compile_time": 0.000299,
                    "planning_time": 0.042766
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.189223,
                    "execution_time": 0.077075,
                    "compile_time": 0.052449,
                    "planning_time": 0.042758
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAJJGICAAA  Conservative values make in a armies. Urban, small options come notable kinds. Pupils ought to contemplate medical, generous offences. Prominent circumstances give. Medium parts used to fit a  Electronics  cameras             1.79     31526.21        0.1495\n1   AAAAAAAACLABDAAA                                                                                                                                     Most current concepts used to restrict usually inc nice year  Electronics  cameras             6.45     19293.61        0.0915\n2   AAAAAAAADAHFBAAA                                                                                                                                                                                       Important   Electronics  cameras             7.77      8538.13        0.0405\n3   AAAAAAAAIFGOBAAA                    Then economic terms might create previously only rights; electric, minute benefits assist both new sorts. Families take delicate, able difficulties. Patterns clear identical  Electronics  cameras             8.72     27464.48        0.1303\n4   AAAAAAAAMELABAAA                                                                                                        Years will not recover famous principles. Months change natural fans. Clean inc numbers s  Electronics  cameras             8.65     29251.32        0.1388\n5   AAAAAAAAEOPICAAA       Concerned soldiers could not drive maybe cards. New, bright institutions will not claim new, warm threats. Polish, short authorities go largely past drugs. Children give however too heav  Electronics  cameras             3.53     80869.92        0.3837\n6   AAAAAAAAELEADAAA                                                                                                                                                  Too electronic women cost now more than other a  Electronics  cameras             5.95     47726.96        0.2264\n7   AAAAAAAAAJBHCAAA                                                                                          Otherwise large specialists can paint only possible, useful rebels. Nearly comparable miles call old, o  Electronics  cameras             1.62     18332.84        0.0869\n8   AAAAAAAAEANADAAA     Great, alternative elections combat; other, sure years help main numbers. Only unemployed diseases prove directly royal, valuable islands. Cigarettes should not contribute; available, wide  Electronics  cameras             0.81     26508.91        0.1257\n9   AAAAAAAAGMIFAAAA           Miles wait late. Just slight minutes study certain sums. Democratic patients fall secondly so much as happy types. Unfair beds weigh mathematical, other minutes. Very current men shi  Electronics  cameras             1.95     20433.54        0.0969\n10  AAAAAAAAIIOLAAAA                                                                         In particular old benefits see seriously perfect factors. Shallow facilities may survive. Eyes should turn. Formal, old   Electronics  cameras             0.54     43514.85        0.2064\n11  AAAAAAAACAPBCAAA                                                                                                                 Boys establish individually green needs; less small patterns shall not get small  Electronics  cameras             6.72     33929.20        0.1609\n12  AAAAAAAAGMDGBAAA                                                                                                                                                   Environmental members bring just. Technical ty  Electronics  cameras             2.21     33957.39        0.1611\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                     i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAMLOBAAA                                                                                                                                                                              Real walls ought t  Electronics                     0.79     36231.51        2.4720\n1   AAAAAAAAOBAKAAAA                                                                                                                                                                                                        Shoes                     4.31     22064.11        1.5053\n2   AAAAAAAAGDFIAAAA                    Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81     34322.37        2.3417\n3   AAAAAAAAPCDJCAAA                                                                                                                                                                                                  Electronics                     9.97     38785.76        2.6462\n4   AAAAAAAAOJAADAAA                       Bodies use unlikely courses. Happy games ensue all. Only, new levels would reduce firmly tasks; scottish, individual ideas tell main bands. Then left reactions should fa       Sports                     8.03     33225.80        2.2669\n5   AAAAAAAAEEBNAAAA                                                                                                                                                                                                        Shoes                      NaN     33611.68        2.2932\n6   AAAAAAAABHHGBAAA                                                                                                                                                                                                        Shoes                    25.29     25036.16        1.7081\n7   AAAAAAAAAHJKAAAA                                                                                                                                                                                             Sma  Electronics                      NaN     31261.55        2.1329\n8   AAAAAAAAOCOLAAAA                                                                                                                                                                                                        Shoes                     1.47     42840.80        2.9229\n9   AAAAAAAAMAJLAAAA  All right new questions get at last only groups. Economic, public women can go numbers. Hence other assets used to make sometimes political thin eyes. Attractive, healthy cups might proceed         Shoes                     6.51     44160.10        3.0129\n10  AAAAAAAAAAMCAAAA                                                                                                                                                                                                       Sports                      NaN     42161.82        2.8766\n11  AAAAAAAAAMIBCAAA                                                                                                                                                                                                       Sports                      NaN      5093.30        0.3475\n12  AAAAAAAAHPDFBAAA                                                                                                                                                                                                  Electronics                     1.24     52785.09        3.6014\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.141265,
                    "execution_time": 0.080337,
                    "compile_time": 0.000307,
                    "planning_time": 0.043491
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.139224,
                    "execution_time": 0.079496,
                    "compile_time": 0.000298,
                    "planning_time": 0.042541
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                     i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAMLOBAAA                                                                                                                                                                              Real walls ought t  Electronics                     0.79     36231.51        2.4720\n1   AAAAAAAAOBAKAAAA                                                                                                                                                                                                        Shoes                     4.31     22064.11        1.5053\n2   AAAAAAAAGDFIAAAA                    Certainly extra wages save otherwise civil genes. Inner, national mines will not investigate rather literary months. All honest pp. come at all never new sisters. Backwards        Shoes                     4.81     34322.37        2.3417\n3   AAAAAAAAPCDJCAAA                                                                                                                                                                                                  Electronics                     9.97     38785.76        2.6462\n4   AAAAAAAAOJAADAAA                       Bodies use unlikely courses. Happy games ensue all. Only, new levels would reduce firmly tasks; scottish, individual ideas tell main bands. Then left reactions should fa       Sports                     8.03     33225.80        2.2669\n5   AAAAAAAAEEBNAAAA                                                                                                                                                                                                        Shoes                      NaN     33611.68        2.2932\n6   AAAAAAAABHHGBAAA                                                                                                                                                                                                        Shoes                    25.29     25036.16        1.7081\n7   AAAAAAAAAHJKAAAA                                                                                                                                                                                             Sma  Electronics                      NaN     31261.55        2.1329\n8   AAAAAAAAOCOLAAAA                                                                                                                                                                                                        Shoes                     1.47     42840.80        2.9229\n9   AAAAAAAAMAJLAAAA  All right new questions get at last only groups. Economic, public women can go numbers. Hence other assets used to make sometimes political thin eyes. Attractive, healthy cups might proceed         Shoes                     6.51     44160.10        3.0129\n10  AAAAAAAAAAMCAAAA                                                                                                                                                                                                       Sports                      NaN     42161.82        2.8766\n11  AAAAAAAAAMIBCAAA                                                                                                                                                                                                       Sports                      NaN      5093.30        0.3475\n12  AAAAAAAAHPDFBAAA                                                                                                                                                                                                  Electronics                     1.24     52785.09        3.6014\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAELJFCAAA                                       Probable, essential plans used to say firms. Students lead trains; managerial, old consequences run so. More necessary lives wait urgent times. Average, e  Electronics     cameras             6.57     13644.54        0.0647\n1   AAAAAAAALMKCCAAA                                                                                          Detailed, light crops remind in a words; present standards shall not promote in a sizes. Different orga  Electronics  automotive             3.06     54303.70        0.2584\n2   AAAAAAAABLNNCAAA                                                                                                                 Once apparent times may open for a individuals. Certainly large children obtain   Electronics      karoke             1.72     26854.48        0.1232\n3   AAAAAAAAOBNFCAAA       Then economic photographs must go fully priorities. Present regions find crews; used, living courts wait off the structures. Formal, improved buildings end more important, double objecti  Electronics     cameras             2.41     61078.62        0.2898\n4   AAAAAAAAMEACCAAA                        Kinds may develop teeth. Just live policies take too evil, unknown police. Small, bright systems used to introduce other, british organs. Terrible statements will start   Electronics  automotive             0.13     46608.92        0.2218\n5   AAAAAAAAFCLFCAAA                                                                           European, sufficient motives would not dance deliberately in a teachers. Signals keep more with a players. Workers mak  Electronics      karoke             7.62     35352.10        0.1622\n6   AAAAAAAADHCCCAAA                                                                                                                                             Small, essential patients increase. Periods cannot s  Electronics     cameras             8.30     65180.20        0.3092\n7   AAAAAAAAIHHNCAAA                     Unknown photographs might not include. Matters could explain then national others. Now labour products hear softly labour details. Clearly extra boys wait serious eyes. Mai  Electronics  automotive             7.12     46342.62        0.2206\n8   AAAAAAAALKLACAAA                                                                                                                                                                                             Blac  Electronics      karoke             7.38     44770.59        0.2054\n9   AAAAAAAAGOPHCAAA                                                                                                                                                            Forward annual songs shall say babies  Electronics     cameras             0.54     37023.09        0.1756\n10  AAAAAAAAACJCAAAA                                                                                                                                     Fundamentally joint committees should live all right; others  Electronics  automotive             9.87     25096.11        0.1194\n11  AAAAAAAAOJMNBAAA                                                                                                                                                Short-term, contemporary years could double force  Electronics      karoke             2.00     27920.29        0.1281\n12  AAAAAAAAECCDAAAA  Right customs want always widespread subjects. Poor, extra years take obviously leaves. Months may not measure for the companies. Particular, traditional reforms advertise countries. Ends use  Electronics     cameras             2.51     43327.51        0.2055\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.13869,
                    "execution_time": 0.076756,
                    "compile_time": 0.000338,
                    "planning_time": 0.044319
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.208618,
                    "execution_time": 0.079156,
                    "compile_time": 0.000348,
                    "planning_time": 0.111228
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAELJFCAAA                                       Probable, essential plans used to say firms. Students lead trains; managerial, old consequences run so. More necessary lives wait urgent times. Average, e  Electronics     cameras             6.57     13644.54        0.0647\n1   AAAAAAAALMKCCAAA                                                                                          Detailed, light crops remind in a words; present standards shall not promote in a sizes. Different orga  Electronics  automotive             3.06     54303.70        0.2584\n2   AAAAAAAABLNNCAAA                                                                                                                 Once apparent times may open for a individuals. Certainly large children obtain   Electronics      karoke             1.72     26854.48        0.1232\n3   AAAAAAAAOBNFCAAA       Then economic photographs must go fully priorities. Present regions find crews; used, living courts wait off the structures. Formal, improved buildings end more important, double objecti  Electronics     cameras             2.41     61078.62        0.2898\n4   AAAAAAAAMEACCAAA                        Kinds may develop teeth. Just live policies take too evil, unknown police. Small, bright systems used to introduce other, british organs. Terrible statements will start   Electronics  automotive             0.13     46608.92        0.2218\n5   AAAAAAAAFCLFCAAA                                                                           European, sufficient motives would not dance deliberately in a teachers. Signals keep more with a players. Workers mak  Electronics      karoke             7.62     35352.10        0.1622\n6   AAAAAAAADHCCCAAA                                                                                                                                             Small, essential patients increase. Periods cannot s  Electronics     cameras             8.30     65180.20        0.3092\n7   AAAAAAAAIHHNCAAA                     Unknown photographs might not include. Matters could explain then national others. Now labour products hear softly labour details. Clearly extra boys wait serious eyes. Mai  Electronics  automotive             7.12     46342.62        0.2206\n8   AAAAAAAALKLACAAA                                                                                                                                                                                             Blac  Electronics      karoke             7.38     44770.59        0.2054\n9   AAAAAAAAGOPHCAAA                                                                                                                                                            Forward annual songs shall say babies  Electronics     cameras             0.54     37023.09        0.1756\n10  AAAAAAAAACJCAAAA                                                                                                                                     Fundamentally joint committees should live all right; others  Electronics  automotive             9.87     25096.11        0.1194\n11  AAAAAAAAOJMNBAAA                                                                                                                                                Short-term, contemporary years could double force  Electronics      karoke             2.00     27920.29        0.1281\n12  AAAAAAAAECCDAAAA  Right customs want always widespread subjects. Poor, extra years take obviously leaves. Months may not measure for the companies. Particular, traditional reforms advertise countries. Ends use  Electronics     cameras             2.51     43327.51        0.2055\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                        Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAMLOBAAA                                                                                                                                                                    Real walls ought t  Electronics                     0.79     36231.51        2.4720\n2   AAAAAAAAJAHLBAAA                                                                               Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                        Electronics                     1.24     52785.09        3.6014\n4   AAAAAAAAONDOCAAA                                                                                                                                                                                        Electronics                      NaN     17491.19        1.1933\n5   AAAAAAAAAHJKAAAA                                                                                                                                                                                   Sma  Electronics                      NaN     31261.55        2.1329\n6   AAAAAAAAPCDJCAAA                                                                                                                                                                                        Electronics                     9.97     38785.76        2.6462\n7   AAAAAAAAEOGIAAAA                                                                                                                                                                                        Electronics                      NaN     28049.19        1.9137\n8   AAAAAAAAOFEJAAAA                                                                                                                                                                                    Be  Electronics                    49.14      6617.20        0.4514\n9   AAAAAAAANAHDCAAA                                                                                                                                              Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n10  AAAAAAAAGCDEBAAA                                                                                                                                                                                        Electronics                      NaN     51789.34        3.5334\n11  AAAAAAAAHGCFCAAA                                                                                                                                                                                        Electronics                     3.56     27353.15        1.8662\n12  AAAAAAAAEONBCAAA                                                                                                                   Too current changes would see fresh, similar men. Just genuine deta  Electronics   audio             1.57     25886.37        0.1174\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.141159,
                    "execution_time": 0.078546,
                    "compile_time": 0.00035,
                    "planning_time": 0.044716
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.212494,
                    "execution_time": 0.083069,
                    "compile_time": 0.00034,
                    "planning_time": 0.111701
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                        Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAMLOBAAA                                                                                                                                                                    Real walls ought t  Electronics                     0.79     36231.51        2.4720\n2   AAAAAAAAJAHLBAAA                                                                               Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                        Electronics                     1.24     52785.09        3.6014\n4   AAAAAAAAONDOCAAA                                                                                                                                                                                        Electronics                      NaN     17491.19        1.1933\n5   AAAAAAAAAHJKAAAA                                                                                                                                                                                   Sma  Electronics                      NaN     31261.55        2.1329\n6   AAAAAAAAPCDJCAAA                                                                                                                                                                                        Electronics                     9.97     38785.76        2.6462\n7   AAAAAAAAEOGIAAAA                                                                                                                                                                                        Electronics                      NaN     28049.19        1.9137\n8   AAAAAAAAOFEJAAAA                                                                                                                                                                                    Be  Electronics                    49.14      6617.20        0.4514\n9   AAAAAAAANAHDCAAA                                                                                                                                              Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n10  AAAAAAAAGCDEBAAA                                                                                                                                                                                        Electronics                      NaN     51789.34        3.5334\n11  AAAAAAAAHGCFCAAA                                                                                                                                                                                        Electronics                     3.56     27353.15        1.8662\n12  AAAAAAAAEONBCAAA                                                                                                                   Too current changes would see fresh, similar men. Just genuine deta  Electronics   audio             1.57     25886.37        0.1174\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.138516,
                    "execution_time": 0.077787,
                    "compile_time": 0.000334,
                    "planning_time": 0.043179
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.206924,
                    "execution_time": 0.077349,
                    "compile_time": 0.000367,
                    "planning_time": 0.111959
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.144848,
                    "execution_time": 0.083463,
                    "compile_time": 0.000332,
                    "planning_time": 0.043991
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.208834,
                    "execution_time": 0.080321,
                    "compile_time": 0.000339,
                    "planning_time": 0.110996
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.484446,
                    "execution_time": 0.382662,
                    "compile_time": 0.038035,
                    "planning_time": 0.045747
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.846791,
                    "execution_time": 0.382396,
                    "compile_time": 3.334378,
                    "planning_time": 0.110627
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.463971,
                    "execution_time": 0.389142,
                    "compile_time": 0.000362,
                    "planning_time": 0.057143
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.454316,
                    "execution_time": 0.391915,
                    "compile_time": 0.000356,
                    "planning_time": 0.044292
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAGKPBAAA                                                                                                                                                                                       Electronics                      NaN     54034.75        3.6866\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                                  Sma  Electronics                      NaN     31261.55        2.1329\n2   AAAAAAAAAMLOBAAA                                                                                                                                                                   Real walls ought t  Electronics                     0.79     36231.51        2.4720\n3   AAAAAAAAEOGIAAAA                                                                                                                                                                                       Electronics                      NaN     28049.19        1.9137\n4   AAAAAAAAGCDEBAAA                                                                                                                                                                                       Electronics                      NaN     51789.34        3.5334\n5   AAAAAAAAHGCFCAAA                                                                                                                                                                                       Electronics                     3.56     27353.15        1.8662\n6   AAAAAAAAHPDFBAAA                                                                                                                                                                                       Electronics                     1.24     52785.09        3.6014\n7   AAAAAAAAJAHLBAAA                                                                              Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     16991.61        1.1593\n8   AAAAAAAANAHDCAAA                                                                                                                                             Even organic circumstances see together   Electronics                     1.44     44086.12        3.0079\n9   AAAAAAAAOFEJAAAA                                                                                                                                                                                   Be  Electronics                    49.14      6617.20        0.4514\n10  AAAAAAAAONDOCAAA                                                                                                                                                                                       Electronics                      NaN     17491.19        1.1933\n11  AAAAAAAAPCDJCAAA                                                                                                                                                                                       Electronics                     9.97     38785.76        2.6462\n12  AAAAAAAAAAAKBAAA                                                                                                                                       More different others would not sound great ta  Electronics   audio             1.54     15571.86        0.0706\n13  AAAAAAAAAAGFCAAA                                                                                                                                                                                Only   Electronics   audio             2.74     29346.79        0.1331\n...*/"
    }
]