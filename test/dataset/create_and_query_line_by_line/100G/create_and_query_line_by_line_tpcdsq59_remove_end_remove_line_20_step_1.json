[
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nWITH /* TPC-DS query59.tpl 0.30 */ wss AS \n (SELECT d_week_seq,\n        ss_store_sk,\n        SUM(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales,\n        SUM(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales,\n        SUM(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales,\n        SUM(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales,\n        SUM(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales,\n        SUM(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales,\n        SUM(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales\n FROM store_sales, date_dim\n WHERE d_date_sk = ss_sold_date_sk\n GROUP BY d_week_seq, ss_store_sk\n ),\n store_info AS (\n  SELECT s_store_name,\n         s_store_id,\n         wss.d_week_seq,\n         sun_sales,\n         mon_sales,\n         tue_sales,\n         wed_sales,\n         thu_sales,\n         fri_sales,\n         sat_sales\n  FROM wss\n  JOIN store ON store.s_store_sk = wss.ss_store_sk\n )\n SELECT s_store_name1, s_store_id1, d_week_seq1,\n        sun_sales1/sun_sales2 AS sun_sales_ratio,\n        mon_sales1/mon_sales2 AS mon_sales_ratio,\n        tue_sales1/tue_sales2 AS tue_sales_ratio,\n        wed_sales1/wed_sales2 AS wed_sales_ratio,\n        thu_sales1/thu_sales2 AS thu_sales_ratio,\n        fri_sales1/fri_sales2 AS fri_sales_ratio,\n        sat_sales1/sat_sales2 AS sat_sales_ratio\n FROM\n (SELECT s_store_name AS s_store_name1,\n         d_week_seq AS d_week_seq1,\n         s_store_id AS s_store_id1,\n         sun_sales AS sun_sales1,\n         mon_sales AS mon_sales1,\n         tue_sales AS tue_sales1,\n         wed_sales AS wed_sales1,\n         thu_sales AS thu_sales1,\n         fri_sales AS fri_sales1,\n         sat_sales AS sat_sales1\n  FROM store_info\n  WHERE s_store_name = 'Store A') AS t1\n JOIN\n (SELECT s_store_name AS s_store_name2,\n         d_week_seq AS d_week_seq2,\n         s_store_id AS s_store_id2,\n         sun_sales AS sun_sales2,\n         mon_sales AS mon_sales2,\n         tue_sales AS tue_sales2,\n         wed_sales AS wed_sales2,\n         thu_sales AS thu_sales2,\n         fri_sales AS fri_sales2,\n         sat_sales AS sat_sales2\n  FROM store_info\n  WHERE s_store_name = 'Store B') AS t2\n ON t1.d_week_seq1 = t2.d_week_seq2;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"STORE_INFO\" AS ( SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE_INFO\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE_INFO\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"STORE_INFO\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE_INFO\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"STORE_INFO\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"STORE_INFO\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"STORE_INFO\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"STORE_INFO\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"STORE_INFO\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"STORE_INFO\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"STORE_INFO\" AS \"STORE_INFO\" JOIN \"STORE_INFO\" AS \"STORE_INFO_2\" ON \"STORE_INFO\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"STORE_INFO\".\"S_STORE_NAME\" = 'Store A'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.056853,
                    "execution_time": 1.666743,
                    "compile_time": 0.083484,
                    "planning_time": 0.038955,
                    "create_size": 864
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.247819,
                    "execution_time": 1.73617,
                    "compile_time": 9.129335,
                    "planning_time": 0.108949,
                    "create_size": 864
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.548787,
                    "execution_time": 0.076493,
                    "compile_time": 0.163216,
                    "planning_time": 0.027829,
                    "create_size": 936
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.795018,
                    "execution_time": 0.085692,
                    "compile_time": 10.31606,
                    "planning_time": 0.091201,
                    "create_size": 936
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"STORE_INFO_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" = 'Store A'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.163766,
                    "execution_time": 0.038815,
                    "compile_time": 0.086497,
                    "planning_time": 0.009931,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.195449,
                    "execution_time": 0.040714,
                    "compile_time": 7.006566,
                    "planning_time": 0.112566,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [s_store_name1, s_store_id1, d_week_seq1, sun_sales_ratio, mon_sales_ratio, tue_sales_ratio, wed_sales_ratio, thu_sales_ratio, fri_sales_ratio, sat_sales_ratio]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.049415,
                    "execution_time": 0.007524,
                    "compile_time": 0.029637,
                    "planning_time": 0.005676
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.397778,
                    "execution_time": 0.007784,
                    "compile_time": 3.337661,
                    "planning_time": 0.041196
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"STORE_INFO_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" = 'Store A'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [s_store_name1, s_store_id1, d_week_seq1, sun_sales_ratio, mon_sales_ratio, tue_sales_ratio, wed_sales_ratio, thu_sales_ratio, fri_sales_ratio, sat_sales_ratio]\nIndex: []*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name as s_store_name1, wss.d_week_seq as d_week_seq1\n        ,s_store_id as s_store_id1, sun_sales as sun_sales1\n        ,mon_sales as mon_sales1, tue_sales as tue_sales1\n        ,wed_sales as wed_sales1, thu_sales as thu_sales1\n        ,fri_sales as fri_sales1, sat_sales as sat_sales1\n from wss\n join store on wss.ss_store_sk = store.s_store_sk) as wss_data /*CURSOR_IDENTIFIER*/ \n join\n (\n select s_store_name as s_store_name2, wss.d_week_seq as d_week_seq2\n       ,s_store_id as s_store_id2, sun_sales as sun_sales2\n       ,mon_sales as mon_sales2, tue_sales as tue_sales2\n       ,wed_sales as wed_sales2, thu_sales as thu_sales2\n       ,fri_sales as fri_sales2, sat_sales as sat_sales2\n from wss\n join store on wss.ss_store_sk = store.s_store_sk) as wss_data2\n on wss_data.s_store_id1 = wss_data2.s_store_id2\n and wss_data.d_week_seq1 = wss_data2.d_week_seq2 - 1",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"WSS_DATA2\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_DATA2\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_DATA2\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_DATA2\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_DATA2\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_DATA2\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_DATA2\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_DATA2\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS_DATA2\" AS \"WSS_DATA2\" ON \"STORE\".\"S_STORE_ID\" = \"WSS_DATA2\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"WSS_DATA2\".\"D_WEEK_SEQ2\" - 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.594599,
                    "execution_time": 0.069633,
                    "compile_time": 0.232561,
                    "planning_time": 0.027764,
                    "create_size": 840
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.744272,
                    "execution_time": 0.088921,
                    "compile_time": 10.284833,
                    "planning_time": 0.089829,
                    "create_size": 828
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ2\" - 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.542132,
                    "execution_time": 0.099501,
                    "compile_time": 0.133336,
                    "planning_time": 0.037004,
                    "create_size": 923
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.711459,
                    "execution_time": 0.104183,
                    "compile_time": 9.234987,
                    "planning_time": 0.096626,
                    "create_size": 884
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAACOAAAAAA         5311  1.0253  0.9137  0.8654  1.1034  1.0209  1.2727  0.8426\n1          ation  AAAAAAAABGAAAAAA         5311  1.2071  0.8575  0.9136  1.1009  0.8950  1.1563  1.0451\n2            ese  AAAAAAAAOEBAAAAA         5311  1.4657  1.1602  1.0464  1.0215  0.9558  1.1406  0.7046\n3            ese  AAAAAAAAGNAAAAAA         5311  1.4240  1.1279  1.1623  1.0370  0.8540  1.0249  0.9792\n4           n st  AAAAAAAADABAAAAA         5311  0.9786  1.0414  0.9094  0.8155  1.0510  1.4232  0.9837\n5          cally  AAAAAAAAIIAAAAAA         5311  1.0872  1.2029  1.0971  0.9838  0.9788  0.9233  0.8252\n6            ese  AAAAAAAACCAAAAAA         5311  0.8601  1.0128  0.9874  0.8480  0.8668  0.9329  1.0066\n7           eing  AAAAAAAAAHBAAAAA         5311  1.1853  1.3753  0.8372  1.0184  0.9605  0.9534  1.2190\n8          ation  AAAAAAAADEAAAAAA         5311  0.7897  0.9736  0.9709  1.2843  1.0584  1.0363  1.1064\n9          ation  AAAAAAAANJAAAAAA         5311  1.3044  0.8333  1.1410  1.2235  1.1064  1.0330  0.9455\n10          able  AAAAAAAAOCBAAAAA         5311  1.1690  1.2320  0.8572  0.9079  0.8668  1.1831  0.9569\n11         cally  AAAAAAAAMDBAAAAA         5311  0.8453  1.0366  1.1600  0.9305  1.1494  0.9156  1.0036\n12         cally  AAAAAAAAABAAAAAA         5311  1.1364  0.7838  1.0811  0.9258  0.9134  0.9166  1.0581\n13          eing  AAAAAAAAEJAAAAAA         5312  0.8378  1.2763  0.7772  0.7635  1.2312  1.2731  1.3876\n14          n st  AAAAAAAALHBAAAAA         5312  1.0538  0.9816  0.9903  1.4425  0.9943  1.0595  0.8822\n15           bar  AAAAAAAACIAAAAAA         5312  1.1719  1.0762  1.0806  1.0561  0.9230  1.2920  0.9859\n16                AAAAAAAAEGBAAAAA         5312  1.1818  1.1548  1.1780  1.0147  0.9500  0.8966  0.9783\n17          anti  AAAAAAAAPKAAAAAA         5312  0.9874  1.2284  0.9704  1.1622  0.9283  1.3457  1.2059\n18          eing  AAAAAAAAGHAAAAAA         5312  1.4798  0.8645  1.1005  1.0053  0.8080  0.8870  1.0694\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018952,
                    "execution_time": 0.008117,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004351
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.137432,
                    "execution_time": 0.00837,
                    "compile_time": 0.07979,
                    "planning_time": 0.039984
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ2\" - 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAACOAAAAAA         5311  1.0253  0.9137  0.8654  1.1034  1.0209  1.2727  0.8426\n1          ation  AAAAAAAABGAAAAAA         5311  1.2071  0.8575  0.9136  1.1009  0.8950  1.1563  1.0451\n2            ese  AAAAAAAAOEBAAAAA         5311  1.4657  1.1602  1.0464  1.0215  0.9558  1.1406  0.7046\n3            ese  AAAAAAAAGNAAAAAA         5311  1.4240  1.1279  1.1623  1.0370  0.8540  1.0249  0.9792\n4           n st  AAAAAAAADABAAAAA         5311  0.9786  1.0414  0.9094  0.8155  1.0510  1.4232  0.9837\n5          cally  AAAAAAAAIIAAAAAA         5311  1.0872  1.2029  1.0971  0.9838  0.9788  0.9233  0.8252\n6            ese  AAAAAAAACCAAAAAA         5311  0.8601  1.0128  0.9874  0.8480  0.8668  0.9329  1.0066\n7           eing  AAAAAAAAAHBAAAAA         5311  1.1853  1.3753  0.8372  1.0184  0.9605  0.9534  1.2190\n8          ation  AAAAAAAADEAAAAAA         5311  0.7897  0.9736  0.9709  1.2843  1.0584  1.0363  1.1064\n9          ation  AAAAAAAANJAAAAAA         5311  1.3044  0.8333  1.1410  1.2235  1.1064  1.0330  0.9455\n10          able  AAAAAAAAOCBAAAAA         5311  1.1690  1.2320  0.8572  0.9079  0.8668  1.1831  0.9569\n11         cally  AAAAAAAAMDBAAAAA         5311  0.8453  1.0366  1.1600  0.9305  1.1494  0.9156  1.0036\n12         cally  AAAAAAAAABAAAAAA         5311  1.1364  0.7838  1.0811  0.9258  0.9134  0.9166  1.0581\n13          eing  AAAAAAAAEJAAAAAA         5312  0.8378  1.2763  0.7772  0.7635  1.2312  1.2731  1.3876\n14          n st  AAAAAAAALHBAAAAA         5312  1.0538  0.9816  0.9903  1.4425  0.9943  1.0595  0.8822\n15           bar  AAAAAAAACIAAAAAA         5312  1.1719  1.0762  1.0806  1.0561  0.9230  1.2920  0.9859\n16                AAAAAAAAEGBAAAAA         5312  1.1818  1.1548  1.1780  1.0147  0.9500  0.8966  0.9783\n17          anti  AAAAAAAAPKAAAAAA         5312  0.9874  1.2284  0.9704  1.1622  0.9283  1.3457  1.2059\n18          eing  AAAAAAAAGHAAAAAA         5312  1.4798  0.8645  1.1005  1.0053  0.8080  0.8870  1.0694\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\n  select  s_store_name, s_store_id, wss1.d_week_seq\n       , wss1.sun_sales / wss2.sun_sales sun_sales_ratio\n       , wss1.mon_sales / wss2.mon_sales mon_sales_ratio\n       , wss1.tue_sales / wss2.tue_sales tue_sales_ratio\n       , wss1.wed_sales / wss2.wed_sales wed_sales_ratio\n       , wss1.thu_sales / wss2.thu_sales thu_sales_ratio\n       , wss1.fri_sales / wss2.fri_sales fri_sales_ratio\n       , wss1.sat_sales / wss2.sat_sales sat_sales_ratio\n from\n (select s_store_name, s_store_id, wss.d_week_seq, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales\n  from wss, store\n  where store.s_store_sk = wss.ss_store_sk) wss1\n join \n (select d_week_seq, sum(sun_sales) as sun_sales, sum(mon_sales) as mon_sales, sum(tue_sales) as tue_sales, \n          sum(wed_sales) as wed_sales, sum(thu_sales) as thu_sales, sum(fri_sales) as fri_sales, sum(sat_sales) as sat_sales\n  from wss\n  group by d_week_seq) wss2\n on wss1.d_week_seq = wss2.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"WSS2\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( \"WSS\".\"SUN_SALES\" ) AS \"SUN_SALES\" , SUM ( \"WSS\".\"MON_SALES\" ) AS \"MON_SALES\" , SUM ( \"WSS\".\"TUE_SALES\" ) AS \"TUE_SALES\" , SUM ( \"WSS\".\"WED_SALES\" ) AS \"WED_SALES\" , SUM ( \"WSS\".\"THU_SALES\" ) AS \"THU_SALES\" , SUM ( \"WSS\".\"FRI_SALES\" ) AS \"FRI_SALES\" , SUM ( \"WSS\".\"SAT_SALES\" ) AS \"SAT_SALES\" FROM \"WSS\" AS \"WSS\" GROUP BY \"WSS\".\"D_WEEK_SEQ\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WSS\".\"SUN_SALES\" / \"WSS2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"WSS\".\"MON_SALES\" / \"WSS2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"WSS\".\"TUE_SALES\" / \"WSS2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"WSS\".\"WED_SALES\" / \"WSS2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"WSS\".\"THU_SALES\" / \"WSS2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"WSS\".\"FRI_SALES\" / \"WSS2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"WSS\".\"SAT_SALES\" / \"WSS2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS2\" AS \"WSS2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" ) AS \"SUN_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" ) AS \"MON_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" ) AS \"TUE_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" ) AS \"WED_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" ) AS \"THU_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" ) AS \"FRI_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.135053,
                    "execution_time": 0.060748,
                    "compile_time": 0.041248,
                    "planning_time": 0.005662,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.441805,
                    "execution_time": 0.062026,
                    "compile_time": 3.280992,
                    "planning_time": 0.063367,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.43804,
                    "execution_time": 0.084769,
                    "compile_time": 0.068177,
                    "planning_time": 0.042305,
                    "create_size": 936
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.767127,
                    "execution_time": 0.086974,
                    "compile_time": 6.336175,
                    "planning_time": 0.094399,
                    "create_size": 910
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   s_store_name        s_store_id  d_week_seq  sun_sales_ratio  mon_sales_ratio  tue_sales_ratio  wed_sales_ratio  thu_sales_ratio  fri_sales_ratio  sat_sales_ratio\n0           bar  AAAAAAAAGOAAAAAA        5286           0.0055           0.0046           0.0046           0.0056           0.0044           0.0038           0.0043\n1           bar  AAAAAAAAOGAAAAAA        5286           0.0055           0.0051           0.0050           0.0049           0.0064           0.0031           0.0047\n2          able  AAAAAAAAKMAAAAAA        5286           0.0050           0.0063           0.0065           0.0056           0.0042           0.0046           0.0042\n3         cally  AAAAAAAAIDAAAAAA        5286           0.0046           0.0046           0.0058           0.0053           0.0040           0.0044           0.0040\n4          n st  AAAAAAAALIAAAAAA        5286           0.0051           0.0048           0.0042           0.0045           0.0045           0.0050           0.0051\n5           bar  AAAAAAAAOLAAAAAA        5286           0.0046           0.0056           0.0060           0.0045           0.0049           0.0057           0.0051\n6          able  AAAAAAAAKHAAAAAA        5286           0.0050           0.0058           0.0046           0.0045           0.0044           0.0047           0.0040\n7         ation  AAAAAAAAPGBAAAAA        5286           0.0041           0.0055           0.0059           0.0044           0.0044           0.0039           0.0069\n8          able  AAAAAAAAOIAAAAAA        5286           0.0047           0.0054           0.0037           0.0047           0.0031           0.0053           0.0051\n9          able  AAAAAAAAMEBAAAAA        5287           0.0042           0.0042           0.0055           0.0055           0.0039           0.0053           0.0049\n10         able  AAAAAAAAIJAAAAAA        5287           0.0040           0.0046           0.0035           0.0048           0.0044           0.0052           0.0038\n11          ese  AAAAAAAACBBAAAAA        5287           0.0040           0.0040           0.0049           0.0063           0.0059           0.0041           0.0053\n12         n st  AAAAAAAAPEAAAAAA        5287           0.0043           0.0041           0.0043           0.0065           0.0038           0.0059           0.0048\n13        ought  AAAAAAAABPAAAAAA        5287           0.0046           0.0058           0.0054           0.0054           0.0056           0.0051           0.0050\n14         eing  AAAAAAAAMLAAAAAA        5287           0.0050           0.0053           0.0054           0.0040           0.0054           0.0039           0.0032\n15         eing  AAAAAAAAOOAAAAAA        5287           0.0045           0.0057           0.0044           0.0047           0.0039           0.0052           0.0049\n16        cally  AAAAAAAAKBAAAAAA        5287           0.0046           0.0046           0.0038           0.0047           0.0044           0.0054           0.0059\n17        ation  AAAAAAAABFBAAAAA        5287           0.0053           0.0045           0.0040           0.0041           0.0060           0.0041           0.0031\n18          bar  AAAAAAAAIMAAAAAA        5287           0.0038           0.0066           0.0061           0.0057           0.0056           0.0049           0.0059\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018361,
                    "execution_time": 0.007349,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004468
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058413,
                    "execution_time": 0.008378,
                    "compile_time": 6e-05,
                    "planning_time": 0.040423
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   s_store_name        s_store_id  d_week_seq  sun_sales_ratio  mon_sales_ratio  tue_sales_ratio  wed_sales_ratio  thu_sales_ratio  fri_sales_ratio  sat_sales_ratio\n0           bar  AAAAAAAAGOAAAAAA        5286           0.0055           0.0046           0.0046           0.0056           0.0044           0.0038           0.0043\n1           bar  AAAAAAAAOGAAAAAA        5286           0.0055           0.0051           0.0050           0.0049           0.0064           0.0031           0.0047\n2          able  AAAAAAAAKMAAAAAA        5286           0.0050           0.0063           0.0065           0.0056           0.0042           0.0046           0.0042\n3         cally  AAAAAAAAIDAAAAAA        5286           0.0046           0.0046           0.0058           0.0053           0.0040           0.0044           0.0040\n4          n st  AAAAAAAALIAAAAAA        5286           0.0051           0.0048           0.0042           0.0045           0.0045           0.0050           0.0051\n5           bar  AAAAAAAAOLAAAAAA        5286           0.0046           0.0056           0.0060           0.0045           0.0049           0.0057           0.0051\n6          able  AAAAAAAAKHAAAAAA        5286           0.0050           0.0058           0.0046           0.0045           0.0044           0.0047           0.0040\n7         ation  AAAAAAAAPGBAAAAA        5286           0.0041           0.0055           0.0059           0.0044           0.0044           0.0039           0.0069\n8          able  AAAAAAAAOIAAAAAA        5286           0.0047           0.0054           0.0037           0.0047           0.0031           0.0053           0.0051\n9          able  AAAAAAAAMEBAAAAA        5287           0.0042           0.0042           0.0055           0.0055           0.0039           0.0053           0.0049\n10         able  AAAAAAAAIJAAAAAA        5287           0.0040           0.0046           0.0035           0.0048           0.0044           0.0052           0.0038\n11          ese  AAAAAAAACBBAAAAA        5287           0.0040           0.0040           0.0049           0.0063           0.0059           0.0041           0.0053\n12         n st  AAAAAAAAPEAAAAAA        5287           0.0043           0.0041           0.0043           0.0065           0.0038           0.0059           0.0048\n13        ought  AAAAAAAABPAAAAAA        5287           0.0046           0.0058           0.0054           0.0054           0.0056           0.0051           0.0050\n14         eing  AAAAAAAAMLAAAAAA        5287           0.0050           0.0053           0.0054           0.0040           0.0054           0.0039           0.0032\n15         eing  AAAAAAAAOOAAAAAA        5287           0.0045           0.0057           0.0044           0.0047           0.0039           0.0052           0.0049\n16        cally  AAAAAAAAKBAAAAAA        5287           0.0046           0.0046           0.0038           0.0047           0.0044           0.0054           0.0059\n17        ation  AAAAAAAABFBAAAAA        5287           0.0053           0.0045           0.0040           0.0041           0.0060           0.0041           0.0031\n18          bar  AAAAAAAAIMAAAAAA        5287           0.0038           0.0066           0.0061           0.0057           0.0056           0.0049           0.0059\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n ),\n sales_totals as \n (select sum(sun_sales) as sun_sales_total,\n         sum(mon_sales) as mon_sales_total,\n         sum(tue_sales) as tue_sales_total,\n         sum(wed_sales) as wed_sales_total,\n         sum(thu_sales) as thu_sales_total,\n         sum(fri_sales) as fri_sales_total,\n         sum(sat_sales) as sat_sales_total\n  from wss)\n select s_store_name1, s_store_id1, d_week_seq1,\n        sun_sales1/sun_sales_total as sun_sales2,\n        mon_sales1/mon_sales_total as mon_sales2,\n        tue_sales1/tue_sales_total as tue_sales2,\n        wed_sales1/wed_sales_total as wed_sales2,\n        thu_sales1/thu_sales_total as thu_sales2,\n        fri_sales1/fri_sales_total as fri_sales2,\n        sat_sales1/sat_sales_total as sat_sales2\n from\n (select s_store_name s_store_name1, wss.d_week_seq d_week_seq1,\n         s_store_id s_store_id1, sun_sales sun_sales1,\n         mon_sales mon_sales1, tue_sales tue_sales1,\n         wed_sales wed_sales1, thu_sales thu_sales1,\n         fri_sales fri_sales1, sat_sales sat_sales1\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n/*CURSOR_IDENTIFIER*/\n  wss.ss_store_sk = s_store_sk), sales_totals",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.651869,
                    "execution_time": 0.473675,
                    "compile_time": 0.131163,
                    "planning_time": 0.038079,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.236392,
                    "execution_time": 0.533735,
                    "compile_time": 6.560886,
                    "planning_time": 0.106102,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUN_SALES1\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"MON_SALES1\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"TUE_SALES1\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"WED_SALES1\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"THU_SALES1\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"FRI_SALES1\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SAT_SALES1\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   s_store_name1  d_week_seq1       s_store_id1  sun_sales1  mon_sales1  tue_sales1  wed_sales1  thu_sales1  fri_sales1  sat_sales1\n0          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n1          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n2          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n3          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n4          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n5            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n6            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n7            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n8            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n9            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n10           bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n11           bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n12          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n13          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n14          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n15          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n16          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n17          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n18          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.078213,
                    "execution_time": 0.007939,
                    "compile_time": 0.058904,
                    "planning_time": 0.004521
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.360179,
                    "execution_time": 0.008598,
                    "compile_time": 3.300115,
                    "planning_time": 0.040436
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUN_SALES1\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"MON_SALES1\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"TUE_SALES1\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"WED_SALES1\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"THU_SALES1\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"FRI_SALES1\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SAT_SALES1\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   s_store_name1  d_week_seq1       s_store_id1  sun_sales1  mon_sales1  tue_sales1  wed_sales1  thu_sales1  fri_sales1  sat_sales1\n0          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n1          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n2          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n3          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n4          cally         5276  AAAAAAAAAABAAAAA    17677.70    19043.82    16809.99    18109.17    13684.20    15022.42    15848.82\n5            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n6            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n7            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n8            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n9            bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n10           bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n11           bar         5276  AAAAAAAAKKAAAAAA    16651.14    14426.25    14254.90    17354.03    18231.81    15086.24    13063.12\n12          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n13          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n14          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n15          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n16          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n17          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n18          able         5276  AAAAAAAAIIBAAAAA    14829.79    10789.17    15121.45    20953.29    15811.69    13471.24    15501.22\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\n  select  s_store_name1, s_store_id1, d_week_seq1\n       , sun_sales1 / sun_sales2, mon_sales1 / mon_sales2\n       , tue_sales1 / tue_sales2, wed_sales1 / wed_sales2, thu_sales1 / thu_sales2\n       , fri_sales1 / fri_sales2, sat_sales1 / sat_sales2\n from\n (select s_store_name as s_store_name1, wss.d_week_seq as d_week_seq1\n        , s_store_id as s_store_id1, sun_sales as sun_sales1\n        , mon_sales as mon_sales1, tue_sales as tue_sales1\n        , wed_sales as wed_sales1, thu_sales as thu_sales1\n        , fri_sales as fri_sales1, sat_sales as sat_sales1\n  from wss, store\n  where ss_store_sk = s_store_sk\n ) s1\n join\n (select d_week_seq, sun_sales as sun_sales2, mon_sales as mon_sales2, tue_sales as tue_sales2,\n        wed_sales as wed_sales2, thu_sales as thu_sales2, fri_sales as fri_sales2, sat_sales as sat_sales2\n  from wss\n ) s2\n on s1.d_week_seq1 = s2.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.63788,
                    "execution_time": 1.346199,
                    "compile_time": 0.093368,
                    "planning_time": 0.031205,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.598295,
                    "execution_time": 1.920438,
                    "compile_time": 3.385151,
                    "planning_time": 0.093976,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAGGBAAAAA         5268  1.0472  1.0751  0.9269  1.0617  0.9286  1.1193  0.8543\n1           eing  AAAAAAAAGGBAAAAA         5268  0.7971  0.9537  1.0271  0.9600  1.0461  0.9701  0.8524\n2           eing  AAAAAAAAGGBAAAAA         5268  0.8989  1.0997  0.9197  1.0515  1.0501  0.8339  0.9776\n3           eing  AAAAAAAAGGBAAAAA         5268  0.9432  0.9606  1.1426  0.9834  0.9990  1.0376  0.9027\n4           eing  AAAAAAAAGGBAAAAA         5268  0.9620  1.0804  1.0568  0.8513  1.0362  0.9873  0.9111\n5           eing  AAAAAAAAGGBAAAAA         5268  0.8960  1.0806  0.9633  0.9437  1.0797  0.9938  0.9535\n6           eing  AAAAAAAAGGBAAAAA         5268  1.0210  1.0687  0.9666  1.0275  0.9490  0.9997  1.0015\n7           eing  AAAAAAAAGGBAAAAA         5268  0.9189  0.9408  0.9446  0.9457  1.1848  1.1839  0.8346\n8           eing  AAAAAAAAGGBAAAAA         5268  0.8978  0.9543  1.0091  1.0803  1.1458  1.1341  0.8983\n9           eing  AAAAAAAAGGBAAAAA         5268  1.0381  0.9972  1.1022  0.9711  0.9327  1.0634  0.9486\n10          eing  AAAAAAAAGGBAAAAA         5268  0.9109  1.0205  0.9768  1.0496  1.0319  1.0993  1.0062\n11          eing  AAAAAAAAGGBAAAAA         5268  0.9804  0.9171  1.1212  1.0908  0.9482  1.0988  1.0240\n12          eing  AAAAAAAAGGBAAAAA         5268  0.9392  1.1273  0.9694  1.2655  0.9499  1.1839  0.8889\n13          eing  AAAAAAAAGGBAAAAA         5268  0.9716  1.2344  1.1050  0.9002  0.9991  0.9510  0.9714\n14          eing  AAAAAAAAGGBAAAAA         5268  1.1073  1.0082  1.1142  0.9530  1.1682  1.2903  0.9287\n15          eing  AAAAAAAAGGBAAAAA         5268  1.0470  1.0462  1.0235  0.9205  1.1067  1.3751  1.0659\n16          eing  AAAAAAAAGGBAAAAA         5268  0.9688  1.2741  0.9341  0.9471  0.9537  0.9992  1.0625\n17          eing  AAAAAAAAGGBAAAAA         5268  0.9558  1.3342  1.0512  0.8683  1.2530  1.1781  1.0006\n18          eing  AAAAAAAAGGBAAAAA         5268  1.0268  1.0158  0.9379  1.0190  1.1363  1.1086  0.9734\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019051,
                    "execution_time": 0.008093,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004318
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057736,
                    "execution_time": 0.00829,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040296
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAGGBAAAAA         5268  1.0472  1.0751  0.9269  1.0617  0.9286  1.1193  0.8543\n1           eing  AAAAAAAAGGBAAAAA         5268  0.7971  0.9537  1.0271  0.9600  1.0461  0.9701  0.8524\n2           eing  AAAAAAAAGGBAAAAA         5268  0.8989  1.0997  0.9197  1.0515  1.0501  0.8339  0.9776\n3           eing  AAAAAAAAGGBAAAAA         5268  0.9432  0.9606  1.1426  0.9834  0.9990  1.0376  0.9027\n4           eing  AAAAAAAAGGBAAAAA         5268  0.9620  1.0804  1.0568  0.8513  1.0362  0.9873  0.9111\n5           eing  AAAAAAAAGGBAAAAA         5268  0.8960  1.0806  0.9633  0.9437  1.0797  0.9938  0.9535\n6           eing  AAAAAAAAGGBAAAAA         5268  1.0210  1.0687  0.9666  1.0275  0.9490  0.9997  1.0015\n7           eing  AAAAAAAAGGBAAAAA         5268  0.9189  0.9408  0.9446  0.9457  1.1848  1.1839  0.8346\n8           eing  AAAAAAAAGGBAAAAA         5268  0.8978  0.9543  1.0091  1.0803  1.1458  1.1341  0.8983\n9           eing  AAAAAAAAGGBAAAAA         5268  1.0381  0.9972  1.1022  0.9711  0.9327  1.0634  0.9486\n10          eing  AAAAAAAAGGBAAAAA         5268  0.9109  1.0205  0.9768  1.0496  1.0319  1.0993  1.0062\n11          eing  AAAAAAAAGGBAAAAA         5268  0.9804  0.9171  1.1212  1.0908  0.9482  1.0988  1.0240\n12          eing  AAAAAAAAGGBAAAAA         5268  0.9392  1.1273  0.9694  1.2655  0.9499  1.1839  0.8889\n13          eing  AAAAAAAAGGBAAAAA         5268  0.9716  1.2344  1.1050  0.9002  0.9991  0.9510  0.9714\n14          eing  AAAAAAAAGGBAAAAA         5268  1.1073  1.0082  1.1142  0.9530  1.1682  1.2903  0.9287\n15          eing  AAAAAAAAGGBAAAAA         5268  1.0470  1.0462  1.0235  0.9205  1.1067  1.3751  1.0659\n16          eing  AAAAAAAAGGBAAAAA         5268  0.9688  1.2741  0.9341  0.9471  0.9537  0.9992  1.0625\n17          eing  AAAAAAAAGGBAAAAA         5268  0.9558  1.3342  1.0512  0.8683  1.2530  1.1781  1.0006\n18          eing  AAAAAAAAGGBAAAAA         5268  1.0268  1.0158  0.9379  1.0190  1.1363  1.1086  0.9734\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1, s_store_id1, d_week_seq1\n       , NULL AS sun_sales2, NULL AS mon_sales2\n       , NULL AS tue_sales2, NULL AS wed_sales2, NULL AS thu_sales2\n       , NULL AS fri_sales2, NULL AS sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y\n \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.087978,
                    "execution_time": 0.043817,
                    "compile_time": 0.000243,
                    "planning_time": 0.003163,
                    "create_size": 350
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.147391,
                    "execution_time": 0.043759,
                    "compile_time": 0.000231,
                    "planning_time": 0.058768,
                    "create_size": 345
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.340606,
                    "execution_time": 0.077347,
                    "compile_time": 0.138026,
                    "planning_time": 0.03656,
                    "create_size": 1235
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.159785,
                    "execution_time": 0.078955,
                    "compile_time": 9.878521,
                    "planning_time": 0.102393,
                    "create_size": 1261
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1 sun_sales2 mon_sales2 tue_sales2 wed_sales2 thu_sales2 fri_sales2 sat_sales2\n0          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n1          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n2          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n3          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n4          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n5          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n6          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n7          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n8          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n9          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n10         ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n11         ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n12         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n13         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n14         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n15         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n16         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n17         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n18         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.053619,
                    "execution_time": 0.008383,
                    "compile_time": 0.033509,
                    "planning_time": 0.004684
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.335078,
                    "execution_time": 0.008064,
                    "compile_time": 3.27541,
                    "planning_time": 0.040276
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1 sun_sales2 mon_sales2 tue_sales2 wed_sales2 thu_sales2 fri_sales2 sat_sales2\n0          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n1          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n2          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n3          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n4          cally  AAAAAAAAIDAAAAAA         5142       None       None       None       None       None       None       None\n5          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n6          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n7          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n8          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n9          ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n10         ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n11         ation  AAAAAAAADEAAAAAA         5142       None       None       None       None       None       None       None\n12         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n13         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n14         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n15         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n16         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n17         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n18         ought  AAAAAAAAPABAAAAA         5142       None       None       None       None       None       None       None\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\nselect  s_store_name1, s_store_id1, d_week_seq1\n       , sun_sales1/sun_sales2, mon_sales1/mon_sales2\n       , tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2\n       , fri_sales1/fri_sales2, sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1, wss.d_week_seq d_week_seq1\n        , s_store_id s_store_id1, sun_sales sun_sales1\n        , mon_sales mon_sales1, tue_sales tue_sales1\n        , wed_sales wed_sales1, thu_sales thu_sales1\n        , fri_sales fri_sales1, sat_sales sat_sales1\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d.d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2, wss.d_week_seq d_week_seq2\n        , s_store_id s_store_id2, sun_sales sun_sales2\n        , mon_sales mon_sales2, tue_sales tue_sales2\n        , wed_sales wed_sales2, thu_sales thu_sales2\n        , fri_sales fri_sales2, sat_sales sat_sales2\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d.d_month_seq between 1182 + 12 and 1182 + 23) z\nwhere s_store_id1 = s_store_id2\nand d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.459298,
                    "execution_time": 0.081583,
                    "compile_time": 0.015975,
                    "planning_time": 0.036928,
                    "create_size": 1140
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.103431,
                    "execution_time": 0.081294,
                    "compile_time": 3.589219,
                    "planning_time": 0.105776,
                    "create_size": 1176
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.232935,
                    "execution_time": 0.054647,
                    "compile_time": 0.098221,
                    "planning_time": 0.042868,
                    "create_size": 65
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.003467,
                    "execution_time": 0.056031,
                    "compile_time": 6.789177,
                    "planning_time": 0.11213,
                    "create_size": 65
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018738,
                    "execution_time": 0.007335,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.0045
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057488,
                    "execution_time": 0.008105,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040142
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d_month_seq between 1182 + 12 and 1182 + 23) z\nwhere s_store_id1 = s_store_id2\nand d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018039,
                    "execution_time": 0.007351,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004233
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053425,
                    "execution_time": 0.007806,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039256
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAANAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAAGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         ation  AAAAAAAABFBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1182 + 12 and 1182 + 23) z where s_store_id1 = s_store_id2 and d_week_seq1 = d_week_seq2 order by s_store_name1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\" ORDER BY \"S_STORE_NAME1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"S_STORE_NAME1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041412,
                    "execution_time": 0.008757,
                    "compile_time": 0.0209,
                    "planning_time": 0.004828
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.253776,
                    "execution_time": 0.009569,
                    "compile_time": 5.199347,
                    "planning_time": 0.039921
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" ORDER BY \"S_STORE_NAME1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"S_STORE_NAME1\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9                 AAAAAAAAEGBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17          able  AAAAAAAAIIBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18          able  AAAAAAAAMEBAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.109032,
                    "execution_time": 0.032708,
                    "compile_time": 0.026893,
                    "planning_time": 0.024856,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.470194,
                    "execution_time": 0.032876,
                    "compile_time": 3.310668,
                    "planning_time": 0.088794,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAGDBAAAAA         5140  1.3939  0.9103  0.8445  0.8519  1.1352  0.6649  0.9244\n1          ation  AAAAAAAAHPAAAAAA         5140  1.0145  0.7918  0.9873  1.2522  0.8398  0.5877  0.9450\n2            ese  AAAAAAAAGHBAAAAA         5140  1.4946  0.8828  0.8163  1.0265  1.0479  0.8792  0.8133\n3           able  AAAAAAAAMFAAAAAA         5140  0.9880  0.9851  0.8838  0.8451  0.7431  0.7610  1.0259\n4           eing  AAAAAAAAGGBAAAAA         5140  0.9506  1.0894  0.6800  1.0133  1.5819  0.9100  0.8738\n5           n st  AAAAAAAABCBAAAAA         5140  1.5021  0.8250  0.9446  0.8160  1.1406  0.5482  1.0548\n6            ese  AAAAAAAAKJAAAAAA         5140  1.5626  0.7716  1.0627  0.9533  1.3708  0.8690  1.0253\n7           eing  AAAAAAAAIEBAAAAA         5140  1.4270  0.9163  0.7605  0.9053  1.1055  0.7183  0.9007\n8           n st  AAAAAAAAJKAAAAAA         5140  1.3558  0.6925  1.2040  1.0092  1.1005  0.4786  0.7547\n9          ation  AAAAAAAALLAAAAAA         5140  1.4925  1.0064  1.0621  0.6906  1.4926  0.6899  0.8676\n10           ese  AAAAAAAACMAAAAAA         5140  1.2056  0.7818  1.1852  0.9922  0.9788  1.0026  0.6236\n11         cally  AAAAAAAAKABAAAAA         5140  1.0111  0.8774  1.2433  1.0215  1.4510  0.5553  0.7062\n12           bar  AAAAAAAAMNAAAAAA         5140  1.1017  0.7353  0.9678  0.9336  1.0704  0.7252  0.8680\n13          able  AAAAAAAACPAAAAAA         5140  1.0905  0.7918  1.1802  1.1918  1.1200  0.8398  0.9186\n14           ese  AAAAAAAAOPAAAAAA         5140  1.3400  1.0230  1.0650  0.9547  1.1024  0.7661  0.9266\n15          able  AAAAAAAAODAAAAAA         5140  1.4618  0.8296  0.9406  0.8095  1.1481  0.6797  0.9082\n16          anti  AAAAAAAABJAAAAAA         5140  1.4337  1.0840  0.9916  0.6146  1.1060  0.8518  0.8674\n17          anti  AAAAAAAAHCBAAAAA         5140  1.5063  0.9097  0.8989  1.4128  0.7982  0.6439  0.9244\n18          eing  AAAAAAAAMBAAAAAA         5140  1.4701  0.8151  1.3016  1.0503  1.0472  1.0795  0.7645\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.219272,
                    "execution_time": 0.057202,
                    "compile_time": 0.09922,
                    "planning_time": 0.043133
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.074192,
                    "execution_time": 0.054206,
                    "compile_time": 6.893053,
                    "planning_time": 0.100026
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAGDBAAAAA         5140  1.3939  0.9103  0.8445  0.8519  1.1352  0.6649  0.9244\n1          ation  AAAAAAAAHPAAAAAA         5140  1.0145  0.7918  0.9873  1.2522  0.8398  0.5877  0.9450\n2            ese  AAAAAAAAGHBAAAAA         5140  1.4946  0.8828  0.8163  1.0265  1.0479  0.8792  0.8133\n3           able  AAAAAAAAMFAAAAAA         5140  0.9880  0.9851  0.8838  0.8451  0.7431  0.7610  1.0259\n4           eing  AAAAAAAAGGBAAAAA         5140  0.9506  1.0894  0.6800  1.0133  1.5819  0.9100  0.8738\n5           n st  AAAAAAAABCBAAAAA         5140  1.5021  0.8250  0.9446  0.8160  1.1406  0.5482  1.0548\n6            ese  AAAAAAAAKJAAAAAA         5140  1.5626  0.7716  1.0627  0.9533  1.3708  0.8690  1.0253\n7           eing  AAAAAAAAIEBAAAAA         5140  1.4270  0.9163  0.7605  0.9053  1.1055  0.7183  0.9007\n8           n st  AAAAAAAAJKAAAAAA         5140  1.3558  0.6925  1.2040  1.0092  1.1005  0.4786  0.7547\n9          ation  AAAAAAAALLAAAAAA         5140  1.4925  1.0064  1.0621  0.6906  1.4926  0.6899  0.8676\n10           ese  AAAAAAAACMAAAAAA         5140  1.2056  0.7818  1.1852  0.9922  0.9788  1.0026  0.6236\n11         cally  AAAAAAAAKABAAAAA         5140  1.0111  0.8774  1.2433  1.0215  1.4510  0.5553  0.7062\n12           bar  AAAAAAAAMNAAAAAA         5140  1.1017  0.7353  0.9678  0.9336  1.0704  0.7252  0.8680\n13          able  AAAAAAAACPAAAAAA         5140  1.0905  0.7918  1.1802  1.1918  1.1200  0.8398  0.9186\n14           ese  AAAAAAAAOPAAAAAA         5140  1.3400  1.0230  1.0650  0.9547  1.1024  0.7661  0.9266\n15          able  AAAAAAAAODAAAAAA         5140  1.4618  0.8296  0.9406  0.8095  1.1481  0.6797  0.9082\n16          anti  AAAAAAAABJAAAAAA         5140  1.4337  1.0840  0.9916  0.6146  1.1060  0.8518  0.8674\n17          anti  AAAAAAAAHCBAAAAA         5140  1.5063  0.9097  0.8989  1.4128  0.7982  0.6439  0.9244\n18          eing  AAAAAAAAMBAAAAAA         5140  1.4701  0.8151  1.3016  1.0503  1.0472  1.0795  0.7645\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 14.09463,
                    "execution_time": 12.807924,
                    "compile_time": 0.000828,
                    "planning_time": 0.04181,
                    "create_size": 15744
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 20.714817,
                    "execution_time": 19.35729,
                    "compile_time": 0.068998,
                    "planning_time": 0.041335,
                    "create_size": 15744
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  0.9906  0.9913  0.9557  0.8237  1.1129  0.9977  0.9191\n1           anti  AAAAAAAABJAAAAAA         5148  1.2302  0.8934  0.8735  0.9452  0.9059  0.9232  1.1137\n2           anti  AAAAAAAABJAAAAAA         5148  0.9739  0.9674  0.8217  0.9748  1.0123  0.9228  0.9243\n3           anti  AAAAAAAABJAAAAAA         5148  1.0113  0.8998  0.7767  1.2248  0.8372  0.9477  0.8555\n4           anti  AAAAAAAABJAAAAAA         5148  1.1810  0.8542  0.8607  0.8016  0.9840  1.0488  0.8272\n5           anti  AAAAAAAABJAAAAAA         5148  0.8040  0.9379  0.9647  1.0520  0.8240  1.0054  0.8265\n6           anti  AAAAAAAABJAAAAAA         5148  1.2542  0.9553  0.8826  0.9020  0.8634  0.9904  0.9225\n7           anti  AAAAAAAABJAAAAAA         5148  1.1967  0.7036  1.0480  0.8807  0.9401  0.9083  0.8492\n8           anti  AAAAAAAABJAAAAAA         5148  1.0630  0.9122  0.7812  1.0038  0.8742  1.1061  0.9087\n9           anti  AAAAAAAABJAAAAAA         5148  1.0584  0.8818  1.0415  1.0453  1.1070  0.9552  0.7452\n10          anti  AAAAAAAABJAAAAAA         5148  1.1625  0.9009  0.8471  0.9115  0.8058  1.0100  0.9779\n11          anti  AAAAAAAABJAAAAAA         5148  1.0643  1.1453  0.8131  0.9952  1.1259  0.8337  0.8503\n12          anti  AAAAAAAABJAAAAAA         5148  1.0042  0.8812  0.9009  0.8134  1.1498  1.0912  0.9318\n13          anti  AAAAAAAABJAAAAAA         5148  0.9512  1.1375  0.8849  0.9315  0.9789  0.9888  0.9901\n14          anti  AAAAAAAABJAAAAAA         5148  1.1437  1.0545  0.9807  0.9434  0.8419  1.1789  0.8299\n15          anti  AAAAAAAABJAAAAAA         5148  0.9989  0.8532  0.9776  0.9381  0.8299  1.1123  0.9002\n16          anti  AAAAAAAABJAAAAAA         5148  1.1993  0.9697  0.8147  0.9838  1.0239  0.8289  0.8861\n17          anti  AAAAAAAABJAAAAAA         5148  1.0297  1.2950  0.8432  0.8976  0.7285  0.8386  1.1469\n18          anti  AAAAAAAABJAAAAAA         5148  0.9510  1.0796  0.8338  0.8934  0.8689  0.9130  1.0368\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020508,
                    "execution_time": 0.008401,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004706
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059648,
                    "execution_time": 0.010127,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040248
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  0.9906  0.9913  0.9557  0.8237  1.1129  0.9977  0.9191\n1           anti  AAAAAAAABJAAAAAA         5148  1.2302  0.8934  0.8735  0.9452  0.9059  0.9232  1.1137\n2           anti  AAAAAAAABJAAAAAA         5148  0.9739  0.9674  0.8217  0.9748  1.0123  0.9228  0.9243\n3           anti  AAAAAAAABJAAAAAA         5148  1.0113  0.8998  0.7767  1.2248  0.8372  0.9477  0.8555\n4           anti  AAAAAAAABJAAAAAA         5148  1.1810  0.8542  0.8607  0.8016  0.9840  1.0488  0.8272\n5           anti  AAAAAAAABJAAAAAA         5148  0.8040  0.9379  0.9647  1.0520  0.8240  1.0054  0.8265\n6           anti  AAAAAAAABJAAAAAA         5148  1.2542  0.9553  0.8826  0.9020  0.8634  0.9904  0.9225\n7           anti  AAAAAAAABJAAAAAA         5148  1.1967  0.7036  1.0480  0.8807  0.9401  0.9083  0.8492\n8           anti  AAAAAAAABJAAAAAA         5148  1.0630  0.9122  0.7812  1.0038  0.8742  1.1061  0.9087\n9           anti  AAAAAAAABJAAAAAA         5148  1.0584  0.8818  1.0415  1.0453  1.1070  0.9552  0.7452\n10          anti  AAAAAAAABJAAAAAA         5148  1.1625  0.9009  0.8471  0.9115  0.8058  1.0100  0.9779\n11          anti  AAAAAAAABJAAAAAA         5148  1.0643  1.1453  0.8131  0.9952  1.1259  0.8337  0.8503\n12          anti  AAAAAAAABJAAAAAA         5148  1.0042  0.8812  0.9009  0.8134  1.1498  1.0912  0.9318\n13          anti  AAAAAAAABJAAAAAA         5148  0.9512  1.1375  0.8849  0.9315  0.9789  0.9888  0.9901\n14          anti  AAAAAAAABJAAAAAA         5148  1.1437  1.0545  0.9807  0.9434  0.8419  1.1789  0.8299\n15          anti  AAAAAAAABJAAAAAA         5148  0.9989  0.8532  0.9776  0.9381  0.8299  1.1123  0.9002\n16          anti  AAAAAAAABJAAAAAA         5148  1.1993  0.9697  0.8147  0.9838  1.0239  0.8289  0.8861\n17          anti  AAAAAAAABJAAAAAA         5148  1.0297  1.2950  0.8432  0.8976  0.7285  0.8386  1.1469\n18          anti  AAAAAAAABJAAAAAA         5148  0.9510  1.0796  0.8338  0.8934  0.8689  0.9130  1.0368\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  1.0416  1.1047  0.8133  0.8611  0.8795  1.2118  1.0256\n1           anti  AAAAAAAABJAAAAAA         5148  1.0339  1.2130  1.0316  1.1102  0.9873  0.7960  0.7434\n2           anti  AAAAAAAABJAAAAAA         5148  1.0796  0.9562  1.0868  0.7533  0.9965  0.9207  1.0346\n3           anti  AAAAAAAABJAAAAAA         5148  1.0093  1.1614  1.0132  0.9548  0.7789  0.9715  0.8738\n4           anti  AAAAAAAABJAAAAAA         5148  1.1770  0.9844  0.9678  1.0544  0.7261  0.9437  0.8065\n5           anti  AAAAAAAABJAAAAAA         5148  1.2898  1.0762  0.8173  0.8466  1.1478  1.1011  0.8761\n6           anti  AAAAAAAABJAAAAAA         5148  1.0421  1.0501  0.9197  0.8846  0.8992  1.0720  0.9358\n7           anti  AAAAAAAABJAAAAAA         5148  1.1269  1.0010  0.7750  0.7996  0.9556  0.9472  0.8130\n8           anti  AAAAAAAABJAAAAAA         5148  1.0785  1.1157  1.1533  0.9882  0.9793  0.9817  0.9381\n9           anti  AAAAAAAABJAAAAAA         5148  1.0744  0.8876  0.8885  0.8236  0.8564  0.8850  1.0137\n10          anti  AAAAAAAABJAAAAAA         5148  1.1551  0.9487  0.8892  0.8928  0.9609  1.0278  1.1625\n11          anti  AAAAAAAABJAAAAAA         5148  1.0083  0.9782  0.9789  1.0246  0.9350  0.9271  0.8797\n12          anti  AAAAAAAABJAAAAAA         5148  0.8810  0.9674  0.9628  0.9165  0.9729  0.7529  0.8522\n13          anti  AAAAAAAABJAAAAAA         5148  1.0598  1.0040  0.9730  0.8204  0.9171  0.8767  0.8739\n14          anti  AAAAAAAABJAAAAAA         5148  1.1372  0.8584  0.9699  1.1077  0.9464  0.8798  0.9723\n15          anti  AAAAAAAABJAAAAAA         5148  0.9350  0.8304  1.1671  0.9615  0.9459  1.0691  0.9763\n16          anti  AAAAAAAABJAAAAAA         5148  1.2676  1.2051  0.8465  0.8253  0.9638  0.9058  1.1029\n17          anti  AAAAAAAABJAAAAAA         5148  1.0936  0.8615  1.1064  0.8172  0.9926  0.9181  0.8785\n18          anti  AAAAAAAABJAAAAAA         5148  1.1634  1.1959  0.9184  1.0349  1.0231  1.0989  0.9233\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020438,
                    "execution_time": 0.009441,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004305
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054203,
                    "execution_time": 0.008389,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.039129
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  1.0416  1.1047  0.8133  0.8611  0.8795  1.2118  1.0256\n1           anti  AAAAAAAABJAAAAAA         5148  1.0339  1.2130  1.0316  1.1102  0.9873  0.7960  0.7434\n2           anti  AAAAAAAABJAAAAAA         5148  1.0796  0.9562  1.0868  0.7533  0.9965  0.9207  1.0346\n3           anti  AAAAAAAABJAAAAAA         5148  1.0093  1.1614  1.0132  0.9548  0.7789  0.9715  0.8738\n4           anti  AAAAAAAABJAAAAAA         5148  1.1770  0.9844  0.9678  1.0544  0.7261  0.9437  0.8065\n5           anti  AAAAAAAABJAAAAAA         5148  1.2898  1.0762  0.8173  0.8466  1.1478  1.1011  0.8761\n6           anti  AAAAAAAABJAAAAAA         5148  1.0421  1.0501  0.9197  0.8846  0.8992  1.0720  0.9358\n7           anti  AAAAAAAABJAAAAAA         5148  1.1269  1.0010  0.7750  0.7996  0.9556  0.9472  0.8130\n8           anti  AAAAAAAABJAAAAAA         5148  1.0785  1.1157  1.1533  0.9882  0.9793  0.9817  0.9381\n9           anti  AAAAAAAABJAAAAAA         5148  1.0744  0.8876  0.8885  0.8236  0.8564  0.8850  1.0137\n10          anti  AAAAAAAABJAAAAAA         5148  1.1551  0.9487  0.8892  0.8928  0.9609  1.0278  1.1625\n11          anti  AAAAAAAABJAAAAAA         5148  1.0083  0.9782  0.9789  1.0246  0.9350  0.9271  0.8797\n12          anti  AAAAAAAABJAAAAAA         5148  0.8810  0.9674  0.9628  0.9165  0.9729  0.7529  0.8522\n13          anti  AAAAAAAABJAAAAAA         5148  1.0598  1.0040  0.9730  0.8204  0.9171  0.8767  0.8739\n14          anti  AAAAAAAABJAAAAAA         5148  1.1372  0.8584  0.9699  1.1077  0.9464  0.8798  0.9723\n15          anti  AAAAAAAABJAAAAAA         5148  0.9350  0.8304  1.1671  0.9615  0.9459  1.0691  0.9763\n16          anti  AAAAAAAABJAAAAAA         5148  1.2676  1.2051  0.8465  0.8253  0.9638  0.9058  1.1029\n17          anti  AAAAAAAABJAAAAAA         5148  1.0936  0.8615  1.1064  0.8172  0.9926  0.9181  0.8785\n18          anti  AAAAAAAABJAAAAAA         5148  1.1634  1.1959  0.9184  1.0349  1.0231  1.0989  0.9233\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk\n) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n1           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n2           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n3           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n4           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n5           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n6           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n7           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n8           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n9           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n10          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n11          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n12          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n13          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n14          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n15          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n16          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n17          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n18          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.249384,
                    "execution_time": 0.037463,
                    "compile_time": 0.135574,
                    "planning_time": 0.055534
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 12.980102,
                    "execution_time": 0.042576,
                    "compile_time": 12.783023,
                    "planning_time": 0.125037
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n1           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n2           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n3           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n4           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n5           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n6           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n7           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n8           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n9           eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n10          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n11          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n12          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n13          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n14          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n15          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n16          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n17          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n18          eing  AAAAAAAACLAAAAAA         5140  1.0585  1.0559  1.2126  0.9327  0.9753  0.5842  0.9592\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  1.0416  1.1047  0.8133  0.8611  0.8795  1.2118  1.0256\n1           anti  AAAAAAAABJAAAAAA         5148  1.0339  1.2130  1.0316  1.1102  0.9873  0.7960  0.7434\n2           anti  AAAAAAAABJAAAAAA         5148  1.0796  0.9562  1.0868  0.7533  0.9965  0.9207  1.0346\n3           anti  AAAAAAAABJAAAAAA         5148  1.0093  1.1614  1.0132  0.9548  0.7789  0.9715  0.8738\n4           anti  AAAAAAAABJAAAAAA         5148  1.1770  0.9844  0.9678  1.0544  0.7261  0.9437  0.8065\n5           anti  AAAAAAAABJAAAAAA         5148  1.2898  1.0762  0.8173  0.8466  1.1478  1.1011  0.8761\n6           anti  AAAAAAAABJAAAAAA         5148  1.0421  1.0501  0.9197  0.8846  0.8992  1.0720  0.9358\n7           anti  AAAAAAAABJAAAAAA         5148  1.1269  1.0010  0.7750  0.7996  0.9556  0.9472  0.8130\n8           anti  AAAAAAAABJAAAAAA         5148  1.0785  1.1157  1.1533  0.9882  0.9793  0.9817  0.9381\n9           anti  AAAAAAAABJAAAAAA         5148  1.0744  0.8876  0.8885  0.8236  0.8564  0.8850  1.0137\n10          anti  AAAAAAAABJAAAAAA         5148  1.1551  0.9487  0.8892  0.8928  0.9609  1.0278  1.1625\n11          anti  AAAAAAAABJAAAAAA         5148  1.0083  0.9782  0.9789  1.0246  0.9350  0.9271  0.8797\n12          anti  AAAAAAAABJAAAAAA         5148  0.8810  0.9674  0.9628  0.9165  0.9729  0.7529  0.8522\n13          anti  AAAAAAAABJAAAAAA         5148  1.0598  1.0040  0.9730  0.8204  0.9171  0.8767  0.8739\n14          anti  AAAAAAAABJAAAAAA         5148  1.1372  0.8584  0.9699  1.1077  0.9464  0.8798  0.9723\n15          anti  AAAAAAAABJAAAAAA         5148  0.9350  0.8304  1.1671  0.9615  0.9459  1.0691  0.9763\n16          anti  AAAAAAAABJAAAAAA         5148  1.2676  1.2051  0.8465  0.8253  0.9638  0.9058  1.1029\n17          anti  AAAAAAAABJAAAAAA         5148  1.0936  0.8615  1.1064  0.8172  0.9926  0.9181  0.8785\n18          anti  AAAAAAAABJAAAAAA         5148  1.1634  1.1959  0.9184  1.0349  1.0231  1.0989  0.9233\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019531,
                    "execution_time": 0.008994,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004251
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021357,
                    "execution_time": 0.010077,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004398
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  1.0416  1.1047  0.8133  0.8611  0.8795  1.2118  1.0256\n1           anti  AAAAAAAABJAAAAAA         5148  1.0339  1.2130  1.0316  1.1102  0.9873  0.7960  0.7434\n2           anti  AAAAAAAABJAAAAAA         5148  1.0796  0.9562  1.0868  0.7533  0.9965  0.9207  1.0346\n3           anti  AAAAAAAABJAAAAAA         5148  1.0093  1.1614  1.0132  0.9548  0.7789  0.9715  0.8738\n4           anti  AAAAAAAABJAAAAAA         5148  1.1770  0.9844  0.9678  1.0544  0.7261  0.9437  0.8065\n5           anti  AAAAAAAABJAAAAAA         5148  1.2898  1.0762  0.8173  0.8466  1.1478  1.1011  0.8761\n6           anti  AAAAAAAABJAAAAAA         5148  1.0421  1.0501  0.9197  0.8846  0.8992  1.0720  0.9358\n7           anti  AAAAAAAABJAAAAAA         5148  1.1269  1.0010  0.7750  0.7996  0.9556  0.9472  0.8130\n8           anti  AAAAAAAABJAAAAAA         5148  1.0785  1.1157  1.1533  0.9882  0.9793  0.9817  0.9381\n9           anti  AAAAAAAABJAAAAAA         5148  1.0744  0.8876  0.8885  0.8236  0.8564  0.8850  1.0137\n10          anti  AAAAAAAABJAAAAAA         5148  1.1551  0.9487  0.8892  0.8928  0.9609  1.0278  1.1625\n11          anti  AAAAAAAABJAAAAAA         5148  1.0083  0.9782  0.9789  1.0246  0.9350  0.9271  0.8797\n12          anti  AAAAAAAABJAAAAAA         5148  0.8810  0.9674  0.9628  0.9165  0.9729  0.7529  0.8522\n13          anti  AAAAAAAABJAAAAAA         5148  1.0598  1.0040  0.9730  0.8204  0.9171  0.8767  0.8739\n14          anti  AAAAAAAABJAAAAAA         5148  1.1372  0.8584  0.9699  1.1077  0.9464  0.8798  0.9723\n15          anti  AAAAAAAABJAAAAAA         5148  0.9350  0.8304  1.1671  0.9615  0.9459  1.0691  0.9763\n16          anti  AAAAAAAABJAAAAAA         5148  1.2676  1.2051  0.8465  0.8253  0.9638  0.9058  1.1029\n17          anti  AAAAAAAABJAAAAAA         5148  1.0936  0.8615  1.1064  0.8172  0.9926  0.9181  0.8785\n18          anti  AAAAAAAABJAAAAAA         5148  1.1634  1.1959  0.9184  1.0349  1.0231  1.0989  0.9233\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" CROSS JOIN \"WSS\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  2.9314  2.3969  2.4315  1.7966  1.9937  3.0793  1.9128\n1           anti  AAAAAAAABJAAAAAA         5148  2.3973  2.0720  2.2561  1.9311  2.0246  1.9844  2.3046\n2           anti  AAAAAAAABJAAAAAA         5148  2.5260  3.1814  1.6747  1.9283  2.4921  1.8767  1.7749\n3           anti  AAAAAAAABJAAAAAA         5148  3.0634  2.8548  2.2867  2.0722  1.7348  2.5141  1.8306\n4           anti  AAAAAAAABJAAAAAA         5148  3.0514  1.9746  3.0150  2.3276  1.9633  2.6599  1.9352\n5           anti  AAAAAAAABJAAAAAA         5148  1.8982  1.9893  2.4572  2.1928  1.8039  1.9469  1.5035\n6           anti  AAAAAAAABJAAAAAA         5148  2.7189  2.1312  3.3615  2.0943  1.9057  2.1943  2.1382\n7           anti  AAAAAAAABJAAAAAA         5148  3.2458  2.2684  1.5402  2.0833  2.3959  2.2154  2.7608\n8           anti  AAAAAAAABJAAAAAA         5148  2.1904  2.1576  1.6677  2.1907  1.7832  1.8116  1.8618\n9           anti  AAAAAAAABJAAAAAA         5148  3.3718  2.2056  2.3226  2.0366  2.0279  2.3839  1.8386\n10          anti  AAAAAAAABJAAAAAA         5148  2.8784  2.0387  2.1298  1.8814  2.9624  2.3447  1.5997\n11          anti  AAAAAAAABJAAAAAA         5148  2.8238  2.4915  2.0890  2.1889  2.3280  2.4428  2.2113\n12          anti  AAAAAAAABJAAAAAA         5148  1.9699  2.1002  2.4675  2.1537  1.8420  2.6883  1.3696\n13          anti  AAAAAAAABJAAAAAA         5148  2.1335  2.3695  1.7835  2.0736  1.8337  2.3087  2.2129\n14          anti  AAAAAAAABJAAAAAA         5148  2.8057  1.7070  3.0107  1.9738  2.0116  1.6406  2.0978\n15          anti  AAAAAAAABJAAAAAA         5148  2.6339  1.9436  2.3631  1.5567  1.8034  2.0528  1.5209\n16          anti  AAAAAAAABJAAAAAA         5148  2.7365  2.5714  1.9687  1.9523  2.4373  2.5070  1.9446\n17          anti  AAAAAAAABJAAAAAA         5148  2.0545  2.1914  1.7361  2.1356  1.8138  2.2558  2.1952\n18          anti  AAAAAAAABJAAAAAA         5148  2.2494  2.5444  1.7750  1.5812  2.5525  2.0417  1.8023\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.103659,
                    "execution_time": 0.029832,
                    "compile_time": 0.000333,
                    "planning_time": 0.055575
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.541046,
                    "execution_time": 0.031554,
                    "compile_time": 4.363914,
                    "planning_time": 0.12339
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           anti  AAAAAAAABJAAAAAA         5148  2.9314  2.3969  2.4315  1.7966  1.9937  3.0793  1.9128\n1           anti  AAAAAAAABJAAAAAA         5148  2.3973  2.0720  2.2561  1.9311  2.0246  1.9844  2.3046\n2           anti  AAAAAAAABJAAAAAA         5148  2.5260  3.1814  1.6747  1.9283  2.4921  1.8767  1.7749\n3           anti  AAAAAAAABJAAAAAA         5148  3.0634  2.8548  2.2867  2.0722  1.7348  2.5141  1.8306\n4           anti  AAAAAAAABJAAAAAA         5148  3.0514  1.9746  3.0150  2.3276  1.9633  2.6599  1.9352\n5           anti  AAAAAAAABJAAAAAA         5148  1.8982  1.9893  2.4572  2.1928  1.8039  1.9469  1.5035\n6           anti  AAAAAAAABJAAAAAA         5148  2.7189  2.1312  3.3615  2.0943  1.9057  2.1943  2.1382\n7           anti  AAAAAAAABJAAAAAA         5148  3.2458  2.2684  1.5402  2.0833  2.3959  2.2154  2.7608\n8           anti  AAAAAAAABJAAAAAA         5148  2.1904  2.1576  1.6677  2.1907  1.7832  1.8116  1.8618\n9           anti  AAAAAAAABJAAAAAA         5148  3.3718  2.2056  2.3226  2.0366  2.0279  2.3839  1.8386\n10          anti  AAAAAAAABJAAAAAA         5148  2.8784  2.0387  2.1298  1.8814  2.9624  2.3447  1.5997\n11          anti  AAAAAAAABJAAAAAA         5148  2.8238  2.4915  2.0890  2.1889  2.3280  2.4428  2.2113\n12          anti  AAAAAAAABJAAAAAA         5148  1.9699  2.1002  2.4675  2.1537  1.8420  2.6883  1.3696\n13          anti  AAAAAAAABJAAAAAA         5148  2.1335  2.3695  1.7835  2.0736  1.8337  2.3087  2.2129\n14          anti  AAAAAAAABJAAAAAA         5148  2.8057  1.7070  3.0107  1.9738  2.0116  1.6406  2.0978\n15          anti  AAAAAAAABJAAAAAA         5148  2.6339  1.9436  2.3631  1.5567  1.8034  2.0528  1.5209\n16          anti  AAAAAAAABJAAAAAA         5148  2.7365  2.5714  1.9687  1.9523  2.4373  2.5070  1.9446\n17          anti  AAAAAAAABJAAAAAA         5148  2.0545  2.1914  1.7361  2.1356  1.8138  2.2558  2.1952\n18          anti  AAAAAAAABJAAAAAA         5148  2.2494  2.5444  1.7750  1.5812  2.5525  2.0417  1.8023\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.444304,
                    "execution_time": 0.07992,
                    "compile_time": 0.046396,
                    "planning_time": 0.004267,
                    "create_size": 1078
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.167901,
                    "execution_time": 0.217022,
                    "compile_time": 3.568038,
                    "planning_time": 0.06085,
                    "create_size": 1078
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_ID2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.008183,
                    "execution_time": 2.619298,
                    "compile_time": 0.173657,
                    "planning_time": 0.04164,
                    "create_size": 4992
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.823444,
                    "execution_time": 4.852273,
                    "compile_time": 9.60342,
                    "planning_time": 0.110714,
                    "create_size": 4992
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n1          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n2          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n3          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n4          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n5          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n6          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n7          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n8          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n9          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n10         cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n11         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n12         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n13         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n14         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n15         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n16         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n17         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n18         cally  AAAAAAAAKABAAAAA         5147  2.2147  1.7676  2.0247  2.1078  2.4476  2.8414  2.8003\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019173,
                    "execution_time": 0.008021,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004472
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057281,
                    "execution_time": 0.008099,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040082
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_16\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_ID2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n1          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n2          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n3          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n4          cally  AAAAAAAAKABAAAAA         5155  2.3038  2.1072  2.0473  1.6942  1.7405  2.7661  2.3025\n5          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n6          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n7          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n8          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n9          cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n10         cally  AAAAAAAAKABAAAAA         5140  0.8289  0.8891  1.0841  0.9086  1.0322  0.8373  0.8650\n11         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n12         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n13         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n14         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n15         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n16         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n17         cally  AAAAAAAAKABAAAAA         5146  2.4612  3.0401  2.1181  2.2059  1.8909  3.1631  2.9829\n18         cally  AAAAAAAAKABAAAAA         5147  2.2147  1.7676  2.0247  2.1078  2.4476  2.8414  2.8003\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.605417,
                    "execution_time": 0.64366,
                    "compile_time": 0.037058,
                    "planning_time": 0.043463,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.009653,
                    "execution_time": 0.653317,
                    "compile_time": 3.354881,
                    "planning_time": 0.111368,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n1           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n2           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n3           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n4           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n5           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n6           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n7           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n8           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n9           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n10          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n11          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n12          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n13          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n14          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n15          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n16          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n17          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n18          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019616,
                    "execution_time": 0.008299,
                    "compile_time": 5e-05,
                    "planning_time": 0.004574
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05681,
                    "execution_time": 0.008496,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040022
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n1           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n2           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n3           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n4           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n5           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n6           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n7           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n8           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n9           eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n10          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n11          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n12          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n13          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n14          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n15          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n16          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n17          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n18          eing  AAAAAAAAIPAAAAAA         5145  1.1466  0.9923  0.9906  0.9508  0.9615  0.9902  1.3033\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"S_STORE_NAME1\" , \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n1                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n2                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n3                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n4                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n5                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n6                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n7                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n8                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n9                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n10                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n11                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n12                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n13                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n14                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n15                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n16                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n17                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n18                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.051542,
                    "execution_time": 0.024886,
                    "compile_time": 0.015407,
                    "planning_time": 0.00474
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.420754,
                    "execution_time": 0.025407,
                    "compile_time": 3.367063,
                    "planning_time": 0.040556
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n1                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n2                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n3                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n4                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n5                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n6                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n7                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n8                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n9                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n10                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n11                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n12                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n13                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n14                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n15                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n16                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n17                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n18                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"S_STORE_NAME1\" , \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n1                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n2                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n3                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n4                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n5                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n6                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n7                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n8                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n9                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n10                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n11                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n12                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n13                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n14                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n15                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n16                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n17                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n18                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036431,
                    "execution_time": 0.024709,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.004871
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.037029,
                    "execution_time": 0.025341,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004934
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n1                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n2                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n3                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n4                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n5                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n6                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n7                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n8                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n9                 AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n10                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n11                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n12                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n13                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n14                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n15                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n16                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n17                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n18                AAAAAAAAEGBAAAAA         5140  0.8679  1.1276  1.4717  1.2542  2.3499  1.3489  0.6577\n...*/"
    }
]