[
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id, i_item_desc, i_category, i_class, i_current_price, sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere 1=1  \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.177119,
                    "execution_time": 3.918862,
                    "compile_time": 0.034777,
                    "planning_time": 0.045738,
                    "create_size": 680
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.2896,
                    "execution_time": 4.589139,
                    "compile_time": 3.370818,
                    "planning_time": 0.14743,
                    "create_size": 680
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc i_category        i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFFHEBAAA                                  Steadily identical claims shall not show largely active opinions; formal, funny interests used to go today good, economic others. Examples ought to make radically po    Jewelry  semi-precious             2.58   1823141.03        0.1653\n1   AAAAAAAAFIECAAAA                                                                                                                                       No longer statistical months should find well basic, american bu    Jewelry  semi-precious             7.24   1711043.67        0.1552\n2   AAAAAAAAENOHAAAA             Both dirty designs might think already contracts; warm teachers bury infrequently in a museums. Physical streets drive. Fully young interests shall teach quickly; highly only rights shal    Jewelry  semi-precious             9.42   1099583.81        0.0997\n3   AAAAAAAANCAMBAAA                                                                                                                                                                                   Clear children make     Jewelry  semi-precious             7.39   1814991.77        0.1646\n4   AAAAAAAAFJAPCAAA                                                                                                                                                        Particular, unlikely improvements shall not get    Jewelry  semi-precious             4.16   1621031.80        0.1470\n5   AAAAAAAALOCICAAA                                                                                                                            Physically terrible abilities withstand early new talks. Good youngsters ca    Jewelry  semi-precious             3.72   1738994.44        0.1577\n6   AAAAAAAALMEMBAAA                                                                                                             Able, concerned sheets will find now broken corners. Star, other years ought to prevent be    Jewelry  semi-precious             7.82   2035753.63        0.1846\n7   AAAAAAAAAGDGCAAA                                                                                                                                                                                                   Publ    Jewelry  semi-precious             7.83   1122083.09        0.1017\n8   AAAAAAAAGNEGAAAA              Old, different words raise social securities. Just short tons could use local girls. Here extra tests think very public, likely names. Western tensions rain perhaps little years. Truly     Jewelry  semi-precious             0.67   1094222.27        0.0992\n9   AAAAAAAAOOHNCAAA                                                                                                                                                                  Common groups solve in order happy pr    Jewelry  semi-precious             2.13   1150033.66        0.1043\n10  AAAAAAAAOKCMCAAA               Orders cannot complete extremely on a views; women get diplomatic, likely bones. Gastric, available reasons go other, male authorities. Flat candidates could stand else further certain    Jewelry  semi-precious             1.09    760654.34        0.0690\n11  AAAAAAAAIHOEBAAA                                                                                                                                                      Cameras shall not taste precisely germans. Light     Jewelry  semi-precious             9.13    762019.47        0.0691\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018822,
                    "execution_time": 0.007544,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.005032
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056264,
                    "execution_time": 0.007503,
                    "compile_time": 0.001163,
                    "planning_time": 0.040237
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc i_category        i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFFHEBAAA                                  Steadily identical claims shall not show largely active opinions; formal, funny interests used to go today good, economic others. Examples ought to make radically po    Jewelry  semi-precious             2.58   1823141.03        0.1653\n1   AAAAAAAAFIECAAAA                                                                                                                                       No longer statistical months should find well basic, american bu    Jewelry  semi-precious             7.24   1711043.67        0.1552\n2   AAAAAAAAENOHAAAA             Both dirty designs might think already contracts; warm teachers bury infrequently in a museums. Physical streets drive. Fully young interests shall teach quickly; highly only rights shal    Jewelry  semi-precious             9.42   1099583.81        0.0997\n3   AAAAAAAANCAMBAAA                                                                                                                                                                                   Clear children make     Jewelry  semi-precious             7.39   1814991.77        0.1646\n4   AAAAAAAAFJAPCAAA                                                                                                                                                        Particular, unlikely improvements shall not get    Jewelry  semi-precious             4.16   1621031.80        0.1470\n5   AAAAAAAALOCICAAA                                                                                                                            Physically terrible abilities withstand early new talks. Good youngsters ca    Jewelry  semi-precious             3.72   1738994.44        0.1577\n6   AAAAAAAALMEMBAAA                                                                                                             Able, concerned sheets will find now broken corners. Star, other years ought to prevent be    Jewelry  semi-precious             7.82   2035753.63        0.1846\n7   AAAAAAAAAGDGCAAA                                                                                                                                                                                                   Publ    Jewelry  semi-precious             7.83   1122083.09        0.1017\n8   AAAAAAAAGNEGAAAA              Old, different words raise social securities. Just short tons could use local girls. Here extra tests think very public, likely names. Western tensions rain perhaps little years. Truly     Jewelry  semi-precious             0.67   1094222.27        0.0992\n9   AAAAAAAAOOHNCAAA                                                                                                                                                                  Common groups solve in order happy pr    Jewelry  semi-precious             2.13   1150033.66        0.1043\n10  AAAAAAAAOKCMCAAA               Orders cannot complete extremely on a views; women get diplomatic, likely bones. Gastric, available reasons go other, male authorities. Flat candidates could stand else further certain    Jewelry  semi-precious             1.09    760654.34        0.0690\n11  AAAAAAAAIHOEBAAA                                                                                                                                                      Cameras shall not taste precisely germans. Light     Jewelry  semi-precious             9.13    762019.47        0.0691\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) and cast('2001-07-29' as date) \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-07-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-07-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.54395,
                    "execution_time": 0.368808,
                    "compile_time": 0.028502,
                    "planning_time": 0.046601,
                    "create_size": 680
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.127413,
                    "execution_time": 0.36859,
                    "compile_time": 3.537874,
                    "planning_time": 0.119994,
                    "create_size": 680
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc i_category        i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAIPMCAAA                                                         Lively, public others can deny otherwise other, realistic woods. Rare, other buyers identify shortly pp.. Important trusts sign slightly     Jewelry  semi-precious             4.50     10811.70        0.0998\n1   AAAAAAAAAEDKAAAA                                                                                                                                                                            Areas may mix for a ac    Jewelry  semi-precious             2.16     14103.34        0.1302\n2   AAAAAAAAMKGNCAAA                                                                                                                                     Public eyes make thereafter plain new sides. Private, good di    Jewelry  semi-precious             0.84      3779.10        0.0348\n3   AAAAAAAAGIAACAAA                                                                                                  Busy, long issues could blame even clinical maps. Great details may go again for a proceedings.     Jewelry  semi-precious             7.97     15742.17        0.1453\n4   AAAAAAAAELNLBAAA                                                                                                            Potentially revolutionary courses may not go russian minutes. High gradual conditions     Jewelry  semi-precious             1.83     15016.80        0.1386\n5   AAAAAAAAGLJJAAAA                                                                                    Wrong, small cells sustain even; values predict away central items. More cautious techniques keep years; gener    Jewelry  semi-precious             1.84     17723.63        0.1636\n6   AAAAAAAAJMOMCAAA                                                         Blacks must let also in a prospects; human observers attempt probably. Both subsequent plans could not sanction more messages. More compl    Jewelry  semi-precious             1.41     16875.92        0.1558\n7   AAAAAAAAACMFAAAA                                      Human, continuous others could ask far. Features date more low cigarettes. Circumstances used to depend however round suppliers. Mainly rare things enter al    Jewelry  semi-precious             4.54     12338.08        0.1139\n8   AAAAAAAADEJMAAAA                                                   Good, emotional groups stay delegates; top, economic products slip. Usually public months cannot limit. Probable sources can co-ordinate here p    Jewelry  semi-precious             6.94     22458.48        0.2073\n9   AAAAAAAAGEHKCAAA                                                                                                Partners go to a children. Voices may rent at all standard families. Studies stroke. Proceedings s    Jewelry  semi-precious             0.88     22884.65        0.2112\n10  AAAAAAAAIACIBAAA  International, anonymous flames deepen easier necessary prisons. So as southern cases instruct. As front organisms explore so dramatic, insufficient jews. Still specific miles develop low dead    Jewelry  semi-precious             3.84      7245.81        0.0668\n11  AAAAAAAAGLHBAAAA                                                                                                           Vigorously anonymous women follow; european pupils leap mass, pleasant characteristics.    Jewelry  semi-precious            30.51      4826.76        0.0445\n12  AAAAAAAAPKGECAAA                                                                                                                                                             Still full languages could impose int    Jewelry  semi-precious             1.88     28771.43        0.2656\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019402,
                    "execution_time": 0.007771,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.005104
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054405,
                    "execution_time": 0.007506,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040236
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2001-07-29' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc i_category        i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAIPMCAAA                                                         Lively, public others can deny otherwise other, realistic woods. Rare, other buyers identify shortly pp.. Important trusts sign slightly     Jewelry  semi-precious             4.50     10811.70        0.0998\n1   AAAAAAAAAEDKAAAA                                                                                                                                                                            Areas may mix for a ac    Jewelry  semi-precious             2.16     14103.34        0.1302\n2   AAAAAAAAMKGNCAAA                                                                                                                                     Public eyes make thereafter plain new sides. Private, good di    Jewelry  semi-precious             0.84      3779.10        0.0348\n3   AAAAAAAAGIAACAAA                                                                                                  Busy, long issues could blame even clinical maps. Great details may go again for a proceedings.     Jewelry  semi-precious             7.97     15742.17        0.1453\n4   AAAAAAAAELNLBAAA                                                                                                            Potentially revolutionary courses may not go russian minutes. High gradual conditions     Jewelry  semi-precious             1.83     15016.80        0.1386\n5   AAAAAAAAGLJJAAAA                                                                                    Wrong, small cells sustain even; values predict away central items. More cautious techniques keep years; gener    Jewelry  semi-precious             1.84     17723.63        0.1636\n6   AAAAAAAAJMOMCAAA                                                         Blacks must let also in a prospects; human observers attempt probably. Both subsequent plans could not sanction more messages. More compl    Jewelry  semi-precious             1.41     16875.92        0.1558\n7   AAAAAAAAACMFAAAA                                      Human, continuous others could ask far. Features date more low cigarettes. Circumstances used to depend however round suppliers. Mainly rare things enter al    Jewelry  semi-precious             4.54     12338.08        0.1139\n8   AAAAAAAADEJMAAAA                                                   Good, emotional groups stay delegates; top, economic products slip. Usually public months cannot limit. Probable sources can co-ordinate here p    Jewelry  semi-precious             6.94     22458.48        0.2073\n9   AAAAAAAAGEHKCAAA                                                                                                Partners go to a children. Voices may rent at all standard families. Studies stroke. Proceedings s    Jewelry  semi-precious             0.88     22884.65        0.2112\n10  AAAAAAAAIACIBAAA  International, anonymous flames deepen easier necessary prisons. So as southern cases instruct. As front organisms explore so dramatic, insufficient jews. Still specific miles develop low dead    Jewelry  semi-precious             3.84      7245.81        0.0668\n11  AAAAAAAAGLHBAAAA                                                                                                           Vigorously anonymous women follow; european pupils leap mass, pleasant characteristics.    Jewelry  semi-precious            30.51      4826.76        0.0445\n12  AAAAAAAAPKGECAAA                                                                                                                                                             Still full languages could impose int    Jewelry  semi-precious             1.88     28771.43        0.2656\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACJBKAAAA                                                                                                                                                           Groups operate only necessary proposals. Huge  Electronics  cameras             4.48     15076.08        0.1448\n1   AAAAAAAAOAKNBAAA                                  Legal, soviet advertisements improve. Right small areas will not go hardly others. Parliamentary elections should agree further beds. Origins understand high directly  Electronics  cameras             6.32     22605.77        0.2171\n2   AAAAAAAAINJCAAAA                                                                                                                                                                            High circumstances used to l  Electronics  cameras             2.20     25239.20        0.2424\n3   AAAAAAAAHFEGAAAA                                                                 Labour pensioners might say presently certain banks. Previous, national tests like. Natural, maximum savings would attempt slightly wor  Electronics  cameras             2.23      7054.55        0.0677\n4   AAAAAAAAKFNGAAAA                                                                       Democratic forms could come constant, other resources. Social, large thoughts raise again similar thanks; prices assess. As speci  Electronics  cameras             6.95     25396.24        0.2440\n5   AAAAAAAAINHADAAA                                                                                                                                                                          All cold allegations used to b  Electronics  cameras             4.92     41578.44        0.3994\n6   AAAAAAAAHJOKAAAA                                                                                                                                                Connections see independently communities. New, ready ye  Electronics  cameras             8.33     13418.38        0.1289\n7   AAAAAAAAEKEICAAA                                                                                                     Real, able proposals turn else desperate, independent types. New, blue tactics see good, present co  Electronics  cameras             2.46     28152.30        0.2704\n8   AAAAAAAAKDOACAAA           Fundamental, possible policemen stick fast amounts. British, guilty opponents speak below councils; conclusions will not smooth large readers. Emotional, weak properties must not gain still  Electronics  cameras             5.64     11123.03        0.1068\n9   AAAAAAAAEOHJAAAA                                                                                                                              Details believe practices. Valuable lists used to take later into a follow  Electronics  cameras             1.52     21086.22        0.2025\n10  AAAAAAAAKAJABAAA                                                                                                                                                     External, available arrangements should not indicat  Electronics  cameras             8.63     10645.20        0.1022\n11  AAAAAAAAHIPCCAAA                                                                                                                                                       Familiar relations shall imagine. Probably quiet   Electronics  cameras             3.54     33095.79        0.3179\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.372585,
                    "execution_time": 0.306152,
                    "compile_time": 0.0003,
                    "planning_time": 0.049183
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.448672,
                    "execution_time": 0.304518,
                    "compile_time": 0.016891,
                    "planning_time": 0.109206
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACJBKAAAA                                                                                                                                                           Groups operate only necessary proposals. Huge  Electronics  cameras             4.48     15076.08        0.1448\n1   AAAAAAAAOAKNBAAA                                  Legal, soviet advertisements improve. Right small areas will not go hardly others. Parliamentary elections should agree further beds. Origins understand high directly  Electronics  cameras             6.32     22605.77        0.2171\n2   AAAAAAAAINJCAAAA                                                                                                                                                                            High circumstances used to l  Electronics  cameras             2.20     25239.20        0.2424\n3   AAAAAAAAHFEGAAAA                                                                 Labour pensioners might say presently certain banks. Previous, national tests like. Natural, maximum savings would attempt slightly wor  Electronics  cameras             2.23      7054.55        0.0677\n4   AAAAAAAAKFNGAAAA                                                                       Democratic forms could come constant, other resources. Social, large thoughts raise again similar thanks; prices assess. As speci  Electronics  cameras             6.95     25396.24        0.2440\n5   AAAAAAAAINHADAAA                                                                                                                                                                          All cold allegations used to b  Electronics  cameras             4.92     41578.44        0.3994\n6   AAAAAAAAHJOKAAAA                                                                                                                                                Connections see independently communities. New, ready ye  Electronics  cameras             8.33     13418.38        0.1289\n7   AAAAAAAAEKEICAAA                                                                                                     Real, able proposals turn else desperate, independent types. New, blue tactics see good, present co  Electronics  cameras             2.46     28152.30        0.2704\n8   AAAAAAAAKDOACAAA           Fundamental, possible policemen stick fast amounts. British, guilty opponents speak below councils; conclusions will not smooth large readers. Emotional, weak properties must not gain still  Electronics  cameras             5.64     11123.03        0.1068\n9   AAAAAAAAEOHJAAAA                                                                                                                              Details believe practices. Valuable lists used to take later into a follow  Electronics  cameras             1.52     21086.22        0.2025\n10  AAAAAAAAKAJABAAA                                                                                                                                                     External, available arrangements should not indicat  Electronics  cameras             8.63     10645.20        0.1022\n11  AAAAAAAAHIPCCAAA                                                                                                                                                       Familiar relations shall imagine. Probably quiet   Electronics  cameras             3.54     33095.79        0.3179\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \ni_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAABNHLCAAA                                                                                                                                                       Past parts cancel now old records; main, qu  Electronics  cameras             0.84     28291.51        0.2718\n1   AAAAAAAAEBLJAAAA                                                                                                                                                     Poems must not feel for a countries. Even med  Electronics  cameras             3.12     41860.30        0.4021\n2   AAAAAAAADHCCCAAA                                                                                                                                              Small, essential patients increase. Periods cannot s  Electronics  cameras             8.30     47328.06        0.4547\n3   AAAAAAAAEAAJBAAA        Old contributions might care always on a guards. Contemporary assumptions will not choose different ears. Parents may not wait still young committees; certainly increased accidents could  Electronics  cameras             6.79      7862.44        0.0755\n4   AAAAAAAAKCBIBAAA                                                                                                                                                                                             Fine,  Electronics  cameras             1.75     12855.94        0.1235\n5   AAAAAAAAKJECBAAA                                                                                                                                      Passive cars get still during an sorts. Sisters depend tradi  Electronics  cameras             0.20     14943.82        0.1435\n6   AAAAAAAAGEEHBAAA                                                                                                                                                                                    Important case  Electronics  cameras             6.94     12329.99        0.1184\n7   AAAAAAAAAKOGCAAA                                                                                                       Areas show earlier. Full, private features escape. Mental conservatives should make even to  Electronics  cameras             4.58      4799.82        0.0461\n8   AAAAAAAAIDMECAAA                                                                                Sexual, special words deny invisible, whole parents. General rooms bother with a reasons. Yesterday increased wall  Electronics  cameras             7.20     13296.52        0.1277\n9   AAAAAAAAIGNLCAAA                                                                                                             Static, proposed sites ought to balance regularly for a types; conclusions must not r  Electronics  cameras             5.25     53302.58        0.5121\n10  AAAAAAAADKFABAAA  Theoretical parties may conduct fields; questions could insist; simple, general residents agree distinct friends. Colours should show common, typical police. Extreme, special judges shall requ  Electronics  cameras             7.47     21678.30        0.2082\n11  AAAAAAAAGEEMCAAA                                                                                                                       Foreign, little eyes obtain even little, low kings. Proper, big levels know  Electronics  cameras             4.18     12800.64        0.1229\n12  AAAAAAAAGJMMCAAA           Commercial, local laws might go. Both academic players must not take now. Simply likely months succeed also steep, literary attacks. Other, old accounts may not break afterwards white  Electronics  cameras             0.29     17804.52        0.1710\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.366333,
                    "execution_time": 0.306809,
                    "compile_time": 0.000308,
                    "planning_time": 0.041862
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.367314,
                    "execution_time": 0.307464,
                    "compile_time": 0.000305,
                    "planning_time": 0.042405
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAABNHLCAAA                                                                                                                                                       Past parts cancel now old records; main, qu  Electronics  cameras             0.84     28291.51        0.2718\n1   AAAAAAAAEBLJAAAA                                                                                                                                                     Poems must not feel for a countries. Even med  Electronics  cameras             3.12     41860.30        0.4021\n2   AAAAAAAADHCCCAAA                                                                                                                                              Small, essential patients increase. Periods cannot s  Electronics  cameras             8.30     47328.06        0.4547\n3   AAAAAAAAEAAJBAAA        Old contributions might care always on a guards. Contemporary assumptions will not choose different ears. Parents may not wait still young committees; certainly increased accidents could  Electronics  cameras             6.79      7862.44        0.0755\n4   AAAAAAAAKCBIBAAA                                                                                                                                                                                             Fine,  Electronics  cameras             1.75     12855.94        0.1235\n5   AAAAAAAAKJECBAAA                                                                                                                                      Passive cars get still during an sorts. Sisters depend tradi  Electronics  cameras             0.20     14943.82        0.1435\n6   AAAAAAAAGEEHBAAA                                                                                                                                                                                    Important case  Electronics  cameras             6.94     12329.99        0.1184\n7   AAAAAAAAAKOGCAAA                                                                                                       Areas show earlier. Full, private features escape. Mental conservatives should make even to  Electronics  cameras             4.58      4799.82        0.0461\n8   AAAAAAAAIDMECAAA                                                                                Sexual, special words deny invisible, whole parents. General rooms bother with a reasons. Yesterday increased wall  Electronics  cameras             7.20     13296.52        0.1277\n9   AAAAAAAAIGNLCAAA                                                                                                             Static, proposed sites ought to balance regularly for a types; conclusions must not r  Electronics  cameras             5.25     53302.58        0.5121\n10  AAAAAAAADKFABAAA  Theoretical parties may conduct fields; questions could insist; simple, general residents agree distinct friends. Colours should show common, typical police. Extreme, special judges shall requ  Electronics  cameras             7.47     21678.30        0.2082\n11  AAAAAAAAGEEMCAAA                                                                                                                       Foreign, little eyes obtain even little, low kings. Proper, big levels know  Electronics  cameras             4.18     12800.64        0.1229\n12  AAAAAAAAGJMMCAAA           Commercial, local laws might go. Both academic players must not take now. Simply likely months succeed also steep, literary attacks. Other, old accounts may not break afterwards white  Electronics  cameras             0.29     17804.52        0.1710\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALACKCAAA                                                                                                                                        Now middle degrees manage working, severe intentions. Vari  Electronics  cameras             3.73     32209.02        0.3094\n1   AAAAAAAAEAPMAAAA  Possible, main patients come either for a tiles. Papers play highly upper points. Personal, male instruments test. Long years realise just about a items. Allies shall employ so; levels open ma  Electronics  cameras             1.75     25921.47        0.2490\n2   AAAAAAAANFLIAAAA                                                      Marginal, organic readers should not feel mildly to a experiences. Upper, likely streets say sometimes warm improvements. Police find techni  Electronics  cameras            70.99     11951.02        0.1148\n3   AAAAAAAAKFLPAAAA                                                                                  Letters ought to use informal, little years. Small others might find within a modules. Other eyes help later pub  Electronics  cameras             2.11     11081.72        0.1064\n4   AAAAAAAAGHGECAAA                                As new readers could know. General accounts register easy, fierce others. Less reasonable relatives pay yet industries. Outstanding cases would form again contrib  Electronics  cameras             4.14     21944.95        0.2108\n5   AAAAAAAAAILJBAAA                                                                                                                      Written, determined waves relax; modest, good profits employ eager, upper co  Electronics  cameras             8.96     22038.35        0.2117\n6   AAAAAAAACBHCBAAA                                                                                                                                           Carefully clear regulations must imagine soon banks. Hi  Electronics  cameras             9.76      9025.71        0.0867\n7   AAAAAAAAEIIGAAAA                                                                                                                                                                    Never necessary reports ask so  Electronics  cameras             5.79     10303.21        0.0989\n8   AAAAAAAAKANPCAAA                                                                                  About accessible addresses could control alone civil, back purposes; now modern senses may not deny other, joint  Electronics  cameras             1.93     11115.13        0.1067\n9   AAAAAAAAGONOAAAA                                                                                                New, human trees will not shape so. Immense periods could ensure ears. Clear, social directors ste  Electronics  cameras             0.15     20000.99        0.1921\n10  AAAAAAAAAEOJCAAA                                                                                                                 Long new ministers remain very in a questions. New, commercial solutions explore   Electronics  cameras             2.96     10359.55        0.0995\n11  AAAAAAAAMKEIAAAA                                                                                                 Defensive areas shall not force near the groups. Other, european plates see only naturally full e  Electronics  cameras             4.75     12267.68        0.1178\n12  AAAAAAAAHJEBBAAA                                                                                                                                          Intact events used to remove rather girls; unable senten  Electronics  cameras             7.18     48511.22        0.4660\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.174315,
                    "execution_time": 0.069855,
                    "compile_time": 0.044401,
                    "planning_time": 0.042775
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.364075,
                    "execution_time": 0.303577,
                    "compile_time": 0.000329,
                    "planning_time": 0.042839
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALACKCAAA                                                                                                                                        Now middle degrees manage working, severe intentions. Vari  Electronics  cameras             3.73     32209.02        0.3094\n1   AAAAAAAAEAPMAAAA  Possible, main patients come either for a tiles. Papers play highly upper points. Personal, male instruments test. Long years realise just about a items. Allies shall employ so; levels open ma  Electronics  cameras             1.75     25921.47        0.2490\n2   AAAAAAAANFLIAAAA                                                      Marginal, organic readers should not feel mildly to a experiences. Upper, likely streets say sometimes warm improvements. Police find techni  Electronics  cameras            70.99     11951.02        0.1148\n3   AAAAAAAAKFLPAAAA                                                                                  Letters ought to use informal, little years. Small others might find within a modules. Other eyes help later pub  Electronics  cameras             2.11     11081.72        0.1064\n4   AAAAAAAAGHGECAAA                                As new readers could know. General accounts register easy, fierce others. Less reasonable relatives pay yet industries. Outstanding cases would form again contrib  Electronics  cameras             4.14     21944.95        0.2108\n5   AAAAAAAAAILJBAAA                                                                                                                      Written, determined waves relax; modest, good profits employ eager, upper co  Electronics  cameras             8.96     22038.35        0.2117\n6   AAAAAAAACBHCBAAA                                                                                                                                           Carefully clear regulations must imagine soon banks. Hi  Electronics  cameras             9.76      9025.71        0.0867\n7   AAAAAAAAEIIGAAAA                                                                                                                                                                    Never necessary reports ask so  Electronics  cameras             5.79     10303.21        0.0989\n8   AAAAAAAAKANPCAAA                                                                                  About accessible addresses could control alone civil, back purposes; now modern senses may not deny other, joint  Electronics  cameras             1.93     11115.13        0.1067\n9   AAAAAAAAGONOAAAA                                                                                                New, human trees will not shape so. Immense periods could ensure ears. Clear, social directors ste  Electronics  cameras             0.15     20000.99        0.1921\n10  AAAAAAAAAEOJCAAA                                                                                                                 Long new ministers remain very in a questions. New, commercial solutions explore   Electronics  cameras             2.96     10359.55        0.0995\n11  AAAAAAAAMKEIAAAA                                                                                                 Defensive areas shall not force near the groups. Other, european plates see only naturally full e  Electronics  cameras             4.75     12267.68        0.1178\n12  AAAAAAAAHJEBBAAA                                                                                                                                          Intact events used to remove rather girls; unable senten  Electronics  cameras             7.18     48511.22        0.4660\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABMJAAAA                                                                                   Usual streets should occur labour plans. Furious, local measures will not lower only good plans. Accurate windows resp  Electronics  cameras             3.74     15301.31        0.1470\n1   AAAAAAAAGIKKBAAA                                                                                                                                                                                      Short english payme  Electronics  cameras             1.18     26591.89        0.2554\n2   AAAAAAAAGPGHAAAA                                                                                                                                                                                              Forward nat  Electronics  cameras             2.20     16806.93        0.1614\n3   AAAAAAAAACPNBAAA                                                                                   Debts imagine rather final names. Years relax; services would hear also for the cases. Games achieve large, small winn  Electronics  cameras             1.11     20312.60        0.1951\n4   AAAAAAAAODCOCAAA                                                                                                                                                                                                       Fr  Electronics  cameras             7.74     18883.94        0.1814\n5   AAAAAAAAAOMAAAAA      Competent women must work substantially in a months. Standard, united police will hide at a women. Specialist activities create directly. About beautiful terms can tell at first incidents. More i  Electronics  cameras             2.96     33537.60        0.3222\n6   AAAAAAAANGHMCAAA                                                                                                                                  Areas withstand late thus other economies. Technical, reliable demands   Electronics  cameras            51.89      7257.10        0.0697\n7   AAAAAAAACNFDAAAA                                                                                                                                                                                      Again incredible ri  Electronics  cameras             9.70     28745.75        0.2761\n8   AAAAAAAAMPBOCAAA  Left, splendid tons keep never; more new rights shall conquer for instance. Pleasant, awkward neighbours should emerge negotiations. Components should understand green, natural customers. Upstairs pl  Electronics  cameras            22.16     14447.70        0.1388\n9   AAAAAAAAIPCCBAAA                                                                                                                                                                                        Now independent p  Electronics  cameras             2.33     26822.51        0.2577\n10  AAAAAAAAOEBGAAAA                                                                                                                                            Chemicals vote later major, private windows. Perhaps other po  Electronics  cameras             3.58      8260.66        0.0793\n11  AAAAAAAAHLHGAAAA                                                                                                                                      Observers play. Tasks used to fit profoundly nervous witnesses; pos  Electronics  cameras             0.18     17725.58        0.1703\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.131247,
                    "execution_time": 0.070403,
                    "compile_time": 0.000302,
                    "planning_time": 0.043486
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.142177,
                    "execution_time": 0.069593,
                    "compile_time": 0.000302,
                    "planning_time": 0.055128
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABMJAAAA                                                                                   Usual streets should occur labour plans. Furious, local measures will not lower only good plans. Accurate windows resp  Electronics  cameras             3.74     15301.31        0.1470\n1   AAAAAAAAGIKKBAAA                                                                                                                                                                                      Short english payme  Electronics  cameras             1.18     26591.89        0.2554\n2   AAAAAAAAGPGHAAAA                                                                                                                                                                                              Forward nat  Electronics  cameras             2.20     16806.93        0.1614\n3   AAAAAAAAACPNBAAA                                                                                   Debts imagine rather final names. Years relax; services would hear also for the cases. Games achieve large, small winn  Electronics  cameras             1.11     20312.60        0.1951\n4   AAAAAAAAODCOCAAA                                                                                                                                                                                                       Fr  Electronics  cameras             7.74     18883.94        0.1814\n5   AAAAAAAAAOMAAAAA      Competent women must work substantially in a months. Standard, united police will hide at a women. Specialist activities create directly. About beautiful terms can tell at first incidents. More i  Electronics  cameras             2.96     33537.60        0.3222\n6   AAAAAAAANGHMCAAA                                                                                                                                  Areas withstand late thus other economies. Technical, reliable demands   Electronics  cameras            51.89      7257.10        0.0697\n7   AAAAAAAACNFDAAAA                                                                                                                                                                                      Again incredible ri  Electronics  cameras             9.70     28745.75        0.2761\n8   AAAAAAAAMPBOCAAA  Left, splendid tons keep never; more new rights shall conquer for instance. Pleasant, awkward neighbours should emerge negotiations. Components should understand green, natural customers. Upstairs pl  Electronics  cameras            22.16     14447.70        0.1388\n9   AAAAAAAAIPCCBAAA                                                                                                                                                                                        Now independent p  Electronics  cameras             2.33     26822.51        0.2577\n10  AAAAAAAAOEBGAAAA                                                                                                                                            Chemicals vote later major, private windows. Perhaps other po  Electronics  cameras             3.58      8260.66        0.0793\n11  AAAAAAAAHLHGAAAA                                                                                                                                      Observers play. Tasks used to fit profoundly nervous witnesses; pos  Electronics  cameras             0.18     17725.58        0.1703\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category,\n        i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKMJMAAAA                                                           Months strengthen just like a workers. Private rooms might like most other, obvious risks. Out      Jewelry                     3.98     17681.03        2.9708\n1   AAAAAAAAGHJJAAAA                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAKCBOCAAA                                                                                                                                                               Jewelry                     0.82     34288.07        5.7612\n3   AAAAAAAACIELAAAA                                                                                                                         Lines explain real friends. Grou        Shoes                      NaN     40225.68        6.7589\n4   AAAAAAAAFLPIBAAA  Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will         Shoes                     1.56     26951.88        4.5285\n5   AAAAAAAAGGJFAAAA                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n6   AAAAAAAAFDFCBAAA                                                                                                                                                               Jewelry                     4.09     24802.74        4.1674\n7   AAAAAAAAOAEABAAA                                                                                                                                                                 Shoes                    60.87      9644.38        1.6204\n8   AAAAAAAABHHGBAAA                                                                                                                                                                 Shoes                    25.29     40972.09        6.8843\n9   AAAAAAAAIDMKBAAA                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n10  AAAAAAAAOKPICAAA                                                                                                                                                     Chur      Jewelry                     4.06     14814.00        2.4891\n11  AAAAAAAAMKAADAAA                                                                                                                                                               Jewelry                      NaN     34958.09        5.8738\n12  AAAAAAAAHGCFCAAA                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n13  AAAAAAAANAHDCAAA                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n14  AAAAAAAADBFLCAAA                                                                                                                                                                 Shoes                      NaN     34823.99        5.8513\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.125724,
                    "execution_time": 0.065445,
                    "compile_time": 0.000303,
                    "planning_time": 0.042624
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.129938,
                    "execution_time": 0.068553,
                    "compile_time": 0.000298,
                    "planning_time": 0.043685
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKMJMAAAA                                                           Months strengthen just like a workers. Private rooms might like most other, obvious risks. Out      Jewelry                     3.98     17681.03        2.9708\n1   AAAAAAAAGHJJAAAA                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAKCBOCAAA                                                                                                                                                               Jewelry                     0.82     34288.07        5.7612\n3   AAAAAAAACIELAAAA                                                                                                                         Lines explain real friends. Grou        Shoes                      NaN     40225.68        6.7589\n4   AAAAAAAAFLPIBAAA  Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will         Shoes                     1.56     26951.88        4.5285\n5   AAAAAAAAGGJFAAAA                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n6   AAAAAAAAFDFCBAAA                                                                                                                                                               Jewelry                     4.09     24802.74        4.1674\n7   AAAAAAAAOAEABAAA                                                                                                                                                                 Shoes                    60.87      9644.38        1.6204\n8   AAAAAAAABHHGBAAA                                                                                                                                                                 Shoes                    25.29     40972.09        6.8843\n9   AAAAAAAAIDMKBAAA                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n10  AAAAAAAAOKPICAAA                                                                                                                                                     Chur      Jewelry                     4.06     14814.00        2.4891\n11  AAAAAAAAMKAADAAA                                                                                                                                                               Jewelry                      NaN     34958.09        5.8738\n12  AAAAAAAAHGCFCAAA                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n13  AAAAAAAANAHDCAAA                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n14  AAAAAAAADBFLCAAA                                                                                                                                                                 Shoes                      NaN     34823.99        5.8513\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price \n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADBFLCAAA                                                                                                                                                                 Shoes                      NaN     34823.99        5.8513\n1   AAAAAAAABHHGBAAA                                                                                                                                                                 Shoes                    25.29     40972.09        6.8843\n2   AAAAAAAAOKPICAAA                                                                                                                                                     Chur      Jewelry                     4.06     14814.00        2.4891\n3   AAAAAAAACKKAAAAA                     Ago proposed hours accelerate. Urban stones used to find recent, interested delegates. Eyes rise. Always red leaders shall not put.       Jewelry                     0.46     16565.93        2.7834\n4   AAAAAAAACIELAAAA                                                                                                                         Lines explain real friends. Grou        Shoes                      NaN     40225.68        6.7589\n5   AAAAAAAAOAEABAAA                                                                                                                                                                 Shoes                    60.87      9644.38        1.6204\n6   AAAAAAAAKMJMAAAA                                                           Months strengthen just like a workers. Private rooms might like most other, obvious risks. Out      Jewelry                     3.98     17681.03        2.9708\n7   AAAAAAAAGLLPBAAA                                                                                                                                    Known steps look teac        Shoes                      NaN     13285.02        2.2322\n8   AAAAAAAAGGJFAAAA                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n9   AAAAAAAAMKAADAAA                                                                                                                                                               Jewelry                      NaN     34958.09        5.8738\n10  AAAAAAAAHGCFCAAA                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n11  AAAAAAAAFDFCBAAA                                                                                                                                                               Jewelry                     4.09     24802.74        4.1674\n12  AAAAAAAAIDMKBAAA                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n13  AAAAAAAAILMADAAA                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n14  AAAAAAAAGHJJAAAA                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.127831,
                    "execution_time": 0.066965,
                    "compile_time": 0.000299,
                    "planning_time": 0.04377
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.131847,
                    "execution_time": 0.072121,
                    "compile_time": 0.000295,
                    "planning_time": 0.042461
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADBFLCAAA                                                                                                                                                                 Shoes                      NaN     34823.99        5.8513\n1   AAAAAAAABHHGBAAA                                                                                                                                                                 Shoes                    25.29     40972.09        6.8843\n2   AAAAAAAAOKPICAAA                                                                                                                                                     Chur      Jewelry                     4.06     14814.00        2.4891\n3   AAAAAAAACKKAAAAA                     Ago proposed hours accelerate. Urban stones used to find recent, interested delegates. Eyes rise. Always red leaders shall not put.       Jewelry                     0.46     16565.93        2.7834\n4   AAAAAAAACIELAAAA                                                                                                                         Lines explain real friends. Grou        Shoes                      NaN     40225.68        6.7589\n5   AAAAAAAAOAEABAAA                                                                                                                                                                 Shoes                    60.87      9644.38        1.6204\n6   AAAAAAAAKMJMAAAA                                                           Months strengthen just like a workers. Private rooms might like most other, obvious risks. Out      Jewelry                     3.98     17681.03        2.9708\n7   AAAAAAAAGLLPBAAA                                                                                                                                    Known steps look teac        Shoes                      NaN     13285.02        2.2322\n8   AAAAAAAAGGJFAAAA                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n9   AAAAAAAAMKAADAAA                                                                                                                                                               Jewelry                      NaN     34958.09        5.8738\n10  AAAAAAAAHGCFCAAA                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n11  AAAAAAAAFDFCBAAA                                                                                                                                                               Jewelry                     4.09     24802.74        4.1674\n12  AAAAAAAAIDMKBAAA                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n13  AAAAAAAAILMADAAA                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n14  AAAAAAAAGHJJAAAA                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMKAADAAA                                                                                                                                                                                                         Jewelry                      NaN     34958.09        5.8738\n1   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will         Shoes                     1.56     26951.88        4.5285\n2   AAAAAAAAPCDJCAAA                                                                                                                                                                                                     Electronics                     9.97     23187.61        3.8961\n3   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better        Shoes                      NaN     12581.73        2.1140\n4   AAAAAAAAOKPICAAA                                                                                                                                                                                               Chur      Jewelry                     4.06     14814.00        2.4891\n5   AAAAAAAAKCBOCAAA                                                                                                                                                                                                         Jewelry                     0.82     34288.07        5.7612\n6   AAAAAAAACPCLBAAA                                                                                                                                                                                                           Shoes                      NaN      9907.82        1.6647\n7   AAAAAAAALGHOCAAA                                                                                                                                                                                                         Jewelry                      NaN     11653.21        1.9580\n8   AAAAAAAAJAHLBAAA                                                                                            Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n9   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura        Shoes                     7.02     30481.50        5.1216\n10  AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09     24802.74        4.1674\n11  AAAAAAAAKMJMAAAA                                                                                                     Months strengthen just like a workers. Private rooms might like most other, obvious risks. Out      Jewelry                     3.98     17681.03        2.9708\n12  AAAAAAAAGGJFAAAA                                                                Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.12581,
                    "execution_time": 0.065746,
                    "compile_time": 0.000308,
                    "planning_time": 0.042838
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.124183,
                    "execution_time": 0.065253,
                    "compile_time": 0.000305,
                    "planning_time": 0.041557
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMKAADAAA                                                                                                                                                                                                         Jewelry                      NaN     34958.09        5.8738\n1   AAAAAAAAFLPIBAAA                                            Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will         Shoes                     1.56     26951.88        4.5285\n2   AAAAAAAAPCDJCAAA                                                                                                                                                                                                     Electronics                     9.97     23187.61        3.8961\n3   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better        Shoes                      NaN     12581.73        2.1140\n4   AAAAAAAAOKPICAAA                                                                                                                                                                                               Chur      Jewelry                     4.06     14814.00        2.4891\n5   AAAAAAAAKCBOCAAA                                                                                                                                                                                                         Jewelry                     0.82     34288.07        5.7612\n6   AAAAAAAACPCLBAAA                                                                                                                                                                                                           Shoes                      NaN      9907.82        1.6647\n7   AAAAAAAALGHOCAAA                                                                                                                                                                                                         Jewelry                      NaN     11653.21        1.9580\n8   AAAAAAAAJAHLBAAA                                                                                            Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n9   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura        Shoes                     7.02     30481.50        5.1216\n10  AAAAAAAAFDFCBAAA                                                                                                                                                                                                         Jewelry                     4.09     24802.74        4.1674\n11  AAAAAAAAKMJMAAAA                                                                                                     Months strengthen just like a workers. Private rooms might like most other, obvious risks. Out      Jewelry                     3.98     17681.03        2.9708\n12  AAAAAAAAGGJFAAAA                                                                Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \nrevenueratio /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category          i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAJDMDBAAA                                                                                                                                            Funny, conservative tickets take small humans.        Shoes             kids            22.64        16.77        0.0000\n1   AAAAAAAAELBADAAA                                          More true countries go however sources; together pale figures could conclude at the fires. Large settlements must rest more in a firms. Cautious      Jewelry            rings             4.38         5.78        0.0000\n2   AAAAAAAAOALGBAAA  Particular, free benefits submit. Silver jobs ought to mean against a tickets. Upper minutes award really arms. Candidates offer right carefully disciplinary offences. Also great resul  Electronics      televisions             0.83         6.29        0.0000\n3   AAAAAAAAIPCDBAAA                                                                                                                                                                        Reasons avoid. The        Shoes             kids             2.57        21.42        0.0000\n4   AAAAAAAAIMCBCAAA               Political, various rooms shall support so new police. United levels can introduce insufficient, european studies. Once enormous activities used to claim financially instit  Electronics         wireless             7.46         6.00        0.0000\n5   AAAAAAAAAKLJCAAA                                          Yards strike; pale houses reach established, southern copies. Then coming managers cannot get. Others improve for the time being british, inc st      Jewelry          costume             4.93         0.00        0.0000\n6   AAAAAAAACMJHCAAA                                                                      Reportedly physical changes influence with a groups. Key families help obvious questions; highly vital places establ  Electronics           stereo            68.22         0.00        0.0000\n7   AAAAAAAAENMFAAAA                                                                                                                                  Private, bad symptoms ought to get at least pregnant boo        Shoes         athletic             0.73         0.00        0.0000\n8   AAAAAAAAONJIAAAA                                                                                                                                                                             As full years      Jewelry    semi-precious             2.23         0.00        0.0000\n9   AAAAAAAABJIOCAAA             Black proportions could find neither christian libraries. Clear, new shares might monitor. Documents can wait finally now british players; students mention under way much ea        Shoes             mens            98.80         0.00        0.0000\n10  AAAAAAAAICBJAAAA                                                                                                                                                                                  Refugees        Shoes             kids             4.70        81.36        0.0001\n11  AAAAAAAAENPBCAAA                                                Arms cost words. Then particular supporters round left, natural applications; attractive, political symptoms must announce usually strong         Shoes         athletic            46.54        70.68        0.0001\n12  AAAAAAAAOBEFCAAA                                                                        New, legal words improve now leaves. Commercial, recent interests could not serve too at a sales. Financial, respo        Shoes           womens             0.42        85.40        0.0001\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.409032,
                    "execution_time": 0.318694,
                    "compile_time": 0.060359,
                    "planning_time": 0.044988
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.795811,
                    "execution_time": 0.323222,
                    "compile_time": 6.626333,
                    "planning_time": 0.109974
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category          i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAJDMDBAAA                                                                                                                                            Funny, conservative tickets take small humans.        Shoes             kids            22.64        16.77        0.0000\n1   AAAAAAAAELBADAAA                                          More true countries go however sources; together pale figures could conclude at the fires. Large settlements must rest more in a firms. Cautious      Jewelry            rings             4.38         5.78        0.0000\n2   AAAAAAAAOALGBAAA  Particular, free benefits submit. Silver jobs ought to mean against a tickets. Upper minutes award really arms. Candidates offer right carefully disciplinary offences. Also great resul  Electronics      televisions             0.83         6.29        0.0000\n3   AAAAAAAAIPCDBAAA                                                                                                                                                                        Reasons avoid. The        Shoes             kids             2.57        21.42        0.0000\n4   AAAAAAAAIMCBCAAA               Political, various rooms shall support so new police. United levels can introduce insufficient, european studies. Once enormous activities used to claim financially instit  Electronics         wireless             7.46         6.00        0.0000\n5   AAAAAAAAAKLJCAAA                                          Yards strike; pale houses reach established, southern copies. Then coming managers cannot get. Others improve for the time being british, inc st      Jewelry          costume             4.93         0.00        0.0000\n6   AAAAAAAACMJHCAAA                                                                      Reportedly physical changes influence with a groups. Key families help obvious questions; highly vital places establ  Electronics           stereo            68.22         0.00        0.0000\n7   AAAAAAAAENMFAAAA                                                                                                                                  Private, bad symptoms ought to get at least pregnant boo        Shoes         athletic             0.73         0.00        0.0000\n8   AAAAAAAAONJIAAAA                                                                                                                                                                             As full years      Jewelry    semi-precious             2.23         0.00        0.0000\n9   AAAAAAAABJIOCAAA             Black proportions could find neither christian libraries. Clear, new shares might monitor. Documents can wait finally now british players; students mention under way much ea        Shoes             mens            98.80         0.00        0.0000\n10  AAAAAAAAICBJAAAA                                                                                                                                                                                  Refugees        Shoes             kids             4.70        81.36        0.0001\n11  AAAAAAAAENPBCAAA                                                Arms cost words. Then particular supporters round left, natural applications; attractive, political symptoms must announce usually strong         Shoes         athletic            46.54        70.68        0.0001\n12  AAAAAAAAOBEFCAAA                                                                        New, legal words improve now leaves. Commercial, recent interests could not serve too at a sales. Financial, respo        Shoes           womens             0.42        85.40        0.0001\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                          i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAODCOCAAA                                                                                                                                                                                                   Fr  Electronics     cameras             7.74     18883.94        0.1814\n1   AAAAAAAAEKNEBAAA                                                                                                               Programs provide just independent, right hundreds. Together similar studies should not  Electronics  automotive             4.62     27999.12        0.2674\n2   AAAAAAAAACFPAAAA                                                               Signals can perform most matters. Automatically technical areas wish. Then naval persons can wake years. No longer recent cultures arr  Electronics      karoke             3.88     32001.39        0.2788\n3   AAAAAAAAOEBGAAAA                                                                                                                                        Chemicals vote later major, private windows. Perhaps other po  Electronics     cameras             3.58      8260.66        0.0793\n4   AAAAAAAAKIAABAAA                                                                                                                                                          Much conservative eyes sell; plans accept p  Electronics  automotive             5.79     14068.56        0.1344\n5   AAAAAAAAEMKOBAAA                                                                                                                Months ought to reduce well modern ministers. Defensive beliefs like home financial g  Electronics      karoke             2.96     14747.30        0.1285\n6   AAAAAAAANGHMCAAA                                                                                                                              Areas withstand late thus other economies. Technical, reliable demands   Electronics     cameras            51.89      7257.10        0.0697\n7   AAAAAAAALHKFBAAA                                                                                                                          Children see either large, effective forms. Problems provide with a princip  Electronics  automotive            69.06      7943.30        0.0758\n8   AAAAAAAAAHIIAAAA                                                                                                                                  Countries should move muscles. Forms appreciate totally effective,   Electronics      karoke             1.70      9360.10        0.0815\n9   AAAAAAAACNFDAAAA                                                                                                                                                                                  Again incredible ri  Electronics     cameras             9.70     28745.75        0.2761\n10  AAAAAAAAKCMMBAAA            Public, very pensions could go late never interested processes; average, available processes carry increasingly till a reasons. Desperate prisons die by a savings; light, religious bene  Electronics  automotive             2.34     17518.51        0.1673\n11  AAAAAAAAAKBDAAAA                                                English, fatal days used to suggest with a studies. Legs result groups. Old, easy spaces perform rules. Successive facilities shall not like. Things   Electronics      karoke             6.72     20941.56        0.1825\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.132436,
                    "execution_time": 0.070332,
                    "compile_time": 0.000356,
                    "planning_time": 0.043989
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.249767,
                    "execution_time": 0.065688,
                    "compile_time": 0.08304,
                    "planning_time": 0.113984
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                          i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAODCOCAAA                                                                                                                                                                                                   Fr  Electronics     cameras             7.74     18883.94        0.1814\n1   AAAAAAAAEKNEBAAA                                                                                                               Programs provide just independent, right hundreds. Together similar studies should not  Electronics  automotive             4.62     27999.12        0.2674\n2   AAAAAAAAACFPAAAA                                                               Signals can perform most matters. Automatically technical areas wish. Then naval persons can wake years. No longer recent cultures arr  Electronics      karoke             3.88     32001.39        0.2788\n3   AAAAAAAAOEBGAAAA                                                                                                                                        Chemicals vote later major, private windows. Perhaps other po  Electronics     cameras             3.58      8260.66        0.0793\n4   AAAAAAAAKIAABAAA                                                                                                                                                          Much conservative eyes sell; plans accept p  Electronics  automotive             5.79     14068.56        0.1344\n5   AAAAAAAAEMKOBAAA                                                                                                                Months ought to reduce well modern ministers. Defensive beliefs like home financial g  Electronics      karoke             2.96     14747.30        0.1285\n6   AAAAAAAANGHMCAAA                                                                                                                              Areas withstand late thus other economies. Technical, reliable demands   Electronics     cameras            51.89      7257.10        0.0697\n7   AAAAAAAALHKFBAAA                                                                                                                          Children see either large, effective forms. Problems provide with a princip  Electronics  automotive            69.06      7943.30        0.0758\n8   AAAAAAAAAHIIAAAA                                                                                                                                  Countries should move muscles. Forms appreciate totally effective,   Electronics      karoke             1.70      9360.10        0.0815\n9   AAAAAAAACNFDAAAA                                                                                                                                                                                  Again incredible ri  Electronics     cameras             9.70     28745.75        0.2761\n10  AAAAAAAAKCMMBAAA            Public, very pensions could go late never interested processes; average, available processes carry increasingly till a reasons. Desperate prisons die by a savings; light, religious bene  Electronics  automotive             2.34     17518.51        0.1673\n11  AAAAAAAAAKBDAAAA                                                English, fatal days used to suggest with a studies. Legs result groups. Old, easy spaces perform rules. Successive facilities shall not like. Things   Electronics      karoke             6.72     20941.56        0.1825\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPCDJCAAA                                                                                                                                                                                                     Electronics                     9.97     23187.61        3.8961\n1   AAAAAAAAIDMKBAAA                                                                          Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n2   AAAAAAAAGHJJAAAA                                                                                                                                                                                                     Electronics                      NaN      7705.71        1.2947\n3   AAAAAAAANAHDCAAA                                                                                                                                                           Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n4   AAAAAAAAILMADAAA                                                                                                                                                                                                     Electronics                     2.37      8985.46        1.5097\n5   AAAAAAAAJAHLBAAA                                                                                            Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n6   AAAAAAAAGGJFAAAA                                                                Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n7   AAAAAAAAGOOOCAAA                                                                                                                                                                                                     Electronics                     3.18      7768.97        1.3053\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                                     Electronics                     1.24     13240.32        2.2247\n9   AAAAAAAAHGCFCAAA                                                                                                                                                                                                     Electronics                     3.56     13711.22        2.3038\n10  AAAAAAAACOEBCAAA                                                In order alive fortunes might not like; animals focus appropriate, genuine lips; never united units must not show a little only things. New rights   Electronics   audio            43.93      4247.95        0.0382\n11  AAAAAAAAMPFDAAAA           Ancient, traditional matters will say surprisingly hard years. Clear courses renew. Perhaps industrial statements ought to digest in a alternatives; obviously interesting women introdu  Electronics   audio             3.98     34686.81        0.3122\n12  AAAAAAAAPKDCBAAA                                                         Electric papers achieve members. Even left suggestions should destroy policies. Parliamentary women keep still big, great solutions. Light  Electronics   audio             1.64     10298.69        0.0927\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.129057,
                    "execution_time": 0.06749,
                    "compile_time": 0.000357,
                    "planning_time": 0.044125
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.283109,
                    "execution_time": 0.067539,
                    "compile_time": 0.116193,
                    "planning_time": 0.112357
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPCDJCAAA                                                                                                                                                                                                     Electronics                     9.97     23187.61        3.8961\n1   AAAAAAAAIDMKBAAA                                                                          Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n2   AAAAAAAAGHJJAAAA                                                                                                                                                                                                     Electronics                      NaN      7705.71        1.2947\n3   AAAAAAAANAHDCAAA                                                                                                                                                           Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n4   AAAAAAAAILMADAAA                                                                                                                                                                                                     Electronics                     2.37      8985.46        1.5097\n5   AAAAAAAAJAHLBAAA                                                                                            Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n6   AAAAAAAAGGJFAAAA                                                                Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n7   AAAAAAAAGOOOCAAA                                                                                                                                                                                                     Electronics                     3.18      7768.97        1.3053\n8   AAAAAAAAHPDFBAAA                                                                                                                                                                                                     Electronics                     1.24     13240.32        2.2247\n9   AAAAAAAAHGCFCAAA                                                                                                                                                                                                     Electronics                     3.56     13711.22        2.3038\n10  AAAAAAAACOEBCAAA                                                In order alive fortunes might not like; animals focus appropriate, genuine lips; never united units must not show a little only things. New rights   Electronics   audio            43.93      4247.95        0.0382\n11  AAAAAAAAMPFDAAAA           Ancient, traditional matters will say surprisingly hard years. Clear courses renew. Perhaps industrial statements ought to digest in a alternatives; obviously interesting women introdu  Electronics   audio             3.98     34686.81        0.3122\n12  AAAAAAAAPKDCBAAA                                                         Electric papers achieve members. Even left suggestions should destroy policies. Parliamentary women keep still big, great solutions. Light  Electronics   audio             1.64     10298.69        0.0927\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.132832,
                    "execution_time": 0.069274,
                    "compile_time": 0.000358,
                    "planning_time": 0.045528
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.278075,
                    "execution_time": 0.070375,
                    "compile_time": 0.11196,
                    "planning_time": 0.111325
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.139526,
                    "execution_time": 0.073208,
                    "compile_time": 0.000344,
                    "planning_time": 0.048723
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.251903,
                    "execution_time": 0.070873,
                    "compile_time": 0.086493,
                    "planning_time": 0.111395
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.129972,
                    "execution_time": 0.066793,
                    "compile_time": 0.000341,
                    "planning_time": 0.04472
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.279035,
                    "execution_time": 0.070909,
                    "compile_time": 0.110455,
                    "planning_time": 0.113777
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.136235,
                    "execution_time": 0.072649,
                    "compile_time": 0.000356,
                    "planning_time": 0.045415
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.132779,
                    "execution_time": 0.07054,
                    "compile_time": 0.000354,
                    "planning_time": 0.044063
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                      Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85     31434.53        5.2817\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                           Electronics                      NaN      7705.71        1.2947\n2   AAAAAAAAGOOOCAAA                                                                                                                                                                                           Electronics                     3.18      7768.97        1.3053\n3   AAAAAAAAHGCFCAAA                                                                                                                                                                                           Electronics                     3.56     13711.22        2.3038\n4   AAAAAAAAHPDFBAAA                                                                                                                                                                                           Electronics                     1.24     13240.32        2.2247\n5   AAAAAAAAIDMKBAAA                                                                Regular, major police might not give organizations. Events congratulate others. Sure poor rats include soon partners. Fin  Electronics                     2.70     33543.01        5.6360\n6   AAAAAAAAILMADAAA                                                                                                                                                                                           Electronics                     2.37      8985.46        1.5097\n7   AAAAAAAAJAHLBAAA                                                                                  Though minute members shall perform questions. Much fashionable areas end. Especially capitalist americ  Electronics                      NaN     24461.57        4.1101\n8   AAAAAAAANAHDCAAA                                                                                                                                                 Even organic circumstances see together   Electronics                     1.44     12945.05        2.1750\n9   AAAAAAAAPCDJCAAA                                                                                                                                                                                           Electronics                     9.97     23187.61        3.8961\n10  AAAAAAAAAACGCAAA  Materials unite also girls. Specific, domestic campaigns will lie. Vehicles could not live unique, possible buses. Plans utilise there to the principles. Rough, basic incentives shall  Electronics   audio             3.53     41515.59        0.3737\n11  AAAAAAAAAAEKAAAA                                                                                                              Enormous, separate results would not make for example inc sites. Complex, o  Electronics   audio             4.43      8425.01        0.0758\n12  AAAAAAAAAAJPBAAA        Cars dispose total forces; proud, old seconds alienate individual effects. Clearly dual members return generally fine improvements. Local keys continue. Sure, lucky proposals ca  Electronics   audio             5.04     12586.77        0.1133\n...*/"
    }
]