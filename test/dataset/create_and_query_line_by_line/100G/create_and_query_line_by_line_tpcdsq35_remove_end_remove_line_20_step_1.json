[
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\nfrom\n  customer c, customer_address ca, customer_demographics cd\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk as customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n            select cs_bill_customer_sk as customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n           ) x\n           where customsk = c.c_customer_sk)\ngroup by\n  ca_state, \n  cd_gender, \n  cd_marital_status, \n  cd_dep_count, \n  cd_dep_employed_count, \n  cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.672823,
                    "execution_time": 0.408148,
                    "compile_time": 0.156547,
                    "planning_time": 0.032525,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.450211,
                    "execution_time": 1.881698,
                    "compile_time": 6.389751,
                    "planning_time": 0.095952,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125969,
                    "execution_time": 0.032508,
                    "compile_time": 0.046096,
                    "planning_time": 0.024285,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.287068,
                    "execution_time": 0.03202,
                    "compile_time": 3.142929,
                    "planning_time": 0.085139,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.593442,
                    "execution_time": 0.451011,
                    "compile_time": 0.04038,
                    "planning_time": 0.036171,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.417224,
                    "execution_time": 0.5574,
                    "compile_time": 5.687971,
                    "planning_time": 0.12743,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.508657,
                    "execution_time": 0.405098,
                    "compile_time": 0.029739,
                    "planning_time": 0.003023,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.687505,
                    "execution_time": 0.413036,
                    "compile_time": 3.139586,
                    "planning_time": 0.057941,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.252221,
                    "execution_time": 0.267426,
                    "compile_time": 0.336895,
                    "planning_time": 0.044729,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.762057,
                    "execution_time": 0.672373,
                    "compile_time": 13.352666,
                    "planning_time": 0.116343,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        PA         F                 W             4     7       4       4       4                      1     7        1        1        1                     0     7        0        0        0\n1        OR         F                 S             4     3       4       4       4                      1     3        1        1        1                     0     3        0        0        0\n2        MS         F                 M             4     9       4       4       4                      1     9        1        1        1                     0     9        0        0        0\n3        IA         M                 W             1    12       1       1       1                      3    12        3        3        3                     5    12        5        5        5\n4        TN         M                 W             1     8       1       1       1                      3     8        3        3        3                     5     8        5        5        5\n5        MI         M                 D             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n6        MN         M                 S             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n7        IN         F                 S             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n8        CO         F                 D             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n9        SD         M                 D             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n10       IL         M                 S             2    12       2       2       2                      3    12        3        3        3                     5    12        5        5        5\n11       AK         M                 D             2     6       2       2       2                      3     6        3        3        3                     5     6        5        5        5\n12       LA         M                 W             2     2       2       2       2                      3     2        3        3        3                     5     2        5        5        5\n13       WA         M                 M             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n14       PA         M                 M             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n15       KS         M                 U             2    13       2       2       2                      3    13        3        3        3                     5    13        5        5        5\n16       NH         M                 D             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n17       MS         M                 D             2     8       2       2       2                      1     8        1        1        1                     2     8        2        2        2\n18       VA         M                 W             2     7       2       2       2                      1     7        1        1        1                     2     7        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.052982,
                    "execution_time": 0.008446,
                    "compile_time": 0.031747,
                    "planning_time": 0.005594
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.152378,
                    "execution_time": 0.00909,
                    "compile_time": 3.090215,
                    "planning_time": 0.041668
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        PA         F                 W             4     7       4       4       4                      1     7        1        1        1                     0     7        0        0        0\n1        OR         F                 S             4     3       4       4       4                      1     3        1        1        1                     0     3        0        0        0\n2        MS         F                 M             4     9       4       4       4                      1     9        1        1        1                     0     9        0        0        0\n3        IA         M                 W             1    12       1       1       1                      3    12        3        3        3                     5    12        5        5        5\n4        TN         M                 W             1     8       1       1       1                      3     8        3        3        3                     5     8        5        5        5\n5        MI         M                 D             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n6        MN         M                 S             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n7        IN         F                 S             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n8        CO         F                 D             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n9        SD         M                 D             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n10       IL         M                 S             2    12       2       2       2                      3    12        3        3        3                     5    12        5        5        5\n11       AK         M                 D             2     6       2       2       2                      3     6        3        3        3                     5     6        5        5        5\n12       LA         M                 W             2     2       2       2       2                      3     2        3        3        3                     5     2        5        5        5\n13       WA         M                 M             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n14       PA         M                 M             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n15       KS         M                 U             2    13       2       2       2                      3    13        3        3        3                     5    13        5        5        5\n16       NH         M                 D             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n17       MS         M                 D             2     8       2       2       2                      1     8        1        1        1                     2     8        2        2        2\n18       VA         M                 W             2     7       2       2       2                      1     7        1        1        1                     2     7        2        2        2\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales, date_dim\n            where \n/*CURSOR_IDENTIFIER*/ d_date_sk = cs_sold_date_sk and d_year = 1999 and d_qoy < 4\n)\n) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count \n",
        "optimize": [
            "SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.509261,
                    "execution_time": 0.338914,
                    "compile_time": 0.056023,
                    "planning_time": 0.042109,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.645022,
                    "execution_time": 1.156628,
                    "compile_time": 3.311698,
                    "planning_time": 0.098602,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    customsk\n0    1507950\n1    1507950\n2    1507950\n3    1507950\n4      13583\n5      13583\n6      13583\n7      13583\n8     433592\n9     433592\n10    433592\n11    433592\n12    433592\n13    433592\n14    433592\n15    433592\n16   1075843\n17   1075843\n18   1075843\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015355,
                    "execution_time": 0.007153,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002812
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052664,
                    "execution_time": 0.007964,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.037688
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    customsk\n0    1507950\n1    1507950\n2    1507950\n3    1507950\n4      13583\n5      13583\n6      13583\n7      13583\n8     433592\n9     433592\n10    433592\n11    433592\n12    433592\n13    433592\n14    433592\n15    433592\n16   1075843\n17   1075843\n18   1075843\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.508958,
                    "execution_time": 0.393476,
                    "compile_time": 0.000367,
                    "planning_time": 0.040978,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.582654,
                    "execution_time": 0.409624,
                    "compile_time": 0.000375,
                    "planning_time": 0.097243,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081015,
                    "execution_time": 0.03116,
                    "compile_time": 0.000248,
                    "planning_time": 0.025847,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.226721,
                    "execution_time": 0.033353,
                    "compile_time": 0.083139,
                    "planning_time": 0.085478,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.556237,
                    "execution_time": 0.452862,
                    "compile_time": 0.000448,
                    "planning_time": 0.036641,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.651871,
                    "execution_time": 0.460964,
                    "compile_time": 0.000416,
                    "planning_time": 0.124095,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.38967,
                    "execution_time": 0.314752,
                    "compile_time": 0.000292,
                    "planning_time": 0.003243,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.54095,
                    "execution_time": 0.331797,
                    "compile_time": 0.076123,
                    "planning_time": 0.058938,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.90844,
                    "execution_time": 0.254918,
                    "compile_time": 0.000974,
                    "planning_time": 0.04569,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.62419,
                    "execution_time": 0.857625,
                    "compile_time": 0.040637,
                    "planning_time": 0.116001,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OH         F                 D             3    11       3       3       3                      1    11        1        1        1                     0    11        0        0        0\n1        SD         M                 U             4     8       4       4       4                      1     8        1        1        1                     0     8        0        0        0\n2        KY         F                 W             4    23       4       4       4                      1    23        1        1        1                     0    23        0        0        0\n3        SC         F                 W             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n4        NY         F                 U             4     4       4       4       4                      1     4        1        1        1                     0     4        0        0        0\n5        NC         F                 W             4    10       4       4       4                      1    10        1        1        1                     0    10        0        0        0\n6        AL         M                 M             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n7        WV         M                 W             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n8        MN         F                 U             2    10       2       2       2                      3    10        3        3        3                     5    10        5        5        5\n9        IA         F                 U             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n10       MO         M                 S             2     3       2       2       2                      3     3        3        3        3                     5     3        5        5        5\n11       AL         M                 S             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n12       NC         M                 M             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n13       NJ         M                 S             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n14       TX         M                 W             2    23       2       2       2                      3    23        3        3        3                     5    23        5        5        5\n15       ID         M                 M             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n16       KY         M                 W             2    13       2       2       2                      1    13        1        1        1                     2    13        2        2        2\n17       WA         M                 S             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n18       TN         M                 M             2    13       2       2       2                      1    13        1        1        1                     2    13        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021844,
                    "execution_time": 0.008594,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005876
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.132734,
                    "execution_time": 0.008339,
                    "compile_time": 0.07344,
                    "planning_time": 0.04211
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OH         F                 D             3    11       3       3       3                      1    11        1        1        1                     0    11        0        0        0\n1        SD         M                 U             4     8       4       4       4                      1     8        1        1        1                     0     8        0        0        0\n2        KY         F                 W             4    23       4       4       4                      1    23        1        1        1                     0    23        0        0        0\n3        SC         F                 W             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n4        NY         F                 U             4     4       4       4       4                      1     4        1        1        1                     0     4        0        0        0\n5        NC         F                 W             4    10       4       4       4                      1    10        1        1        1                     0    10        0        0        0\n6        AL         M                 M             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n7        WV         M                 W             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n8        MN         F                 U             2    10       2       2       2                      3    10        3        3        3                     5    10        5        5        5\n9        IA         F                 U             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n10       MO         M                 S             2     3       2       2       2                      3     3        3        3        3                     5     3        5        5        5\n11       AL         M                 S             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n12       NC         M                 M             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n13       NJ         M                 S             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n14       TX         M                 W             2    23       2       2       2                      3    23        3        3        3                     5    23        5        5        5\n15       ID         M                 M             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n16       KY         M                 W             2    13       2       2       2                      1    13        1        1        1                     2    13        2        2        2\n17       WA         M                 S             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n18       TN         M                 M             2    13       2       2       2                      1    13        1        1        1                     2    13        2        2        2\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        MD         M                 W             3     3       3       3       3                      1     3        1        1        1                     0     3        0        0        0\n1        TX         F                 U             3    28       3       3       3                      1    28        1        1        1                     0    28        0        0        0\n2        TX         F                 S             4    27       4       4       4                      1    27        1        1        1                     0    27        0        0        0\n3        OK         F                 M             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n4        MD         M                 U             4     2       4       4       4                      1     2        1        1        1                     0     2        0        0        0\n5        SD         M                 W             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n6        MO         M                 W             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n7        KS         M                 W             2    12       2       2       2                      3    12        3        3        3                     5    12        5        5        5\n8        SD         M                 D             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n9        KS         M                 U             2    13       2       2       2                      3    13        3        3        3                     5    13        5        5        5\n10       WA         M                 M             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n11       IL         M                 W             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n12       KY         F                 M             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n13       KY         M                 D             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n14       TX         F                 U             2    21       2       2       2                      1    21        1        1        1                     2    21        2        2        2\n15       NE         M                 U             2     5       2       2       2                      1     5        1        1        1                     2     5        2        2        2\n16       MI         F                 U             2    14       2       2       2                      1    14        1        1        1                     2    14        2        2        2\n17       MO         F                 D             2     9       2       2       2                      1     9        1        1        1                     2     9        2        2        2\n18       CT         F                 S             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020492,
                    "execution_time": 0.007866,
                    "compile_time": 6e-05,
                    "planning_time": 0.005523
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056418,
                    "execution_time": 0.008756,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.040274
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        MD         M                 W             3     3       3       3       3                      1     3        1        1        1                     0     3        0        0        0\n1        TX         F                 U             3    28       3       3       3                      1    28        1        1        1                     0    28        0        0        0\n2        TX         F                 S             4    27       4       4       4                      1    27        1        1        1                     0    27        0        0        0\n3        OK         F                 M             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n4        MD         M                 U             4     2       4       4       4                      1     2        1        1        1                     0     2        0        0        0\n5        SD         M                 W             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n6        MO         M                 W             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n7        KS         M                 W             2    12       2       2       2                      3    12        3        3        3                     5    12        5        5        5\n8        SD         M                 D             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n9        KS         M                 U             2    13       2       2       2                      3    13        3        3        3                     5    13        5        5        5\n10       WA         M                 M             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n11       IL         M                 W             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n12       KY         F                 M             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n13       KY         M                 D             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n14       TX         F                 U             2    21       2       2       2                      1    21        1        1        1                     2    21        2        2        2\n15       NE         M                 U             2     5       2       2       2                      1     5        1        1        1                     2     5        2        2        2\n16       MI         F                 U             2    14       2       2       2                      1    14        1        1        1                     2    14        2        2        2\n17       MO         F                 D             2     9       2       2       2                      1     9        1        1        1                     2     9        2        2        2\n18       CT         F                 S             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.906603,
                    "execution_time": 0.259031,
                    "compile_time": 0.000913,
                    "planning_time": 0.044465,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.65023,
                    "execution_time": 1.925499,
                    "compile_time": 0.00096,
                    "planning_time": 0.119834,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        KS         F                 S             3    11       3       3       3                      1    11        1        1        1                     0    11        0        0        0\n1        MN         M                 S             3     7       3       3       3                      1     7        1        1        1                     0     7        0        0        0\n2        KY         M                 M             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n3        TX         M                 D             4    22       4       4       4                      1    22        1        1        1                     0    22        0        0        0\n4        WY         F                 D             4     7       4       4       4                      1     7        1        1        1                     0     7        0        0        0\n5        OH         F                 U             4     9       4       4       4                      1     9        1        1        1                     0     9        0        0        0\n6        WI         F                 U             4     8       4       4       4                      1     8        1        1        1                     0     8        0        0        0\n7                   F                 U             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n8        LA         F                 W             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n9        MT         F                 D             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n10       MS         F                 S             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n11       AZ         F                 U             2     2       2       2       2                      3     2        3        3        3                     5     2        5        5        5\n12       GA         M                 M             2    20       2       2       2                      3    20        3        3        3                     5    20        5        5        5\n13       MA         M                 W             2     3       2       2       2                      3     3        3        3        3                     5     3        5        5        5\n14       OK         M                 W             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n15       IL         F                 S             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n16       NC         F                 S             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n17       CO         F                 M             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n18       CA         M                 W             2     5       2       2       2                      3     5        3        3        3                     5     5        5        5        5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021055,
                    "execution_time": 0.007864,
                    "compile_time": 6e-05,
                    "planning_time": 0.005916
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058307,
                    "execution_time": 0.008893,
                    "compile_time": 6e-05,
                    "planning_time": 0.041773
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        KS         F                 S             3    11       3       3       3                      1    11        1        1        1                     0    11        0        0        0\n1        MN         M                 S             3     7       3       3       3                      1     7        1        1        1                     0     7        0        0        0\n2        KY         M                 M             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n3        TX         M                 D             4    22       4       4       4                      1    22        1        1        1                     0    22        0        0        0\n4        WY         F                 D             4     7       4       4       4                      1     7        1        1        1                     0     7        0        0        0\n5        OH         F                 U             4     9       4       4       4                      1     9        1        1        1                     0     9        0        0        0\n6        WI         F                 U             4     8       4       4       4                      1     8        1        1        1                     0     8        0        0        0\n7                   F                 U             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n8        LA         F                 W             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n9        MT         F                 D             4     5       4       4       4                      1     5        1        1        1                     0     5        0        0        0\n10       MS         F                 S             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n11       AZ         F                 U             2     2       2       2       2                      3     2        3        3        3                     5     2        5        5        5\n12       GA         M                 M             2    20       2       2       2                      3    20        3        3        3                     5    20        5        5        5\n13       MA         M                 W             2     3       2       2       2                      3     3        3        3        3                     5     3        5        5        5\n14       OK         M                 W             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n15       IL         F                 S             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n16       NC         F                 S             2     9       2       2       2                      3     9        3        3        3                     5     9        5        5        5\n17       CO         F                 M             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n18       CA         M                 W             2     5       2       2       2                      3     5        3        3        3                     5     5        5        5        5\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca.ca_state,\n  cd.cd_gender,\n  cd.cd_marital_status,\n  cd.cd_dep_count,\n  count(*) cnt1,\n  max(cd.cd_dep_count),\n  min(cd.cd_dep_count),\n  max(cd.cd_dep_count),\n  cd.cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd.cd_dep_employed_count),\n  min(cd.cd_dep_employed_count),\n  max(cd.cd_dep_employed_count),\n  cd.cd_dep_college_count,\n  count(*) cnt3,\n  max(cd.cd_dep_college_count),\n  min(cd.cd_dep_college_count),\n  max(cd.cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws.ws_bill_customer_sk customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n    \t    select cs.cs_ship_customer_sk customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca.ca_state,\n          cd.cd_gender,\n          cd.cd_marital_status,\n          cd.cd_dep_count,\n          cd.cd_dep_employed_count,\n          cd.cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.557739,
                    "execution_time": 0.45599,
                    "compile_time": 0.000404,
                    "planning_time": 0.035343,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.659082,
                    "execution_time": 0.473438,
                    "compile_time": 0.000412,
                    "planning_time": 0.118488,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" GROUP BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.395711,
                    "execution_time": 0.3213,
                    "compile_time": 0.000273,
                    "planning_time": 0.003226,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.460031,
                    "execution_time": 0.327589,
                    "compile_time": 0.000265,
                    "planning_time": 0.060975,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.952839,
                    "execution_time": 0.300395,
                    "compile_time": 0.000948,
                    "planning_time": 0.044807,
                    "create_size": 2688
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.641313,
                    "execution_time": 3.917893,
                    "compile_time": 0.000992,
                    "planning_time": 0.115999,
                    "create_size": 2688
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TX         M                 U             3    22       3       3       3                      1    22        1        1        1                     0    22        0        0        0\n1        NE         F                 S             3     9       3       3       3                      1     9        1        1        1                     0     9        0        0        0\n2                   M                 M             4    10       4       4       4                      1    10        1        1        1                     0    10        0        0        0\n3        NY         F                 U             4     4       4       4       4                      1     4        1        1        1                     0     4        0        0        0\n4        WY         M                 U             4     2       4       4       4                      1     2        1        1        1                     0     2        0        0        0\n5        PA         M                 S             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n6        OK         F                 W             4     9       4       4       4                      1     9        1        1        1                     0     9        0        0        0\n7        ND         F                 W             4     8       4       4       4                      1     8        1        1        1                     0     8        0        0        0\n8        MO         F                 S             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n9        IA         F                 U             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n10       TX         M                 W             2    23       2       2       2                      3    23        3        3        3                     5    23        5        5        5\n11       AL         F                 D             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n12       NC         M                 M             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n13       AL         M                 S             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n14       CT         F                 W             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n15       MO         F                 W             2    15       2       2       2                      3    15        3        3        3                     5    15        5        5        5\n16       CO         M                 D             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n17       OH         M                 S             2    13       2       2       2                      3    13        3        3        3                     5    13        5        5        5\n18                  F                 M             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021605,
                    "execution_time": 0.008131,
                    "compile_time": 6e-05,
                    "planning_time": 0.006064
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057983,
                    "execution_time": 0.008481,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.04205
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TX         M                 U             3    22       3       3       3                      1    22        1        1        1                     0    22        0        0        0\n1        NE         F                 S             3     9       3       3       3                      1     9        1        1        1                     0     9        0        0        0\n2                   M                 M             4    10       4       4       4                      1    10        1        1        1                     0    10        0        0        0\n3        NY         F                 U             4     4       4       4       4                      1     4        1        1        1                     0     4        0        0        0\n4        WY         M                 U             4     2       4       4       4                      1     2        1        1        1                     0     2        0        0        0\n5        PA         M                 S             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n6        OK         F                 W             4     9       4       4       4                      1     9        1        1        1                     0     9        0        0        0\n7        ND         F                 W             4     8       4       4       4                      1     8        1        1        1                     0     8        0        0        0\n8        MO         F                 S             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n9        IA         F                 U             2    14       2       2       2                      3    14        3        3        3                     5    14        5        5        5\n10       TX         M                 W             2    23       2       2       2                      3    23        3        3        3                     5    23        5        5        5\n11       AL         F                 D             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n12       NC         M                 M             2    11       2       2       2                      3    11        3        3        3                     5    11        5        5        5\n13       AL         M                 S             2     4       2       2       2                      3     4        3        3        3                     5     4        5        5        5\n14       CT         F                 W             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n15       MO         F                 W             2    15       2       2       2                      3    15        3        3        3                     5    15        5        5        5\n16       CO         M                 D             2     7       2       2       2                      3     7        3        3        3                     5     7        5        5        5\n17       OH         M                 S             2    13       2       2       2                      3    13        3        3        3                     5    13        5        5        5\n18                  F                 M             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select *\n          from store_sales, date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * \n           from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales, date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales, date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4) x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        IL         F                 W             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n1        VA         M                 D             4    17       4       4       4                      1    17        1        1        1                     0    17        0        0        0\n2                   F                 S             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n3        WA         F                 D             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n4        TX         F                 S             2    22       2       2       2                      3    22        3        3        3                     5    22        5        5        5\n5        NE         M                 U             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n6        TN         M                 M             2    16       2       2       2                      3    16        3        3        3                     5    16        5        5        5\n7        AR         M                 M             2     6       2       2       2                      3     6        3        3        3                     5     6        5        5        5\n8        PA         M                 U             2     5       2       2       2                      3     5        3        3        3                     5     5        5        5        5\n9        OH         F                 M             2    15       2       2       2                      3    15        3        3        3                     5    15        5        5        5\n10       OH         F                 W             2     7       2       2       2                      1     7        1        1        1                     2     7        2        2        2\n11       WA         M                 M             2     7       2       2       2                      1     7        1        1        1                     2     7        2        2        2\n12       AL         F                 U             2     5       2       2       2                      1     5        1        1        1                     2     5        2        2        2\n13                  F                 S             2    12       2       2       2                      1    12        1        1        1                     2    12        2        2        2\n14       IN         F                 S             2    14       2       2       2                      1    14        1        1        1                     2    14        2        2        2\n15       IA         M                 U             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n16       KY         F                 D             2    14       2       2       2                      1    14        1        1        1                     2    14        2        2        2\n17       WV         F                 D             2     4       2       2       2                      1     4        1        1        1                     2     4        2        2        2\n18       VA         F                 U             1    12       1       1       1                      4    12        4        4        4                     4    12        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020121,
                    "execution_time": 0.008011,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005266
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.069626,
                    "execution_time": 0.022138,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.04046
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        IL         F                 W             4    12       4       4       4                      1    12        1        1        1                     0    12        0        0        0\n1        VA         M                 D             4    17       4       4       4                      1    17        1        1        1                     0    17        0        0        0\n2                   F                 S             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n3        WA         F                 D             4     6       4       4       4                      1     6        1        1        1                     0     6        0        0        0\n4        TX         F                 S             2    22       2       2       2                      3    22        3        3        3                     5    22        5        5        5\n5        NE         M                 U             2     8       2       2       2                      3     8        3        3        3                     5     8        5        5        5\n6        TN         M                 M             2    16       2       2       2                      3    16        3        3        3                     5    16        5        5        5\n7        AR         M                 M             2     6       2       2       2                      3     6        3        3        3                     5     6        5        5        5\n8        PA         M                 U             2     5       2       2       2                      3     5        3        3        3                     5     5        5        5        5\n9        OH         F                 M             2    15       2       2       2                      3    15        3        3        3                     5    15        5        5        5\n10       OH         F                 W             2     7       2       2       2                      1     7        1        1        1                     2     7        2        2        2\n11       WA         M                 M             2     7       2       2       2                      1     7        1        1        1                     2     7        2        2        2\n12       AL         F                 U             2     5       2       2       2                      1     5        1        1        1                     2     5        2        2        2\n13                  F                 S             2    12       2       2       2                      1    12        1        1        1                     2    12        2        2        2\n14       IN         F                 S             2    14       2       2       2                      1    14        1        1        1                     2    14        2        2        2\n15       IA         M                 U             2    11       2       2       2                      1    11        1        1        1                     2    11        2        2        2\n16       KY         F                 D             2    14       2       2       2                      1    14        1        1        1                     2    14        2        2        2\n17       WV         F                 D             2     4       2       2       2                      1     4        1        1        1                     2     4        2        2        2\n18       VA         F                 U             1    12       1       1       1                      4    12        4        4        4                     4    12        4        4        4\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        MS         F                 U             6     9       6       6       6                      6     9        6        6        6                     1     9        1        1        1\n1        CA         M                 W             3     5       3       3       3                      2     5        2        2        2                     1     5        1        1        1\n2        AR         M                 U             3     8       3       3       3                      2     8        2        2        2                     1     8        1        1        1\n3                   F                 D             3    11       3       3       3                      2    11        2        2        2                     1    11        1        1        1\n4        TX         M                 W             3    27       3       3       3                      2    27        2        2        2                     1    27        1        1        1\n5        KS         F                 D             3    19       3       3       3                      2    19        2        2        2                     1    19        1        1        1\n6        WI         F                 S             3     4       3       3       3                      6     4        6        6        6                     5     4        5        5        5\n7        CA         F                 U             3     8       3       3       3                      6     8        6        6        6                     5     8        5        5        5\n8        NY         F                 D             3     6       3       3       3                      6     6        6        6        6                     5     6        5        5        5\n9        IN         M                 S             3     9       3       3       3                      6     9        6        6        6                     5     9        5        5        5\n10       WY         F                 D             3     2       3       3       3                      6     2        6        6        6                     5     2        5        5        5\n11       TN         M                 D             3    12       3       3       3                      6    12        6        6        6                     5    12        5        5        5\n12       KS         M                 U             3    10       3       3       3                      6    10        6        6        6                     5    10        5        5        5\n13       KY         F                 M             3    11       3       3       3                      6    11        6        6        6                     5    11        5        5        5\n14       NH         M                 W             4     2       4       4       4                      6     2        6        6        6                     5     2        5        5        5\n15       MI         M                 S             0     8       0       0       0                      5     8        5        5        5                     3     8        3        3        3\n16       IL         F                 D             0     9       0       0       0                      5     9        5        5        5                     3     9        3        3        3\n17       WI         F                 D             0    11       0       0       0                      5    11        5        5        5                     3    11        3        3        3\n18       WA         F                 U             0     2       0       0       0                      5     2        5        5        5                     3     2        3        3        3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02184,
                    "execution_time": 0.009677,
                    "compile_time": 6e-05,
                    "planning_time": 0.005181
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020443,
                    "execution_time": 0.007957,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        MS         F                 U             6     9       6       6       6                      6     9        6        6        6                     1     9        1        1        1\n1        CA         M                 W             3     5       3       3       3                      2     5        2        2        2                     1     5        1        1        1\n2        AR         M                 U             3     8       3       3       3                      2     8        2        2        2                     1     8        1        1        1\n3                   F                 D             3    11       3       3       3                      2    11        2        2        2                     1    11        1        1        1\n4        TX         M                 W             3    27       3       3       3                      2    27        2        2        2                     1    27        1        1        1\n5        KS         F                 D             3    19       3       3       3                      2    19        2        2        2                     1    19        1        1        1\n6        WI         F                 S             3     4       3       3       3                      6     4        6        6        6                     5     4        5        5        5\n7        CA         F                 U             3     8       3       3       3                      6     8        6        6        6                     5     8        5        5        5\n8        NY         F                 D             3     6       3       3       3                      6     6        6        6        6                     5     6        5        5        5\n9        IN         M                 S             3     9       3       3       3                      6     9        6        6        6                     5     9        5        5        5\n10       WY         F                 D             3     2       3       3       3                      6     2        6        6        6                     5     2        5        5        5\n11       TN         M                 D             3    12       3       3       3                      6    12        6        6        6                     5    12        5        5        5\n12       KS         M                 U             3    10       3       3       3                      6    10        6        6        6                     5    10        5        5        5\n13       KY         F                 M             3    11       3       3       3                      6    11        6        6        6                     5    11        5        5        5\n14       NH         M                 W             4     2       4       4       4                      6     2        6        6        6                     5     2        5        5        5\n15       MI         M                 S             0     8       0       0       0                      5     8        5        5        5                     3     8        3        3        3\n16       IL         F                 D             0     9       0       0       0                      5     9        5        5        5                     3     9        3        3        3\n17       WI         F                 D             0    11       0       0       0                      5    11        5        5        5                     3    11        3        3        3\n18       WA         F                 U             0     2       0       0       0                      5     2        5        5        5                     3     2        3        3        3\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             4     6       4       4       4                      3     6        3        3        3                     3     6        3        3        3\n1                   F                 M             5    15       5       5       5                      2    15        2        2        2                     4    15        4        4        4\n2                   M                 W             0    11       0       0       0                      4    11        4        4        4                     6    11        6        6        6\n3                   M                 D             2    10       2       2       2                      5    10        5        5        5                     1    10        1        1        1\n4                   M                 U             5    13       5       5       5                      1    13        1        1        1                     5    13        5        5        5\n5                   F                 M             4    12       4       4       4                      4    12        4        4        4                     2    12        2        2        2\n6                   M                 W             4     6       4       4       4                      0     6        0        0        0                     3     6        3        3        3\n7                   M                 S             3     9       3       3       3                      0     9        0        0        0                     5     9        5        5        5\n8                   F                 S             0     9       0       0       0                      0     9        0        0        0                     0     9        0        0        0\n9                   F                 S             3    14       3       3       3                      5    14        5        5        5                     6    14        6        6        6\n10                  F                 D             3     6       3       3       3                      3     6        3        3        3                     0     6        0        0        0\n11                  F                 U             3     9       3       3       3                      0     9        0        0        0                     5     9        5        5        5\n12                  M                 U             0    13       0       0       0                      0    13        0        0        0                     4    13        4        4        4\n13                  M                 M             3     8       3       3       3                      0     8        0        0        0                     5     8        5        5        5\n14                  M                 D             0    14       0       0       0                      1    14        1        1        1                     4    14        4        4        4\n15                  M                 M             5     3       5       5       5                      3     3        3        3        3                     3     3        3        3        3\n16                  F                 W             2    11       2       2       2                      6    11        6        6        6                     0    11        0        0        0\n17                  M                 D             6    12       6       6       6                      1    12        1        1        1                     0    12        0        0        0\n18                  F                 U             6     6       6       6       6                      0     6        0        0        0                     6     6        6        6        6\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044032,
                    "execution_time": 0.017875,
                    "compile_time": 0.012933,
                    "planning_time": 0.005827
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.905205,
                    "execution_time": 0.76542,
                    "compile_time": 4.848872,
                    "planning_time": 0.04173
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             4     6       4       4       4                      3     6        3        3        3                     3     6        3        3        3\n1                   F                 M             5    15       5       5       5                      2    15        2        2        2                     4    15        4        4        4\n2                   M                 W             0    11       0       0       0                      4    11        4        4        4                     6    11        6        6        6\n3                   M                 D             2    10       2       2       2                      5    10        5        5        5                     1    10        1        1        1\n4                   M                 U             5    13       5       5       5                      1    13        1        1        1                     5    13        5        5        5\n5                   F                 M             4    12       4       4       4                      4    12        4        4        4                     2    12        2        2        2\n6                   M                 W             4     6       4       4       4                      0     6        0        0        0                     3     6        3        3        3\n7                   M                 S             3     9       3       3       3                      0     9        0        0        0                     5     9        5        5        5\n8                   F                 S             0     9       0       0       0                      0     9        0        0        0                     0     9        0        0        0\n9                   F                 S             3    14       3       3       3                      5    14        5        5        5                     6    14        6        6        6\n10                  F                 D             3     6       3       3       3                      3     6        3        3        3                     0     6        0        0        0\n11                  F                 U             3     9       3       3       3                      0     9        0        0        0                     5     9        5        5        5\n12                  M                 U             0    13       0       0       0                      0    13        0        0        0                     4    13        4        4        4\n13                  M                 M             3     8       3       3       3                      0     8        0        0        0                     5     8        5        5        5\n14                  M                 D             0    14       0       0       0                      1    14        1        1        1                     4    14        4        4        4\n15                  M                 M             5     3       5       5       5                      3     3        3        3        3                     3     3        3        3        3\n16                  F                 W             2    11       2       2       2                      6    11        6        6        6                     0    11        0        0        0\n17                  M                 D             6    12       6       6       6                      1    12        1        1        1                     0    12        0        0        0\n18                  F                 U             6     6       6       6       6                      0     6        0        0        0                     6     6        6        6        6\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws.ws_bill_customer_sk customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n    \t    select cs.cs_ship_customer_sk customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n/*CURSOR_IDENTIFIER*/\n          cd_marital_status",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             3    14       3       3       3                      6    14        6        6        6                     6    14        6        6        6\n1                   F                 D             6    16       6       6       6                      4    16        4        4        4                     1    16        1        1        1\n2                   F                 D             1    11       1       1       1                      5    11        5        5        5                     0    11        0        0        0\n3                   F                 D             3     9       3       3       3                      2     9        2        2        2                     0     9        0        0        0\n4                   F                 D             5    14       5       5       5                      6    14        6        6        6                     2    14        2        2        2\n5                   F                 D             3     6       3       3       3                      4     6        4        4        4                     2     6        2        2        2\n6                   F                 D             2    10       2       2       2                      3    10        3        3        3                     4    10        4        4        4\n7                   F                 D             2     8       2       2       2                      4     8        4        4        4                     3     8        3        3        3\n8                   F                 D             4     9       4       4       4                      0     9        0        0        0                     3     9        3        3        3\n9                   F                 D             6     7       6       6       6                      1     7        1        1        1                     4     7        4        4        4\n10                  F                 D             3     9       3       3       3                      3     9        3        3        3                     5     9        5        5        5\n11                  F                 D             3    12       3       3       3                      0    12        0        0        0                     2    12        2        2        2\n12                  F                 D             2    12       2       2       2                      2    12        2        2        2                     0    12        0        0        0\n13                  F                 D             2     9       2       2       2                      5     9        5        5        5                     2     9        2        2        2\n14                  F                 D             2    12       2       2       2                      3    12        3        3        3                     1    12        1        1        1\n15                  F                 D             3    11       3       3       3                      1    11        1        1        1                     3    11        3        3        3\n16                  F                 D             1    13       1       1       1                      3    13        3        3        3                     4    13        4        4        4\n17                  F                 D             4     8       4       4       4                      6     8        6        6        6                     6     8        6        6        6\n18                  F                 D             6     6       6       6       6                      1     6        1        1        1                     5     6        5        5        5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043578,
                    "execution_time": 0.016225,
                    "compile_time": 0.013368,
                    "planning_time": 0.006254
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.991973,
                    "execution_time": 0.017443,
                    "compile_time": 4.92573,
                    "planning_time": 0.04159
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             3    14       3       3       3                      6    14        6        6        6                     6    14        6        6        6\n1                   F                 D             6    16       6       6       6                      4    16        4        4        4                     1    16        1        1        1\n2                   F                 D             1    11       1       1       1                      5    11        5        5        5                     0    11        0        0        0\n3                   F                 D             3     9       3       3       3                      2     9        2        2        2                     0     9        0        0        0\n4                   F                 D             5    14       5       5       5                      6    14        6        6        6                     2    14        2        2        2\n5                   F                 D             3     6       3       3       3                      4     6        4        4        4                     2     6        2        2        2\n6                   F                 D             2    10       2       2       2                      3    10        3        3        3                     4    10        4        4        4\n7                   F                 D             2     8       2       2       2                      4     8        4        4        4                     3     8        3        3        3\n8                   F                 D             4     9       4       4       4                      0     9        0        0        0                     3     9        3        3        3\n9                   F                 D             6     7       6       6       6                      1     7        1        1        1                     4     7        4        4        4\n10                  F                 D             3     9       3       3       3                      3     9        3        3        3                     5     9        5        5        5\n11                  F                 D             3    12       3       3       3                      0    12        0        0        0                     2    12        2        2        2\n12                  F                 D             2    12       2       2       2                      2    12        2        2        2                     0    12        0        0        0\n13                  F                 D             2     9       2       2       2                      5     9        5        5        5                     2     9        2        2        2\n14                  F                 D             2    12       2       2       2                      3    12        3        3        3                     1    12        1        1        1\n15                  F                 D             3    11       3       3       3                      1    11        1        1        1                     3    11        3        3        3\n16                  F                 D             1    13       1       1       1                      3    13        3        3        3                     4    13        4        4        4\n17                  F                 D             4     8       4       4       4                      6     8        6        6        6                     6     8        6        6        6\n18                  F                 D             6     6       6       6       6                      1     6        1        1        1                     5     6        5        5        5\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             5    10       5       5       5                      5    10        5        5        5                     2    10        2        2        2\n1                   F                 D             3     7       3       3       3                      5     7        5        5        5                     2     7        2        2        2\n2                   F                 D             4     4       4       4       4                      4     4        4        4        4                     6     4        6        6        6\n3                   F                 D             3     9       3       3       3                      1     9        1        1        1                     2     9        2        2        2\n4                   F                 D             4     8       4       4       4                      2     8        2        2        2                     0     8        0        0        0\n5                   F                 D             3    10       3       3       3                      6    10        6        6        6                     2    10        2        2        2\n6                   F                 D             4    14       4       4       4                      3    14        3        3        3                     4    14        4        4        4\n7                   F                 D             2    10       2       2       2                      0    10        0        0        0                     0    10        0        0        0\n8                   F                 D             4     9       4       4       4                      3     9        3        3        3                     5     9        5        5        5\n9                   F                 D             1     9       1       1       1                      1     9        1        1        1                     3     9        3        3        3\n10                  F                 D             6     9       6       6       6                      4     9        4        4        4                     5     9        5        5        5\n11                  F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n12                  F                 D             3     5       3       3       3                      1     5        1        1        1                     5     5        5        5        5\n13                  F                 D             4    10       4       4       4                      5    10        5        5        5                     1    10        1        1        1\n14                  F                 D             1    13       1       1       1                      3    13        3        3        3                     4    13        4        4        4\n15                  F                 D             4    13       4       4       4                      2    13        2        2        2                     3    13        3        3        3\n16                  F                 D             6    14       6       6       6                      3    14        3        3        3                     3    14        3        3        3\n17                  F                 D             2     6       2       2       2                      1     6        1        1        1                     6     6        6        6        6\n18                  F                 D             4    12       4       4       4                      4    12        4        4        4                     0    12        0        0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030213,
                    "execution_time": 0.016148,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.00627
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.066112,
                    "execution_time": 0.016335,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.041968
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             5    10       5       5       5                      5    10        5        5        5                     2    10        2        2        2\n1                   F                 D             3     7       3       3       3                      5     7        5        5        5                     2     7        2        2        2\n2                   F                 D             4     4       4       4       4                      4     4        4        4        4                     6     4        6        6        6\n3                   F                 D             3     9       3       3       3                      1     9        1        1        1                     2     9        2        2        2\n4                   F                 D             4     8       4       4       4                      2     8        2        2        2                     0     8        0        0        0\n5                   F                 D             3    10       3       3       3                      6    10        6        6        6                     2    10        2        2        2\n6                   F                 D             4    14       4       4       4                      3    14        3        3        3                     4    14        4        4        4\n7                   F                 D             2    10       2       2       2                      0    10        0        0        0                     0    10        0        0        0\n8                   F                 D             4     9       4       4       4                      3     9        3        3        3                     5     9        5        5        5\n9                   F                 D             1     9       1       1       1                      1     9        1        1        1                     3     9        3        3        3\n10                  F                 D             6     9       6       6       6                      4     9        4        4        4                     5     9        5        5        5\n11                  F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n12                  F                 D             3     5       3       3       3                      1     5        1        1        1                     5     5        5        5        5\n13                  F                 D             4    10       4       4       4                      5    10        5        5        5                     1    10        1        1        1\n14                  F                 D             1    13       1       1       1                      3    13        3        3        3                     4    13        4        4        4\n15                  F                 D             4    13       4       4       4                      2    13        2        2        2                     3    13        3        3        3\n16                  F                 D             6    14       6       6       6                      3    14        3        3        3                     3    14        3        3        3\n17                  F                 D             2     6       2       2       2                      1     6        1        1        1                     6     6        6        6        6\n18                  F                 D             4    12       4       4       4                      4    12        4        4        4                     0    12        0        0        0\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    13       0       0       0                      5    13        5        5        5                     4    13        4        4        4\n1                   F                 D             0     6       0       0       0                      2     6        2        2        2                     1     6        1        1        1\n2                   F                 D             0     4       0       0       0                      0     4        0        0        0                     5     4        5        5        5\n3                   F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n4                   F                 D             0    12       0       0       0                      4    12        4        4        4                     0    12        0        0        0\n5                   F                 D             0    14       0       0       0                      6    14        6        6        6                     3    14        3        3        3\n6                   F                 D             0     7       0       0       0                      3     7        3        3        3                     1     7        1        1        1\n7                   F                 D             0     8       0       0       0                      4     8        4        4        4                     6     8        6        6        6\n8                   F                 D             0     9       0       0       0                      1     9        1        1        1                     5     9        5        5        5\n9                   F                 D             0     5       0       0       0                      1     5        1        1        1                     6     5        6        6        6\n10                  F                 D             0     9       0       0       0                      3     9        3        3        3                     3     9        3        3        3\n11                  F                 D             0     6       0       0       0                      4     6        4        4        4                     5     6        5        5        5\n12                  F                 D             0    13       0       0       0                      2    13        2        2        2                     3    13        3        3        3\n13                  F                 D             0    10       0       0       0                      1    10        1        1        1                     4    10        4        4        4\n14                  F                 D             0    11       0       0       0                      4    11        4        4        4                     3    11        3        3        3\n15                  F                 D             0    12       0       0       0                      1    12        1        1        1                     1    12        1        1        1\n16                  F                 D             0     7       0       0       0                      5     7        5        5        5                     0     7        0        0        0\n17                  F                 D             0     6       0       0       0                      2     6        2        2        2                     6     6        6        6        6\n18                  F                 D             0     4       0       0       0                      6     4        6        6        6                     5     4        5        5        5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.047875,
                    "execution_time": 0.017352,
                    "compile_time": 0.016285,
                    "planning_time": 0.006487
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.671651,
                    "execution_time": 0.017023,
                    "compile_time": 4.616394,
                    "planning_time": 0.041911
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0    13       0       0       0                      5    13        5        5        5                     4    13        4        4        4\n1                   F                 D             0     6       0       0       0                      2     6        2        2        2                     1     6        1        1        1\n2                   F                 D             0     4       0       0       0                      0     4        0        0        0                     5     4        5        5        5\n3                   F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n4                   F                 D             0    12       0       0       0                      4    12        4        4        4                     0    12        0        0        0\n5                   F                 D             0    14       0       0       0                      6    14        6        6        6                     3    14        3        3        3\n6                   F                 D             0     7       0       0       0                      3     7        3        3        3                     1     7        1        1        1\n7                   F                 D             0     8       0       0       0                      4     8        4        4        4                     6     8        6        6        6\n8                   F                 D             0     9       0       0       0                      1     9        1        1        1                     5     9        5        5        5\n9                   F                 D             0     5       0       0       0                      1     5        1        1        1                     6     5        6        6        6\n10                  F                 D             0     9       0       0       0                      3     9        3        3        3                     3     9        3        3        3\n11                  F                 D             0     6       0       0       0                      4     6        4        4        4                     5     6        5        5        5\n12                  F                 D             0    13       0       0       0                      2    13        2        2        2                     3    13        3        3        3\n13                  F                 D             0    10       0       0       0                      1    10        1        1        1                     4    10        4        4        4\n14                  F                 D             0    11       0       0       0                      4    11        4        4        4                     3    11        3        3        3\n15                  F                 D             0    12       0       0       0                      1    12        1        1        1                     1    12        1        1        1\n16                  F                 D             0     7       0       0       0                      5     7        5        5        5                     0     7        0        0        0\n17                  F                 D             0     6       0       0       0                      2     6        2        2        2                     6     6        6        6        6\n18                  F                 D             0     4       0       0       0                      6     4        6        6        6                     5     4        5        5        5\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n1                   F                 D             0     8       0       0       0                      0     8        0        0        0                     1     8        1        1        1\n2                   F                 D             0    11       0       0       0                      0    11        0        0        0                     2    11        2        2        2\n3                   F                 D             0    10       0       0       0                      0    10        0        0        0                     3    10        3        3        3\n4                   F                 D             0    11       0       0       0                      0    11        0        0        0                     4    11        4        4        4\n5                   F                 D             0     4       0       0       0                      0     4        0        0        0                     5     4        5        5        5\n6                   F                 D             0    11       0       0       0                      0    11        0        0        0                     6    11        6        6        6\n7                   F                 D             0     7       0       0       0                      1     7        1        1        1                     0     7        0        0        0\n8                   F                 D             0    12       0       0       0                      1    12        1        1        1                     1    12        1        1        1\n9                   F                 D             0    10       0       0       0                      1    10        1        1        1                     2    10        2        2        2\n10                  F                 D             0     8       0       0       0                      1     8        1        1        1                     3     8        3        3        3\n11                  F                 D             0    10       0       0       0                      1    10        1        1        1                     4    10        4        4        4\n12                  F                 D             0     9       0       0       0                      1     9        1        1        1                     5     9        5        5        5\n13                  F                 D             0     5       0       0       0                      1     5        1        1        1                     6     5        6        6        6\n14                  F                 D             0     5       0       0       0                      2     5        2        2        2                     0     5        0        0        0\n15                  F                 D             0     6       0       0       0                      2     6        2        2        2                     1     6        1        1        1\n16                  F                 D             0    14       0       0       0                      2    14        2        2        2                     2    14        2        2        2\n17                  F                 D             0    13       0       0       0                      2    13        2        2        2                     3    13        3        3        3\n18                  F                 D             0     4       0       0       0                      2     4        2        2        2                     4     4        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04795,
                    "execution_time": 0.017306,
                    "compile_time": 0.016401,
                    "planning_time": 0.00652
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.592331,
                    "execution_time": 0.016527,
                    "compile_time": 4.537335,
                    "planning_time": 0.041996
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n1                   F                 D             0     8       0       0       0                      0     8        0        0        0                     1     8        1        1        1\n2                   F                 D             0    11       0       0       0                      0    11        0        0        0                     2    11        2        2        2\n3                   F                 D             0    10       0       0       0                      0    10        0        0        0                     3    10        3        3        3\n4                   F                 D             0    11       0       0       0                      0    11        0        0        0                     4    11        4        4        4\n5                   F                 D             0     4       0       0       0                      0     4        0        0        0                     5     4        5        5        5\n6                   F                 D             0    11       0       0       0                      0    11        0        0        0                     6    11        6        6        6\n7                   F                 D             0     7       0       0       0                      1     7        1        1        1                     0     7        0        0        0\n8                   F                 D             0    12       0       0       0                      1    12        1        1        1                     1    12        1        1        1\n9                   F                 D             0    10       0       0       0                      1    10        1        1        1                     2    10        2        2        2\n10                  F                 D             0     8       0       0       0                      1     8        1        1        1                     3     8        3        3        3\n11                  F                 D             0    10       0       0       0                      1    10        1        1        1                     4    10        4        4        4\n12                  F                 D             0     9       0       0       0                      1     9        1        1        1                     5     9        5        5        5\n13                  F                 D             0     5       0       0       0                      1     5        1        1        1                     6     5        6        6        6\n14                  F                 D             0     5       0       0       0                      2     5        2        2        2                     0     5        0        0        0\n15                  F                 D             0     6       0       0       0                      2     6        2        2        2                     1     6        1        1        1\n16                  F                 D             0    14       0       0       0                      2    14        2        2        2                     2    14        2        2        2\n17                  F                 D             0    13       0       0       0                      2    13        2        2        2                     3    13        3        3        3\n18                  F                 D             0     4       0       0       0                      2     4        2        2        2                     4     4        4        4        4\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n1                   F                 D             0     8       0       0       0                      0     8        0        0        0                     1     8        1        1        1\n2                   F                 D             0    11       0       0       0                      0    11        0        0        0                     2    11        2        2        2\n3                   F                 D             0    10       0       0       0                      0    10        0        0        0                     3    10        3        3        3\n4                   F                 D             0    11       0       0       0                      0    11        0        0        0                     4    11        4        4        4\n5                   F                 D             0     4       0       0       0                      0     4        0        0        0                     5     4        5        5        5\n6                   F                 D             0    11       0       0       0                      0    11        0        0        0                     6    11        6        6        6\n7                   F                 D             0     7       0       0       0                      1     7        1        1        1                     0     7        0        0        0\n8                   F                 D             0    12       0       0       0                      1    12        1        1        1                     1    12        1        1        1\n9                   F                 D             0    10       0       0       0                      1    10        1        1        1                     2    10        2        2        2\n10                  F                 D             0     8       0       0       0                      1     8        1        1        1                     3     8        3        3        3\n11                  F                 D             0    10       0       0       0                      1    10        1        1        1                     4    10        4        4        4\n12                  F                 D             0     9       0       0       0                      1     9        1        1        1                     5     9        5        5        5\n13                  F                 D             0     5       0       0       0                      1     5        1        1        1                     6     5        6        6        6\n14                  F                 D             0     5       0       0       0                      2     5        2        2        2                     0     5        0        0        0\n15                  F                 D             0     6       0       0       0                      2     6        2        2        2                     1     6        1        1        1\n16                  F                 D             0    14       0       0       0                      2    14        2        2        2                     2    14        2        2        2\n17                  F                 D             0    13       0       0       0                      2    13        2        2        2                     3    13        3        3        3\n18                  F                 D             0     4       0       0       0                      2     4        2        2        2                     4     4        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031532,
                    "execution_time": 0.017022,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.006536
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.031299,
                    "execution_time": 0.016574,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.006616
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     6       0       0       0                      0     6        0        0        0                     0     6        0        0        0\n1                   F                 D             0     8       0       0       0                      0     8        0        0        0                     1     8        1        1        1\n2                   F                 D             0    11       0       0       0                      0    11        0        0        0                     2    11        2        2        2\n3                   F                 D             0    10       0       0       0                      0    10        0        0        0                     3    10        3        3        3\n4                   F                 D             0    11       0       0       0                      0    11        0        0        0                     4    11        4        4        4\n5                   F                 D             0     4       0       0       0                      0     4        0        0        0                     5     4        5        5        5\n6                   F                 D             0    11       0       0       0                      0    11        0        0        0                     6    11        6        6        6\n7                   F                 D             0     7       0       0       0                      1     7        1        1        1                     0     7        0        0        0\n8                   F                 D             0    12       0       0       0                      1    12        1        1        1                     1    12        1        1        1\n9                   F                 D             0    10       0       0       0                      1    10        1        1        1                     2    10        2        2        2\n10                  F                 D             0     8       0       0       0                      1     8        1        1        1                     3     8        3        3        3\n11                  F                 D             0    10       0       0       0                      1    10        1        1        1                     4    10        4        4        4\n12                  F                 D             0     9       0       0       0                      1     9        1        1        1                     5     9        5        5        5\n13                  F                 D             0     5       0       0       0                      1     5        1        1        1                     6     5        6        6        6\n14                  F                 D             0     5       0       0       0                      2     5        2        2        2                     0     5        0        0        0\n15                  F                 D             0     6       0       0       0                      2     6        2        2        2                     1     6        1        1        1\n16                  F                 D             0    14       0       0       0                      2    14        2        2        2                     2    14        2        2        2\n17                  F                 D             0    13       0       0       0                      2    13        2        2        2                     3    13        3        3        3\n18                  F                 D             0     4       0       0       0                      2     4        2        2        2                     4     4        4        4        4\n...*/"
    }
]