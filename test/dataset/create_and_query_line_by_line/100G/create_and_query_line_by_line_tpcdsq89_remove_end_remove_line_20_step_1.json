[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk \ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk\n/*CURSOR_IDENTIFIER*/\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 10.876452,
                    "execution_time": 10.281098,
                    "compile_time": 0.000676,
                    "planning_time": 0.054805,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.225203,
                    "execution_time": 10.549979,
                    "compile_time": 0.005085,
                    "planning_time": 0.123243,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                      stereo                 able        Unknown     11     975.42            2326.68\n1                 disk drives                 able        Unknown     11    1667.25            2326.68\n2                     newborn                 able        Unknown     11    4354.13            2326.68\n3                     science                 able        Unknown     11     727.18            2326.68\n4                     mystery                 able        Unknown      1     354.55            2326.68\n5                   classical                 able        Unknown     12     280.83            2326.68\n6                        arts                 able        Unknown      1     374.63            2326.68\n7                  fragrances                 able        Unknown      3     735.77            2326.68\n8              entertainments                 able        Unknown      2     460.14            2326.68\n9                    portable                 able        Unknown      6     342.48            2326.68\n10                    earings                 able        Unknown      4    1015.89            2326.68\n11                     optics                 able        Unknown      3     125.07            2326.68\n12                    history                 able        Unknown      4    1018.02            2326.68\n13                 camcorders                 able        Unknown      4     474.95            2326.68\n14                    science                 able        Unknown      5     392.35            2326.68\n15                   business                 able        Unknown      7     324.94            2326.68\n16                     womens                 able        Unknown     12    2653.92            2326.68\n17                televisions                 able        Unknown     11    2030.32            2326.68\n18                  bracelets                 able        Unknown     11    2667.91            2326.68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018301,
                    "execution_time": 0.007763,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004052
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056001,
                    "execution_time": 0.008398,
                    "compile_time": 0.001186,
                    "planning_time": 0.039716
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                      stereo                 able        Unknown     11     975.42            2326.68\n1                 disk drives                 able        Unknown     11    1667.25            2326.68\n2                     newborn                 able        Unknown     11    4354.13            2326.68\n3                     science                 able        Unknown     11     727.18            2326.68\n4                     mystery                 able        Unknown      1     354.55            2326.68\n5                   classical                 able        Unknown     12     280.83            2326.68\n6                        arts                 able        Unknown      1     374.63            2326.68\n7                  fragrances                 able        Unknown      3     735.77            2326.68\n8              entertainments                 able        Unknown      2     460.14            2326.68\n9                    portable                 able        Unknown      6     342.48            2326.68\n10                    earings                 able        Unknown      4    1015.89            2326.68\n11                     optics                 able        Unknown      3     125.07            2326.68\n12                    history                 able        Unknown      4    1018.02            2326.68\n13                 camcorders                 able        Unknown      4     474.95            2326.68\n14                    science                 able        Unknown      5     392.35            2326.68\n15                   business                 able        Unknown      7     324.94            2326.68\n16                     womens                 able        Unknown     12    2653.92            2326.68\n17                televisions                 able        Unknown     11    2030.32            2326.68\n18                  bracelets                 able        Unknown     11    2667.91            2326.68\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) \ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.556431,
                    "execution_time": 2.072615,
                    "compile_time": 0.000674,
                    "planning_time": 0.049721,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.670181,
                    "execution_time": 2.111738,
                    "compile_time": 0.003796,
                    "planning_time": 0.126365,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                   maternity                 able        Unknown      3     165.90              619.8\n1                                             able        Unknown      8   18535.88              619.8\n2                        rock                 able        Unknown      2     801.52              619.8\n3                   maternity                 able        Unknown      5     299.90              619.8\n4                      womens                 able        Unknown      5     366.37              619.8\n5                     newborn                 able        Unknown      8    1021.96              619.8\n6                     fitness                 able        Unknown      2     119.04              619.8\n7                    baseball                 able        Unknown      2     218.77              619.8\n8                     newborn                 able        Unknown      3     149.86              619.8\n9                    diamonds                 able        Unknown      3     258.89              619.8\n10                       rugs                 able        Unknown      6      83.90              619.8\n11                    earings                 able        Unknown      8     403.76              619.8\n12                    dresses                 able        Unknown      4     484.97              619.8\n13                        pop                 able        Unknown      4     154.68              619.8\n14                    dresses                 able        Unknown      6     340.66              619.8\n15                   portable                 able        Unknown      5     270.96              619.8\n16                    fitness                 able        Unknown      5     196.29              619.8\n17                   toddlers                 able        Unknown      5     304.37              619.8\n18                    country                 able        Unknown      4     203.12              619.8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018674,
                    "execution_time": 0.008028,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004104
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053904,
                    "execution_time": 0.007734,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039458
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                   maternity                 able        Unknown      3     165.90              619.8\n1                                             able        Unknown      8   18535.88              619.8\n2                        rock                 able        Unknown      2     801.52              619.8\n3                   maternity                 able        Unknown      5     299.90              619.8\n4                      womens                 able        Unknown      5     366.37              619.8\n5                     newborn                 able        Unknown      8    1021.96              619.8\n6                     fitness                 able        Unknown      2     119.04              619.8\n7                    baseball                 able        Unknown      2     218.77              619.8\n8                     newborn                 able        Unknown      3     149.86              619.8\n9                    diamonds                 able        Unknown      3     258.89              619.8\n10                       rugs                 able        Unknown      6      83.90              619.8\n11                    earings                 able        Unknown      8     403.76              619.8\n12                    dresses                 able        Unknown      4     484.97              619.8\n13                        pop                 able        Unknown      4     154.68              619.8\n14                    dresses                 able        Unknown      6     340.66              619.8\n15                   portable                 able        Unknown      5     270.96              619.8\n16                    fitness                 able        Unknown      5     196.29              619.8\n17                   toddlers                 able        Unknown      5     304.37              619.8\n18                    country                 able        Unknown      4     203.12              619.8\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n      i_category in ('Shoes','Men','Music')\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.502983,
                    "execution_time": 0.408009,
                    "compile_time": 0.000605,
                    "planning_time": 0.052404,
                    "create_size": 176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.588602,
                    "execution_time": 0.403002,
                    "compile_time": 0.005808,
                    "planning_time": 0.134654,
                    "create_size": 176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   i_category i_class            i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men   pants  exportiimporto #1         able        Unknown      2  198920.70          183075.51\n1         Men   pants  exportiimporto #1         able        Unknown      5  217786.44          183075.51\n2         Men   pants  exportiimporto #1         able        Unknown     10  492784.54          183075.51\n3         Men   pants  exportiimporto #1         able        Unknown      1  250732.91          183075.51\n4         Men   pants  exportiimporto #1         able        Unknown      3  205465.22          183075.51\n5         Men   pants  exportiimporto #1         able        Unknown      4  208572.95          183075.51\n6         Men          exportiimporto #1         able        Unknown      6     196.45          183075.51\n7         Men          exportiimporto #1         able        Unknown      2     141.56          183075.51\n8         Men          exportiimporto #1         able        Unknown      1      59.09          183075.51\n9         Men   pants  exportiimporto #1         able        Unknown      7  214792.10          183075.51\n10        Men   pants  exportiimporto #1         able        Unknown      8  474136.53          183075.51\n11        Men   pants  exportiimporto #1         able        Unknown      9  472397.38          183075.51\n12        Men          exportiimporto #1         able        Unknown     10     506.25          183075.51\n13        Men          exportiimporto #1         able        Unknown     12     324.37          183075.51\n14        Men   pants  exportiimporto #1         able        Unknown     11  705404.13          183075.51\n15        Men          exportiimporto #1         able        Unknown      5     122.93          183075.51\n16        Men          exportiimporto #1         able        Unknown      4       2.12          183075.51\n17        Men   pants  exportiimporto #1         able        Unknown     12  750409.93          183075.51\n18        Men          exportiimporto #1         able        Unknown      8     292.25          183075.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018676,
                    "execution_time": 0.007573,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004228
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054232,
                    "execution_time": 0.007642,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.039726
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   i_category i_class            i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men   pants  exportiimporto #1         able        Unknown      2  198920.70          183075.51\n1         Men   pants  exportiimporto #1         able        Unknown      5  217786.44          183075.51\n2         Men   pants  exportiimporto #1         able        Unknown     10  492784.54          183075.51\n3         Men   pants  exportiimporto #1         able        Unknown      1  250732.91          183075.51\n4         Men   pants  exportiimporto #1         able        Unknown      3  205465.22          183075.51\n5         Men   pants  exportiimporto #1         able        Unknown      4  208572.95          183075.51\n6         Men          exportiimporto #1         able        Unknown      6     196.45          183075.51\n7         Men          exportiimporto #1         able        Unknown      2     141.56          183075.51\n8         Men          exportiimporto #1         able        Unknown      1      59.09          183075.51\n9         Men   pants  exportiimporto #1         able        Unknown      7  214792.10          183075.51\n10        Men   pants  exportiimporto #1         able        Unknown      8  474136.53          183075.51\n11        Men   pants  exportiimporto #1         able        Unknown      9  472397.38          183075.51\n12        Men          exportiimporto #1         able        Unknown     10     506.25          183075.51\n13        Men          exportiimporto #1         able        Unknown     12     324.37          183075.51\n14        Men   pants  exportiimporto #1         able        Unknown     11  705404.13          183075.51\n15        Men          exportiimporto #1         able        Unknown      5     122.93          183075.51\n16        Men          exportiimporto #1         able        Unknown      4       2.12          183075.51\n17        Men   pants  exportiimporto #1         able        Unknown     12  750409.93          183075.51\n18        Men          exportiimporto #1         able        Unknown      8     292.25          183075.51\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical'))\n          )\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n) /* Added the missing closing parenthesis and GROUP BY clause for the outer select subquery */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.299292,
                    "execution_time": 0.215865,
                    "compile_time": 0.000587,
                    "planning_time": 0.053901,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.377028,
                    "execution_time": 0.212603,
                    "compile_time": 0.002828,
                    "planning_time": 0.131123,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel                              ese                     8     158.60              54.77\n1         Men  sports-apparel                              ese                    11      73.91              54.77\n2         Men  sports-apparel                              ese                     2       2.24              54.77\n3         Men  sports-apparel                              ese                     5      23.90              54.77\n4         Men  sports-apparel                              ese                     4      15.21              54.77\n5         Men  sports-apparel  edu packimporto #1         able        Unknown      7  229790.38          396323.84\n6         Men  sports-apparel  edu packimporto #1         able        Unknown      9  531411.76          396323.84\n7         Men  sports-apparel  edu packimporto #1         able        Unknown      5  233388.58          396323.84\n8         Men  sports-apparel  edu packimporto #1         able        Unknown      3  220197.10          396323.84\n9         Men  sports-apparel  edu packimporto #1         able        Unknown     10  537778.45          396323.84\n10        Men  sports-apparel  edu packimporto #1         able        Unknown      6  227397.46          396323.84\n11        Men  sports-apparel  edu packimporto #1         able        Unknown      8  509996.83          396323.84\n12        Men  sports-apparel  edu packimporto #1         able        Unknown     11  769750.27          396323.84\n13        Men  sports-apparel  edu packimporto #1         able        Unknown     12  799038.99          396323.84\n14        Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n15        Men  sports-apparel  edu packimporto #1         able        Unknown      1  276069.03          396323.84\n16        Men  sports-apparel  edu packimporto #1         able        Unknown      4  217377.01          396323.84\n17        Men  sports-apparel  edu packimporto #2                     Unknown      3    3313.30            6482.28\n18        Men  sports-apparel  edu packimporto #2                     Unknown      5    3345.46            6482.28\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018056,
                    "execution_time": 0.007351,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004114
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054211,
                    "execution_time": 0.007915,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039582
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel                              ese                     8     158.60              54.77\n1         Men  sports-apparel                              ese                    11      73.91              54.77\n2         Men  sports-apparel                              ese                     2       2.24              54.77\n3         Men  sports-apparel                              ese                     5      23.90              54.77\n4         Men  sports-apparel                              ese                     4      15.21              54.77\n5         Men  sports-apparel  edu packimporto #1         able        Unknown      7  229790.38          396323.84\n6         Men  sports-apparel  edu packimporto #1         able        Unknown      9  531411.76          396323.84\n7         Men  sports-apparel  edu packimporto #1         able        Unknown      5  233388.58          396323.84\n8         Men  sports-apparel  edu packimporto #1         able        Unknown      3  220197.10          396323.84\n9         Men  sports-apparel  edu packimporto #1         able        Unknown     10  537778.45          396323.84\n10        Men  sports-apparel  edu packimporto #1         able        Unknown      6  227397.46          396323.84\n11        Men  sports-apparel  edu packimporto #1         able        Unknown      8  509996.83          396323.84\n12        Men  sports-apparel  edu packimporto #1         able        Unknown     11  769750.27          396323.84\n13        Men  sports-apparel  edu packimporto #1         able        Unknown     12  799038.99          396323.84\n14        Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n15        Men  sports-apparel  edu packimporto #1         able        Unknown      1  276069.03          396323.84\n16        Men  sports-apparel  edu packimporto #1         able        Unknown      4  217377.01          396323.84\n17        Men  sports-apparel  edu packimporto #2                     Unknown      3    3313.30            6482.28\n18        Men  sports-apparel  edu packimporto #2                     Unknown      5    3345.46            6482.28\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n) /* Added closing parenthesis for the inner subquery */\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n\n) /* Removed redundant parentheses and fixed grouping position */\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category    i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Music  classical  edu packscholar #1          ese                    10   20849.20           14306.31\n1       Music  classical  edu packscholar #1         n st        Unknown     10  246839.87          186362.43\n2       Music  classical  edu packscholar #1         n st        Unknown      2   96563.79          186362.43\n3       Music  classical  edu packscholar #1         n st        Unknown     12  379349.62          186362.43\n4       Music  classical  edu packscholar #1         n st        Unknown      6  104485.19          186362.43\n5       Music  classical  edu packscholar #1         n st        Unknown     11  362459.05          186362.43\n6       Music  classical  edu packscholar #1         n st        Unknown      5  105197.04          186362.43\n7       Music  classical  edu packscholar #1         n st        Unknown      1  134400.71          186362.43\n8       Music  classical  edu packscholar #1         n st        Unknown      3  109416.58          186362.43\n9       Music  classical  edu packscholar #1         n st        Unknown      4  108458.85          186362.43\n10      Music  classical  edu packscholar #1         n st        Unknown      7  112923.72          186362.43\n11      Music  classical  edu packscholar #1         n st        Unknown      8  239172.40          186362.43\n12      Music  classical  edu packscholar #1         n st        Unknown      9  237082.45          186362.43\n13      Music  classical  edu packscholar #2         anti        Unknown      7   55328.08           96431.53\n14      Music  classical  edu packscholar #2         anti        Unknown      9  124397.97           96431.53\n15      Music  classical  edu packscholar #2         anti        Unknown      2   53495.26           96431.53\n16      Music  classical  edu packscholar #2         anti        Unknown     12  197083.86           96431.53\n17      Music  classical  edu packscholar #2         anti        Unknown      6   56978.02           96431.53\n18      Music  classical  edu packscholar #2         anti        Unknown     10  127107.81           96431.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017844,
                    "execution_time": 0.007262,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004122
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01792,
                    "execution_time": 0.007293,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004149
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category    i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Music  classical  edu packscholar #1          ese                    10   20849.20           14306.31\n1       Music  classical  edu packscholar #1         n st        Unknown     10  246839.87          186362.43\n2       Music  classical  edu packscholar #1         n st        Unknown      2   96563.79          186362.43\n3       Music  classical  edu packscholar #1         n st        Unknown     12  379349.62          186362.43\n4       Music  classical  edu packscholar #1         n st        Unknown      6  104485.19          186362.43\n5       Music  classical  edu packscholar #1         n st        Unknown     11  362459.05          186362.43\n6       Music  classical  edu packscholar #1         n st        Unknown      5  105197.04          186362.43\n7       Music  classical  edu packscholar #1         n st        Unknown      1  134400.71          186362.43\n8       Music  classical  edu packscholar #1         n st        Unknown      3  109416.58          186362.43\n9       Music  classical  edu packscholar #1         n st        Unknown      4  108458.85          186362.43\n10      Music  classical  edu packscholar #1         n st        Unknown      7  112923.72          186362.43\n11      Music  classical  edu packscholar #1         n st        Unknown      8  239172.40          186362.43\n12      Music  classical  edu packscholar #1         n st        Unknown      9  237082.45          186362.43\n13      Music  classical  edu packscholar #2         anti        Unknown      7   55328.08           96431.53\n14      Music  classical  edu packscholar #2         anti        Unknown      9  124397.97           96431.53\n15      Music  classical  edu packscholar #2         anti        Unknown      2   53495.26           96431.53\n16      Music  classical  edu packscholar #2         anti        Unknown     12  197083.86           96431.53\n17      Music  classical  edu packscholar #2         anti        Unknown      6   56978.02           96431.53\n18      Music  classical  edu packscholar #2         anti        Unknown     10  127107.81           96431.53\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\ns_store_name, s_company_name, d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\n/*CURSOR_IDENTIFIER*/\ngroup by i_category, i_class, i_brand,\ns_store_name, s_company_name, d_moy\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.041973,
                    "execution_time": 0.810078,
                    "compile_time": 0.000653,
                    "planning_time": 0.053872,
                    "create_size": 924
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.088123,
                    "execution_time": 0.774907,
                    "compile_time": 0.002802,
                    "planning_time": 0.132902,
                    "create_size": 924
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category      i_class              i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics                                            ese                     7      31.25              69.00\n1   Electronics     scanners                               ese                     7      25.84              69.00\n2   Electronics      musical                               ese                    11      96.19              69.00\n3   Electronics                                            ese                     8      17.28              69.00\n4   Electronics                                            ese                    12      97.35              69.00\n5   Electronics                                            ese                     6      17.38              69.00\n6   Electronics  disk drives  amalgamalgamalg #10          ese                     1     155.39             161.74\n7   Electronics  disk drives  amalgamalgamalg #10          ese                     2     276.51             161.74\n8   Electronics  disk drives  amalgamalgamalg #10          ese                    11     621.75             161.74\n9   Electronics               amalgamalgamalg #10          ese                    10      19.77             161.74\n10  Electronics  disk drives  amalgamalgamalg #10          ese                    10     138.89             161.74\n11  Electronics  disk drives  amalgamalgamalg #10          ese                     8     307.72             161.74\n12  Electronics  disk drives  amalgamalgamalg #10          ese                     4      26.32             161.74\n13  Electronics  disk drives  amalgamalgamalg #10          ese                    12     188.73             161.74\n14  Electronics  disk drives  amalgamalgamalg #10          ese                     3     190.26             161.74\n15  Electronics  disk drives  amalgamalgamalg #10          ese                     5     119.42             161.74\n16  Electronics  disk drives  amalgamalgamalg #10          ese                     6     102.32             161.74\n17  Electronics  disk drives  amalgamalgamalg #10          ese                     9     126.41             161.74\n18  Electronics  disk drives  amalgamalgamalg #10          ese                     7     117.80             161.74\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018777,
                    "execution_time": 0.008102,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004193
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054095,
                    "execution_time": 0.007762,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039596
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category      i_class              i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics                                            ese                     7      31.25              69.00\n1   Electronics     scanners                               ese                     7      25.84              69.00\n2   Electronics      musical                               ese                    11      96.19              69.00\n3   Electronics                                            ese                     8      17.28              69.00\n4   Electronics                                            ese                    12      97.35              69.00\n5   Electronics                                            ese                     6      17.38              69.00\n6   Electronics  disk drives  amalgamalgamalg #10          ese                     1     155.39             161.74\n7   Electronics  disk drives  amalgamalgamalg #10          ese                     2     276.51             161.74\n8   Electronics  disk drives  amalgamalgamalg #10          ese                    11     621.75             161.74\n9   Electronics               amalgamalgamalg #10          ese                    10      19.77             161.74\n10  Electronics  disk drives  amalgamalgamalg #10          ese                    10     138.89             161.74\n11  Electronics  disk drives  amalgamalgamalg #10          ese                     8     307.72             161.74\n12  Electronics  disk drives  amalgamalgamalg #10          ese                     4      26.32             161.74\n13  Electronics  disk drives  amalgamalgamalg #10          ese                    12     188.73             161.74\n14  Electronics  disk drives  amalgamalgamalg #10          ese                     3     190.26             161.74\n15  Electronics  disk drives  amalgamalgamalg #10          ese                     5     119.42             161.74\n16  Electronics  disk drives  amalgamalgamalg #10          ese                     6     102.32             161.74\n17  Electronics  disk drives  amalgamalgamalg #10          ese                     9     126.41             161.74\n18  Electronics  disk drives  amalgamalgamalg #10          ese                     7     117.80             161.74\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  televisions                  bar        Unknown      2      88.95             548.48\n1   Electronics                               bar        Unknown      1    1483.59             548.48\n2   Electronics                               bar        Unknown      3     849.58             548.48\n3   Electronics     scanners                  bar        Unknown      3     343.20             548.48\n4   Electronics                               bar        Unknown      4     989.51             548.48\n5   Electronics  televisions                  bar        Unknown      5     114.63             548.48\n6   Electronics                               bar        Unknown      2    1316.52             548.48\n7   Electronics      musical                  bar        Unknown      1     243.83             548.48\n8   Electronics                               bar        Unknown      6     444.45             548.48\n9   Electronics  televisions                  bar        Unknown      7     244.55             548.48\n10  Electronics                               bar        Unknown      5     783.78             548.48\n11  Electronics                               bar        Unknown      8    1948.28             548.48\n12  Electronics      musical                  bar        Unknown      9     617.30             548.48\n13  Electronics     scanners                  bar        Unknown      7     124.97             548.48\n14  Electronics                               bar        Unknown     10    2159.13             548.48\n15  Electronics      musical                  bar        Unknown      8     332.74             548.48\n16  Electronics     scanners                  bar        Unknown      6      65.90             548.48\n17  Electronics     scanners                  bar        Unknown     10     222.46             548.48\n18  Electronics                               bar        Unknown     11    3038.83             548.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017637,
                    "execution_time": 0.007284,
                    "compile_time": 5e-05,
                    "planning_time": 0.003993
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018838,
                    "execution_time": 0.007725,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004338
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  televisions                  bar        Unknown      2      88.95             548.48\n1   Electronics                               bar        Unknown      1    1483.59             548.48\n2   Electronics                               bar        Unknown      3     849.58             548.48\n3   Electronics     scanners                  bar        Unknown      3     343.20             548.48\n4   Electronics                               bar        Unknown      4     989.51             548.48\n5   Electronics  televisions                  bar        Unknown      5     114.63             548.48\n6   Electronics                               bar        Unknown      2    1316.52             548.48\n7   Electronics      musical                  bar        Unknown      1     243.83             548.48\n8   Electronics                               bar        Unknown      6     444.45             548.48\n9   Electronics  televisions                  bar        Unknown      7     244.55             548.48\n10  Electronics                               bar        Unknown      5     783.78             548.48\n11  Electronics                               bar        Unknown      8    1948.28             548.48\n12  Electronics      musical                  bar        Unknown      9     617.30             548.48\n13  Electronics     scanners                  bar        Unknown      7     124.97             548.48\n14  Electronics                               bar        Unknown     10    2159.13             548.48\n15  Electronics      musical                  bar        Unknown      8     332.74             548.48\n16  Electronics     scanners                  bar        Unknown      6      65.90             548.48\n17  Electronics     scanners                  bar        Unknown     10     222.46             548.48\n18  Electronics                               bar        Unknown     11    3038.83             548.48\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics      musical                 able        Unknown      1     114.25             569.22\n1   Electronics     scanners                 able        Unknown      1      58.16             569.22\n2   Electronics                              able        Unknown      2     660.68             569.22\n3   Electronics                              able        Unknown      3    1141.71             569.22\n4   Electronics  televisions                 able        Unknown      3      16.29             569.22\n5   Electronics                              able        Unknown      1    1246.36             569.22\n6   Electronics     scanners                 able        Unknown      2     162.87             569.22\n7   Electronics  televisions                 able        Unknown      1     290.85             569.22\n8   Electronics                              able        Unknown      4     484.50             569.22\n9   Electronics                              able        Unknown      5     634.74             569.22\n10  Electronics  televisions                 able        Unknown      6     130.57             569.22\n11  Electronics     scanners                 able        Unknown      6      44.87             569.22\n12  Electronics      musical                 able        Unknown      4      94.63             569.22\n13  Electronics     scanners                 able        Unknown      7     246.41             569.22\n14  Electronics                              able        Unknown      7    1321.28             569.22\n15  Electronics      musical                 able        Unknown      8     442.35             569.22\n16  Electronics      musical                 able        Unknown      9     346.30             569.22\n17  Electronics     scanners                 able        Unknown     11     515.31             569.22\n18  Electronics      musical                 able        Unknown      3     162.78             569.22\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018119,
                    "execution_time": 0.007402,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004214
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01923,
                    "execution_time": 0.008194,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004293
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics      musical                 able        Unknown      1     114.25             569.22\n1   Electronics     scanners                 able        Unknown      1      58.16             569.22\n2   Electronics                              able        Unknown      2     660.68             569.22\n3   Electronics                              able        Unknown      3    1141.71             569.22\n4   Electronics  televisions                 able        Unknown      3      16.29             569.22\n5   Electronics                              able        Unknown      1    1246.36             569.22\n6   Electronics     scanners                 able        Unknown      2     162.87             569.22\n7   Electronics  televisions                 able        Unknown      1     290.85             569.22\n8   Electronics                              able        Unknown      4     484.50             569.22\n9   Electronics                              able        Unknown      5     634.74             569.22\n10  Electronics  televisions                 able        Unknown      6     130.57             569.22\n11  Electronics     scanners                 able        Unknown      6      44.87             569.22\n12  Electronics      musical                 able        Unknown      4      94.63             569.22\n13  Electronics     scanners                 able        Unknown      7     246.41             569.22\n14  Electronics                              able        Unknown      7    1321.28             569.22\n15  Electronics      musical                 able        Unknown      8     442.35             569.22\n16  Electronics      musical                 able        Unknown      9     346.30             569.22\n17  Electronics     scanners                 able        Unknown     11     515.31             569.22\n18  Electronics      musical                 able        Unknown      3     162.78             569.22\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.249864,
                    "execution_time": 0.068128,
                    "compile_time": 0.000276,
                    "planning_time": 0.006036,
                    "create_size": 880
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.309486,
                    "execution_time": 0.067964,
                    "compile_time": 0.001369,
                    "planning_time": 0.064032,
                    "create_size": 913
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*     i_category     i_class               i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics    monitors  importoamalgamalg #8         n st        Unknown      3    1950.63            3708.87\n1   Electronics    monitors  importoamalgamalg #8         n st        Unknown      4    1945.61            3708.87\n2   Electronics    monitors  importoamalgamalg #8         n st        Unknown      5    2639.35            3708.87\n3   Electronics    monitors  importoamalgamalg #8         n st        Unknown      7    2021.05            3708.87\n4   Electronics    monitors  importoamalgamalg #8         n st        Unknown      6    2208.82            3708.87\n5   Electronics    monitors  importoamalgamalg #8         n st        Unknown      9    5351.98            3708.87\n6   Electronics    monitors  importoamalgamalg #8         n st        Unknown     12    7471.56            3708.87\n7   Electronics    monitors  importoamalgamalg #8         n st        Unknown     11    5803.01            3708.87\n8   Electronics    monitors  importoamalgamalg #8         n st        Unknown      8    5766.36            3708.87\n9   Electronics    monitors  importoamalgamalg #8         n st        Unknown     10    5451.22            3708.87\n10  Electronics    monitors  importoamalgamalg #9          bar        Unknown      1    5722.54            7391.80\n11  Electronics    monitors  importoamalgamalg #9          bar        Unknown      2    3910.38            7391.80\n12  Electronics    monitors  importoamalgamalg #9          bar        Unknown      3    3871.51            7391.80\n13  Electronics  camcorders   importounivamalg #8          pri        Unknown      4    2269.74            3680.91\n14  Electronics  camcorders   importounivamalg #8          pri        Unknown      6    2066.41            3680.91\n15  Electronics  camcorders   importounivamalg #8          pri        Unknown      3    2114.49            3680.91\n16  Electronics  camcorders   importounivamalg #8          pri        Unknown      8    5027.79            3680.91\n17  Electronics  camcorders   importounivamalg #8          pri        Unknown      9    5507.43            3680.91\n18  Electronics  camcorders   importounivamalg #8          pri        Unknown     11    7840.75            3680.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018436,
                    "execution_time": 0.007429,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004268
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054242,
                    "execution_time": 0.007897,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.039654
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*     i_category     i_class               i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics    monitors  importoamalgamalg #8         n st        Unknown      3    1950.63            3708.87\n1   Electronics    monitors  importoamalgamalg #8         n st        Unknown      4    1945.61            3708.87\n2   Electronics    monitors  importoamalgamalg #8         n st        Unknown      5    2639.35            3708.87\n3   Electronics    monitors  importoamalgamalg #8         n st        Unknown      7    2021.05            3708.87\n4   Electronics    monitors  importoamalgamalg #8         n st        Unknown      6    2208.82            3708.87\n5   Electronics    monitors  importoamalgamalg #8         n st        Unknown      9    5351.98            3708.87\n6   Electronics    monitors  importoamalgamalg #8         n st        Unknown     12    7471.56            3708.87\n7   Electronics    monitors  importoamalgamalg #8         n st        Unknown     11    5803.01            3708.87\n8   Electronics    monitors  importoamalgamalg #8         n st        Unknown      8    5766.36            3708.87\n9   Electronics    monitors  importoamalgamalg #8         n st        Unknown     10    5451.22            3708.87\n10  Electronics    monitors  importoamalgamalg #9          bar        Unknown      1    5722.54            7391.80\n11  Electronics    monitors  importoamalgamalg #9          bar        Unknown      2    3910.38            7391.80\n12  Electronics    monitors  importoamalgamalg #9          bar        Unknown      3    3871.51            7391.80\n13  Electronics  camcorders   importounivamalg #8          pri        Unknown      4    2269.74            3680.91\n14  Electronics  camcorders   importounivamalg #8          pri        Unknown      6    2066.41            3680.91\n15  Electronics  camcorders   importounivamalg #8          pri        Unknown      3    2114.49            3680.91\n16  Electronics  camcorders   importounivamalg #8          pri        Unknown      8    5027.79            3680.91\n17  Electronics  camcorders   importounivamalg #8          pri        Unknown      9    5507.43            3680.91\n18  Electronics  camcorders   importounivamalg #8          pri        Unknown     11    7840.75            3680.91\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"S_STORE_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.247363,
                    "execution_time": 0.065965,
                    "compile_time": 0.000265,
                    "planning_time": 0.00391,
                    "create_size": 946
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.43859,
                    "execution_time": 0.066981,
                    "compile_time": 0.133755,
                    "planning_time": 0.058841,
                    "create_size": 935
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.244562,
                    "execution_time": 0.06318,
                    "compile_time": 0.000268,
                    "planning_time": 0.00598,
                    "create_size": 913
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.307161,
                    "execution_time": 0.070001,
                    "compile_time": 0.000274,
                    "planning_time": 0.061074,
                    "create_size": 913
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n1       Women                     exportiamalg #1         able        Unknown      5     201.34          189661.36\n2       Women                     exportiamalg #1         able        Unknown      4     227.70          189661.36\n3       Women                     exportiamalg #1         eing        Unknown      4      42.01          189393.93\n4       Women                     exportiamalg #1         able        Unknown      1     336.91          189661.36\n5       Women                     exportiamalg #1         able        Unknown      2     390.05          189661.36\n6       Women                     exportiamalg #1         able        Unknown      9     396.43          189661.36\n7       Women                     exportiamalg #1         eing        Unknown      5     146.87          189393.93\n8       Women                     exportiamalg #1         eing        Unknown      6     156.57          189393.93\n9       Women                     exportiamalg #1         able        Unknown      7     445.91          189661.36\n10      Women                     exportiamalg #1         eing        Unknown      7     212.95          189393.93\n11      Women                     exportiamalg #1         eing        Unknown      3     219.48          189393.93\n12      Women                     exportiamalg #1         able        Unknown      6     513.34          189661.36\n13      Women                     exportiamalg #1         eing        Unknown      2     249.75          189393.93\n14      Women                     exportiamalg #1         able        Unknown      3     543.87          189661.36\n15      Women                     exportiamalg #1         able        Unknown     10     632.28          189661.36\n16      Women                     exportiamalg #1         able        Unknown      8     643.73          189661.36\n17      Women                     exportiamalg #1          bar        Unknown      4     124.02          189129.91\n18      Women                     exportiamalg #1          bar        Unknown      7     133.35          189129.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044238,
                    "execution_time": 0.015028,
                    "compile_time": 0.01521,
                    "planning_time": 0.006477
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.592332,
                    "execution_time": 0.015361,
                    "compile_time": 5.535959,
                    "planning_time": 0.041736
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n1       Women                     exportiamalg #1         able        Unknown      5     201.34          189661.36\n2       Women                     exportiamalg #1         able        Unknown      4     227.70          189661.36\n3       Women                     exportiamalg #1         eing        Unknown      4      42.01          189393.93\n4       Women                     exportiamalg #1         able        Unknown      1     336.91          189661.36\n5       Women                     exportiamalg #1         able        Unknown      2     390.05          189661.36\n6       Women                     exportiamalg #1         able        Unknown      9     396.43          189661.36\n7       Women                     exportiamalg #1         eing        Unknown      5     146.87          189393.93\n8       Women                     exportiamalg #1         eing        Unknown      6     156.57          189393.93\n9       Women                     exportiamalg #1         able        Unknown      7     445.91          189661.36\n10      Women                     exportiamalg #1         eing        Unknown      7     212.95          189393.93\n11      Women                     exportiamalg #1         eing        Unknown      3     219.48          189393.93\n12      Women                     exportiamalg #1         able        Unknown      6     513.34          189661.36\n13      Women                     exportiamalg #1         eing        Unknown      2     249.75          189393.93\n14      Women                     exportiamalg #1         able        Unknown      3     543.87          189661.36\n15      Women                     exportiamalg #1         able        Unknown     10     632.28          189661.36\n16      Women                     exportiamalg #1         able        Unknown      8     643.73          189661.36\n17      Women                     exportiamalg #1          bar        Unknown      4     124.02          189129.91\n18      Women                     exportiamalg #1          bar        Unknown      7     133.35          189129.91\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n1       Women                     exportiamalg #1         able        Unknown      5     201.34          189661.36\n2       Women                     exportiamalg #1         able        Unknown      4     227.70          189661.36\n3       Women                     exportiamalg #1         eing        Unknown      4      42.01          189393.93\n4       Women                     exportiamalg #1         able        Unknown      1     336.91          189661.36\n5       Women                     exportiamalg #1         able        Unknown      2     390.05          189661.36\n6       Women                     exportiamalg #1         able        Unknown      9     396.43          189661.36\n7       Women                     exportiamalg #1         eing        Unknown      5     146.87          189393.93\n8       Women                     exportiamalg #1         eing        Unknown      6     156.57          189393.93\n9       Women                     exportiamalg #1         able        Unknown      7     445.91          189661.36\n10      Women                     exportiamalg #1         eing        Unknown      7     212.95          189393.93\n11      Women                     exportiamalg #1         eing        Unknown      3     219.48          189393.93\n12      Women                     exportiamalg #1         able        Unknown      6     513.34          189661.36\n13      Women                     exportiamalg #1         eing        Unknown      2     249.75          189393.93\n14      Women                     exportiamalg #1         able        Unknown      3     543.87          189661.36\n15      Women                     exportiamalg #1         able        Unknown     10     632.28          189661.36\n16      Women                     exportiamalg #1         able        Unknown      8     643.73          189661.36\n17      Women                     exportiamalg #1          bar        Unknown      4     124.02          189129.91\n18      Women                     exportiamalg #1          bar        Unknown      7     133.35          189129.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.028854,
                    "execution_time": 0.014617,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.006507
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.029952,
                    "execution_time": 0.015204,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006545
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n1       Women                     exportiamalg #1         able        Unknown      5     201.34          189661.36\n2       Women                     exportiamalg #1         able        Unknown      4     227.70          189661.36\n3       Women                     exportiamalg #1         eing        Unknown      4      42.01          189393.93\n4       Women                     exportiamalg #1         able        Unknown      1     336.91          189661.36\n5       Women                     exportiamalg #1         able        Unknown      2     390.05          189661.36\n6       Women                     exportiamalg #1         able        Unknown      9     396.43          189661.36\n7       Women                     exportiamalg #1         eing        Unknown      5     146.87          189393.93\n8       Women                     exportiamalg #1         eing        Unknown      6     156.57          189393.93\n9       Women                     exportiamalg #1         able        Unknown      7     445.91          189661.36\n10      Women                     exportiamalg #1         eing        Unknown      7     212.95          189393.93\n11      Women                     exportiamalg #1         eing        Unknown      3     219.48          189393.93\n12      Women                     exportiamalg #1         able        Unknown      6     513.34          189661.36\n13      Women                     exportiamalg #1         eing        Unknown      2     249.75          189393.93\n14      Women                     exportiamalg #1         able        Unknown      3     543.87          189661.36\n15      Women                     exportiamalg #1         able        Unknown     10     632.28          189661.36\n16      Women                     exportiamalg #1         able        Unknown      8     643.73          189661.36\n17      Women                     exportiamalg #1          bar        Unknown      4     124.02          189129.91\n18      Women                     exportiamalg #1          bar        Unknown      7     133.35          189129.91\n...*/"
    }
]