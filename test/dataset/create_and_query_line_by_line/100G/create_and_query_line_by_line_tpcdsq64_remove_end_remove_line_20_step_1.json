[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.305811,
                    "execution_time": 1.193102,
                    "compile_time": 0.000331,
                    "planning_time": 0.036669,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.009398,
                    "execution_time": 3.846492,
                    "compile_time": 7.029678,
                    "planning_time": 0.037338,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\" LIMIT 21",
                "preview": "\n/*                  product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name        c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear  cnt\n0   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  39076.0  71896.0        0.0   1998  400\n1   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  27012.0  31332.0        0.0   1998  400\n2   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  35528.0  44408.0        0.0   1998  400\n3   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  12108.0  14284.0        0.0   1998  400\n4   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  39744.0  66768.0        0.0   1999  400\n5   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  16912.0  19276.0        0.0   1999  400\n6   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0   6064.0  12128.0        0.0   1999  400\n7   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0   5268.0   6900.0    62912.0   1999  400\n8   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  25980.0  30396.0        0.0   1999  400\n9   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  30156.0  59708.0        0.0   1999  400\n10  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  39504.0  76636.0    12228.0   1999  400\n11  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0   6080.0  10516.0        0.0   2000  400\n12  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  19336.0  22236.0  1141084.0   2000  400\n13  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  16580.0  23212.0    32452.0   2000  400\n14  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  28620.0  53232.0   238716.0   2001  400\n15  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  19464.0  26276.0        0.0   2001  400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 16.702364,
                    "execution_time": 2.055811,
                    "compile_time": 0.002268,
                    "planning_time": 14.545277
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 25.818587,
                    "execution_time": 2.097077,
                    "compile_time": 9.047842,
                    "planning_time": 14.563696
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\"",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\""
            }
        ],
        "preview": "\n/*                  product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name        c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear  cnt\n0   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  39076.0  71896.0        0.0   1998  400\n1   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  27012.0  31332.0        0.0   1998  400\n2   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  35528.0  44408.0        0.0   1998  400\n3   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  12108.0  14284.0        0.0   1998  400\n4   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  39744.0  66768.0        0.0   1999  400\n5   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  16912.0  19276.0        0.0   1999  400\n6   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0   6064.0  12128.0        0.0   1999  400\n7   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0   5268.0   6900.0    62912.0   1999  400\n8   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  25980.0  30396.0        0.0   1999  400\n9   n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  30156.0  59708.0        0.0   1999  400\n10  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  39504.0  76636.0    12228.0   1999  400\n11  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0   6080.0  10516.0        0.0   2000  400\n12  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  19336.0  22236.0  1141084.0   2000  400\n13  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  16580.0  23212.0    32452.0   2000  400\n14  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  28620.0  53232.0   238716.0   2001  400\n15  n stbarcallyableationought      ought     34136             449          Elm   Rockwood  71545             846    Wilson 4th  Walnut Grove  57752   1998  400  6344.0  8688.0  0.0  19464.0  26276.0        0.0   2001  400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\ncs1.store_zip = cs2.store_zip\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.654413,
                    "execution_time": 1.05672,
                    "compile_time": 0.292263,
                    "planning_time": 7.191891,
                    "create_size": 320
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 16.575593,
                    "execution_time": 2.242341,
                    "compile_time": 7.203468,
                    "planning_time": 7.005281,
                    "create_size": 320
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR_COL_19\" , \"CS2\".\"CNT\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.51094,
                    "execution_time": 0.096338,
                    "compile_time": 0.234211,
                    "planning_time": 0.009945,
                    "create_size": 696
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.484866,
                    "execution_time": 0.097594,
                    "compile_time": 10.135116,
                    "planning_time": 0.067135,
                    "create_size": 672
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_3\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_3\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_3\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_3\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_3\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*                 product_name store_name store_zip b_street_number    b_street_name      b_city  b_zip c_street_number  c_street_name       c_city  c_zip  syear  cnt      s11      s21        s31      s12      s22        s32  syear_col_19  cnt_col_20\n0    priantioughteseableought      cally     20059              21         Madison    Riverdale  79391                           Elm      Waterloo          2000  400  12136.0  15652.0        0.0   7456.0  13868.0    11180.0          1999         400\n1     prieingn stbarn stought      ought     35709              97         Main 6th  Mount Zion  68054             744       Seventh       Lebanon  72898   2001  400  22728.0  40000.0   493920.0  22728.0  40000.0   493920.0          2001         400\n2     prieingn stbarn stought      ought     35709              97         Main 6th  Mount Zion  68054             744       Seventh       Lebanon  72898   2001  400  22728.0  40000.0   493920.0  30080.0  58052.0        0.0          2001         400\n3        ableationprieseation        ese     53604             685      Central Oak    Hamilton  82808             341        Willow   Shady Grove  52812   2000  400  15488.0  19824.0        0.0  15488.0  19824.0        0.0          2000         400\n4        ableationprieseation        ese     53604             685      Central Oak    Hamilton  82808             341        Willow   Shady Grove  52812   2000  400  15488.0  19824.0        0.0  13360.0  20304.0        0.0          1999         400\n5        ableationprieseation        ese     53604             685      Central Oak    Hamilton  82808             341        Willow   Shady Grove  52812   2000  400  15488.0  19824.0        0.0   3604.0   4432.0        0.0          2000         400\n6      antipriantibarbarought       n st     32812             909       Hillcrest    Oak Grove  28370             764      Broadway   Springfield  39303   2001  400  17372.0  33004.0  2582580.0  17372.0  33004.0  2582580.0          2001         400\n7      antipriantibarbarought       n st     32812             909       Hillcrest    Oak Grove  28370             764      Broadway   Springfield  39303   2001  400  17372.0  33004.0  2582580.0  32024.0  57320.0        0.0          2001         400\n8   pricallyeseationableought      ought     31933             294            West    Jamestown  66867             273        2nd 8th     Kingston  34975   2001  400  18344.0  20176.0        0.0  18344.0  20176.0        0.0          2001         400\n9   pricallyeseationableought      ought     31933             294            West    Jamestown  66867             273        2nd 8th     Kingston  34975   2001  400  18344.0  20176.0        0.0   6976.0   9136.0        0.0          2000         400\n10   priablepricallyantiought        bar     29231             390     Pine Jackson     Belmont  00791             445                     Antioch          2001  400  18332.0  25112.0        0.0  19532.0  29492.0        0.0          2001         400\n11   priablepricallyantiought        bar     29231             390     Pine Jackson     Belmont  00791             445                     Antioch          2001  400  18332.0  25112.0        0.0  34652.0  61680.0   268644.0          2001         400\n12   priablepricallyantiought        bar     29231             390     Pine Jackson     Belmont  00791             445                     Antioch          2001  400  18332.0  25112.0        0.0  18332.0  25112.0        0.0          2001         400\n13  antiationableoughtbarable      ought     34136               4  Woodland Sunset     Granite  66284             957     Hillcrest      Oak Hill  57838   2001  400  39800.0  44576.0    17316.0  39800.0  44576.0    17316.0          2001         400\n14  antiationableoughtbarable      ought     34136               4  Woodland Sunset     Granite  66284             957     Hillcrest      Oak Hill  57838   2001  400  39800.0  44576.0    17316.0  16796.0  23512.0        0.0          2000         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.085612,
                    "execution_time": 0.008721,
                    "compile_time": 0.062919,
                    "planning_time": 0.006205
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.313862,
                    "execution_time": 0.0081,
                    "compile_time": 3.251054,
                    "planning_time": 0.042447
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_3\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_3\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_3\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_3\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_3\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*                 product_name store_name store_zip b_street_number    b_street_name      b_city  b_zip c_street_number  c_street_name       c_city  c_zip  syear  cnt      s11      s21        s31      s12      s22        s32  syear_col_19  cnt_col_20\n0    priantioughteseableought      cally     20059              21         Madison    Riverdale  79391                           Elm      Waterloo          2000  400  12136.0  15652.0        0.0   7456.0  13868.0    11180.0          1999         400\n1     prieingn stbarn stought      ought     35709              97         Main 6th  Mount Zion  68054             744       Seventh       Lebanon  72898   2001  400  22728.0  40000.0   493920.0  22728.0  40000.0   493920.0          2001         400\n2     prieingn stbarn stought      ought     35709              97         Main 6th  Mount Zion  68054             744       Seventh       Lebanon  72898   2001  400  22728.0  40000.0   493920.0  30080.0  58052.0        0.0          2001         400\n3        ableationprieseation        ese     53604             685      Central Oak    Hamilton  82808             341        Willow   Shady Grove  52812   2000  400  15488.0  19824.0        0.0  15488.0  19824.0        0.0          2000         400\n4        ableationprieseation        ese     53604             685      Central Oak    Hamilton  82808             341        Willow   Shady Grove  52812   2000  400  15488.0  19824.0        0.0  13360.0  20304.0        0.0          1999         400\n5        ableationprieseation        ese     53604             685      Central Oak    Hamilton  82808             341        Willow   Shady Grove  52812   2000  400  15488.0  19824.0        0.0   3604.0   4432.0        0.0          2000         400\n6      antipriantibarbarought       n st     32812             909       Hillcrest    Oak Grove  28370             764      Broadway   Springfield  39303   2001  400  17372.0  33004.0  2582580.0  17372.0  33004.0  2582580.0          2001         400\n7      antipriantibarbarought       n st     32812             909       Hillcrest    Oak Grove  28370             764      Broadway   Springfield  39303   2001  400  17372.0  33004.0  2582580.0  32024.0  57320.0        0.0          2001         400\n8   pricallyeseationableought      ought     31933             294            West    Jamestown  66867             273        2nd 8th     Kingston  34975   2001  400  18344.0  20176.0        0.0  18344.0  20176.0        0.0          2001         400\n9   pricallyeseationableought      ought     31933             294            West    Jamestown  66867             273        2nd 8th     Kingston  34975   2001  400  18344.0  20176.0        0.0   6976.0   9136.0        0.0          2000         400\n10   priablepricallyantiought        bar     29231             390     Pine Jackson     Belmont  00791             445                     Antioch          2001  400  18332.0  25112.0        0.0  19532.0  29492.0        0.0          2001         400\n11   priablepricallyantiought        bar     29231             390     Pine Jackson     Belmont  00791             445                     Antioch          2001  400  18332.0  25112.0        0.0  34652.0  61680.0   268644.0          2001         400\n12   priablepricallyantiought        bar     29231             390     Pine Jackson     Belmont  00791             445                     Antioch          2001  400  18332.0  25112.0        0.0  18332.0  25112.0        0.0          2001         400\n13  antiationableoughtbarable      ought     34136               4  Woodland Sunset     Granite  66284             957     Hillcrest      Oak Hill  57838   2001  400  39800.0  44576.0    17316.0  39800.0  44576.0    17316.0          2001         400\n14  antiationableoughtbarable      ought     34136               4  Woodland Sunset     Granite  66284             957     Hillcrest      Oak Hill  57838   2001  400  39800.0  44576.0    17316.0  16796.0  23512.0        0.0          2000         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_2\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"S1\" AS \"S1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S2\" AS \"S2\" , \"SPEQLITE_TEMP_TABLE_2\".\"S3\" AS \"S3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.162358,
                    "execution_time": 0.048591,
                    "compile_time": 0.043303,
                    "planning_time": 0.005529,
                    "create_size": 220
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.661812,
                    "execution_time": 0.048499,
                    "compile_time": 3.481953,
                    "planning_time": 0.060965,
                    "create_size": 220
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR_COL_19\" , \"CS2\".\"CNT\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.061741,
                    "execution_time": 0.229292,
                    "compile_time": 0.326761,
                    "planning_time": 0.010553,
                    "create_size": 3072
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 17.781987,
                    "execution_time": 0.261126,
                    "compile_time": 15.927655,
                    "planning_time": 0.067241,
                    "create_size": 3072
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*             product_name store_name store_zip b_street_number       b_street_name           b_city  b_zip c_street_number       c_street_name         c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   barn stbaresepriought      cally     58048                                              Clinton  68222             410              Third     Valley View  45124   2000  400  13032.0  24628.0       0.0  31068.0  48152.0  0.0          1998         400\n1   barn stbaresepriought        ese     35281             387           Highland        Friendship  54536             831      Washington 2nd   Forest Hills  99237   2000  400  28468.0  44692.0  885228.0  31068.0  48152.0  0.0          1998         400\n2   barn stbaresepriought       n st     49231             274          5th Meadow       Union City  68087             917      Maple Broadway       Franklin  79101   2000  400  34580.0  42184.0       0.0  31068.0  48152.0  0.0          1998         400\n3   barn stbaresepriought       n st     73451             484              Green        Pine Grove  54593             808               Park        Hopewell  90587   2000  400  33736.0  64096.0       0.0  31068.0  48152.0  0.0          1998         400\n4   barn stbaresepriought        pri     28828             226            Jackson         Oak Grove  48370             881  Lincoln Washington      Jamestown  76867   2000  400   3136.0   4452.0       0.0  31068.0  48152.0  0.0          1998         400\n5   barn stbaresepriought        ese     58721             776          2nd Valley         Hopewell  30587             653    Third Thirteenth  Spring Valley  76060   2000  400  12220.0  15760.0       0.0  31068.0  48152.0  0.0          1998         400\n6   barn stbaresepriought      ought     53451             398             Forest           Jackson  59583             197             Cherry     Green Acres  67683   2000  400  11780.0  19436.0       0.0  31068.0  48152.0  0.0          1998         400\n7   barn stbaresepriought      ought     28721             346    Johnson Chestnut          Concord  84107             928           Woodland         Newtown  91749   2000  400   1432.0   2420.0    9756.0  31068.0  48152.0  0.0          1998         400\n8   barn stbaresepriought       able     78370             113                Elm           Oakwood  40169             258           Maple 8th     Springdale  68883   2000  400  11780.0  16724.0       0.0  31068.0  48152.0  0.0          1998         400\n9   barn stbaresepriought      cally     36098             831              South       Green Acres  97683             557        Adams Fourth        Liberty  63451   2000  400  39776.0  75572.0       0.0  31068.0  48152.0  0.0          1998         400\n10  barn stbaresepriought       n st     29843              55             Second       Buena Vista  75752              67         Main Spruce         Ludlow  65566   2000  400   8464.0  10664.0       0.0  31068.0  48152.0  0.0          1998         400\n11  barn stbaresepriought      cally     73604             917          5th Walnut        Riverview  49003             853          Jefferson          Wilton  36997   2000  400    780.0   1224.0   38520.0  31068.0  48152.0  0.0          1998         400\n12  barn stbaresepriought        ese     43604             917       Johnson First  Pleasant Valley  22477              28      Davis Highland   Mount Vernon  78482   2000  400  13688.0  21488.0       0.0  31068.0  48152.0  0.0          1998         400\n13  barn stbaresepriought       eing     55709             815           Woodland          Kingston  44975             733                5th        Red Hill  44338   2000  400  31752.0  39688.0       0.0  31068.0  48152.0  0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02293,
                    "execution_time": 0.0089,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.006094
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.132638,
                    "execution_time": 0.008791,
                    "compile_time": 0.071827,
                    "planning_time": 0.041888
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*             product_name store_name store_zip b_street_number       b_street_name           b_city  b_zip c_street_number       c_street_name         c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   barn stbaresepriought      cally     58048                                              Clinton  68222             410              Third     Valley View  45124   2000  400  13032.0  24628.0       0.0  31068.0  48152.0  0.0          1998         400\n1   barn stbaresepriought        ese     35281             387           Highland        Friendship  54536             831      Washington 2nd   Forest Hills  99237   2000  400  28468.0  44692.0  885228.0  31068.0  48152.0  0.0          1998         400\n2   barn stbaresepriought       n st     49231             274          5th Meadow       Union City  68087             917      Maple Broadway       Franklin  79101   2000  400  34580.0  42184.0       0.0  31068.0  48152.0  0.0          1998         400\n3   barn stbaresepriought       n st     73451             484              Green        Pine Grove  54593             808               Park        Hopewell  90587   2000  400  33736.0  64096.0       0.0  31068.0  48152.0  0.0          1998         400\n4   barn stbaresepriought        pri     28828             226            Jackson         Oak Grove  48370             881  Lincoln Washington      Jamestown  76867   2000  400   3136.0   4452.0       0.0  31068.0  48152.0  0.0          1998         400\n5   barn stbaresepriought        ese     58721             776          2nd Valley         Hopewell  30587             653    Third Thirteenth  Spring Valley  76060   2000  400  12220.0  15760.0       0.0  31068.0  48152.0  0.0          1998         400\n6   barn stbaresepriought      ought     53451             398             Forest           Jackson  59583             197             Cherry     Green Acres  67683   2000  400  11780.0  19436.0       0.0  31068.0  48152.0  0.0          1998         400\n7   barn stbaresepriought      ought     28721             346    Johnson Chestnut          Concord  84107             928           Woodland         Newtown  91749   2000  400   1432.0   2420.0    9756.0  31068.0  48152.0  0.0          1998         400\n8   barn stbaresepriought       able     78370             113                Elm           Oakwood  40169             258           Maple 8th     Springdale  68883   2000  400  11780.0  16724.0       0.0  31068.0  48152.0  0.0          1998         400\n9   barn stbaresepriought      cally     36098             831              South       Green Acres  97683             557        Adams Fourth        Liberty  63451   2000  400  39776.0  75572.0       0.0  31068.0  48152.0  0.0          1998         400\n10  barn stbaresepriought       n st     29843              55             Second       Buena Vista  75752              67         Main Spruce         Ludlow  65566   2000  400   8464.0  10664.0       0.0  31068.0  48152.0  0.0          1998         400\n11  barn stbaresepriought      cally     73604             917          5th Walnut        Riverview  49003             853          Jefferson          Wilton  36997   2000  400    780.0   1224.0   38520.0  31068.0  48152.0  0.0          1998         400\n12  barn stbaresepriought        ese     43604             917       Johnson First  Pleasant Valley  22477              28      Davis Highland   Mount Vernon  78482   2000  400  13688.0  21488.0       0.0  31068.0  48152.0  0.0          1998         400\n13  barn stbaresepriought       eing     55709             815           Woodland          Kingston  44975             733                5th        Red Hill  44338   2000  400  31752.0  39688.0       0.0  31068.0  48152.0  0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS2\".\"SYEAR\" = 2001 LIMIT 21",
                "preview": "\n/*           product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n1   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n2   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n3   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n4   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n5   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n6   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n7   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n8   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n9   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n10  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n11  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n12  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n13  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n14  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n15  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.034704,
                    "execution_time": 0.016043,
                    "compile_time": 0.000107,
                    "planning_time": 0.009858
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.792819,
                    "execution_time": 0.017068,
                    "compile_time": 3.722108,
                    "planning_time": 0.046418
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS2\".\"SYEAR\" = 2001"
            }
        ],
        "preview": "\n/*           product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n1   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n2   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n3   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n4   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n5   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n6   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n7   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n8   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n9   ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n10  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n11  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n12  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n13  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n14  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n15  ationeingpribarable        pri     69231             461   2nd Central  Oak Hill  67838             467       Second   Glenwood  73511   2000  400  4160.0  5488.0  0.0  10200.0  18156.0  38680.0          2000         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS2\".\"SYEAR\" = 2001 LIMIT 21",
                "preview": "\n/*                product_name store_name store_zip b_street_number b_street_name      b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n1   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n2   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n3   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n4   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n5   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n6   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n7   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n8   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n9   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n10  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n11  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n12  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n13  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n14  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n15  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.057964,
                    "execution_time": 0.016965,
                    "compile_time": 0.0273,
                    "planning_time": 0.010756
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.356732,
                    "execution_time": 0.018408,
                    "compile_time": 3.285354,
                    "planning_time": 0.04706
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS2\".\"SYEAR\" = 2001"
            }
        ],
        "preview": "\n/*                product_name store_name store_zip b_street_number b_street_name      b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n1   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n2   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n3   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n4   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n5   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n6   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n7   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n8   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n9   priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n10  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n11  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n12  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n13  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n14  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n15  priantioughteseableought        bar     68370             440          Elm   Bridgeport  55817             955    3rd Center  Valley View  95124   2000  400  32884.0  61492.0  0.0  38680.0  52988.0  0.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.824412,
                    "execution_time": 4.941957,
                    "compile_time": 0.088929,
                    "planning_time": 0.01144,
                    "create_size": 8064
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 25.120119,
                    "execution_time": 5.60899,
                    "compile_time": 17.545563,
                    "planning_time": 0.069489,
                    "create_size": 8064
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_6\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_6\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_6\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_6\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_6\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*                product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n1   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n2   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n3   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n4   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n5   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n6   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n7   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n8   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n9   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n10  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n11  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n12  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n13  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n14  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n15  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021947,
                    "execution_time": 0.008267,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.006096
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061844,
                    "execution_time": 0.009326,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.042166
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_6\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_6\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_6\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_6\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_6\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*                product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n1   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n2   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n3   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n4   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n5   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n6   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n7   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n8   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n9   ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n10  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n11  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n12  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n13  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n14  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n15  ationableprieingeseought      cally     61904              44      Central   Freeport  31844             479    4th Second  Summerville  32033   2000  400  24936.0  44632.0  0.0  27012.0  31332.0  0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.119237,
                    "execution_time": 1.317058,
                    "compile_time": 0.094998,
                    "planning_time": 0.011744,
                    "create_size": 3072
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.514243,
                    "execution_time": 1.315388,
                    "compile_time": 6.445433,
                    "planning_time": 0.074315,
                    "create_size": 3072
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_7\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_7\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_7\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_7\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_7\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*           product_name store_name store_zip b_street_number  b_street_name      b_city  b_zip c_street_number c_street_name        c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n1   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n2   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n3   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n4   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n5   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n6   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n7   antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n8   antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n9   antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n10  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n11  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n12  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n13  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n14  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n15  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023019,
                    "execution_time": 0.009129,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.006129
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060749,
                    "execution_time": 0.008191,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.042267
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_7\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_7\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_7\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_7\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_7\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*           product_name store_name store_zip b_street_number  b_street_name      b_city  b_zip c_street_number c_street_name        c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n1   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n2   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n3   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n4   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n5   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n6   antin stantin stpri       eing     23604                  Broadway View                                495    Second 7th     Riverdale  79391   2000  400  13448.0  15328.0  0.0  33052.0  48916.0  0.0          2001         400\n7   antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n8   antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n9   antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n10  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n11  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n12  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n13  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n14  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n15  antin stantin stpri       able     58828             857        Spring   Springdale  48883             858        South       Glenwood  53511   2000  400  26220.0  36444.0  0.0  33052.0  48916.0  0.0          2001         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name     b_city  b_zip c_street_number c_street_name      c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22       s32  syear_col_19  cnt_col_20\n0   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0    620.0   1064.0       0.0          1998         400\n1   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0  28284.0  56568.0  785532.0          1999         400\n2   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0    620.0   1064.0       0.0          1998         400\n3   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0  28284.0  56568.0  785532.0          1999         400\n4   ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0    620.0   1064.0       0.0          1998         400\n5   ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0  28284.0  56568.0  785532.0          1999         400\n6   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0    620.0   1064.0       0.0          1998         400\n7   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0  28284.0  56568.0  785532.0          1999         400\n8   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0    620.0   1064.0       0.0          1998         400\n9   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0  28284.0  56568.0  785532.0          1999         400\n10  ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0    620.0   1064.0       0.0          1998         400\n11  ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0  28284.0  56568.0  785532.0          1999         400\n12  ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0    620.0   1064.0       0.0          1998         400\n13  ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0  28284.0  56568.0  785532.0          1999         400\n14  ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0    620.0   1064.0       0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.19539,
                    "execution_time": 0.155508,
                    "compile_time": 0.015325,
                    "planning_time": 0.012421
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.155197,
                    "execution_time": 0.15634,
                    "compile_time": 5.077071,
                    "planning_time": 0.048157
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name     b_city  b_zip c_street_number c_street_name      c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22       s32  syear_col_19  cnt_col_20\n0   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0    620.0   1064.0       0.0          1998         400\n1   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0  28284.0  56568.0  785532.0          1999         400\n2   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0    620.0   1064.0       0.0          1998         400\n3   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0  28284.0  56568.0  785532.0          1999         400\n4   ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0    620.0   1064.0       0.0          1998         400\n5   ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0  28284.0  56568.0  785532.0          1999         400\n6   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0    620.0   1064.0       0.0          1998         400\n7   ableationprieseation      cally     58048             532      Lincoln   Woodville  24289             987         11th        Union  38721   2000  400  13444.0  13844.0       0.0  28284.0  56568.0  785532.0          1999         400\n8   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0    620.0   1064.0       0.0          1998         400\n9   ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0  28284.0  56568.0  785532.0          1999         400\n10  ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0    620.0   1064.0       0.0          1998         400\n11  ableationprieseation        bar     75709             846   South River  Greenwood  28828             667      Pine 6th   Greenwood  38828   2000  400  24976.0  34716.0  372328.0  28284.0  56568.0  785532.0          1999         400\n12  ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0    620.0   1064.0       0.0          1998         400\n13  ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0  28284.0  56568.0  785532.0          1999         400\n14  ableationprieseation        pri     41904             572     13th Main  Hillcrest  53003             205          4th   Pine Grove  74593   2000  400   9228.0  17532.0       0.0    620.0   1064.0       0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.198222,
                    "execution_time": 0.157833,
                    "compile_time": 0.015807,
                    "planning_time": 0.012387
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.704216,
                    "execution_time": 0.157574,
                    "compile_time": 4.628776,
                    "planning_time": 0.048484
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.196137,
                    "execution_time": 0.156415,
                    "compile_time": 0.015178,
                    "planning_time": 0.01244
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.963692,
                    "execution_time": 0.15734,
                    "compile_time": 4.887341,
                    "planning_time": 0.048815
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.201395,
                    "execution_time": 0.157243,
                    "compile_time": 0.019461,
                    "planning_time": 0.012478
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.558335,
                    "execution_time": 0.157279,
                    "compile_time": 4.482392,
                    "planning_time": 0.048643
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31      s12      s22        s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0    620.0   1064.0        0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  28284.0  56568.0   785532.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  39548.0  75536.0  1450964.0          1998         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  17496.0  21344.0   224264.0          1998         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  34876.0  58240.0        0.0          1998         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  30308.0  38792.0   122888.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31    s12     s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n16  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.198747,
                    "execution_time": 0.15813,
                    "compile_time": 0.015427,
                    "planning_time": 0.012719
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.703522,
                    "execution_time": 0.157465,
                    "compile_time": 5.628835,
                    "planning_time": 0.048574
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31    s12     s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n16  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31    s12     s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n16  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.181901,
                    "execution_time": 0.15725,
                    "compile_time": 0.000177,
                    "planning_time": 0.012228
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.181315,
                    "execution_time": 0.157033,
                    "compile_time": 0.000179,
                    "planning_time": 0.012331
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt     s11     s21  s31    s12     s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n1   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n2   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n3   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n4   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n5   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n6   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n7   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n8   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  620.0  1064.0  0.0          1998         400\n9   ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n10  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n11  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n12  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n13  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n14  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n15  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n16  ableationprieseation                38721             822    Park Smith  Glenwood  63511             413       Cherry   Bunker Hill  50150   2000  400  1068.0  1952.0  0.0  632.0   656.0  0.0          1999         400\n...*/"
    }
]