[
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20) B4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.432783,
                    "execution_time": 0.373933,
                    "compile_time": 0.000406,
                    "planning_time": 0.027493,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.204116,
                    "execution_time": 3.365445,
                    "compile_time": 8.83944,
                    "planning_time": 0.099109,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.390058,
                    "execution_time": 0.330964,
                    "compile_time": 0.000418,
                    "planning_time": 0.027765,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.211486,
                    "execution_time": 0.332051,
                    "compile_time": 3.75749,
                    "planning_time": 0.087967,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.438424,
                    "execution_time": 0.377208,
                    "compile_time": 0.000394,
                    "planning_time": 0.028378,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.196677,
                    "execution_time": 0.377082,
                    "compile_time": 3.698829,
                    "planning_time": 0.087013,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.245222,
                    "execution_time": 0.191282,
                    "compile_time": 0.000388,
                    "planning_time": 0.023978,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.815998,
                    "execution_time": 0.192988,
                    "compile_time": 3.501221,
                    "planning_time": 0.088704,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.225467,
                    "execution_time": 0.061611,
                    "compile_time": 0.129697,
                    "planning_time": 0.007286,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.8302,
                    "execution_time": 0.061914,
                    "compile_time": 6.669332,
                    "planning_time": 0.063595,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd  b4_lp    b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  75.76  13426545    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.066113,
                    "execution_time": 0.007507,
                    "compile_time": 0.047709,
                    "planning_time": 0.004483
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.342472,
                    "execution_time": 0.009599,
                    "compile_time": 3.282784,
                    "planning_time": 0.040303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd  b4_lp    b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  75.76  13426545    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"_Q_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"_Q_0\".\"B4_LP\" AS \"B4_LP\" , \"_Q_0\".\"B4_CNT\" AS \"B4_CNT\" , \"_Q_0\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"_Q_0\" AS \"_Q_0\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.259062,
                    "execution_time": 0.203666,
                    "compile_time": 0.000391,
                    "planning_time": 0.025385,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.858135,
                    "execution_time": 0.209774,
                    "compile_time": 3.533086,
                    "planning_time": 0.083093,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.09935,
                    "execution_time": 0.036278,
                    "compile_time": 0.035174,
                    "planning_time": 0.00319,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.236074,
                    "execution_time": 0.036202,
                    "compile_time": 3.112875,
                    "planning_time": 0.059467,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.06571,
                    "execution_time": 0.037409,
                    "compile_time": 0.000262,
                    "planning_time": 0.00314,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.120339,
                    "execution_time": 0.036299,
                    "compile_time": 0.000266,
                    "planning_time": 0.058716,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.109773,
                    "execution_time": 0.06278,
                    "compile_time": 0.012611,
                    "planning_time": 0.007677,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.253276,
                    "execution_time": 0.06195,
                    "compile_time": 3.100376,
                    "planning_time": 0.062593,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  108.87  16797791     1001*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018925,
                    "execution_time": 0.007715,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004539
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.092801,
                    "execution_time": 0.007384,
                    "compile_time": 0.038442,
                    "planning_time": 0.04012
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  108.87  16797791     1001*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10)\n          or ss_coupon_amt between 2440 and 2440+1000\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"_Q_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_QUANTITY\" <= 20 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_QUANTITY\" <= 20 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"_Q_0\".\"B4_LP\" AS \"B4_LP\" , \"_Q_0\".\"B4_CNT\" AS \"B4_CNT\" , \"_Q_0\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"_Q_0\" AS \"_Q_0\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.999514,
                    "execution_time": 0.881953,
                    "compile_time": 0.059583,
                    "planning_time": 0.026061,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.593728,
                    "execution_time": 3.185256,
                    "compile_time": 3.274122,
                    "planning_time": 0.089318,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095123,
                    "execution_time": 0.063396,
                    "compile_time": 0.000368,
                    "planning_time": 0.007291,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.184625,
                    "execution_time": 0.061454,
                    "compile_time": 0.033005,
                    "planning_time": 0.063084,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd  b4_lp     b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  75.22  265862294    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018388,
                    "execution_time": 0.007269,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004591
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054625,
                    "execution_time": 0.007649,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040213
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd  b4_lp     b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  75.22  265862294    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.462898,
                    "execution_time": 0.405661,
                    "compile_time": 0.000391,
                    "planning_time": 0.026494,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.283736,
                    "execution_time": 0.406559,
                    "compile_time": 3.75381,
                    "planning_time": 0.088281,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.097604,
                    "execution_time": 0.06168,
                    "compile_time": 0.000444,
                    "planning_time": 0.007488,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154775,
                    "execution_time": 0.06091,
                    "compile_time": 0.000463,
                    "planning_time": 0.064975,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019393,
                    "execution_time": 0.007392,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004949
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055002,
                    "execution_time": 0.007663,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040336
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            /*CURSOR_IDENTIFIER*/\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 120 and 120+10\n          or ss_coupon_amt between 3000 and 3000+1000\n          or ss_wholesale_cost between 75 and 75+20)) B5\n",
        "optimize": [
            "SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.454693,
                    "execution_time": 0.398283,
                    "compile_time": 0.000348,
                    "planning_time": 0.028771,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.281263,
                    "execution_time": 0.397501,
                    "compile_time": 3.767333,
                    "planning_time": 0.086198,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"B5_LP\" AS \"B5_LP\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    b5_lp\n0  127.21*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016208,
                    "execution_time": 0.007589,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002986
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051381,
                    "execution_time": 0.007419,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.037996
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE (\"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"B5_LP\" AS \"B5_LP\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    b5_lp\n0  127.21*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25) B5  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.064208,
                    "execution_time": 0.036051,
                    "compile_time": 0.00026,
                    "planning_time": 0.003159,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.176994,
                    "execution_time": 0.036224,
                    "compile_time": 0.056952,
                    "planning_time": 0.058559,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.245793,
                    "execution_time": 0.191798,
                    "compile_time": 0.000388,
                    "planning_time": 0.024181,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.308283,
                    "execution_time": 0.192298,
                    "compile_time": 0.000375,
                    "planning_time": 0.084654,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.280432,
                    "execution_time": 0.071441,
                    "compile_time": 0.171826,
                    "planning_time": 0.008972,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.271009,
                    "execution_time": 0.071321,
                    "compile_time": 7.09687,
                    "planning_time": 0.067014,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  75.74  13423325    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.058632,
                    "execution_time": 0.008208,
                    "compile_time": 0.037747,
                    "planning_time": 0.00531
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.426443,
                    "execution_time": 0.007916,
                    "compile_time": 3.367098,
                    "planning_time": 0.041008
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  75.74  13423325    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 90 and 90+10\n          or ss_coupon_amt between 5000 and 5000+1000\n          or ss_wholesale_cost between 12 and 12+20)) B5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 100 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 90 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 32 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 12 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 100 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 90 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 32 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 12 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.459249,
                    "execution_time": 0.394917,
                    "compile_time": 0.000442,
                    "planning_time": 0.031882,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.523875,
                    "execution_time": 0.396497,
                    "compile_time": 0.000449,
                    "planning_time": 0.093455,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.110919,
                    "execution_time": 0.070622,
                    "compile_time": 0.00054,
                    "planning_time": 0.009428,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.20458,
                    "execution_time": 0.068744,
                    "compile_time": 0.039039,
                    "planning_time": 0.066177,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  49.11  18103918     6121*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020771,
                    "execution_time": 0.007933,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005589
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.156561,
                    "execution_time": 0.007679,
                    "compile_time": 0.100233,
                    "planning_time": 0.041037
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  49.11  18103918     6121*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n) B5 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.782183,
                    "execution_time": 0.663839,
                    "compile_time": 0.063514,
                    "planning_time": 0.025061,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.704247,
                    "execution_time": 3.064842,
                    "compile_time": 3.520301,
                    "planning_time": 0.085818,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.105555,
                    "execution_time": 0.068549,
                    "compile_time": 0.000412,
                    "planning_time": 0.008768,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.161641,
                    "execution_time": 0.068879,
                    "compile_time": 0.000423,
                    "planning_time": 0.064629,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  75.74  275044916    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019775,
                    "execution_time": 0.007417,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005287
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055714,
                    "execution_time": 0.008023,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040765
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp     b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  75.74  275044916    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n) B5/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  75.74  13423325    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019473,
                    "execution_time": 0.007809,
                    "compile_time": 6e-05,
                    "planning_time": 0.004983
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054026,
                    "execution_time": 0.007486,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.039678
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  75.74  13423325    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 10295 and 10295+1000\n          or ss_wholesale_cost between 85 and 85+20)\n/*CURSOR_IDENTIFIER*/\n      ) B5",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 11295 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 10295 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 105 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 85 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 11295 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 10295 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 105 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 85 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.560091,
                    "execution_time": 0.46421,
                    "compile_time": 0.034443,
                    "planning_time": 0.029675,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.892222,
                    "execution_time": 0.462774,
                    "compile_time": 3.307625,
                    "planning_time": 0.087489,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.109473,
                    "execution_time": 0.069897,
                    "compile_time": 0.000458,
                    "planning_time": 0.009312,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.165507,
                    "execution_time": 0.069587,
                    "compile_time": 0.000466,
                    "planning_time": 0.065693,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd   b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  139.67  10579208    11336*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01967,
                    "execution_time": 0.007279,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005121
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055265,
                    "execution_time": 0.007626,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040806
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd   b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  139.67  10579208    11336*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000)) B5 -- Added missing closing parenthesis\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.414351,
                    "execution_time": 0.32911,
                    "compile_time": 0.026513,
                    "planning_time": 0.027036,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.7383,
                    "execution_time": 0.329769,
                    "compile_time": 3.286232,
                    "planning_time": 0.087954,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.109297,
                    "execution_time": 0.06933,
                    "compile_time": 0.000482,
                    "planning_time": 0.009344,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.167473,
                    "execution_time": 0.070387,
                    "compile_time": 0.000456,
                    "planning_time": 0.066372,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd   b5_lp   b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  153.91  1856073    13512*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019316,
                    "execution_time": 0.007272,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056231,
                    "execution_time": 0.008118,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.040949
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd   b5_lp   b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  153.91  1856073    13512*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.655677,
                    "execution_time": 0.556802,
                    "compile_time": 0.040798,
                    "planning_time": 0.026368,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.997695,
                    "execution_time": 0.556159,
                    "compile_time": 3.320155,
                    "planning_time": 0.087397,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106858,
                    "execution_time": 0.068707,
                    "compile_time": 0.000443,
                    "planning_time": 0.009065,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.166832,
                    "execution_time": 0.071168,
                    "compile_time": 0.000457,
                    "planning_time": 0.065365,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019556,
                    "execution_time": 0.007279,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005247
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056638,
                    "execution_time": 0.00824,
                    "compile_time": 6e-05,
                    "planning_time": 0.041141
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 200 and 200+10\n          or ss_coupon_amt between 1500 and 1500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_28\" AS SELECT \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.064827,
                    "execution_time": 0.03714,
                    "compile_time": 0.000253,
                    "planning_time": 0.003242,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.119124,
                    "execution_time": 0.035607,
                    "compile_time": 0.000271,
                    "planning_time": 0.058296,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_29\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.450813,
                    "execution_time": 0.39175,
                    "compile_time": 0.000418,
                    "planning_time": 0.026783,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.597718,
                    "execution_time": 0.393352,
                    "compile_time": 0.081516,
                    "planning_time": 0.089609,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_30\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.316401,
                    "execution_time": 0.077746,
                    "compile_time": 0.195839,
                    "planning_time": 0.011311,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.080371,
                    "execution_time": 0.07885,
                    "compile_time": 6.89241,
                    "planning_time": 0.068965,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  32.32  16465748    18733*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.055821,
                    "execution_time": 0.007423,
                    "compile_time": 0.035537,
                    "planning_time": 0.005586
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.328209,
                    "execution_time": 0.00787,
                    "compile_time": 3.268136,
                    "planning_time": 0.041631
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  32.32  16465748    18733*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 80 and 80+10\n          or ss_coupon_amt between 1000 and 1000+1000\n          or ss_wholesale_cost between 5 and 5+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 90 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 80 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 25 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 5 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_31\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 90 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 80 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 25 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 5 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.733069,
                    "execution_time": 0.637456,
                    "compile_time": 0.037586,
                    "planning_time": 0.026449,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.271571,
                    "execution_time": 0.638871,
                    "compile_time": 3.507813,
                    "planning_time": 0.091193,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_32\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119444,
                    "execution_time": 0.078258,
                    "compile_time": 0.000463,
                    "planning_time": 0.010943,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.227121,
                    "execution_time": 0.076351,
                    "compile_time": 0.051905,
                    "planning_time": 0.066906,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_32\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  41.84  22581224    19328*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019805,
                    "execution_time": 0.007269,
                    "compile_time": 6.7e-05,
                    "planning_time": 0.005498
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.162588,
                    "execution_time": 0.007529,
                    "compile_time": 0.106256,
                    "planning_time": 0.04142
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_32\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  41.84  22581224    19328*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 10 and 10+10\n          or ss_coupon_amt between 2500 and 2500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 20 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 10 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_33\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 20 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 10 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.687284,
                    "execution_time": 0.586784,
                    "compile_time": 0.041319,
                    "planning_time": 0.027031,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.196363,
                    "execution_time": 0.589307,
                    "compile_time": 3.48491,
                    "planning_time": 0.087199,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_34\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120599,
                    "execution_time": 0.077391,
                    "compile_time": 0.000562,
                    "planning_time": 0.011147,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.179129,
                    "execution_time": 0.078674,
                    "compile_time": 0.000526,
                    "planning_time": 0.06762,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  28.15  18674628    14987*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021315,
                    "execution_time": 0.007554,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.006313
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056479,
                    "execution_time": 0.007431,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.041789
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  28.15  18674628    14987*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n/*CURSOR_IDENTIFIER*/\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 200 and 200+10\n          or ss_coupon_amt between 1500 and 1500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6",
        "optimize": [
            "SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_29\" LIMIT 21",
                "preview": "\n/*   b6_lp    b6_cnt  b6_cntd\n0  32.32  16465748    18733*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.069136,
                    "execution_time": 0.007532,
                    "compile_time": 0.05241,
                    "planning_time": 0.003247
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.36952,
                    "execution_time": 0.007437,
                    "compile_time": 3.314878,
                    "planning_time": 0.038091
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_LP\", COUNT(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_CNT\", COUNT(DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE (\"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_29\""
            }
        ],
        "preview": "\n/*   b6_lp    b6_cnt  b6_cntd\n0  32.32  16465748    18733*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n/*CURSOR_IDENTIFIER*/\n      ) B6",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_35\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.247909,
                    "execution_time": 0.191845,
                    "compile_time": 0.000421,
                    "planning_time": 0.025084,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.312348,
                    "execution_time": 0.193195,
                    "compile_time": 0.000442,
                    "planning_time": 0.086933,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_36\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117749,
                    "execution_time": 0.076565,
                    "compile_time": 0.000451,
                    "planning_time": 0.010862,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177164,
                    "execution_time": 0.078082,
                    "compile_time": 0.000487,
                    "planning_time": 0.068359,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  75.74  13430234    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020392,
                    "execution_time": 0.007313,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.00569
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056223,
                    "execution_time": 0.007525,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.041313
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  75.74  13430234    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 5000 and 5000+1000\n          or ss_wholesale_cost between 25 and 25+20)\n/*CURSOR_IDENTIFIER*/\n      ) B6",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 45 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 25 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_37\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 45 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 25 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.655771,
                    "execution_time": 0.571303,
                    "compile_time": 0.025888,
                    "planning_time": 0.026748,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.221306,
                    "execution_time": 0.570433,
                    "compile_time": 3.529206,
                    "planning_time": 0.086839,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_38\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_37\" AS \"SPEQLITE_TEMP_TABLE_37\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119419,
                    "execution_time": 0.075901,
                    "compile_time": 0.000512,
                    "planning_time": 0.011696,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.179955,
                    "execution_time": 0.077141,
                    "compile_time": 0.000582,
                    "planning_time": 0.068728,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_38\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_38\" AS \"SPEQLITE_TEMP_TABLE_38\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802   55.5  19593707     6565*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019888,
                    "execution_time": 0.007318,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005586
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056912,
                    "execution_time": 0.007636,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.041686
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_37\" AS \"SPEQLITE_TEMP_TABLE_37\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_38\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_38\" AS \"SPEQLITE_TEMP_TABLE_38\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802   55.5  19593707     6565*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n           ,count(ss_list_price) B1_CNT\n           ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n           ,count(ss_list_price) B2_CNT\n           ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n           ,count(ss_list_price) B3_CNT\n           ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n           ,count(ss_list_price) B4_CNT\n           ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n           ,count(ss_list_price) B5_CNT\n           ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n           ,count(ss_list_price) B6_CNT\n           ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_39\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.504651,
                    "execution_time": 0.44579,
                    "compile_time": 0.000434,
                    "planning_time": 0.027165,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.651638,
                    "execution_time": 0.443434,
                    "compile_time": 0.085327,
                    "planning_time": 0.088105,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_40\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_39\" AS \"SPEQLITE_TEMP_TABLE_39\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.121973,
                    "execution_time": 0.07931,
                    "compile_time": 0.00048,
                    "planning_time": 0.011423,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.180151,
                    "execution_time": 0.077235,
                    "compile_time": 0.000536,
                    "planning_time": 0.069554,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_40\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_40\" AS \"SPEQLITE_TEMP_TABLE_40\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  40.28  21759781    13641*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020475,
                    "execution_time": 0.007164,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.005925
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056625,
                    "execution_time": 0.007638,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.041734
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_39\" AS \"SPEQLITE_TEMP_TABLE_39\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_40\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_40\" AS \"SPEQLITE_TEMP_TABLE_40\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  40.28  21759781    13641*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 7 and 7+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_41\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.50307,
                    "execution_time": 0.443891,
                    "compile_time": 0.000464,
                    "planning_time": 0.027218,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.566676,
                    "execution_time": 0.445707,
                    "compile_time": 0.000426,
                    "planning_time": 0.087627,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_42\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.12131,
                    "execution_time": 0.07738,
                    "compile_time": 0.000537,
                    "planning_time": 0.011407,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.186705,
                    "execution_time": 0.07887,
                    "compile_time": 0.000507,
                    "planning_time": 0.076557,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_42\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_42\" AS \"SPEQLITE_TEMP_TABLE_42\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  36.96  21763229    13406*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020627,
                    "execution_time": 0.007211,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.005903
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056297,
                    "execution_time": 0.007372,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.041703
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_42\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_42\" AS \"SPEQLITE_TEMP_TABLE_42\""
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  36.96  21763229    13406*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 7 and 7+20)) B6\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\" LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_43\" AS SELECT \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063275,
                    "execution_time": 0.035359,
                    "compile_time": 0.000257,
                    "planning_time": 0.003279,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.121165,
                    "execution_time": 0.036896,
                    "compile_time": 0.000266,
                    "planning_time": 0.058606,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_44\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_43\" AS \"SPEQLITE_TEMP_TABLE_43\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.121205,
                    "execution_time": 0.077299,
                    "compile_time": 0.000527,
                    "planning_time": 0.011389,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.180066,
                    "execution_time": 0.080153,
                    "compile_time": 0.000616,
                    "planning_time": 0.068684,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_44\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_44\" AS \"SPEQLITE_TEMP_TABLE_44\" LIMIT 21",
                "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  36.96  21763229    13406*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020772,
                    "execution_time": 0.007228,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.005995
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057198,
                    "execution_time": 0.007615,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.041999
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_43\" AS \"SPEQLITE_TEMP_TABLE_43\" LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_44\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_44\" AS \"SPEQLITE_TEMP_TABLE_44\" LIMIT 100"
            }
        ],
        "preview": "\n/*   b1_lp   b1_cnt  b1_cntd  b2_lp   b2_cnt  b2_cntd  b3_lp    b3_cnt  b3_cntd   b4_lp    b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd  b6_lp    b6_cnt  b6_cntd\n0  54.48  3622331     7132  30.63  7228125     6384  59.84  10059224     6678  111.97  12583933    12086  35.85  15255636    17802  36.96  21763229    13406*/"
    }
]