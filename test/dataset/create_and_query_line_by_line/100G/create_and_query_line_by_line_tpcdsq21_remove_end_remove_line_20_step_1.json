[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select NULL as w_warehouse_name\n            ,NULL as i_item_id\n            ,sum(case when INV_DATE_SK < 20000519\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when INV_DATE_SK >= 20000519\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n/*CURSOR_IDENTIFIER*/) as subquery",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT NULL AS \"W_WAREHOUSE_NAME\" , NULL AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" < 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" >= 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" ) SELECT \"SUBQUERY\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SUBQUERY\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SUBQUERY\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SUBQUERY\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT NULL AS \"W_WAREHOUSE_NAME\" , NULL AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" < 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" >= 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.475095,
                    "execution_time": 0.263854,
                    "compile_time": 0.162951,
                    "planning_time": 0.022634,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.825577,
                    "execution_time": 10.432329,
                    "compile_time": 9.33357,
                    "planning_time": 0.02377,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name i_item_id    inv_before  inv_after\n0             None      None  189669979621          0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.047248,
                    "execution_time": 0.008165,
                    "compile_time": 0.029775,
                    "planning_time": 0.003331
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.338214,
                    "execution_time": 0.007825,
                    "compile_time": 3.282801,
                    "planning_time": 0.038414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*  w_warehouse_name i_item_id    inv_before  inv_after\n0             None      None  189669979621          0*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.234914,
                    "execution_time": 0.915433,
                    "compile_time": 0.03052,
                    "planning_time": 0.044378,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.988039,
                    "execution_time": 2.934181,
                    "compile_time": 11.679417,
                    "planning_time": 0.118122,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAACEICAAAA       52018          0\n1   Conventional childr  AAAAAAAAOEBEAAAA       58418      13473\n2   Conventional childr  AAAAAAAADFMIAAAA       57551      68623\n3   Conventional childr  AAAAAAAAEBFKAAAA       55519      14304\n4   Conventional childr  AAAAAAAABOGNAAAA       58483      67476\n5   Conventional childr  AAAAAAAAOBJABAAA       59216      35589\n6   Conventional childr  AAAAAAAAJGJABAAA       57400      67066\n7   Conventional childr  AAAAAAAAODCCBAAA       55542          0\n8   Conventional childr  AAAAAAAAMGCCBAAA       57961      16780\n9   Conventional childr  AAAAAAAAHPDFBAAA       59427      66085\n10  Conventional childr  AAAAAAAAFJNGBAAA       54580      68804\n11  Conventional childr  AAAAAAAABBILBAAA       61152      65159\n12  Conventional childr  AAAAAAAAECDACAAA       58419      10695\n13  Conventional childr  AAAAAAAAADDACAAA       57682      14754\n14  Conventional childr  AAAAAAAACGMBCAAA       59499      15286\n15  Conventional childr  AAAAAAAAOCFDCAAA       56844      14678\n16  Conventional childr  AAAAAAAAKNPHCAAA       51843      14266\n17  Conventional childr  AAAAAAAAEEJJCAAA       48787          0\n18  Conventional childr  AAAAAAAAAFEOCAAA       51446          0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032392,
                    "execution_time": 0.007875,
                    "compile_time": 0.015152,
                    "planning_time": 0.003239
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.169596,
                    "execution_time": 0.008329,
                    "compile_time": 3.113723,
                    "planning_time": 0.038872
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAACEICAAAA       52018          0\n1   Conventional childr  AAAAAAAAOEBEAAAA       58418      13473\n2   Conventional childr  AAAAAAAADFMIAAAA       57551      68623\n3   Conventional childr  AAAAAAAAEBFKAAAA       55519      14304\n4   Conventional childr  AAAAAAAABOGNAAAA       58483      67476\n5   Conventional childr  AAAAAAAAOBJABAAA       59216      35589\n6   Conventional childr  AAAAAAAAJGJABAAA       57400      67066\n7   Conventional childr  AAAAAAAAODCCBAAA       55542          0\n8   Conventional childr  AAAAAAAAMGCCBAAA       57961      16780\n9   Conventional childr  AAAAAAAAHPDFBAAA       59427      66085\n10  Conventional childr  AAAAAAAAFJNGBAAA       54580      68804\n11  Conventional childr  AAAAAAAABBILBAAA       61152      65159\n12  Conventional childr  AAAAAAAAECDACAAA       58419      10695\n13  Conventional childr  AAAAAAAAADDACAAA       57682      14754\n14  Conventional childr  AAAAAAAACGMBCAAA       59499      15286\n15  Conventional childr  AAAAAAAAOCFDCAAA       56844      14678\n16  Conventional childr  AAAAAAAAKNPHCAAA       51843      14266\n17  Conventional childr  AAAAAAAAEEJJCAAA       48787          0\n18  Conventional childr  AAAAAAAAAFEOCAAA       51446          0\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date)) and cast ('2000-05-19' as date)\n   group by w_warehouse_name, i_item_id\n/*CURSOR_IDENTIFIER*/\n   )",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-05-19' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND CAST ( '2000-05-19' AS DATE ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0      National, comple  AAAAAAAAAOMMCAAA        3089          0\n1      National, comple  AAAAAAAAMOFOCAAA        3204          0\n2      National, comple  AAAAAAAAKFOPCAAA        2620          0\n3   Conventional childr  AAAAAAAAPKPDAAAA        2788          0\n4   Friendly, suitable   AAAAAAAALHOFAAAA        2531          0\n5   Friendly, suitable   AAAAAAAAOKOFAAAA        2147          0\n6   Friendly, suitable   AAAAAAAAKMOFAAAA        3331          0\n7   Conventional childr  AAAAAAAAAJMLAAAA        2324          0\n8   Conventional childr  AAAAAAAACHOOAAAA        1321          0\n9   Conventional childr  AAAAAAAAHOOOAAAA        3831          0\n10  Conventional childr  AAAAAAAAOKHABAAA        1594          0\n11  Friendly, suitable   AAAAAAAAMKEPAAAA        2114          0\n12  Friendly, suitable   AAAAAAAANAOABAAA        2316          0\n13  Conventional childr  AAAAAAAAGFLGBAAA        1777          0\n14  Conventional childr  AAAAAAAAMEEIBAAA        3059          0\n15  Conventional childr  AAAAAAAADMEIBAAA        2350          0\n16  Friendly, suitable   AAAAAAAACAAEBAAA        2958          0\n17  Conventional childr  AAAAAAAAIENJBAAA        2918          0\n18  Conventional childr  AAAAAAAAJONJBAAA        2332          0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.113733,
                    "execution_time": 0.05351,
                    "compile_time": 0.000247,
                    "planning_time": 0.044208
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.370488,
                    "execution_time": 0.050309,
                    "compile_time": 8.190277,
                    "planning_time": 0.111652
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0      National, comple  AAAAAAAAAOMMCAAA        3089          0\n1      National, comple  AAAAAAAAMOFOCAAA        3204          0\n2      National, comple  AAAAAAAAKFOPCAAA        2620          0\n3   Conventional childr  AAAAAAAAPKPDAAAA        2788          0\n4   Friendly, suitable   AAAAAAAALHOFAAAA        2531          0\n5   Friendly, suitable   AAAAAAAAOKOFAAAA        2147          0\n6   Friendly, suitable   AAAAAAAAKMOFAAAA        3331          0\n7   Conventional childr  AAAAAAAAAJMLAAAA        2324          0\n8   Conventional childr  AAAAAAAACHOOAAAA        1321          0\n9   Conventional childr  AAAAAAAAHOOOAAAA        3831          0\n10  Conventional childr  AAAAAAAAOKHABAAA        1594          0\n11  Friendly, suitable   AAAAAAAAMKEPAAAA        2114          0\n12  Friendly, suitable   AAAAAAAANAOABAAA        2316          0\n13  Conventional childr  AAAAAAAAGFLGBAAA        1777          0\n14  Conventional childr  AAAAAAAAMEEIBAAA        3059          0\n15  Conventional childr  AAAAAAAADMEIBAAA        2350          0\n16  Friendly, suitable   AAAAAAAACAAEBAAA        2958          0\n17  Conventional childr  AAAAAAAAIENJBAAA        2918          0\n18  Conventional childr  AAAAAAAAJONJBAAA        2332          0\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0      National, comple  AAAAAAAALOANCAAA        1501       2071\n1   Conventional childr  AAAAAAAAMCKCAAAA        2051       1840\n2   Conventional childr  AAAAAAAAHGKCAAAA        2037       1564\n3      National, comple  AAAAAAAAEICADAAA        2489       1599\n4      National, comple  AAAAAAAAPLCADAAA        2453       1414\n5   Conventional childr  AAAAAAAAIBDEAAAA        2730       2674\n6      National, comple  AAAAAAAAKELBDAAA        2867       2576\n7      National, comple  AAAAAAAACLLBDAAA        2359       2069\n8      National, comple  AAAAAAAAGLLBDAAA        2269       2926\n9      National, comple  AAAAAAAAHMLBDAAA        3358       2003\n10  Conventional childr  AAAAAAAAJKFHAAAA        3451       2161\n11  Friendly, suitable   AAAAAAAAIIEJAAAA        3386       1273\n12  Conventional childr  AAAAAAAAPFCPAAAA        3140       1070\n13  Friendly, suitable   AAAAAAAACNNKAAAA        3578       1577\n14  Conventional childr  AAAAAAAAABECBAAA        1882       1683\n15  Friendly, suitable   AAAAAAAAAAHMAAAA        1993       2863\n16  Conventional childr  AAAAAAAAHIECBAAA        1208       1610\n17  Conventional childr  AAAAAAAAJJECBAAA        2420       2671\n18  Conventional childr  AAAAAAAACNECBAAA        1910       1345\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.12921,
                    "execution_time": 0.069474,
                    "compile_time": 0.000247,
                    "planning_time": 0.043984
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.197399,
                    "execution_time": 0.066319,
                    "compile_time": 0.000271,
                    "planning_time": 0.113443
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0      National, comple  AAAAAAAALOANCAAA        1501       2071\n1   Conventional childr  AAAAAAAAMCKCAAAA        2051       1840\n2   Conventional childr  AAAAAAAAHGKCAAAA        2037       1564\n3      National, comple  AAAAAAAAEICADAAA        2489       1599\n4      National, comple  AAAAAAAAPLCADAAA        2453       1414\n5   Conventional childr  AAAAAAAAIBDEAAAA        2730       2674\n6      National, comple  AAAAAAAAKELBDAAA        2867       2576\n7      National, comple  AAAAAAAACLLBDAAA        2359       2069\n8      National, comple  AAAAAAAAGLLBDAAA        2269       2926\n9      National, comple  AAAAAAAAHMLBDAAA        3358       2003\n10  Conventional childr  AAAAAAAAJKFHAAAA        3451       2161\n11  Friendly, suitable   AAAAAAAAIIEJAAAA        3386       1273\n12  Conventional childr  AAAAAAAAPFCPAAAA        3140       1070\n13  Friendly, suitable   AAAAAAAACNNKAAAA        3578       1577\n14  Conventional childr  AAAAAAAAABECBAAA        1882       1683\n15  Friendly, suitable   AAAAAAAAAAHMAAAA        1993       2863\n16  Conventional childr  AAAAAAAAHIECBAAA        1208       1610\n17  Conventional childr  AAAAAAAAJJECBAAA        2420       2671\n18  Conventional childr  AAAAAAAACNECBAAA        1910       1345\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0      National, comple  AAAAAAAACMEOCAAA        1743       2473\n1      National, comple  AAAAAAAANPNPCAAA        2734       1320\n2   Conventional childr  AAAAAAAAACGCAAAA        2139       2052\n3      National, comple  AAAAAAAABCOPCAAA        2375       2326\n4   Conventional childr  AAAAAAAAHKODAAAA        2602       1491\n5   Conventional childr  AAAAAAAAENODAAAA        1752       3096\n6   Conventional childr  AAAAAAAAINODAAAA        2630       1369\n7   Conventional childr  AAAAAAAAOPODAAAA        2086        644\n8   Conventional childr  AAAAAAAAACPDAAAA        2476       2686\n9   Friendly, suitable   AAAAAAAAPKCBAAAA        2414       1129\n10  Friendly, suitable   AAAAAAAAGBDBAAAA        3327       1809\n11  Conventional childr  AAAAAAAACKAHAAAA        2646       2100\n12  Conventional childr  AAAAAAAAOJJIAAAA        2284       1360\n13  Conventional childr  AAAAAAAAAICKAAAA        2695       2184\n14  Conventional childr  AAAAAAAACLCKAAAA        3386       2325\n15  Friendly, suitable   AAAAAAAAGNGHAAAA        2216       2407\n16  Friendly, suitable   AAAAAAAAOJPIAAAA        3233       2285\n17  Friendly, suitable   AAAAAAAAAAJKAAAA        1626       1211\n18  Conventional childr  AAAAAAAANFGABAAA        2294       2537\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.127919,
                    "execution_time": 0.063175,
                    "compile_time": 0.000249,
                    "planning_time": 0.048767
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.188937,
                    "execution_time": 0.06411,
                    "compile_time": 0.000253,
                    "planning_time": 0.1089
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0      National, comple  AAAAAAAACMEOCAAA        1743       2473\n1      National, comple  AAAAAAAANPNPCAAA        2734       1320\n2   Conventional childr  AAAAAAAAACGCAAAA        2139       2052\n3      National, comple  AAAAAAAABCOPCAAA        2375       2326\n4   Conventional childr  AAAAAAAAHKODAAAA        2602       1491\n5   Conventional childr  AAAAAAAAENODAAAA        1752       3096\n6   Conventional childr  AAAAAAAAINODAAAA        2630       1369\n7   Conventional childr  AAAAAAAAOPODAAAA        2086        644\n8   Conventional childr  AAAAAAAAACPDAAAA        2476       2686\n9   Friendly, suitable   AAAAAAAAPKCBAAAA        2414       1129\n10  Friendly, suitable   AAAAAAAAGBDBAAAA        3327       1809\n11  Conventional childr  AAAAAAAACKAHAAAA        2646       2100\n12  Conventional childr  AAAAAAAAOJJIAAAA        2284       1360\n13  Conventional childr  AAAAAAAAAICKAAAA        2695       2184\n14  Conventional childr  AAAAAAAACLCKAAAA        3386       2325\n15  Friendly, suitable   AAAAAAAAGNGHAAAA        2216       2407\n16  Friendly, suitable   AAAAAAAAOJPIAAAA        3233       2285\n17  Friendly, suitable   AAAAAAAAAAJKAAAA        1626       1211\n18  Conventional childr  AAAAAAAANFGABAAA        2294       2537\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 then 1 else 0 end) = 1\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN 1 ELSE 0 END = 1"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN 1 ELSE 0 END ) = 1 LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Friendly, suitable   AAAAAAAAGBJDAAAA        2057       2407\n1   Conventional childr  AAAAAAAAMBDDAAAA        2151        274\n2   Friendly, suitable   AAAAAAAAGJCFAAAA        2199       2338\n3   Friendly, suitable   AAAAAAAANBLGAAAA         711       2458\n4   Conventional childr  AAAAAAAAENLEAAAA        2125       2805\n5   Friendly, suitable   AAAAAAAACDLGAAAA        2437       1394\n6   Friendly, suitable   AAAAAAAAGILGAAAA        1794       1671\n7   Conventional childr  AAAAAAAANOEGAAAA        2978       2367\n8   Conventional childr  AAAAAAAAOEFGAAAA        3230       2881\n9   Friendly, suitable   AAAAAAAAMOMJAAAA        2603       2253\n10  Friendly, suitable   AAAAAAAAGDNJAAAA        2487       1719\n11  Conventional childr  AAAAAAAAEDOHAAAA        1708       2102\n12  Friendly, suitable   AAAAAAAAOOFLAAAA        2858       2081\n13  Conventional childr  AAAAAAAALDALAAAA        1633       2564\n14  Friendly, suitable   AAAAAAAAOOHOAAAA        1826       1359\n15  Conventional childr  AAAAAAAAKGJMAAAA        1951       2174\n16  Conventional childr  AAAAAAAAJNBOAAAA        3598       1189\n17  Friendly, suitable   AAAAAAAANEBABAAA        2480       1469\n18  Friendly, suitable   AAAAAAAAFEDDBAAA        2075       1180\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.126311,
                    "execution_time": 0.065318,
                    "compile_time": 0.000242,
                    "planning_time": 0.044886
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.256355,
                    "execution_time": 0.065126,
                    "compile_time": 5.061219,
                    "planning_time": 0.111175
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Friendly, suitable   AAAAAAAAGBJDAAAA        2057       2407\n1   Conventional childr  AAAAAAAAMBDDAAAA        2151        274\n2   Friendly, suitable   AAAAAAAAGJCFAAAA        2199       2338\n3   Friendly, suitable   AAAAAAAANBLGAAAA         711       2458\n4   Conventional childr  AAAAAAAAENLEAAAA        2125       2805\n5   Friendly, suitable   AAAAAAAACDLGAAAA        2437       1394\n6   Friendly, suitable   AAAAAAAAGILGAAAA        1794       1671\n7   Conventional childr  AAAAAAAANOEGAAAA        2978       2367\n8   Conventional childr  AAAAAAAAOEFGAAAA        3230       2881\n9   Friendly, suitable   AAAAAAAAMOMJAAAA        2603       2253\n10  Friendly, suitable   AAAAAAAAGDNJAAAA        2487       1719\n11  Conventional childr  AAAAAAAAEDOHAAAA        1708       2102\n12  Friendly, suitable   AAAAAAAAOOFLAAAA        2858       2081\n13  Conventional childr  AAAAAAAALDALAAAA        1633       2564\n14  Friendly, suitable   AAAAAAAAOOHOAAAA        1826       1359\n15  Conventional childr  AAAAAAAAKGJMAAAA        1951       2174\n16  Conventional childr  AAAAAAAAJNBOAAAA        3598       1189\n17  Friendly, suitable   AAAAAAAANEBABAAA        2480       1469\n18  Friendly, suitable   AAAAAAAAFEDDBAAA        2075       1180\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null end) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <> 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAKJAAAAAA        2400       2431\n1    Conventional childr  AAAAAAAAAHJBAAAA        2184       2516\n2    Friendly, suitable   AAAAAAAAPLIDAAAA        2411       2841\n3    Conventional childr  AAAAAAAAKIJBAAAA        1903       2400\n4    Conventional childr  AAAAAAAAMACDAAAA        1796       2379\n5    Conventional childr  AAAAAAAAAAEGAAAA        1595       2152\n6    Conventional childr  AAAAAAAAOBNHAAAA         950       1581\n7    Conventional childr  AAAAAAAAGDPKAAAA        1206       1720\n8    Friendly, suitable   AAAAAAAAHNJBBAAA        2518       3178\n9    Friendly, suitable   AAAAAAAAKJDBCAAA        1300       2846\n10   Conventional childr  AAAAAAAAOOFCCAAA        1859       1986\n11   Conventional childr  AAAAAAAAOPAHCAAA        1828       2466\n12   Conventional childr  AAAAAAAAMIKICAAA        2284       2579\n13   Conventional childr  AAAAAAAAIBFNCAAA        1723       2018\n14   Friendly, suitable   AAAAAAAAAFEPCAAA        2150       2420\n15   Conventional childr  AAAAAAAAKGOOCAAA        1313       1598\n16   Friendly, suitable   AAAAAAAAPMNADAAA        1995       2152\n17    New proceedings fo  AAAAAAAAPJNGAAAA        2398       2403\n18    New proceedings fo  AAAAAAAABFILAAAA        1113       1724\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.132968,
                    "execution_time": 0.069016,
                    "compile_time": 0.000262,
                    "planning_time": 0.046718
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.219237,
                    "execution_time": 0.069153,
                    "compile_time": 5.020587,
                    "planning_time": 0.109817
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAKJAAAAAA        2400       2431\n1    Conventional childr  AAAAAAAAAHJBAAAA        2184       2516\n2    Friendly, suitable   AAAAAAAAPLIDAAAA        2411       2841\n3    Conventional childr  AAAAAAAAKIJBAAAA        1903       2400\n4    Conventional childr  AAAAAAAAMACDAAAA        1796       2379\n5    Conventional childr  AAAAAAAAAAEGAAAA        1595       2152\n6    Conventional childr  AAAAAAAAOBNHAAAA         950       1581\n7    Conventional childr  AAAAAAAAGDPKAAAA        1206       1720\n8    Friendly, suitable   AAAAAAAAHNJBBAAA        2518       3178\n9    Friendly, suitable   AAAAAAAAKJDBCAAA        1300       2846\n10   Conventional childr  AAAAAAAAOOFCCAAA        1859       1986\n11   Conventional childr  AAAAAAAAOPAHCAAA        1828       2466\n12   Conventional childr  AAAAAAAAMIKICAAA        2284       2579\n13   Conventional childr  AAAAAAAAIBFNCAAA        1723       2018\n14   Friendly, suitable   AAAAAAAAAFEPCAAA        2150       2420\n15   Conventional childr  AAAAAAAAKGOOCAAA        1313       1598\n16   Friendly, suitable   AAAAAAAAPMNADAAA        1995       2152\n17    New proceedings fo  AAAAAAAAPJNGAAAA        2398       2403\n18    New proceedings fo  AAAAAAAABFILAAAA        1113       1724\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null end) > 0\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END > 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) > 0 LIMIT 21",
                "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAANNCAAAAA        1464       2668\n1   Friendly, suitable   AAAAAAAAOCEFAAAA        2008       2477\n2   Conventional childr  AAAAAAAAPINEAAAA        1658       2276\n3   Friendly, suitable   AAAAAAAAALOJAAAA        1309       2229\n4   Conventional childr  AAAAAAAALKPHAAAA        2173       2531\n5   Conventional childr  AAAAAAAAAGKMAAAA        1672       2099\n6   Conventional childr  AAAAAAAAFEFBBAAA        1864       2324\n7   Friendly, suitable   AAAAAAAAAPEDBAAA        1683       2517\n8   Friendly, suitable   AAAAAAAAHDAIBAAA        1491       2143\n9   Conventional childr  AAAAAAAAFKLKBAAA         949       3106\n10  Friendly, suitable   AAAAAAAACDLMBAAA        1295       2459\n11  Friendly, suitable   AAAAAAAALPFBCAAA        1112       1957\n12  Conventional childr  AAAAAAAAGMPACAAA        1648       2040\n13  Conventional childr  AAAAAAAAONPACAAA        2388       3635\n14  Friendly, suitable   AAAAAAAABNAGCAAA        1659       1912\n15  Friendly, suitable   AAAAAAAAGJCJCAAA        2131       2840\n16  Friendly, suitable   AAAAAAAAOHLKCAAA        1231       1474\n17  Friendly, suitable   AAAAAAAACCMKCAAA        1622       2373\n18  Conventional childr  AAAAAAAAKOMICAAA        1449       3101\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.131887,
                    "execution_time": 0.068452,
                    "compile_time": 0.000256,
                    "planning_time": 0.046609
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.741825,
                    "execution_time": 0.073013,
                    "compile_time": 3.536017,
                    "planning_time": 0.114681
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*       w_warehouse_name         i_item_id  inv_before  inv_after\n0   Conventional childr  AAAAAAAANNCAAAAA        1464       2668\n1   Friendly, suitable   AAAAAAAAOCEFAAAA        2008       2477\n2   Conventional childr  AAAAAAAAPINEAAAA        1658       2276\n3   Friendly, suitable   AAAAAAAAALOJAAAA        1309       2229\n4   Conventional childr  AAAAAAAALKPHAAAA        2173       2531\n5   Conventional childr  AAAAAAAAAGKMAAAA        1672       2099\n6   Conventional childr  AAAAAAAAFEFBBAAA        1864       2324\n7   Friendly, suitable   AAAAAAAAAPEDBAAA        1683       2517\n8   Friendly, suitable   AAAAAAAAHDAIBAAA        1491       2143\n9   Conventional childr  AAAAAAAAFKLKBAAA         949       3106\n10  Friendly, suitable   AAAAAAAACDLMBAAA        1295       2459\n11  Friendly, suitable   AAAAAAAALPFBCAAA        1112       1957\n12  Conventional childr  AAAAAAAAGMPACAAA        1648       2040\n13  Conventional childr  AAAAAAAAONPACAAA        2388       3635\n14  Friendly, suitable   AAAAAAAABNAGCAAA        1659       1912\n15  Friendly, suitable   AAAAAAAAGJCJCAAA        2131       2840\n16  Friendly, suitable   AAAAAAAAOHLKCAAA        1231       1474\n17  Friendly, suitable   AAAAAAAACCMKCAAA        1622       2373\n18  Conventional childr  AAAAAAAAKOMICAAA        1449       3101\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0       National, comple  AAAAAAAAOIOPCAAA        1589       1665\n1    Friendly, suitable   AAAAAAAADLHHAAAA        1183       1400\n2    Conventional childr  AAAAAAAABJFNAAAA        2462       2837\n3    Friendly, suitable   AAAAAAAAIJAJAAAA        1869       2360\n4    Friendly, suitable   AAAAAAAAEBFPAAAA        2256       2299\n5    Friendly, suitable   AAAAAAAAGMNABAAA        1832       2369\n6    Conventional childr  AAAAAAAAKINJBAAA        2047       2196\n7    Conventional childr  AAAAAAAAIJNJBAAA        2351       2679\n8    Conventional childr  AAAAAAAAEJLPCAAA        2025       2910\n9    Conventional childr  AAAAAAAAKHEBDAAA        1672       3319\n10   Conventional childr  AAAAAAAAGIEBDAAA        1764       2487\n11  Important issues liv  AAAAAAAAAJLFAAAA        1895       2621\n12  Important issues liv  AAAAAAAAKEEHAAAA        2299       2924\n13    New proceedings fo  AAAAAAAACCJEAAAA        1936       2434\n14    New proceedings fo  AAAAAAAACJFMAAAA        2426       2596\n15  Important issues liv  AAAAAAAAMIFFBAAA        1787       2371\n16  Important issues liv  AAAAAAAAHLHIBAAA        1506       1588\n17  Important issues liv  AAAAAAAAIGEACAAA        1758       2402\n18    New proceedings fo  AAAAAAAAGEHKBAAA        1425       2476\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.142831,
                    "execution_time": 0.078559,
                    "compile_time": 0.000256,
                    "planning_time": 0.046616
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.471478,
                    "execution_time": 0.077875,
                    "compile_time": 5.257834,
                    "planning_time": 0.115569
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0       National, comple  AAAAAAAAOIOPCAAA        1589       1665\n1    Friendly, suitable   AAAAAAAADLHHAAAA        1183       1400\n2    Conventional childr  AAAAAAAABJFNAAAA        2462       2837\n3    Friendly, suitable   AAAAAAAAIJAJAAAA        1869       2360\n4    Friendly, suitable   AAAAAAAAEBFPAAAA        2256       2299\n5    Friendly, suitable   AAAAAAAAGMNABAAA        1832       2369\n6    Conventional childr  AAAAAAAAKINJBAAA        2047       2196\n7    Conventional childr  AAAAAAAAIJNJBAAA        2351       2679\n8    Conventional childr  AAAAAAAAEJLPCAAA        2025       2910\n9    Conventional childr  AAAAAAAAKHEBDAAA        1672       3319\n10   Conventional childr  AAAAAAAAGIEBDAAA        1764       2487\n11  Important issues liv  AAAAAAAAAJLFAAAA        1895       2621\n12  Important issues liv  AAAAAAAAKEEHAAAA        2299       2924\n13    New proceedings fo  AAAAAAAACCJEAAAA        1936       2434\n14    New proceedings fo  AAAAAAAACJFMAAAA        2426       2596\n15  Important issues liv  AAAAAAAAMIFFBAAA        1787       2371\n16  Important issues liv  AAAAAAAAHLHIBAAA        1506       1588\n17  Important issues liv  AAAAAAAAIGEACAAA        1758       2402\n18    New proceedings fo  AAAAAAAAGEHKBAAA        1425       2476\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAJANBAAA        2159       2293\n1                    AAAAAAAAOACFBAAA        1656       2667\n2                    AAAAAAAAJCBLCAAA        1394       2237\n3                    AAAAAAAAMOADCAAA        1482       2035\n4                    AAAAAAAAICNLAAAA        2456       3039\n5                    AAAAAAAAGJCACAAA        1892       1995\n6                    AAAAAAAAECANBAAA        2280       2711\n7                    AAAAAAAAKGGABAAA        1768       1915\n8                    AAAAAAAAIPIOBAAA        1592       1805\n9                    AAAAAAAAACPGAAAA        1468       1821\n10                   AAAAAAAAKJIJCAAA        2444       2569\n11                   AAAAAAAABNKJBAAA        2142       2782\n12                   AAAAAAAAPECOCAAA        2166       3119\n13                   AAAAAAAANEOHCAAA        2309       2503\n14                   AAAAAAAAGPIFAAAA        1771       2127\n15                   AAAAAAAAEGJOBAAA        1339       1821\n16                   AAAAAAAABJIABAAA        2045       2586\n17                   AAAAAAAAOJJIAAAA        2143       2605\n18                   AAAAAAAAADHLBAAA        1477       2382\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.146107,
                    "execution_time": 0.082127,
                    "compile_time": 0.000283,
                    "planning_time": 0.046669
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.558226,
                    "execution_time": 0.077549,
                    "compile_time": 4.410814,
                    "planning_time": 0.113048
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAJANBAAA        2159       2293\n1                    AAAAAAAAOACFBAAA        1656       2667\n2                    AAAAAAAAJCBLCAAA        1394       2237\n3                    AAAAAAAAMOADCAAA        1482       2035\n4                    AAAAAAAAICNLAAAA        2456       3039\n5                    AAAAAAAAGJCACAAA        1892       1995\n6                    AAAAAAAAECANBAAA        2280       2711\n7                    AAAAAAAAKGGABAAA        1768       1915\n8                    AAAAAAAAIPIOBAAA        1592       1805\n9                    AAAAAAAAACPGAAAA        1468       1821\n10                   AAAAAAAAKJIJCAAA        2444       2569\n11                   AAAAAAAABNKJBAAA        2142       2782\n12                   AAAAAAAAPECOCAAA        2166       3119\n13                   AAAAAAAANEOHCAAA        2309       2503\n14                   AAAAAAAAGPIFAAAA        1771       2127\n15                   AAAAAAAAEGJOBAAA        1339       1821\n16                   AAAAAAAABJIABAAA        2045       2586\n17                   AAAAAAAAOJJIAAAA        2143       2605\n18                   AAAAAAAAADHLBAAA        1477       2382\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST , \"X\".\"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAABIBAAA        1240       1814\n1                    AAAAAAAAAACOAAAA        1102       2091\n2                    AAAAAAAAAADHAAAA        1888       2409\n3                    AAAAAAAAAADPBAAA        2596       3737\n4                    AAAAAAAAAAFBBAAA        2040       2193\n5                    AAAAAAAAAAGNAAAA        1438       1959\n6                    AAAAAAAAAAIFAAAA        1664       2856\n7                    AAAAAAAAAALAAAAA        1614       1935\n8                    AAAAAAAAAALADAAA        1860       1995\n9                    AAAAAAAAAAOHCAAA        1829       3155\n10                   AAAAAAAAABBDAAAA        2046       2426\n11                   AAAAAAAAABBNBAAA        1801       2344\n12                   AAAAAAAAABCICAAA        1496       2067\n13                   AAAAAAAAABCKAAAA        2254       2679\n14                   AAAAAAAAABDAAAAA        1673       1815\n15                   AAAAAAAAABDHAAAA        3070       3340\n16                   AAAAAAAAABGBCAAA        1052       1580\n17                   AAAAAAAAABGNAAAA        1405       2751\n18                   AAAAAAAAABMECAAA        2335       2712\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.146887,
                    "execution_time": 0.080889,
                    "compile_time": 0.000283,
                    "planning_time": 0.048484
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.208982,
                    "execution_time": 0.085027,
                    "compile_time": 5.059339,
                    "planning_time": 0.115476
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAABIBAAA        1240       1814\n1                    AAAAAAAAAACOAAAA        1102       2091\n2                    AAAAAAAAAADHAAAA        1888       2409\n3                    AAAAAAAAAADPBAAA        2596       3737\n4                    AAAAAAAAAAFBBAAA        2040       2193\n5                    AAAAAAAAAAGNAAAA        1438       1959\n6                    AAAAAAAAAAIFAAAA        1664       2856\n7                    AAAAAAAAAALAAAAA        1614       1935\n8                    AAAAAAAAAALADAAA        1860       1995\n9                    AAAAAAAAAAOHCAAA        1829       3155\n10                   AAAAAAAAABBDAAAA        2046       2426\n11                   AAAAAAAAABBNBAAA        1801       2344\n12                   AAAAAAAAABCICAAA        1496       2067\n13                   AAAAAAAAABCKAAAA        2254       2679\n14                   AAAAAAAAABDAAAAA        1673       1815\n15                   AAAAAAAAABDHAAAA        3070       3340\n16                   AAAAAAAAABGBCAAA        1052       1580\n17                   AAAAAAAAABGNAAAA        1405       2751\n18                   AAAAAAAAABMECAAA        2335       2712\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST , \"X\".\"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAABIBAAA        1240       1814\n1                    AAAAAAAAAACOAAAA        1102       2091\n2                    AAAAAAAAAADHAAAA        1888       2409\n3                    AAAAAAAAAADPBAAA        2596       3737\n4                    AAAAAAAAAAFBBAAA        2040       2193\n5                    AAAAAAAAAAGNAAAA        1438       1959\n6                    AAAAAAAAAAIFAAAA        1664       2856\n7                    AAAAAAAAAALAAAAA        1614       1935\n8                    AAAAAAAAAALADAAA        1860       1995\n9                    AAAAAAAAAAOHCAAA        1829       3155\n10                   AAAAAAAAABBDAAAA        2046       2426\n11                   AAAAAAAAABBNBAAA        1801       2344\n12                   AAAAAAAAABCICAAA        1496       2067\n13                   AAAAAAAAABCKAAAA        2254       2679\n14                   AAAAAAAAABDAAAAA        1673       1815\n15                   AAAAAAAAABDHAAAA        3070       3340\n16                   AAAAAAAAABGBCAAA        1052       1580\n17                   AAAAAAAAABGNAAAA        1405       2751\n18                   AAAAAAAAABMECAAA        2335       2712\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.149011,
                    "execution_time": 0.084695,
                    "compile_time": 0.000298,
                    "planning_time": 0.04704
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.145198,
                    "execution_time": 0.080281,
                    "compile_time": 0.000288,
                    "planning_time": 0.047226
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAABIBAAA        1240       1814\n1                    AAAAAAAAAACOAAAA        1102       2091\n2                    AAAAAAAAAADHAAAA        1888       2409\n3                    AAAAAAAAAADPBAAA        2596       3737\n4                    AAAAAAAAAAFBBAAA        2040       2193\n5                    AAAAAAAAAAGNAAAA        1438       1959\n6                    AAAAAAAAAAIFAAAA        1664       2856\n7                    AAAAAAAAAALAAAAA        1614       1935\n8                    AAAAAAAAAALADAAA        1860       1995\n9                    AAAAAAAAAAOHCAAA        1829       3155\n10                   AAAAAAAAABBDAAAA        2046       2426\n11                   AAAAAAAAABBNBAAA        1801       2344\n12                   AAAAAAAAABCICAAA        1496       2067\n13                   AAAAAAAAABCKAAAA        2254       2679\n14                   AAAAAAAAABDAAAAA        1673       1815\n15                   AAAAAAAAABDHAAAA        3070       3340\n16                   AAAAAAAAABGBCAAA        1052       1580\n17                   AAAAAAAAABGNAAAA        1405       2751\n18                   AAAAAAAAABMECAAA        2335       2712\n...*/"
    }
]