[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk as customer_sk\n      ,ss_item_sk as item_sk\nfrom store_sales \n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0        950402   164264\n1        708699    68755\n2        950402    43459\n3        708699   191605\n4        950402   117559\n5        708699    38905\n6        950402    80816\n7        708699    35629\n8        950402   197554\n9        708699    30778\n10       950402    91921\n11       708699   115615\n12       950402   104848\n13       708699    11060\n14       950402   194156\n15       708699   138074\n16       950402   133256\n17       708699    86602\n18       950402   185404\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046427,
                    "execution_time": 0.003788,
                    "compile_time": 0.013717,
                    "planning_time": 0.022866
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.208121,
                    "execution_time": 0.00412,
                    "compile_time": 3.115455,
                    "planning_time": 0.078302
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0        950402   164264\n1        708699    68755\n2        950402    43459\n3        708699   191605\n4        950402   117559\n5        708699    38905\n6        950402    80816\n7        708699    35629\n8        950402   197554\n9        708699    30778\n10       950402    91921\n11       708699   115615\n12       950402   104848\n13       708699    11060\n14       950402   194156\n15       708699   138074\n16       950402   133256\n17       708699    86602\n18       950402   185404\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk as customer_sk\n      ,ss_item_sk as item_sk\nfrom store_sales, date_dim\nwhere ss_sold_date_sk = d_date_sk\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.925876,
                    "execution_time": 3.697198,
                    "compile_time": 0.077032,
                    "planning_time": 0.031362,
                    "create_size": 3073
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.596707,
                    "execution_time": 8.089431,
                    "compile_time": 3.280084,
                    "planning_time": 0.09829,
                    "create_size": 3073
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0        437895   105205\n1        797256    73670\n2        437895    70336\n3        797256    43178\n4        437895   147538\n5        797256   203510\n6        437895    61396\n7        797256   129506\n8        437895   107305\n9        797256   197122\n10       437895   105698\n11       797256   125540\n12       437895    87955\n13       797256   129571\n14       437895   125900\n15       797256    30046\n16       437895    36217\n17       797256   112796\n18       437895    24493\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017271,
                    "execution_time": 0.0083,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003167
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055207,
                    "execution_time": 0.008047,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038503
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0        437895   105205\n1        797256    73670\n2        437895    70336\n3        797256    43178\n4        437895   147538\n5        797256   203510\n6        437895    61396\n7        797256   129506\n8        437895   107305\n9        797256   197122\n10       437895   105698\n11       797256   125540\n12       437895    87955\n13       797256   129571\n14       437895   125900\n15       797256    30046\n16       437895    36217\n17       797256   112796\n18       437895    24493\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0       1811558    21715\n1       1811558    21715\n2       1811558    21715\n3       1811558    21715\n4       1811558    21715\n5       1811558    21715\n6       1811558    21715\n7       1811558    21715\n8       1811558    21715\n9       1811558    21715\n10      1811558    21715\n11      1811558    21715\n12      1811558    21715\n13      1811558    21715\n14      1811558    21715\n15      1811558    21715\n16      1811558    21715\n17      1811558    21715\n18      1811558    21715\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04448,
                    "execution_time": 0.010416,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.026397
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.172982,
                    "execution_time": 0.011862,
                    "compile_time": 3.057398,
                    "planning_time": 0.083099
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180"
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0       1811558    21715\n1       1811558    21715\n2       1811558    21715\n3       1811558    21715\n4       1811558    21715\n5       1811558    21715\n6       1811558    21715\n7       1811558    21715\n8       1811558    21715\n9       1811558    21715\n10      1811558    21715\n11      1811558    21715\n12      1811558    21715\n13      1811558    21715\n14      1811558    21715\n15      1811558    21715\n16      1811558    21715\n17      1811558    21715\n18      1811558    21715\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk, ss_item_sk\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.008896,
                    "execution_time": 1.788252,
                    "compile_time": 0.062667,
                    "planning_time": 0.033781,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.345424,
                    "execution_time": 3.020479,
                    "compile_time": 3.092904,
                    "planning_time": 0.102533,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0     1475514.0    59090\n1     1475514.0    13471\n2     1451207.0   128701\n3     1451207.0   188641\n4     1451207.0    67849\n5     1451207.0    88909\n6     1301951.0   123328\n7     1301951.0    31054\n8           NaN    16202\n9      716107.0    75757\n10    1747893.0   151672\n11     241909.0   184648\n12     241909.0   126049\n13    1652136.0     6391\n14    1916298.0   192640\n15    1916298.0   108182\n16    1924875.0    88750\n17    1924875.0   140887\n18    1924875.0    30499\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016693,
                    "execution_time": 0.00806,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003019
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054069,
                    "execution_time": 0.008275,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038369
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0     1475514.0    59090\n1     1475514.0    13471\n2     1451207.0   128701\n3     1451207.0   188641\n4     1451207.0    67849\n5     1451207.0    88909\n6     1301951.0   123328\n7     1301951.0    31054\n8           NaN    16202\n9      716107.0    75757\n10    1747893.0   151672\n11     241909.0   184648\n12     241909.0   126049\n13    1652136.0     6391\n14    1916298.0   192640\n15    1916298.0   108182\n16    1924875.0    88750\n17    1924875.0   140887\n18    1924875.0    30499\n...*/"
    },
    {
        "input": "with /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales, date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk\n)\n/*CURSOR_IDENTIFIER*/\nSELECT * FROM ssci; -- Placeholder continuation query",
        "optimize": [
            "WITH \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0     1451207.0    90572\n1     1451207.0    66998\n2     1451207.0    50546\n3     1009383.0   185251\n4           NaN    74605\n5     1009383.0   138494\n6     1301951.0   110389\n7     1747893.0   198025\n8     1652136.0   189578\n9     1652136.0    35194\n10    1652136.0      206\n11    1652136.0   153997\n12    1916298.0   184090\n13    1916298.0     9271\n14    1916298.0    45968\n15    1916298.0   164780\n16    1916298.0   188095\n17          NaN    66554\n18    1924875.0    55702\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016439,
                    "execution_time": 0.007652,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.002966
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016281,
                    "execution_time": 0.007343,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003068
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0     1451207.0    90572\n1     1451207.0    66998\n2     1451207.0    50546\n3     1009383.0   185251\n4           NaN    74605\n5     1009383.0   138494\n6     1301951.0   110389\n7     1747893.0   198025\n8     1652136.0   189578\n9     1652136.0    35194\n10    1652136.0      206\n11    1652136.0   153997\n12    1916298.0   184090\n13    1916298.0     9271\n14    1916298.0    45968\n15    1916298.0   164780\n16    1916298.0   188095\n17          NaN    66554\n18    1924875.0    55702\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n/*CURSOR_IDENTIFIER*/ select * from ssci, csci",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" , \"CSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\" CROSS JOIN \"CSCI\" AS \"CSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.116873,
                    "execution_time": 0.032437,
                    "compile_time": 0.033995,
                    "planning_time": 0.025702,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.2173,
                    "execution_time": 0.031136,
                    "compile_time": 3.073688,
                    "planning_time": 0.087157,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.945332,
                    "execution_time": 1.790651,
                    "compile_time": 0.000357,
                    "planning_time": 0.030731,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.018756,
                    "execution_time": 1.805708,
                    "compile_time": 0.000358,
                    "planning_time": 0.088705,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.345216,
                    "execution_time": 1.192045,
                    "compile_time": 0.000369,
                    "planning_time": 0.028923,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.412944,
                    "execution_time": 1.194502,
                    "compile_time": 0.000357,
                    "planning_time": 0.091611,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk  customer_sk_col_2  item_sk_col_3\n0       1747236   182677             782811         157720\n1       1747236   182677             782811          39250\n2       1747236   182677             782811           2744\n3       1747236   182677             522017         183919\n4       1747236   182677             923232          54896\n5       1747236   182677            1950334         169522\n6       1747236   182677            1950334         198595\n7       1747236   182677            1441322          86722\n8       1747236   182677             895528         176816\n9       1747236   182677             895528          15248\n10      1747236   182677             698567          87793\n11      1747236   182677            1113154         128749\n12      1747236   182677             839783           5107\n13      1747236   182677            1014897          69178\n14      1747236   182677            1392817          61537\n15      1747236   182677            1392817         175255\n16      1747236   182677            1395549         135703\n17      1747236   182677                862         121384\n18      1747236   182677            1953740         178681\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.353671,
                    "execution_time": 0.342169,
                    "compile_time": 0.041951,
                    "planning_time": 0.004253
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.157656,
                    "execution_time": 0.399688,
                    "compile_time": 3.086196,
                    "planning_time": 0.039799
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk  customer_sk_col_2  item_sk_col_3\n0       1747236   182677             782811         157720\n1       1747236   182677             782811          39250\n2       1747236   182677             782811           2744\n3       1747236   182677             522017         183919\n4       1747236   182677             923232          54896\n5       1747236   182677            1950334         169522\n6       1747236   182677            1950334         198595\n7       1747236   182677            1441322          86722\n8       1747236   182677             895528         176816\n9       1747236   182677             895528          15248\n10      1747236   182677             698567          87793\n11      1747236   182677            1113154         128749\n12      1747236   182677             839783           5107\n13      1747236   182677            1014897          69178\n14      1747236   182677            1392817          61537\n15      1747236   182677            1392817         175255\n16      1747236   182677            1395549         135703\n17      1747236   182677                862         121384\n18      1747236   182677            1953740         178681\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only from ssci, csci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SSCI\" AS \"SSCI\" CROSS JOIN \"CSCI\" AS \"CSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.724554,
                    "execution_time": 0.649528,
                    "compile_time": 0.000255,
                    "planning_time": 0.002934,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.797219,
                    "execution_time": 0.664053,
                    "compile_time": 0.000266,
                    "planning_time": 0.057747,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.514278,
                    "execution_time": 0.43943,
                    "compile_time": 0.000252,
                    "planning_time": 0.002981,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.571392,
                    "execution_time": 0.436155,
                    "compile_time": 0.000257,
                    "planning_time": 0.059386,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\nfrom (select * from ssci) as ssci left join (select * from csci) as csci on ssci.customer_sk = csci.customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SSCI\" AS \"SSCI\" LEFT JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.490467,
                    "execution_time": 4.454027,
                    "compile_time": 0.000387,
                    "planning_time": 0.006871,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.639937,
                    "execution_time": 4.420375,
                    "compile_time": 3.089181,
                    "planning_time": 0.090509,
                    "create_size": 5
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only\n0    10945670             0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016108,
                    "execution_time": 0.007094,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003197
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051851,
                    "execution_time": 0.007469,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.038498
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only\n0    10945670             0*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales join date_dim on ss_sold_date_sk = d_date_sk\n\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales join date_dim on cs_sold_date_sk = d_date_sk\n\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on ssci.customer_sk = csci.customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.712579,
                    "execution_time": 4.600964,
                    "compile_time": 0.07366,
                    "planning_time": 0.007596,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 22.093186,
                    "execution_time": 18.548571,
                    "compile_time": 3.512187,
                    "planning_time": 0.064335,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    10945670       2572803          763805007*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.061568,
                    "execution_time": 0.007991,
                    "compile_time": 0.044429,
                    "planning_time": 0.003246
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.141076,
                    "execution_time": 0.007813,
                    "compile_time": 3.085252,
                    "planning_time": 0.038755
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    10945670       2572803          763805007*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    10945670       2572803          763805007*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016235,
                    "execution_time": 0.007513,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.002996
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051289,
                    "execution_time": 0.007231,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038084
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    10945670       2572803          763805007*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n                               and ssci.item_sk = csci.item_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\" AND \"CSCI\".\"ITEM_SK\" = \"SSCI\".\"ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.791298,
                    "execution_time": 0.690708,
                    "compile_time": 0.060974,
                    "planning_time": 0.007889,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.687164,
                    "execution_time": 2.382704,
                    "compile_time": 3.203619,
                    "planning_time": 0.065169,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    53739331      28426514               7419*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015841,
                    "execution_time": 0.006968,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003144
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.08875,
                    "execution_time": 0.007764,
                    "compile_time": 0.035853,
                    "planning_time": 0.038826
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    53739331      28426514               7419*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n                               and ssci.item_sk = csci.item_sk)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\" AND \"CSCI\".\"ITEM_SK\" = \"SSCI\".\"ITEM_SK\" LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    53739331      28426514               7419*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016108,
                    "execution_time": 0.007033,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003231
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016971,
                    "execution_time": 0.007777,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003366
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 100"
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0    53739331      28426514               7419*/"
    }
]