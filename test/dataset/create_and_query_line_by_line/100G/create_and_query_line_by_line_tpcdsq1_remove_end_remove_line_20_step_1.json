[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n-- Assuming date_dim is part of the schema, fixing missed join syntax\njoin date_dim on sr_returned_date_sk = d_date_sk\nwhere d_year = 1999\ngroup by sr_customer_sk, sr_store_sk\n) /* End of CTE */\nselect *\nfrom customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.722468,
                    "execution_time": 0.428459,
                    "compile_time": 0.00036,
                    "planning_time": 0.03072,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.859377,
                    "execution_time": 4.551812,
                    "compile_time": 0.005529,
                    "planning_time": 0.031343,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0           1583249           224           1733.74\n1            346244           392              0.00\n2           1892169            50           1834.80\n3           1795643           193            272.78\n4           1818758           274           2503.41\n5           1707123           302            708.24\n6           1984472           388           1977.26\n7           1822673           142           1423.75\n8           1872438            76           2873.55\n9            342153             7           4665.27\n10          1236050            26            265.18\n11           769802           182            145.68\n12           993179           370             36.36\n13          1453254           226            556.40\n14           568407           134             13.02\n15           978957            98           2752.24\n16           844594            43           1704.01\n17          1533587            14             87.87\n18          1179661           238            382.94\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016793,
                    "execution_time": 0.007575,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003199
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052703,
                    "execution_time": 0.007882,
                    "compile_time": 0.001013,
                    "planning_time": 0.037745
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0           1583249           224           1733.74\n1            346244           392              0.00\n2           1892169            50           1834.80\n3           1795643           193            272.78\n4           1818758           274           2503.41\n5           1707123           302            708.24\n6           1984472           388           1977.26\n7           1822673           142           1423.75\n8           1872438            76           2873.55\n9            342153             7           4665.27\n10          1236050            26            265.18\n11           769802           182            145.68\n12           993179           370             36.36\n13          1453254           226            556.40\n14           568407           134             13.02\n15           978957            98           2752.24\n16           844594            43           1704.01\n17          1533587            14             87.87\n18          1179661           238            382.94\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\nselect * from customer_total_return /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0          694647.0         184.0            133.47\n1         1231089.0         151.0           3785.94\n2          376103.0         370.0           1230.23\n3         1548175.0         331.0             58.24\n4         1255522.0         260.0            529.74\n5          101498.0           NaN            391.60\n6          245079.0          70.0           1018.91\n7               NaN         163.0         129294.46\n8          382827.0         188.0           1524.90\n9         1910337.0         122.0            129.05\n10        1081636.0         256.0           1471.93\n11         790327.0         322.0            347.40\n12        1598816.0         338.0              0.00\n13        1098287.0         308.0            153.93\n14        1211425.0           2.0             85.63\n15        1231726.0         146.0           1759.85\n16        1056227.0          68.0            176.49\n17        1298993.0         308.0             19.20\n18          88501.0           NaN               NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017541,
                    "execution_time": 0.008054,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.003275
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016934,
                    "execution_time": 0.007516,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003288
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0          694647.0         184.0            133.47\n1         1231089.0         151.0           3785.94\n2          376103.0         370.0           1230.23\n3         1548175.0         331.0             58.24\n4         1255522.0         260.0            529.74\n5          101498.0           NaN            391.60\n6          245079.0          70.0           1018.91\n7               NaN         163.0         129294.46\n8          382827.0         188.0           1524.90\n9         1910337.0         122.0            129.05\n10        1081636.0         256.0           1471.93\n11         790327.0         322.0            347.40\n12        1598816.0         338.0              0.00\n13        1098287.0         308.0            153.93\n14        1211425.0           2.0             85.63\n15        1231726.0         146.0           1759.85\n16        1056227.0          68.0            176.49\n17        1298993.0         308.0             19.20\n18          88501.0           NaN               NaN\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n-- Assuming date_dim is a valid table with the necessary columns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select ctr_customer_sk\nfrom customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.312633,
                    "execution_time": 0.238163,
                    "compile_time": 0.00026,
                    "planning_time": 0.002777,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.53627,
                    "execution_time": 0.235437,
                    "compile_time": 0.170616,
                    "planning_time": 0.056479,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk\n0           1566837\n1           1486632\n2           1907680\n3           1889831\n4             77473\n5            922276\n6           1592186\n7            104729\n8           1201293\n9            538622\n10          1052497\n11            88206\n12          1928331\n13          1754690\n14           198386\n15          1376749\n16           245738\n17          1945619\n18          1610905\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016261,
                    "execution_time": 0.00729,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.002915
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052244,
                    "execution_time": 0.007285,
                    "compile_time": 0.000944,
                    "planning_time": 0.037917
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk\n0           1566837\n1           1486632\n2           1907680\n3           1889831\n4             77473\n5            922276\n6           1592186\n7            104729\n8           1201293\n9            538622\n10          1052497\n11            88206\n12          1928331\n13          1754690\n14           198386\n15          1376749\n16           245738\n17          1945619\n18          1610905\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select ctr_customer_sk, ctr_store_sk\nfrom customer_total_return ctr1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.37056,
                    "execution_time": 0.254261,
                    "compile_time": 0.000274,
                    "planning_time": 0.003393,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.578275,
                    "execution_time": 0.259251,
                    "compile_time": 0.133294,
                    "planning_time": 0.069226,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk\n0            930988           217\n1           1886229            88\n2            170690           212\n3            944456           368\n4            421736           250\n5            732588           340\n6            441485           142\n7           1451040           148\n8            250536           110\n9           1889925           151\n10          1437911           272\n11           158225           304\n12          1100620            44\n13           965357           223\n14          1105096           217\n15          1149742           130\n16           490335             7\n17          1856299           187\n18          1695410            19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01658,
                    "execution_time": 0.007418,
                    "compile_time": 5e-05,
                    "planning_time": 0.003061
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.162649,
                    "execution_time": 0.007624,
                    "compile_time": 0.10884,
                    "planning_time": 0.037587
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\"",
                "rewrite": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk\n0            930988           217\n1           1886229            88\n2            170690           212\n3            944456           368\n4            421736           250\n5            732588           340\n6            441485           142\n7           1451040           148\n8            250536           110\n9           1889925           151\n10          1437911           272\n11           158225           304\n12          1100620            44\n13           965357           223\n14          1105096           217\n15          1149742           130\n16           490335             7\n17          1856299           187\n18          1695410            19\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  ctr_customer_sk\nfrom customer_total_return ctr1\n,store\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 19.134603,
                    "execution_time": 19.037669,
                    "compile_time": 0.000316,
                    "planning_time": 0.023945,
                    "create_size": 12802
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.300956,
                    "execution_time": 19.199879,
                    "compile_time": 0.002072,
                    "planning_time": 0.034375,
                    "create_size": 12802
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk\n0           1729985\n1           1729985\n2           1729985\n3           1729985\n4           1729985\n5           1729985\n6           1729985\n7           1729985\n8           1729985\n9           1729985\n10          1729985\n11          1729985\n12          1729985\n13          1729985\n14          1729985\n15          1729985\n16          1729985\n17          1729985\n18          1729985\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016695,
                    "execution_time": 0.008117,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002878
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052798,
                    "execution_time": 0.00872,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.037463
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk\n0           1729985\n1           1729985\n2           1729985\n3           1729985\n4           1729985\n5           1729985\n6           1729985\n7           1729985\n8           1729985\n9           1729985\n10          1729985\n11          1729985\n12          1729985\n13          1729985\n14          1729985\n15          1729985\n16          1729985\n17          1729985\n18          1729985\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT MAX ( 1 ) AS \"_\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT MAX ( 1 ) AS \"_\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.424237,
                    "execution_time": 0.344369,
                    "compile_time": 0.000361,
                    "planning_time": 0.030263,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.522274,
                    "execution_time": 0.374155,
                    "compile_time": 0.003054,
                    "planning_time": 0.094583,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 1,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 2,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LIMIT 21",
                "preview": "\n/*       c_customer_id\n0   AAAAAAAAAHAJNBAA\n1   AAAAAAAAAHAJNBAA\n2   AAAAAAAAAHAJNBAA\n3   AAAAAAAAAHAJNBAA\n4   AAAAAAAAAHAJNBAA\n5   AAAAAAAAAHAJNBAA\n6   AAAAAAAAAHAJNBAA\n7   AAAAAAAAAHAJNBAA\n8   AAAAAAAAAHAJNBAA\n9   AAAAAAAAAHAJNBAA\n10  AAAAAAAAAHAJNBAA\n11  AAAAAAAAAHAJNBAA\n12  AAAAAAAAAHAJNBAA\n13  AAAAAAAAAHAJNBAA\n14  AAAAAAAAAHAJNBAA\n15  AAAAAAAAAHAJNBAA\n16  AAAAAAAAAHAJNBAA\n17  AAAAAAAAAHAJNBAA\n18  AAAAAAAAAHAJNBAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.084635,
                    "execution_time": 0.046704,
                    "compile_time": 0.000143,
                    "planning_time": 0.029545
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.131172,
                    "execution_time": 0.034511,
                    "compile_time": 0.001285,
                    "planning_time": 0.087114
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\""
            }
        ],
        "preview": "\n/*       c_customer_id\n0   AAAAAAAAAHAJNBAA\n1   AAAAAAAAAHAJNBAA\n2   AAAAAAAAAHAJNBAA\n3   AAAAAAAAAHAJNBAA\n4   AAAAAAAAAHAJNBAA\n5   AAAAAAAAAHAJNBAA\n6   AAAAAAAAAHAJNBAA\n7   AAAAAAAAAHAJNBAA\n8   AAAAAAAAAHAJNBAA\n9   AAAAAAAAAHAJNBAA\n10  AAAAAAAAAHAJNBAA\n11  AAAAAAAAAHAJNBAA\n12  AAAAAAAAAHAJNBAA\n13  AAAAAAAAAHAJNBAA\n14  AAAAAAAAAHAJNBAA\n15  AAAAAAAAAHAJNBAA\n16  AAAAAAAAAHAJNBAA\n17  AAAAAAAAAHAJNBAA\n18  AAAAAAAAAHAJNBAA\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.441605,
                    "execution_time": 0.264457,
                    "compile_time": 0.000255,
                    "planning_time": 0.002761,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.572175,
                    "execution_time": 0.285989,
                    "compile_time": 0.0499,
                    "planning_time": 0.057329,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_6\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.070707,
                    "execution_time": 0.040671,
                    "compile_time": 0.000321,
                    "planning_time": 0.003463,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.129566,
                    "execution_time": 0.042396,
                    "compile_time": 0.002276,
                    "planning_time": 0.058707,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 1,
                "create_metrics": {
                    "elapsed_time": 0.124163,
                    "execution_time": 0.06984,
                    "compile_time": 0.000358,
                    "planning_time": 0.038024,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.76001,
                    "execution_time": 0.602582,
                    "compile_time": 9.046144,
                    "planning_time": 0.096627,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []\nSpeQLite may make mistakes. Check important info.*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016774,
                    "execution_time": 0.007461,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003939
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052113,
                    "execution_time": 0.007128,
                    "compile_time": 0.000951,
                    "planning_time": 0.038636
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []\nSpeQLite may make mistakes. Check important info.*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.070865,
                    "execution_time": 0.041048,
                    "compile_time": 0.000327,
                    "planning_time": 0.003375,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.12847,
                    "execution_time": 0.045672,
                    "compile_time": 0.000318,
                    "planning_time": 0.057218,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 1,
                "create_metrics": {
                    "elapsed_time": 0.121674,
                    "execution_time": 0.070503,
                    "compile_time": 0.000382,
                    "planning_time": 0.032858,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.200824,
                    "execution_time": 0.087501,
                    "compile_time": 0.000375,
                    "planning_time": 0.096116,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []\nSpeQLite may make mistakes. Check important info.*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01723,
                    "execution_time": 0.007646,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003922
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051592,
                    "execution_time": 0.007457,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038629
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []\nSpeQLite may make mistakes. Check important info.*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.53791,
                    "execution_time": 0.290036,
                    "compile_time": 0.032434,
                    "planning_time": 0.002985,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.878119,
                    "execution_time": 0.303658,
                    "compile_time": 3.299091,
                    "planning_time": 0.056592,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080372,
                    "execution_time": 0.051387,
                    "compile_time": 0.000272,
                    "planning_time": 0.003631,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.138889,
                    "execution_time": 0.051863,
                    "compile_time": 0.003475,
                    "planning_time": 0.05769,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 1,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 2,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            },
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id\n0   AAAAAAAAMLAJNBAA\n1   AAAAAAAALMAJNBAA\n2   AAAAAAAAEPAJNBAA\n3   AAAAAAAAMCBJNBAA\n4   AAAAAAAANDBJNBAA\n5   AAAAAAAAPOBJNBAA\n6   AAAAAAAANCCJNBAA\n7   AAAAAAAAPMCJNBAA\n8   AAAAAAAALNCJNBAA\n9   AAAAAAAAKADJNBAA\n10  AAAAAAAAAFDJNBAA\n11  AAAAAAAAEKDJNBAA\n12  AAAAAAAAOMDJNBAA\n13  AAAAAAAAEJEJNBAA\n14  AAAAAAAAGJEJNBAA\n15  AAAAAAAAPKEJNBAA\n16  AAAAAAAAEAFJNBAA\n17  AAAAAAAAAFFJNBAA\n18  AAAAAAAAGIFJNBAA\n...*/",
                "retry_time": 1,
                "query_metrics": {
                    "elapsed_time": 0.165178,
                    "execution_time": 0.114445,
                    "compile_time": 0.000217,
                    "planning_time": 0.03933
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.172537,
                    "execution_time": 0.118932,
                    "compile_time": 4.943426,
                    "planning_time": 0.096657
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id\n0   AAAAAAAAMLAJNBAA\n1   AAAAAAAALMAJNBAA\n2   AAAAAAAAEPAJNBAA\n3   AAAAAAAAMCBJNBAA\n4   AAAAAAAANDBJNBAA\n5   AAAAAAAAPOBJNBAA\n6   AAAAAAAANCCJNBAA\n7   AAAAAAAAPMCJNBAA\n8   AAAAAAAALNCJNBAA\n9   AAAAAAAAKADJNBAA\n10  AAAAAAAAAFDJNBAA\n11  AAAAAAAAEKDJNBAA\n12  AAAAAAAAOMDJNBAA\n13  AAAAAAAAEJEJNBAA\n14  AAAAAAAAGJEJNBAA\n15  AAAAAAAAPKEJNBAA\n16  AAAAAAAAEAFJNBAA\n17  AAAAAAAAAFFJNBAA\n18  AAAAAAAAGIFJNBAA\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 1,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 2,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id\n0   AAAAAAAAAHAJNBAA\n1   AAAAAAAAAHAJNBAA\n2   AAAAAAAAAHAJNBAA\n3   AAAAAAAAAHAJNBAA\n4   AAAAAAAAAHAJNBAA\n5   AAAAAAAAAHAJNBAA\n6   AAAAAAAAAHAJNBAA\n7   AAAAAAAAAHAJNBAA\n8   AAAAAAAAAHAJNBAA\n9   AAAAAAAAAHAJNBAA\n10  AAAAAAAAAHAJNBAA\n11  AAAAAAAAAHAJNBAA\n12  AAAAAAAAAHAJNBAA\n13  AAAAAAAAAHAJNBAA\n14  AAAAAAAAAHAJNBAA\n15  AAAAAAAAAHAJNBAA\n16  AAAAAAAAAHAJNBAA\n17  AAAAAAAAAHAJNBAA\n18  AAAAAAAAAHAJNBAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.249667,
                    "execution_time": 5.203484,
                    "compile_time": 0.000207,
                    "planning_time": 0.03458
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.254392,
                    "execution_time": 5.146433,
                    "compile_time": 0.001932,
                    "planning_time": 0.094263
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id\n0   AAAAAAAAAHAJNBAA\n1   AAAAAAAAAHAJNBAA\n2   AAAAAAAAAHAJNBAA\n3   AAAAAAAAAHAJNBAA\n4   AAAAAAAAAHAJNBAA\n5   AAAAAAAAAHAJNBAA\n6   AAAAAAAAAHAJNBAA\n7   AAAAAAAAAHAJNBAA\n8   AAAAAAAAAHAJNBAA\n9   AAAAAAAAAHAJNBAA\n10  AAAAAAAAAHAJNBAA\n11  AAAAAAAAAHAJNBAA\n12  AAAAAAAAAHAJNBAA\n13  AAAAAAAAAHAJNBAA\n14  AAAAAAAAAHAJNBAA\n15  AAAAAAAAAHAJNBAA\n16  AAAAAAAAAHAJNBAA\n17  AAAAAAAAAHAJNBAA\n18  AAAAAAAAAHAJNBAA\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.108164,
                    "execution_time": 0.045728,
                    "compile_time": 0.000352,
                    "planning_time": 0.035103,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.658232,
                    "execution_time": 0.213385,
                    "compile_time": 3.313673,
                    "planning_time": 0.101925,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016863,
                    "execution_time": 0.007182,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003995
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05172,
                    "execution_time": 0.00721,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038643
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.079866,
                    "execution_time": 0.05109,
                    "compile_time": 0.000266,
                    "planning_time": 0.003883,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.187012,
                    "execution_time": 0.103314,
                    "compile_time": 0.000265,
                    "planning_time": 0.058477,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.10556,
                    "execution_time": 0.040983,
                    "compile_time": 0.000408,
                    "planning_time": 0.034851,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.303402,
                    "execution_time": 0.169256,
                    "compile_time": 0.004937,
                    "planning_time": 0.098933,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016543,
                    "execution_time": 0.007031,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003938
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051387,
                    "execution_time": 0.007246,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038545
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017117,
                    "execution_time": 0.007861,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.003953
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053732,
                    "execution_time": 0.008367,
                    "compile_time": 0.001784,
                    "planning_time": 0.038829
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017898,
                    "execution_time": 0.008318,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.0042
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019381,
                    "execution_time": 0.008722,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.004143
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    }
]