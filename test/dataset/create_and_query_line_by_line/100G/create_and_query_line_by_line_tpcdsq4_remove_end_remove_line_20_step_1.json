[
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.477954,
                    "execution_time": 0.656244,
                    "compile_time": 0.189619,
                    "planning_time": 0.024499,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.898119,
                    "execution_time": 4.536513,
                    "compile_time": 9.716965,
                    "planning_time": 0.024334,
                    "create_size": 1408
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.16901,
                    "execution_time": 0.03955,
                    "compile_time": 0.066967,
                    "planning_time": 0.023486,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.190867,
                    "execution_time": 0.041486,
                    "compile_time": 3.082018,
                    "planning_time": 0.024057,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 13.257722,
                    "execution_time": 12.632616,
                    "compile_time": 0.106861,
                    "planning_time": 0.059655,
                    "create_size": 2304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 26.337671,
                    "execution_time": 15.037727,
                    "compile_time": 13.106336,
                    "planning_time": 0.063169,
                    "create_size": 2304
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                      customer_email_address\n0   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n1   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n2   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n3   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n4   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n5   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n6   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n7   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n8   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n9   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n10  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n11  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n12  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n13  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n14  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n15  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n16  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n17  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n18  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.983462,
                    "execution_time": 0.944147,
                    "compile_time": 0.000588,
                    "planning_time": 0.016761
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.155048,
                    "execution_time": 1.014307,
                    "compile_time": 3.056836,
                    "planning_time": 0.053801
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                      customer_email_address\n0   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n1   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n2   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n3   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n4   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n5   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n6   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n7   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n8   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n9   AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n10  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n11  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n12  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n13  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n14  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n15  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n16  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n17  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n18  AAAAAAAABMHKHAAA           Nathaniel            Sargent  Nathaniel.Sargent@yXQ4b5BGuyDQU5fSjMmp.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name           customer_email_address\n0   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n1   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n2   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n3   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n4   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n5   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n6   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n7   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n8   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n9   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n10  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n11  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n12  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n13  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n14  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n15  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n16  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n17  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n18  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.910615,
                    "execution_time": 0.86949,
                    "compile_time": 0.000651,
                    "planning_time": 0.0172
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.879084,
                    "execution_time": 0.798582,
                    "compile_time": 0.000665,
                    "planning_time": 0.054765
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name           customer_email_address\n0   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n1   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n2   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n3   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n4   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n5   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n6   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n7   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n8   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n9   AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n10  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n11  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n12  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n13  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n14  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n15  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n16  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n17  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n18  AAAAAAAABAFDAAAA           Elizabeth             Havens  Elizabeth.Havens@IDu6iy24SU.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 13.246049,
                    "execution_time": 12.683123,
                    "compile_time": 0.001146,
                    "planning_time": 0.0625,
                    "create_size": 2432
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 16.258118,
                    "execution_time": 12.711124,
                    "compile_time": 4.371395,
                    "planning_time": 0.06226,
                    "create_size": 2432
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                    customer_email_address\n0   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n1   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n2   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n3   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n4   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n5   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n6   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n7   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n8   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n9   AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n10  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n11  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n12  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n13  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n14  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n15  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n16  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n17  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n18  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.607443,
                    "execution_time": 0.564012,
                    "compile_time": 0.000636,
                    "planning_time": 0.019556
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.547684,
                    "execution_time": 0.623145,
                    "compile_time": 2.840434,
                    "planning_time": 0.057609
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                    customer_email_address\n0   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n1   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n2   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n3   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n4   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n5   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n6   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n7   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n8   AAAAAAAAJGHIEBAA                Alda               Farr                          Alda.Farr@CG.org\n9   AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n10  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n11  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n12  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n13  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n14  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n15  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n16  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n17  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n18  AAAAAAAAIKJCNBAA           Elizabeth             Holder  Elizabeth.Holder@U7ygYajTvzaRPyY5rK2.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.849762,
                    "execution_time": 2.430063,
                    "compile_time": 0.000894,
                    "planning_time": 0.020955,
                    "create_size": 3072
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.991313,
                    "execution_time": 2.391582,
                    "compile_time": 10.088712,
                    "planning_time": 0.089806,
                    "create_size": 3072
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n1   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n2   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n3   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n4   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n5   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n6   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n7   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n8   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n9   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n10  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n11  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n12  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n13  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n14  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n15  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n16  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n17  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n18  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016526,
                    "execution_time": 0.007498,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003207
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.118563,
                    "execution_time": 0.00795,
                    "compile_time": 3.063675,
                    "planning_time": 0.038798
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n1   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n2   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n3   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n4   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n5   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n6   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n7   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n8   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n9   AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n10  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n11  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n12  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n13  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n14  AAAAAAAAIMOANAAA               Karen          Mcclinton      Karen.Mcclinton@xpEYC.edu\n15  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n16  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n17  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n18  AAAAAAAAGAGEHAAA             Anthony           Quinones  Anthony.Quinones@MK1cYtgA.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n1   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n2   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n3   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n4   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n5   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n6   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n7   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n8   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n9   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n10  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n11  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n12  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n13  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n14  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n15  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n16  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n17  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n18  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.053465,
                    "execution_time": 0.033519,
                    "compile_time": 0.032254,
                    "planning_time": 0.004861
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.145175,
                    "execution_time": 0.036188,
                    "compile_time": 3.08508,
                    "planning_time": 0.040229
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n1   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n2   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n3   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n4   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n5   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n6   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n7   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n8   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n9   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n10  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n11  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n12  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n13  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n14  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n15  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n16  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n17  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n18  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name            customer_email_address\n0   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n1   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n2   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n3   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n4   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n5   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n6   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n7   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n8   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n9   AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n10  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n11  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n12  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n13  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n14  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n15  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n16  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n17  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n18  AAAAAAAAKEANKAAA               Jodie               Hale    Jodie.Hale@pEKEqIcOFZRtqiK.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 3.774266,
                    "execution_time": 3.759132,
                    "compile_time": 0.000155,
                    "planning_time": 0.006316
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.566723,
                    "execution_time": 3.49746,
                    "compile_time": 2.030808,
                    "planning_time": 0.041694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name            customer_email_address\n0   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n1   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n2   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n3   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n4   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n5   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n6   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n7   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n8   AAAAAAAAHBAIHBAA             Barbara                Lee       Barbara.Lee@duZZZxp7zHp.edu\n9   AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n10  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n11  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n12  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n13  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n14  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n15  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n16  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n17  AAAAAAAADIADMAAA               Helen           Williams  Helen.Williams@Mis7VC6Bv1Eoj.com\n18  AAAAAAAAKEANKAAA               Jodie               Hale    Jodie.Hale@pEKEqIcOFZRtqiK.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n1   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n2   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n3   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n4   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n5   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n6   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n7   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n8   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n9   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n10  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n11  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n12  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n13  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n14  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n15  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n16  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n17  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n18  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.182763,
                    "execution_time": 0.163402,
                    "compile_time": 0.000211,
                    "planning_time": 0.008142
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.523096,
                    "execution_time": 0.170831,
                    "compile_time": 3.294842,
                    "planning_time": 0.04404
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n1   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n2   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n3   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n4   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n5   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n6   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n7   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n8   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n9   AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n10  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n11  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n12  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n13  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n14  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n15  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n16  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n17  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n18  AAAAAAAAAPLBLBAA              Steven               Bell     Steven.Bell@yF.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAANDPAJBAA               Lynne           Robinson    Lynne.Robinson@CSMF84qO1DegsN.org\n1   AAAAAAAAFPNGFBAA              George              Baker            George.Baker@JKljYvbi.org\n2   AAAAAAAAKOINHAAA              Joseph            Stewart          Joseph.Stewart@725LikJA.org\n3   AAAAAAAAPFOIDBAA               Susan              Brown           Susan.Brown@dU55JGqc30.com\n4   AAAAAAAAMLEKJBAA              Daniel               Ball           Daniel.Ball@EuEiXLGbPV.org\n5   AAAAAAAANNNMLBAA              Renato                 Yi                   Renato.Yi@4PDk.edu\n6   AAAAAAAAJCBJGBAA             Winford             Petrie               Winford.Petrie@C1N.org\n7   AAAAAAAANPIBFBAA              Thomas            Fajardo  Thomas.Fajardo@RaFT0Nl72rvP2K2Y.edu\n8   AAAAAAAAGHLFCBAA             Gustavo             Dalton               Gustavo.Dalton@vpP.com\n9   AAAAAAAAKNHLHBAA               James           Campbell       James.Campbell@LhAe8aRorab.org\n10  AAAAAAAALIAJKBAA              Curtis              Butts                                     \n11  AAAAAAAAJPKKGBAA            Jennifer                Kay          Jennifer.Kay@KbnSUHOP0D.com\n12  AAAAAAAAJANHGBAA               Wilma           Blackmon      Wilma.Blackmon@NTUIeAu60FIt.edu\n13  AAAAAAAAFBNEEBAA              Howard            Shirley  Howard.Shirley@zCppvygItExgxtlC.com\n14  AAAAAAAANPLEAAAA             Gregory            Watkins     Gregory.Watkins@33oIQydIjzXp.org\n15  AAAAAAAADNACDAAA              Alyssa            Woodard         Alyssa.Woodard@UxT66SlRo.org\n16  AAAAAAAAMHHNJAAA              Harold              Seely          Harold.Seely@7Pdsx4qzud.edu\n17  AAAAAAAADJEGGBAA              Dustin             Rendon   Dustin.Rendon@qizQd1cHMpQpuU8H.org\n18  AAAAAAAAMCKINAAA            Virginia           Anderson           Virginia.Anderson@caEx.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.948289,
                    "execution_time": 5.490616,
                    "compile_time": 0.003294,
                    "planning_time": 0.345523
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 23.030423,
                    "execution_time": 5.495292,
                    "compile_time": 17.082213,
                    "planning_time": 0.422679
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAANDPAJBAA               Lynne           Robinson    Lynne.Robinson@CSMF84qO1DegsN.org\n1   AAAAAAAAFPNGFBAA              George              Baker            George.Baker@JKljYvbi.org\n2   AAAAAAAAKOINHAAA              Joseph            Stewart          Joseph.Stewart@725LikJA.org\n3   AAAAAAAAPFOIDBAA               Susan              Brown           Susan.Brown@dU55JGqc30.com\n4   AAAAAAAAMLEKJBAA              Daniel               Ball           Daniel.Ball@EuEiXLGbPV.org\n5   AAAAAAAANNNMLBAA              Renato                 Yi                   Renato.Yi@4PDk.edu\n6   AAAAAAAAJCBJGBAA             Winford             Petrie               Winford.Petrie@C1N.org\n7   AAAAAAAANPIBFBAA              Thomas            Fajardo  Thomas.Fajardo@RaFT0Nl72rvP2K2Y.edu\n8   AAAAAAAAGHLFCBAA             Gustavo             Dalton               Gustavo.Dalton@vpP.com\n9   AAAAAAAAKNHLHBAA               James           Campbell       James.Campbell@LhAe8aRorab.org\n10  AAAAAAAALIAJKBAA              Curtis              Butts                                     \n11  AAAAAAAAJPKKGBAA            Jennifer                Kay          Jennifer.Kay@KbnSUHOP0D.com\n12  AAAAAAAAJANHGBAA               Wilma           Blackmon      Wilma.Blackmon@NTUIeAu60FIt.edu\n13  AAAAAAAAFBNEEBAA              Howard            Shirley  Howard.Shirley@zCppvygItExgxtlC.com\n14  AAAAAAAANPLEAAAA             Gregory            Watkins     Gregory.Watkins@33oIQydIjzXp.org\n15  AAAAAAAADNACDAAA              Alyssa            Woodard         Alyssa.Woodard@UxT66SlRo.org\n16  AAAAAAAAMHHNJAAA              Harold              Seely          Harold.Seely@7Pdsx4qzud.edu\n17  AAAAAAAADJEGGBAA              Dustin             Rendon   Dustin.Rendon@qizQd1cHMpQpuU8H.org\n18  AAAAAAAAMCKINAAA            Virginia           Anderson           Virginia.Anderson@caEx.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15.095945,
                    "execution_time": 14.370326,
                    "compile_time": 0.001211,
                    "planning_time": 0.065286,
                    "create_size": 2816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.409781,
                    "execution_time": 14.678118,
                    "compile_time": 0.001172,
                    "planning_time": 0.065242,
                    "create_size": 2816
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.820023,
                    "execution_time": 0.364134,
                    "compile_time": 0.000734,
                    "planning_time": 0.027394,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.37158,
                    "execution_time": 0.360115,
                    "compile_time": 14.558552,
                    "planning_time": 0.087816,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAABFBNJBAA             Natalya               Carr          Natalya.Carr@iHeLaRsgls.com\n1   AAAAAAAAEEPEAAAA                Anna              Jones                     Anna.Jones@L.org\n2   AAAAAAAAPPCPJAAA             Michael           Franklin  Michael.Franklin@rbdJ60YBhIYtBC.edu\n3   AAAAAAAANOKNCAAA             Shameka               Cook                  Shameka.Cook@Qc.edu\n4   AAAAAAAAOINPLBAA                Erik              Perez              Erik.Perez@r1zLbx8z.org\n5   AAAAAAAAFOPOFAAA               Ethel            Ramirez     Ethel.Ramirez@qo5KukluOcL4bG.edu\n6   AAAAAAAAFKCKMAAA            Emmanuel            Conklin   Emmanuel.Conklin@dBirAtfPIrLX6.com\n7   AAAAAAAAIBDFPAAA               Elmer           Williams   Elmer.Williams@Lgv2PNsDLKtk0sA.edu\n8   AAAAAAAAEHBBHBAA             William            Jackson   William.Jackson@KKGBJbF7q6QBn3.com\n9   AAAAAAAADLGGBAAA             Deborah              Ramos               Deborah.Ramos@ptib.com\n10  AAAAAAAAGFEEIAAA            Mauricio             Hayden    Mauricio.Hayden@zN3msqbYtOfNI.org\n11  AAAAAAAALNJCKAAA               Danny             Carter           Danny.Carter@2VeUERBFX.org\n12  AAAAAAAANOEPKBAA                Lisa              Diehl                     Lisa.Diehl@R.com\n13  AAAAAAAAHKCOEBAA             Tiffany            Puckett       Tiffany.Puckett@xOEa5ogcG4.com\n14  AAAAAAAAJKEINAAA               Larry             Lester               Larry.Lester@j4UkJ.com\n15  AAAAAAAADJPJCBAA                John             Hooper               John.Hooper@2bVyAD.com\n16  AAAAAAAAEGLHCBAA              Reggie            Hubbard            Reggie.Hubbard@KyfbOU.org\n17  AAAAAAAAFLLOBAAA               Corey              Gibbs       Corey.Gibbs@xF6hNF3BUYZ1Lt.com\n18  AAAAAAAANJAFJAAA                 Amy         Washington     Amy.Washington@AtNK518jnEy2b.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016546,
                    "execution_time": 0.007472,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053807,
                    "execution_time": 0.008032,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038625
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAABFBNJBAA             Natalya               Carr          Natalya.Carr@iHeLaRsgls.com\n1   AAAAAAAAEEPEAAAA                Anna              Jones                     Anna.Jones@L.org\n2   AAAAAAAAPPCPJAAA             Michael           Franklin  Michael.Franklin@rbdJ60YBhIYtBC.edu\n3   AAAAAAAANOKNCAAA             Shameka               Cook                  Shameka.Cook@Qc.edu\n4   AAAAAAAAOINPLBAA                Erik              Perez              Erik.Perez@r1zLbx8z.org\n5   AAAAAAAAFOPOFAAA               Ethel            Ramirez     Ethel.Ramirez@qo5KukluOcL4bG.edu\n6   AAAAAAAAFKCKMAAA            Emmanuel            Conklin   Emmanuel.Conklin@dBirAtfPIrLX6.com\n7   AAAAAAAAIBDFPAAA               Elmer           Williams   Elmer.Williams@Lgv2PNsDLKtk0sA.edu\n8   AAAAAAAAEHBBHBAA             William            Jackson   William.Jackson@KKGBJbF7q6QBn3.com\n9   AAAAAAAADLGGBAAA             Deborah              Ramos               Deborah.Ramos@ptib.com\n10  AAAAAAAAGFEEIAAA            Mauricio             Hayden    Mauricio.Hayden@zN3msqbYtOfNI.org\n11  AAAAAAAALNJCKAAA               Danny             Carter           Danny.Carter@2VeUERBFX.org\n12  AAAAAAAANOEPKBAA                Lisa              Diehl                     Lisa.Diehl@R.com\n13  AAAAAAAAHKCOEBAA             Tiffany            Puckett       Tiffany.Puckett@xOEa5ogcG4.com\n14  AAAAAAAAJKEINAAA               Larry             Lester               Larry.Lester@j4UkJ.com\n15  AAAAAAAADJPJCBAA                John             Hooper               John.Hooper@2bVyAD.com\n16  AAAAAAAAEGLHCBAA              Reggie            Hubbard            Reggie.Hubbard@KyfbOU.org\n17  AAAAAAAAFLLOBAAA               Corey              Gibbs       Corey.Gibbs@xF6hNF3BUYZ1Lt.com\n18  AAAAAAAANJAFJAAA                 Amy         Washington     Amy.Washington@AtNK518jnEy2b.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and (case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end) is not null\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.808196,
                    "execution_time": 0.382144,
                    "compile_time": 0.000728,
                    "planning_time": 0.028652,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.917223,
                    "execution_time": 0.377875,
                    "compile_time": 7.019207,
                    "planning_time": 0.097464,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAJFKANBAA             Heather              Brown                 Heather.Brown@tax76.org\n1   AAAAAAAALJLAKAAA               David             Valdez            David.Valdez@uAymTb6dBiF.com\n2   AAAAAAAAGLLNHBAA             Mildred           Martinez  Mildred.Martinez@ZclftBNNCxP1LeFfc.edu\n3   AAAAAAAAHKPICBAA              Sandra             Reaves       Sandra.Reaves@BbVLiqmuqUjbMKG.edu\n4   AAAAAAAAOEDEBAAA             Phillip            Jackson             Phillip.Jackson@a16q94R.org\n5   AAAAAAAADPALLBAA               Bryan              Watts                       Bryan.Watts@9.com\n6   AAAAAAAAALCELAAA           Elizabeth               Free    Elizabeth.Free@o7szMTNivZPx9jVgn.edu\n7   AAAAAAAAEBBLJAAA                                                Richard.Sanders@gRuHk8VBpYT.org\n8   AAAAAAAAHJBKEBAA                Mark             Flores                     Mark.Flores@PgC.org\n9   AAAAAAAAGBANBBAA              Brenna              Clark             Brenna.Clark@om6jliqYHQ.edu\n10  AAAAAAAAMFPFOBAA             Armando             Felder               Armando.Felder@K0LgEX.org\n11  AAAAAAAALGNHDBAA               David            Delgado                 David.Delgado@cLzX1.edu\n12  AAAAAAAAJNINFAAA                Marc           Ferguson       Marc.Ferguson@rZyLRetNjdf2UAK.org\n13  AAAAAAAAIBPBDBAA             Gilbert              Jones            Gilbert.Jones@2kkIfa2dYj.edu\n14  AAAAAAAABDDKFBAA             Mildred            Morales   Mildred.Morales@8uXNiBoc73tuHebOI.edu\n15  AAAAAAAAKLIIHAAA               Wendy             Mercer                     Wendy.Mercer@gk.com\n16  AAAAAAAABMDFNAAA             Stephen         Farnsworth    Stephen.Farnsworth@TlnoGnMFx0Rfz.org\n17  AAAAAAAAGFNKEBAA                John              Green                   John.Green@GpdlY8.com\n18  AAAAAAAACOEPABAA               David             Wilson                     David.Wilson@xA.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016911,
                    "execution_time": 0.007685,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.003369
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05319,
                    "execution_time": 0.008277,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.038621
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAJFKANBAA             Heather              Brown                 Heather.Brown@tax76.org\n1   AAAAAAAALJLAKAAA               David             Valdez            David.Valdez@uAymTb6dBiF.com\n2   AAAAAAAAGLLNHBAA             Mildred           Martinez  Mildred.Martinez@ZclftBNNCxP1LeFfc.edu\n3   AAAAAAAAHKPICBAA              Sandra             Reaves       Sandra.Reaves@BbVLiqmuqUjbMKG.edu\n4   AAAAAAAAOEDEBAAA             Phillip            Jackson             Phillip.Jackson@a16q94R.org\n5   AAAAAAAADPALLBAA               Bryan              Watts                       Bryan.Watts@9.com\n6   AAAAAAAAALCELAAA           Elizabeth               Free    Elizabeth.Free@o7szMTNivZPx9jVgn.edu\n7   AAAAAAAAEBBLJAAA                                                Richard.Sanders@gRuHk8VBpYT.org\n8   AAAAAAAAHJBKEBAA                Mark             Flores                     Mark.Flores@PgC.org\n9   AAAAAAAAGBANBBAA              Brenna              Clark             Brenna.Clark@om6jliqYHQ.edu\n10  AAAAAAAAMFPFOBAA             Armando             Felder               Armando.Felder@K0LgEX.org\n11  AAAAAAAALGNHDBAA               David            Delgado                 David.Delgado@cLzX1.edu\n12  AAAAAAAAJNINFAAA                Marc           Ferguson       Marc.Ferguson@rZyLRetNjdf2UAK.org\n13  AAAAAAAAIBPBDBAA             Gilbert              Jones            Gilbert.Jones@2kkIfa2dYj.edu\n14  AAAAAAAABDDKFBAA             Mildred            Morales   Mildred.Morales@8uXNiBoc73tuHebOI.edu\n15  AAAAAAAAKLIIHAAA               Wendy             Mercer                     Wendy.Mercer@gk.com\n16  AAAAAAAABMDFNAAA             Stephen         Farnsworth    Stephen.Farnsworth@TlnoGnMFx0Rfz.org\n17  AAAAAAAAGFNKEBAA                John              Green                   John.Green@GpdlY8.com\n18  AAAAAAAACOEPABAA               David             Wilson                     David.Wilson@xA.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.712998,
                    "execution_time": 0.442586,
                    "compile_time": 0.033725,
                    "planning_time": 0.030921,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.036704,
                    "execution_time": 0.463403,
                    "compile_time": 13.315456,
                    "planning_time": 0.089834,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAHFHKDBAA            Marshall              Burke            Marshall.Burke@x5lczC.org\n1   AAAAAAAADCCDHBAA             Michael              Moore       Michael.Moore@PqlPOMRtP8EJ.com\n2   AAAAAAAAHJKNHAAA               Helen              Smith  Helen.Smith@CqFT7QX7uuDcZpDAf09.org\n3   AAAAAAAAHDEKEBAA               Frank              Heard      Frank.Heard@ALM1kOBQZ5DkVRd.org\n4   AAAAAAAAHJBIABAA               Craig             Webber      Craig.Webber@g093BpxrtvAM7g.org\n5   AAAAAAAANHBLJBAA            Nicholas               Pace               Nicholas.Pace@rfRA.edu\n6   AAAAAAAAOIKMGBAA              Joseph              White            Joseph.White@G8la45Ai.edu\n7   AAAAAAAAGMGKIBAA             Timothy               Teel    Timothy.Teel@FIHcRbYLgOQ8Q6le.com\n8   AAAAAAAAEMHJEBAA               Elsie             Walker              Elsie.Walker@nUoYQB.com\n9   AAAAAAAABBIMLAAA               Glenn              Moore        Glenn.Moore@5bOL8Vtx2l44I.com\n10  AAAAAAAAKMGKFAAA            Lorraine               Sosa     Lorraine.Sosa@JcIp8YaB6CelnH.com\n11  AAAAAAAAGJDGDAAA                Paul             Carter               Paul.Carter@p54tcK.org\n12  AAAAAAAAIOFJBAAA            Veronica            Ferrell     Veronica.Ferrell@1kZo4j50i2a.edu\n13  AAAAAAAACLGGDBAA              Rafael               Wood          Rafael.Wood@dbCl2RxUpeA.org\n14  AAAAAAAACBLHJBAA               Andre              Smith           Andre.Smith@bMj1otXqqK.com\n15  AAAAAAAAGGBEJBAA              Cedric           Chalmers      Cedric.Chalmers@gvKpz4IZHUF.edu\n16  AAAAAAAAILCPIAAA              Joseph           Ferguson       Joseph.Ferguson@VdkVo9TlZ3.org\n17  AAAAAAAACGOJEBAA               Penny               Rice          Penny.Rice@CudhJXVimyGl.com\n18  AAAAAAAAHFHIABAA               Tammy                                                        \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017532,
                    "execution_time": 0.008169,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003412
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053221,
                    "execution_time": 0.00774,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038407
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAHFHKDBAA            Marshall              Burke            Marshall.Burke@x5lczC.org\n1   AAAAAAAADCCDHBAA             Michael              Moore       Michael.Moore@PqlPOMRtP8EJ.com\n2   AAAAAAAAHJKNHAAA               Helen              Smith  Helen.Smith@CqFT7QX7uuDcZpDAf09.org\n3   AAAAAAAAHDEKEBAA               Frank              Heard      Frank.Heard@ALM1kOBQZ5DkVRd.org\n4   AAAAAAAAHJBIABAA               Craig             Webber      Craig.Webber@g093BpxrtvAM7g.org\n5   AAAAAAAANHBLJBAA            Nicholas               Pace               Nicholas.Pace@rfRA.edu\n6   AAAAAAAAOIKMGBAA              Joseph              White            Joseph.White@G8la45Ai.edu\n7   AAAAAAAAGMGKIBAA             Timothy               Teel    Timothy.Teel@FIHcRbYLgOQ8Q6le.com\n8   AAAAAAAAEMHJEBAA               Elsie             Walker              Elsie.Walker@nUoYQB.com\n9   AAAAAAAABBIMLAAA               Glenn              Moore        Glenn.Moore@5bOL8Vtx2l44I.com\n10  AAAAAAAAKMGKFAAA            Lorraine               Sosa     Lorraine.Sosa@JcIp8YaB6CelnH.com\n11  AAAAAAAAGJDGDAAA                Paul             Carter               Paul.Carter@p54tcK.org\n12  AAAAAAAAIOFJBAAA            Veronica            Ferrell     Veronica.Ferrell@1kZo4j50i2a.edu\n13  AAAAAAAACLGGDBAA              Rafael               Wood          Rafael.Wood@dbCl2RxUpeA.org\n14  AAAAAAAACBLHJBAA               Andre              Smith           Andre.Smith@bMj1otXqqK.com\n15  AAAAAAAAGGBEJBAA              Cedric           Chalmers      Cedric.Chalmers@gvKpz4IZHUF.edu\n16  AAAAAAAAILCPIAAA              Joseph           Ferguson       Joseph.Ferguson@VdkVo9TlZ3.org\n17  AAAAAAAACGOJEBAA               Penny               Rice          Penny.Rice@CudhJXVimyGl.com\n18  AAAAAAAAHFHIABAA               Tammy                                                        \n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'s' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'c' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'w' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n )\n select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.755663,
                    "execution_time": 1.476631,
                    "compile_time": 0.23279,
                    "planning_time": 1.548293,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 18.197302,
                    "execution_time": 2.759068,
                    "compile_time": 14.345461,
                    "planning_time": 12.184751,
                    "create_size": 1408
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.219719,
                    "execution_time": 0.057289,
                    "compile_time": 0.093799,
                    "planning_time": 0.030923,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.59303,
                    "execution_time": 0.05549,
                    "compile_time": 9.399638,
                    "planning_time": 0.091452,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [customer_id, customer_first_name, customer_last_name, customer_email_address]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017442,
                    "execution_time": 0.007178,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004368
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054241,
                    "execution_time": 0.007827,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039449
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [customer_id, customer_first_name, customer_last_name, customer_email_address]\nIndex: []*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.542481,
                    "execution_time": 0.359336,
                    "compile_time": 0.000747,
                    "planning_time": 0.030985,
                    "create_size": 651
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 18.223549,
                    "execution_time": 0.41873,
                    "compile_time": 17.575724,
                    "planning_time": 0.091709,
                    "create_size": 658
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAILFHJAAA               James          Henderson       James.Henderson@qXrrMX2Np9g.com\n1   AAAAAAAALAEDGAAA                Judy             Flores                   Judy.Flores@Tt3.edu\n2   AAAAAAAANLFFABAA               Louis             Turner                    Louis.Turner@g.edu\n3   AAAAAAAAKBBAPAAA               James             Oliver     James.Oliver@bNPYvCQjTSSOE85Q.edu\n4   AAAAAAAABBJGGBAA                                Oconnor                                      \n5   AAAAAAAAECPLMBAA               Emile              Romeo        Emile.Romeo@tavLD0oKp2ZMHP.edu\n6   AAAAAAAAMJHCNBAA            Margaret              Green   Margaret.Green@23HHiniKiLnHC9Qh.com\n7   AAAAAAAALAJICAAA                John           Douglass                  John.Douglass@km.com\n8   AAAAAAAAPJAHBAAA              Tricia              Pitts             Tricia.Pitts@lbSNEEpJ.org\n9   AAAAAAAALDJJFAAA         Jackqueline                Hsu  Jackqueline.Hsu@nBf9mCdmP6Fm5N1N.edu\n10  AAAAAAAAJMGMKAAA                Alan               Wall                 Alan.Wall@ufk5hof.edu\n11  AAAAAAAAPHIKMAAA               Brian             Bailey              Brian.Bailey@6GeGCUu.edu\n12  AAAAAAAAECNGKAAA              Javier           Zaragoza     Javier.Zaragoza@xj6YD9RZCB5I1.com\n13  AAAAAAAAGAGODAAA             Richard               Meza        Richard.Meza@Ds4sQfy9NfTJs.com\n14  AAAAAAAAPHOBHAAA             Vincent             Wilson               Vincent.Wilson@ndec.org\n15  AAAAAAAAODALDBAA            Nicholas             Hopper        Nicholas.Hopper@HOVMqmfjaA.org\n16  AAAAAAAAOLMDNBAA           Guillermo           Williams     Guillermo.Williams@ke0xhZr1HF.com\n17  AAAAAAAACMNDMAAA               Vance               Hyde         Vance.Hyde@1kf6I0zvinvCOD.edu\n18  AAAAAAAAFCJNMAAA               Debra           Guerrero            Debra.Guerrero@eO0vnPD.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016422,
                    "execution_time": 0.00728,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003317
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053519,
                    "execution_time": 0.00829,
                    "compile_time": 5e-05,
                    "planning_time": 0.038378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAILFHJAAA               James          Henderson       James.Henderson@qXrrMX2Np9g.com\n1   AAAAAAAALAEDGAAA                Judy             Flores                   Judy.Flores@Tt3.edu\n2   AAAAAAAANLFFABAA               Louis             Turner                    Louis.Turner@g.edu\n3   AAAAAAAAKBBAPAAA               James             Oliver     James.Oliver@bNPYvCQjTSSOE85Q.edu\n4   AAAAAAAABBJGGBAA                                Oconnor                                      \n5   AAAAAAAAECPLMBAA               Emile              Romeo        Emile.Romeo@tavLD0oKp2ZMHP.edu\n6   AAAAAAAAMJHCNBAA            Margaret              Green   Margaret.Green@23HHiniKiLnHC9Qh.com\n7   AAAAAAAALAJICAAA                John           Douglass                  John.Douglass@km.com\n8   AAAAAAAAPJAHBAAA              Tricia              Pitts             Tricia.Pitts@lbSNEEpJ.org\n9   AAAAAAAALDJJFAAA         Jackqueline                Hsu  Jackqueline.Hsu@nBf9mCdmP6Fm5N1N.edu\n10  AAAAAAAAJMGMKAAA                Alan               Wall                 Alan.Wall@ufk5hof.edu\n11  AAAAAAAAPHIKMAAA               Brian             Bailey              Brian.Bailey@6GeGCUu.edu\n12  AAAAAAAAECNGKAAA              Javier           Zaragoza     Javier.Zaragoza@xj6YD9RZCB5I1.com\n13  AAAAAAAAGAGODAAA             Richard               Meza        Richard.Meza@Ds4sQfy9NfTJs.com\n14  AAAAAAAAPHOBHAAA             Vincent             Wilson               Vincent.Wilson@ndec.org\n15  AAAAAAAAODALDBAA            Nicholas             Hopper        Nicholas.Hopper@HOVMqmfjaA.org\n16  AAAAAAAAOLMDNBAA           Guillermo           Williams     Guillermo.Williams@ke0xhZr1HF.com\n17  AAAAAAAACMNDMAAA               Vance               Hyde         Vance.Hyde@1kf6I0zvinvCOD.edu\n18  AAAAAAAAFCJNMAAA               Debra           Guerrero            Debra.Guerrero@eO0vnPD.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03826,
                    "execution_time": 0.011171,
                    "compile_time": 0.017445,
                    "planning_time": 0.003617
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.249059,
                    "execution_time": 0.011783,
                    "compile_time": 3.19906,
                    "planning_time": 0.038377
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035312,
                    "execution_time": 0.011426,
                    "compile_time": 0.014567,
                    "planning_time": 0.00355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.102697,
                    "execution_time": 0.011934,
                    "compile_time": 5.053159,
                    "planning_time": 0.038805
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039267,
                    "execution_time": 0.011864,
                    "compile_time": 0.017671,
                    "planning_time": 0.003778
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.72716,
                    "execution_time": 0.012685,
                    "compile_time": 4.677184,
                    "planning_time": 0.038947
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03537,
                    "execution_time": 0.011273,
                    "compile_time": 0.014437,
                    "planning_time": 0.003778
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.276695,
                    "execution_time": 0.011226,
                    "compile_time": 3.227004,
                    "planning_time": 0.039047
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021337,
                    "execution_time": 0.011042,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004004
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022276,
                    "execution_time": 0.011523,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.00412
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAAAABABAA            Cristina            Mcguire  Cristina.Mcguire@pXqzBbMiXdis8i.org\n1   AAAAAAAAAAACPAAA               Marie           Copeland            Marie.Copeland@xCCcTN.com\n2   AAAAAAAAAAAEMAAA               Craig             Heflin     Craig.Heflin@Io5EvOvry1KN88G.org\n3   AAAAAAAAAAAFBBAA               Jimmy             Kruger                Jimmy.Kruger@29jG.edu\n4   AAAAAAAAAAAHAAAA            Victoria             Brooks            Victoria.Brooks@IoIpk.com\n5   AAAAAAAAAAAHCAAA                Emma             Harris                    Emma.Harris@a.com\n6   AAAAAAAAAAAHEBAA              Joseph               Lyon    Joseph.Lyon@iahqScjoQ6z2Rxfpg.com\n7   AAAAAAAAAAAHHBAA               Jason             Medina       Jason.Medina@LGcNhFrMzNcGx.edu\n8   AAAAAAAAAAAILBAA               Nancy                                                        \n9   AAAAAAAAAAAJDBAA             Gerardo          Hernandez     Gerardo.Hernandez@307PikJEZC.com\n10  AAAAAAAAAAAJFBAA              Andrew              Jones    Andrew.Jones@By40O2DTtKMdr5kv.edu\n11  AAAAAAAAAAAPFBAA             Beverly               Page        Beverly.Page@k3GsApflkKfD.com\n12  AAAAAAAAAAAPJBAA            Victoria               Kerr   Victoria.Kerr@b96IA0GKpFnUSI92.org\n13  AAAAAAAAAABAEAAA               David             Mosley                 David.Mosley@qsA.edu\n14  AAAAAAAAAABANBAA             Claudia              Smith                  Claudia.Smith@U.com\n15  AAAAAAAAAABBIAAA               Isaac            Collins         Isaac.Collins@SjmUYvntjR.org\n16  AAAAAAAAAABDHAAA               Donna            Bernard     Donna.Bernard@gRcklsT2fGyvYC.org\n17  AAAAAAAAAABEIBAA             Yolanda           Torrence     Yolanda.Torrence@4phqeMxhEF3.edu\n18  AAAAAAAAAABFNAAA              Carrie             Stoker             Carrie.Stoker@xxtkn4.org\n...*/"
    }
]