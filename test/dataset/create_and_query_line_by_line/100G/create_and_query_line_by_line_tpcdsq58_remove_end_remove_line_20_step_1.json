[
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(SS_EXT_SALES_PRICE) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(CS_EXT_SALES_PRICE) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(WS_EXT_SALES_PRICE) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\nselect * from ss_items  -- Added main SELECT statement\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103437,
                    "execution_time": 0.039357,
                    "compile_time": 0.000238,
                    "planning_time": 0.024557,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.168199,
                    "execution_time": 0.040946,
                    "compile_time": 0.000231,
                    "planning_time": 0.087414,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.225935,
                    "execution_time": 0.052931,
                    "compile_time": 0.00025,
                    "planning_time": 0.023842,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.285435,
                    "execution_time": 0.052582,
                    "compile_time": 0.000241,
                    "planning_time": 0.085144,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.115177,
                    "execution_time": 0.030628,
                    "compile_time": 0.036921,
                    "planning_time": 0.024276,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.45607,
                    "execution_time": 0.03264,
                    "compile_time": 3.313397,
                    "planning_time": 0.085202,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.174191,
                    "execution_time": 0.039976,
                    "compile_time": 0.081616,
                    "planning_time": 0.026423,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.130417,
                    "execution_time": 0.043244,
                    "compile_time": 5.956259,
                    "planning_time": 0.088756,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.562935,
                    "execution_time": 0.307976,
                    "compile_time": 0.080844,
                    "planning_time": 0.033636,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.306755,
                    "execution_time": 0.260454,
                    "compile_time": 6.812451,
                    "planning_time": 0.098498,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev\n0   AAAAAAAAIMKCCAAA      7811.13\n1   AAAAAAAAEAPBCAAA     10358.53\n2   AAAAAAAAPPBGAAAA      7045.05\n3   AAAAAAAAFNFJCAAA     17102.28\n4   AAAAAAAAKJBGCAAA     14009.08\n5   AAAAAAAADOGBBAAA     17489.36\n6   AAAAAAAALKCHBAAA      6210.56\n7   AAAAAAAACDNLAAAA     10147.91\n8   AAAAAAAANHPNBAAA     24802.72\n9   AAAAAAAAKGGBCAAA     13523.93\n10  AAAAAAAACHJNAAAA     15685.70\n11  AAAAAAAAPJLPCAAA     13565.86\n12  AAAAAAAANFGDBAAA     22043.82\n13  AAAAAAAADFCGAAAA      5866.65\n14  AAAAAAAAKEGGAAAA     20437.85\n15  AAAAAAAAELLOAAAA      4143.71\n16  AAAAAAAANJLABAAA      8026.17\n17  AAAAAAAAMJMGCAAA      7125.11\n18  AAAAAAAAJCEMBAAA     11013.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016346,
                    "execution_time": 0.007057,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.003245
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055784,
                    "execution_time": 0.007598,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.03975
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev\n0   AAAAAAAAIMKCCAAA      7811.13\n1   AAAAAAAAEAPBCAAA     10358.53\n2   AAAAAAAAPPBGAAAA      7045.05\n3   AAAAAAAAFNFJCAAA     17102.28\n4   AAAAAAAAKJBGCAAA     14009.08\n5   AAAAAAAADOGBBAAA     17489.36\n6   AAAAAAAALKCHBAAA      6210.56\n7   AAAAAAAACDNLAAAA     10147.91\n8   AAAAAAAANHPNBAAA     24802.72\n9   AAAAAAAAKGGBCAAA     13523.93\n10  AAAAAAAACHJNAAAA     15685.70\n11  AAAAAAAAPJLPCAAA     13565.86\n12  AAAAAAAANFGDBAAA     22043.82\n13  AAAAAAAADFCGAAAA      5866.65\n14  AAAAAAAAKEGGAAAA     20437.85\n15  AAAAAAAAELLOAAAA      4143.71\n16  AAAAAAAANJLABAAA      8026.17\n17  AAAAAAAAMJMGCAAA      7125.11\n18  AAAAAAAAJCEMBAAA     11013.64\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select ss_item_sk item_id\n        ,sum(SS_EXT_SALES_PRICE) ss_item_rev \n from store_sales\n     ,date_dim\n where ss_sold_date_sk   = d_date_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n group by ss_item_sk),\n cs_items as\n (select cs_item_sk item_id\n        ,sum(CS_EXT_SALES_PRICE) cs_item_rev\n  from catalog_sales\n      ,date_dim\n where cs_sold_date_sk = d_date_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n group by cs_item_sk),\n ws_items as\n (select ws_item_sk item_id\n        ,sum(WS_EXT_SALES_PRICE) ws_item_rev\n  from web_sales\n      ,date_dim\n where ws_sold_date_sk   = d_date_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n group by ws_item_sk)\nselect ss_items.item_id\nfrom ss_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.337762,
                    "execution_time": 0.221317,
                    "compile_time": 0.032038,
                    "planning_time": 0.031358,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.679118,
                    "execution_time": 0.186229,
                    "compile_time": 3.338665,
                    "planning_time": 0.095018,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    item_id\n0      6331\n1    130780\n2     48068\n3    104314\n4     22628\n5    158696\n6    178660\n7    184399\n8     75200\n9     67756\n10     9205\n11   203908\n12    61660\n13     8869\n14   123208\n15    72176\n16   155512\n17    87454\n18    36448\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016359,
                    "execution_time": 0.007405,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003051
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057435,
                    "execution_time": 0.007732,
                    "compile_time": 5e-05,
                    "planning_time": 0.041233
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    item_id\n0      6331\n1    130780\n2     48068\n3    104314\n4     22628\n5    158696\n6    178660\n7    184399\n8     75200\n9     67756\n10     9205\n11   203908\n12    61660\n13     8869\n14   123208\n15    72176\n16   155512\n17    87454\n18    36448\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n, cs_item_rev, ws_item_rev from ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095942,
                    "execution_time": 0.042211,
                    "compile_time": 0.000321,
                    "planning_time": 0.026638,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.156995,
                    "execution_time": 0.040401,
                    "compile_time": 0.000331,
                    "planning_time": 0.090337,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.526164,
                    "execution_time": 0.313328,
                    "compile_time": 0.043734,
                    "planning_time": 0.036326,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.071069,
                    "execution_time": 0.322538,
                    "compile_time": 3.507413,
                    "planning_time": 0.101134,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.092959,
                    "execution_time": 0.040457,
                    "compile_time": 0.000313,
                    "planning_time": 0.026281,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.173837,
                    "execution_time": 0.039175,
                    "compile_time": 0.000293,
                    "planning_time": 0.108474,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.280787,
                    "execution_time": 0.08378,
                    "compile_time": 0.04606,
                    "planning_time": 0.03749,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.051455,
                    "execution_time": 0.086511,
                    "compile_time": 5.739676,
                    "planning_time": 0.102448,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.48625,
                    "execution_time": 0.078474,
                    "compile_time": 0.152927,
                    "planning_time": 0.006946,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.378416,
                    "execution_time": 0.097402,
                    "compile_time": 9.951376,
                    "planning_time": 0.065236,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  cs_item_rev  ws_item_rev\n0   AAAAAAAACMAGCAAA     25517.87      2972.15       925.27\n1   AAAAAAAAGNKPCAAA     16462.17          NaN          NaN\n2   AAAAAAAAEGHBBAAA     14889.23     23315.54      4759.29\n3   AAAAAAAAHOJKAAAA      4527.69      5736.58       297.36\n4   AAAAAAAAKLMGCAAA      3594.12      7996.07      8320.10\n5   AAAAAAAAGMCKCAAA      6000.41      9365.16       242.42\n6   AAAAAAAAGHOEAAAA     13588.86     18830.46     16443.81\n7   AAAAAAAAGADNBAAA      8270.98      6904.80     15770.98\n8   AAAAAAAAIAPLBAAA     11409.02      6562.74      1162.71\n9   AAAAAAAAMHCOCAAA     16289.50       367.66          NaN\n10  AAAAAAAAMFGJCAAA     17606.07      1097.73      3665.89\n11  AAAAAAAAOIHAAAAA      6659.07       521.07      2515.81\n12  AAAAAAAAKJCBBAAA     21447.29      9061.44       790.23\n13  AAAAAAAAPCPKBAAA      6594.67     20549.72          NaN\n14  AAAAAAAADCIIBAAA     25009.10      9106.37          NaN\n15  AAAAAAAAGAHNAAAA      7138.98     11700.07          NaN\n16  AAAAAAAAHNEDBAAA     18353.84     11692.77      2582.55\n17  AAAAAAAADOBFCAAA     12759.26     10598.95     13903.66\n18  AAAAAAAAGIEGCAAA      6429.44     10164.45      2842.52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.047049,
                    "execution_time": 0.007869,
                    "compile_time": 0.029437,
                    "planning_time": 0.003499
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.309702,
                    "execution_time": 0.008317,
                    "compile_time": 3.250647,
                    "planning_time": 0.040422
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  cs_item_rev  ws_item_rev\n0   AAAAAAAACMAGCAAA     25517.87      2972.15       925.27\n1   AAAAAAAAGNKPCAAA     16462.17          NaN          NaN\n2   AAAAAAAAEGHBBAAA     14889.23     23315.54      4759.29\n3   AAAAAAAAHOJKAAAA      4527.69      5736.58       297.36\n4   AAAAAAAAKLMGCAAA      3594.12      7996.07      8320.10\n5   AAAAAAAAGMCKCAAA      6000.41      9365.16       242.42\n6   AAAAAAAAGHOEAAAA     13588.86     18830.46     16443.81\n7   AAAAAAAAGADNBAAA      8270.98      6904.80     15770.98\n8   AAAAAAAAIAPLBAAA     11409.02      6562.74      1162.71\n9   AAAAAAAAMHCOCAAA     16289.50       367.66          NaN\n10  AAAAAAAAMFGJCAAA     17606.07      1097.73      3665.89\n11  AAAAAAAAOIHAAAAA      6659.07       521.07      2515.81\n12  AAAAAAAAKJCBBAAA     21447.29      9061.44       790.23\n13  AAAAAAAAPCPKBAAA      6594.67     20549.72          NaN\n14  AAAAAAAADCIIBAAA     25009.10      9106.37          NaN\n15  AAAAAAAAGAHNAAAA      7138.98     11700.07          NaN\n16  AAAAAAAAHNEDBAAA     18353.84     11692.77      2582.55\n17  AAAAAAAADOBFCAAA     12759.26     10598.95     13903.66\n18  AAAAAAAAGIEGCAAA      6429.44     10164.45      2842.52\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\nfrom ss_items\nleft join cs_items on ss_items.item_id = cs_items.item_id\nleft join ws_items on ss_items.item_id = ws_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.337361,
                    "execution_time": 0.075524,
                    "compile_time": 0.070583,
                    "planning_time": 0.007571,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.137578,
                    "execution_time": 0.092058,
                    "compile_time": 6.783451,
                    "planning_time": 0.067827,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_DEV\" AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev\n0   AAAAAAAAIMKCCAAA      7811.13  211.29\n1   AAAAAAAAEAPBCAAA     10358.53   83.77\n2   AAAAAAAAPPBGAAAA      7045.05   94.20\n3   AAAAAAAAFNFJCAAA     17102.28  210.41\n4   AAAAAAAAKJBGCAAA     14009.08  235.38\n5   AAAAAAAADOGBBAAA     17489.36  189.07\n6   AAAAAAAALKCHBAAA      6210.56  118.28\n7   AAAAAAAACDNLAAAA     10147.91  153.01\n8   AAAAAAAANHPNBAAA     24802.72  216.35\n9   AAAAAAAAKGGBCAAA     13523.93  156.85\n10  AAAAAAAACHJNAAAA     15685.70     NaN\n11  AAAAAAAAPJLPCAAA     13565.86  216.07\n12  AAAAAAAANFGDBAAA     22043.82     NaN\n13  AAAAAAAADFCGAAAA      5866.65     NaN\n14  AAAAAAAAKEGGAAAA     20437.85     NaN\n15  AAAAAAAAELLOAAAA      4143.71  224.38\n16  AAAAAAAANJLABAAA      8026.17   85.21\n17  AAAAAAAAMJMGCAAA      7125.11     NaN\n18  AAAAAAAAJCEMBAAA     11013.64  122.98\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.072226,
                    "execution_time": 0.007714,
                    "compile_time": 0.055148,
                    "planning_time": 0.003339
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.328833,
                    "execution_time": 0.008192,
                    "compile_time": 3.270289,
                    "planning_time": 0.040089
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_DEV\" AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev\n0   AAAAAAAAIMKCCAAA      7811.13  211.29\n1   AAAAAAAAEAPBCAAA     10358.53   83.77\n2   AAAAAAAAPPBGAAAA      7045.05   94.20\n3   AAAAAAAAFNFJCAAA     17102.28  210.41\n4   AAAAAAAAKJBGCAAA     14009.08  235.38\n5   AAAAAAAADOGBBAAA     17489.36  189.07\n6   AAAAAAAALKCHBAAA      6210.56  118.28\n7   AAAAAAAACDNLAAAA     10147.91  153.01\n8   AAAAAAAANHPNBAAA     24802.72  216.35\n9   AAAAAAAAKGGBCAAA     13523.93  156.85\n10  AAAAAAAACHJNAAAA     15685.70     NaN\n11  AAAAAAAAPJLPCAAA     13565.86  216.07\n12  AAAAAAAANFGDBAAA     22043.82     NaN\n13  AAAAAAAADFCGAAAA      5866.65     NaN\n14  AAAAAAAAKEGGAAAA     20437.85     NaN\n15  AAAAAAAAELLOAAAA      4143.71  224.38\n16  AAAAAAAANJLABAAA      8026.17   85.21\n17  AAAAAAAAMJMGCAAA      7125.11     NaN\n18  AAAAAAAAJCEMBAAA     11013.64  122.98\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.36961,
                    "execution_time": 0.097998,
                    "compile_time": 0.014164,
                    "planning_time": 0.007628,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.956964,
                    "execution_time": 0.096217,
                    "compile_time": 3.529428,
                    "planning_time": 0.065179,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_13\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev\n0   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86\n1   AAAAAAAAOBIGAAAA      5041.29  120.72      7031.19\n2   AAAAAAAAAKHOBAAA      6964.08     NaN          NaN\n3   AAAAAAAAKLENCAAA      3221.33   76.96      6497.64\n4   AAAAAAAAOMIKCAAA     12941.13     NaN      5124.64\n5   AAAAAAAABOIFAAAA     18456.89  189.33      6453.75\n6   AAAAAAAAOOIICAAA      6390.16   54.64     20872.11\n7   AAAAAAAAMHCLAAAA     14892.82  263.91      1724.88\n8   AAAAAAAAAEACBAAA     16133.34     NaN     22314.56\n9   AAAAAAAACEEHCAAA     15917.01   96.41     30884.31\n10  AAAAAAAAKOANAAAA      9261.33  237.47        93.20\n11  AAAAAAAAIMJHCAAA     11463.24   90.04     13102.57\n12  AAAAAAAAFOHACAAA     20792.67  177.91      7290.68\n13  AAAAAAAACFICCAAA     12490.84     NaN          NaN\n14  AAAAAAAAEPIOCAAA      7079.72  122.50      1364.82\n15  AAAAAAAAGLIBDAAA     20857.95  246.21      3709.68\n16  AAAAAAAACPJPCAAA      7583.67     NaN     14226.39\n17  AAAAAAAACKPICAAA     16392.77  171.38     12010.32\n18  AAAAAAAAPGBLBAAA     12952.89   95.25     10013.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.049162,
                    "execution_time": 0.008257,
                    "compile_time": 0.031234,
                    "planning_time": 0.003463
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.368454,
                    "execution_time": 0.00852,
                    "compile_time": 3.311314,
                    "planning_time": 0.040411
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_13\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev\n0   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86\n1   AAAAAAAAOBIGAAAA      5041.29  120.72      7031.19\n2   AAAAAAAAAKHOBAAA      6964.08     NaN          NaN\n3   AAAAAAAAKLENCAAA      3221.33   76.96      6497.64\n4   AAAAAAAAOMIKCAAA     12941.13     NaN      5124.64\n5   AAAAAAAABOIFAAAA     18456.89  189.33      6453.75\n6   AAAAAAAAOOIICAAA      6390.16   54.64     20872.11\n7   AAAAAAAAMHCLAAAA     14892.82  263.91      1724.88\n8   AAAAAAAAAEACBAAA     16133.34     NaN     22314.56\n9   AAAAAAAACEEHCAAA     15917.01   96.41     30884.31\n10  AAAAAAAAKOANAAAA      9261.33  237.47        93.20\n11  AAAAAAAAIMJHCAAA     11463.24   90.04     13102.57\n12  AAAAAAAAFOHACAAA     20792.67  177.91      7290.68\n13  AAAAAAAACFICCAAA     12490.84     NaN          NaN\n14  AAAAAAAAEPIOCAAA      7079.72  122.50      1364.82\n15  AAAAAAAAGLIBDAAA     20857.95  246.21      3709.68\n16  AAAAAAAACPJPCAAA      7583.67     NaN     14226.39\n17  AAAAAAAACKPICAAA     16392.77  171.38     12010.32\n18  AAAAAAAAPGBLBAAA     12952.89   95.25     10013.51\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+coalesce(cs_item_rev, 0)+coalesce(ws_item_rev, 0))/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+coalesce(cs_item_rev, 0)+coalesce(ws_item_rev, 0))/3) * 100 cs_dev\nfrom ss_items\nleft join cs_items on ss_items.item_id = cs_items.item_id\nleft join ws_items on ss_items.item_id = ws_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + COALESCE ( \"CS_ITEMS\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"WS_ITEMS\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + COALESCE ( \"CS_ITEMS\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"WS_ITEMS\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.483009,
                    "execution_time": 0.082739,
                    "compile_time": 0.060674,
                    "planning_time": 0.008722,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.459019,
                    "execution_time": 0.195813,
                    "compile_time": 6.852735,
                    "planning_time": 0.067822,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_DEV\" AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev\n0   AAAAAAAACMAGCAAA     25517.87  260.25      2972.15   30.31\n1   AAAAAAAAGNKPCAAA     16462.17  300.00          NaN     NaN\n2   AAAAAAAAEGHBBAAA     14889.23  103.96     23315.54  162.80\n3   AAAAAAAAHOJKAAAA      4527.69  128.60      5736.58  162.94\n4   AAAAAAAAKLMGCAAA      3594.12   54.15      7996.07  120.48\n5   AAAAAAAAGMCKCAAA      6000.41  115.33      9365.16  180.00\n6   AAAAAAAAGHOEAAAA     13588.86   83.43     18830.46  115.61\n7   AAAAAAAAGADNBAAA      8270.98   80.17      6904.80   66.93\n8   AAAAAAAAIAPLBAAA     11409.02  178.87      6562.74  102.89\n9   AAAAAAAAMHCOCAAA     16289.50  293.37       367.66    6.62\n10  AAAAAAAAMFGJCAAA     17606.07  236.11      1097.73   14.72\n11  AAAAAAAAOIHAAAAA      6659.07  206.03       521.07   16.12\n12  AAAAAAAAKJCBBAAA     21447.29  205.57      9061.44   86.85\n13  AAAAAAAAPCPKBAAA      6594.67   72.88     20549.72  227.11\n14  AAAAAAAADCIIBAAA     25009.10  219.92      9106.37   80.07\n15  AAAAAAAAGAHNAAAA      7138.98  113.68     11700.07  186.31\n16  AAAAAAAAHNEDBAAA     18353.84  168.74     11692.77  107.50\n17  AAAAAAAADOBFCAAA     12759.26  102.72     10598.95   85.33\n18  AAAAAAAAGIEGCAAA      6429.44   99.23     10164.45  156.88\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.047146,
                    "execution_time": 0.007493,
                    "compile_time": 0.029873,
                    "planning_time": 0.003575
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.332333,
                    "execution_time": 0.008672,
                    "compile_time": 3.27253,
                    "planning_time": 0.040588
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_DEV\" AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev\n0   AAAAAAAACMAGCAAA     25517.87  260.25      2972.15   30.31\n1   AAAAAAAAGNKPCAAA     16462.17  300.00          NaN     NaN\n2   AAAAAAAAEGHBBAAA     14889.23  103.96     23315.54  162.80\n3   AAAAAAAAHOJKAAAA      4527.69  128.60      5736.58  162.94\n4   AAAAAAAAKLMGCAAA      3594.12   54.15      7996.07  120.48\n5   AAAAAAAAGMCKCAAA      6000.41  115.33      9365.16  180.00\n6   AAAAAAAAGHOEAAAA     13588.86   83.43     18830.46  115.61\n7   AAAAAAAAGADNBAAA      8270.98   80.17      6904.80   66.93\n8   AAAAAAAAIAPLBAAA     11409.02  178.87      6562.74  102.89\n9   AAAAAAAAMHCOCAAA     16289.50  293.37       367.66    6.62\n10  AAAAAAAAMFGJCAAA     17606.07  236.11      1097.73   14.72\n11  AAAAAAAAOIHAAAAA      6659.07  206.03       521.07   16.12\n12  AAAAAAAAKJCBBAAA     21447.29  205.57      9061.44   86.85\n13  AAAAAAAAPCPKBAAA      6594.67   72.88     20549.72  227.11\n14  AAAAAAAADCIIBAAA     25009.10  219.92      9106.37   80.07\n15  AAAAAAAAGAHNAAAA      7138.98  113.68     11700.07  186.31\n16  AAAAAAAAHNEDBAAA     18353.84  168.74     11692.77  107.50\n17  AAAAAAAADOBFCAAA     12759.26  102.72     10598.95   85.33\n18  AAAAAAAAGIEGCAAA      6429.44   99.23     10164.45  156.88\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.51595,
                    "execution_time": 0.089005,
                    "compile_time": 0.070838,
                    "planning_time": 0.008461,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.750614,
                    "execution_time": 0.467055,
                    "compile_time": 6.820283,
                    "planning_time": 0.089377,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev\n0   AAAAAAAAKJCBAAAA      2092.04   73.18      5481.60  191.76      1001.65\n1   AAAAAAAAICOCAAAA      5533.82   85.93      9884.72  153.49      3900.53\n2   AAAAAAAAFEBGAAAA      8191.40  195.66      3892.75   92.98       474.98\n3   AAAAAAAAOAGECAAA     14326.57  141.23     15945.33  157.18       160.32\n4   AAAAAAAALCOPBAAA     22291.66     NaN      4807.77     NaN          NaN\n5   AAAAAAAAKPACCAAA     14169.65  131.87     13539.51  126.01      4525.02\n6   AAAAAAAAEDADAAAA      3024.15  109.79      5125.30  186.07       113.90\n7   AAAAAAAAINDEAAAA      6369.57   75.79     16392.11  195.05      2449.50\n8   AAAAAAAAAFNFCAAA      1333.70   25.56       917.23   17.58     13399.20\n9   AAAAAAAAEJMBCAAA     15277.64  100.38     16399.63  107.75     13981.70\n10  AAAAAAAAEBIPAAAA     17720.73  146.59     11218.30   92.80      7324.70\n11  AAAAAAAANLOOAAAA     11883.16     NaN          NaN     NaN     11190.31\n12  AAAAAAAAAKECBAAA     25424.55  250.60      2862.32   28.21      2149.44\n13  AAAAAAAAODPDAAAA      2273.74   54.36      7273.29  173.90      2999.95\n14  AAAAAAAAFGDFAAAA      8801.09     NaN     17696.32     NaN          NaN\n15  AAAAAAAAGFDOBAAA      6005.36   83.63      4746.60   66.10     10789.55\n16  AAAAAAAAMPBLCAAA     16890.97   95.12     35523.27  200.05       857.10\n17  AAAAAAAAKONFBAAA      8723.68  245.80       575.25   16.20      1348.10\n18  AAAAAAAALGGGCAAA     11398.83     NaN          NaN     NaN     11717.14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.048186,
                    "execution_time": 0.007704,
                    "compile_time": 0.030418,
                    "planning_time": 0.003907
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.305427,
                    "execution_time": 0.008314,
                    "compile_time": 3.245266,
                    "planning_time": 0.040945
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev\n0   AAAAAAAAKJCBAAAA      2092.04   73.18      5481.60  191.76      1001.65\n1   AAAAAAAAICOCAAAA      5533.82   85.93      9884.72  153.49      3900.53\n2   AAAAAAAAFEBGAAAA      8191.40  195.66      3892.75   92.98       474.98\n3   AAAAAAAAOAGECAAA     14326.57  141.23     15945.33  157.18       160.32\n4   AAAAAAAALCOPBAAA     22291.66     NaN      4807.77     NaN          NaN\n5   AAAAAAAAKPACCAAA     14169.65  131.87     13539.51  126.01      4525.02\n6   AAAAAAAAEDADAAAA      3024.15  109.79      5125.30  186.07       113.90\n7   AAAAAAAAINDEAAAA      6369.57   75.79     16392.11  195.05      2449.50\n8   AAAAAAAAAFNFCAAA      1333.70   25.56       917.23   17.58     13399.20\n9   AAAAAAAAEJMBCAAA     15277.64  100.38     16399.63  107.75     13981.70\n10  AAAAAAAAEBIPAAAA     17720.73  146.59     11218.30   92.80      7324.70\n11  AAAAAAAANLOOAAAA     11883.16     NaN          NaN     NaN     11190.31\n12  AAAAAAAAAKECBAAA     25424.55  250.60      2862.32   28.21      2149.44\n13  AAAAAAAAODPDAAAA      2273.74   54.36      7273.29  173.90      2999.95\n14  AAAAAAAAFGDFAAAA      8801.09     NaN     17696.32     NaN          NaN\n15  AAAAAAAAGFDOBAAA      6005.36   83.63      4746.60   66.10     10789.55\n16  AAAAAAAAMPBLCAAA     16890.97   95.12     35523.27  200.05       857.10\n17  AAAAAAAAKONFBAAA      8723.68  245.80       575.25   16.20      1348.10\n18  AAAAAAAALGGGCAAA     11398.83     NaN          NaN     NaN     11717.14\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.560614,
                    "execution_time": 0.119483,
                    "compile_time": 0.02642,
                    "planning_time": 0.009177,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.917475,
                    "execution_time": 0.370776,
                    "compile_time": 7.067974,
                    "planning_time": 0.067912,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev\n0   AAAAAAAAKJCBAAAA      2092.04   73.18      5481.60  191.76      1001.65   35.04\n1   AAAAAAAAICOCAAAA      5533.82   85.93      9884.72  153.49      3900.53   60.57\n2   AAAAAAAAFEBGAAAA      8191.40  195.66      3892.75   92.98       474.98   11.34\n3   AAAAAAAAOAGECAAA     14326.57  141.23     15945.33  157.18       160.32    1.58\n4   AAAAAAAALCOPBAAA     22291.66     NaN      4807.77     NaN          NaN     NaN\n5   AAAAAAAAKPACCAAA     14169.65  131.87     13539.51  126.01      4525.02   42.11\n6   AAAAAAAAEDADAAAA      3024.15  109.79      5125.30  186.07       113.90    4.13\n7   AAAAAAAAINDEAAAA      6369.57   75.79     16392.11  195.05      2449.50   29.14\n8   AAAAAAAAAFNFCAAA      1333.70   25.56       917.23   17.58     13399.20  256.85\n9   AAAAAAAAEJMBCAAA     15277.64  100.38     16399.63  107.75     13981.70   91.86\n10  AAAAAAAAEBIPAAAA     17720.73  146.59     11218.30   92.80      7324.70   60.59\n11  AAAAAAAANLOOAAAA     11883.16     NaN          NaN     NaN     11190.31     NaN\n12  AAAAAAAAAKECBAAA     25424.55  250.60      2862.32   28.21      2149.44   21.18\n13  AAAAAAAAODPDAAAA      2273.74   54.36      7273.29  173.90      2999.95   71.72\n14  AAAAAAAAFGDFAAAA      8801.09     NaN     17696.32     NaN          NaN     NaN\n15  AAAAAAAAGFDOBAAA      6005.36   83.63      4746.60   66.10     10789.55  150.26\n16  AAAAAAAAMPBLCAAA     16890.97   95.12     35523.27  200.05       857.10    4.82\n17  AAAAAAAAKONFBAAA      8723.68  245.80       575.25   16.20      1348.10   37.98\n18  AAAAAAAALGGGCAAA     11398.83     NaN          NaN     NaN     11717.14     NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.065189,
                    "execution_time": 0.007682,
                    "compile_time": 0.046997,
                    "planning_time": 0.004022
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.356657,
                    "execution_time": 0.008628,
                    "compile_time": 3.296046,
                    "planning_time": 0.041118
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev\n0   AAAAAAAAKJCBAAAA      2092.04   73.18      5481.60  191.76      1001.65   35.04\n1   AAAAAAAAICOCAAAA      5533.82   85.93      9884.72  153.49      3900.53   60.57\n2   AAAAAAAAFEBGAAAA      8191.40  195.66      3892.75   92.98       474.98   11.34\n3   AAAAAAAAOAGECAAA     14326.57  141.23     15945.33  157.18       160.32    1.58\n4   AAAAAAAALCOPBAAA     22291.66     NaN      4807.77     NaN          NaN     NaN\n5   AAAAAAAAKPACCAAA     14169.65  131.87     13539.51  126.01      4525.02   42.11\n6   AAAAAAAAEDADAAAA      3024.15  109.79      5125.30  186.07       113.90    4.13\n7   AAAAAAAAINDEAAAA      6369.57   75.79     16392.11  195.05      2449.50   29.14\n8   AAAAAAAAAFNFCAAA      1333.70   25.56       917.23   17.58     13399.20  256.85\n9   AAAAAAAAEJMBCAAA     15277.64  100.38     16399.63  107.75     13981.70   91.86\n10  AAAAAAAAEBIPAAAA     17720.73  146.59     11218.30   92.80      7324.70   60.59\n11  AAAAAAAANLOOAAAA     11883.16     NaN          NaN     NaN     11190.31     NaN\n12  AAAAAAAAAKECBAAA     25424.55  250.60      2862.32   28.21      2149.44   21.18\n13  AAAAAAAAODPDAAAA      2273.74   54.36      7273.29  173.90      2999.95   71.72\n14  AAAAAAAAFGDFAAAA      8801.09     NaN     17696.32     NaN          NaN     NaN\n15  AAAAAAAAGFDOBAAA      6005.36   83.63      4746.60   66.10     10789.55  150.26\n16  AAAAAAAAMPBLCAAA     16890.97   95.12     35523.27  200.05       857.10    4.82\n17  AAAAAAAAKONFBAAA      8723.68  245.80       575.25   16.20      1348.10   37.98\n18  AAAAAAAALGGGCAAA     11398.83     NaN          NaN     NaN     11717.14     NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.622067,
                    "execution_time": 0.127464,
                    "compile_time": 0.027689,
                    "planning_time": 0.009695,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.62393,
                    "execution_time": 0.299176,
                    "compile_time": 6.771997,
                    "planning_time": 0.06784,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89   3696.7466\n1   AAAAAAAAEAPBCAAA     10358.53   83.77      3485.79   28.19     23249.72  188.03  12364.6800\n2   AAAAAAAAPPBGAAAA      7045.05   94.20      4966.81   66.41     10422.23  139.37   7478.0300\n3   AAAAAAAAFNFJCAAA     17102.28  210.41      6442.69   79.26       838.86   10.32   8127.9433\n4   AAAAAAAAKJBGCAAA     14009.08  235.38      1821.02   30.59      2024.75   34.02   5951.6166\n5   AAAAAAAADOGBBAAA     17489.36  189.07      4462.02   48.23      5797.85   62.68   9249.7433\n6   AAAAAAAALKCHBAAA      6210.56  118.28       576.57   10.98      8964.56  170.73   5250.5633\n7   AAAAAAAACDNLAAAA     10147.91  153.01      4097.29   61.78      5650.17   85.19   6631.7900\n8   AAAAAAAANHPNBAAA     24802.72  216.35      6594.79   57.52      2994.84   26.12  11464.1166\n9   AAAAAAAAKGGBCAAA     13523.93  156.85      5864.08   68.01      6476.97   75.12   8621.6600\n10  AAAAAAAACHJNAAAA     15685.70     NaN      5180.86     NaN          NaN     NaN         NaN\n11  AAAAAAAAPJLPCAAA     13565.86  216.07      4969.47   79.15       299.54    4.77   6278.2900\n12  AAAAAAAANFGDBAAA     22043.82     NaN     19287.51     NaN          NaN     NaN         NaN\n13  AAAAAAAADFCGAAAA      5866.65     NaN      3716.26     NaN          NaN     NaN         NaN\n14  AAAAAAAAKEGGAAAA     20437.85     NaN     11614.81     NaN          NaN     NaN         NaN\n15  AAAAAAAAELLOAAAA      4143.71  224.38       925.75   50.13       470.58   25.48   1846.6800\n16  AAAAAAAANJLABAAA      8026.17   85.21      9775.89  103.78     10454.68  110.99   9418.9133\n17  AAAAAAAAMJMGCAAA      7125.11     NaN      6766.66     NaN          NaN     NaN         NaN\n18  AAAAAAAAJCEMBAAA     11013.64  122.98      9873.12  110.24      5979.47   66.76   8955.4100\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.07053,
                    "execution_time": 0.008537,
                    "compile_time": 0.05124,
                    "planning_time": 0.004139
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.362026,
                    "execution_time": 0.008128,
                    "compile_time": 3.301748,
                    "planning_time": 0.041367
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89   3696.7466\n1   AAAAAAAAEAPBCAAA     10358.53   83.77      3485.79   28.19     23249.72  188.03  12364.6800\n2   AAAAAAAAPPBGAAAA      7045.05   94.20      4966.81   66.41     10422.23  139.37   7478.0300\n3   AAAAAAAAFNFJCAAA     17102.28  210.41      6442.69   79.26       838.86   10.32   8127.9433\n4   AAAAAAAAKJBGCAAA     14009.08  235.38      1821.02   30.59      2024.75   34.02   5951.6166\n5   AAAAAAAADOGBBAAA     17489.36  189.07      4462.02   48.23      5797.85   62.68   9249.7433\n6   AAAAAAAALKCHBAAA      6210.56  118.28       576.57   10.98      8964.56  170.73   5250.5633\n7   AAAAAAAACDNLAAAA     10147.91  153.01      4097.29   61.78      5650.17   85.19   6631.7900\n8   AAAAAAAANHPNBAAA     24802.72  216.35      6594.79   57.52      2994.84   26.12  11464.1166\n9   AAAAAAAAKGGBCAAA     13523.93  156.85      5864.08   68.01      6476.97   75.12   8621.6600\n10  AAAAAAAACHJNAAAA     15685.70     NaN      5180.86     NaN          NaN     NaN         NaN\n11  AAAAAAAAPJLPCAAA     13565.86  216.07      4969.47   79.15       299.54    4.77   6278.2900\n12  AAAAAAAANFGDBAAA     22043.82     NaN     19287.51     NaN          NaN     NaN         NaN\n13  AAAAAAAADFCGAAAA      5866.65     NaN      3716.26     NaN          NaN     NaN         NaN\n14  AAAAAAAAKEGGAAAA     20437.85     NaN     11614.81     NaN          NaN     NaN         NaN\n15  AAAAAAAAELLOAAAA      4143.71  224.38       925.75   50.13       470.58   25.48   1846.6800\n16  AAAAAAAANJLABAAA      8026.17   85.21      9775.89  103.78     10454.68  110.99   9418.9133\n17  AAAAAAAAMJMGCAAA      7125.11     NaN      6766.66     NaN          NaN     NaN         NaN\n18  AAAAAAAAJCEMBAAA     11013.64  122.98      9873.12  110.24      5979.47   66.76   8955.4100\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" CROSS JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" CROSS JOIN \"WS_ITEMS\" AS \"WS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142489,
                    "execution_time": 0.050255,
                    "compile_time": 0.000248,
                    "planning_time": 0.002851,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.246801,
                    "execution_time": 0.093026,
                    "compile_time": 0.000254,
                    "planning_time": 0.061075,
                    "create_size": 500
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.124263,
                    "execution_time": 0.046224,
                    "compile_time": 0.000238,
                    "planning_time": 0.002893,
                    "create_size": 420
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.22238,
                    "execution_time": 0.076611,
                    "compile_time": 0.000258,
                    "planning_time": 0.064636,
                    "create_size": 416
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAOAPHBAAA      3453.46   52.20     14662.38  221.66      1728.11   26.12   6614.6500\n1   AAAAAAAAOBIGAAAA      5041.29   70.56     14662.38  205.24      1728.11   24.18   7143.9266\n2   AAAAAAAAAKHOBAAA      6964.08   89.45     14662.38  188.34      1728.11   22.19   7784.8566\n3   AAAAAAAAKLENCAAA      3221.33   49.27     14662.38  224.28      1728.11   26.43   6537.2733\n4   AAAAAAAAOMIKCAAA     12941.13  132.36     14662.38  149.96      1728.11   17.67   9777.2066\n5   AAAAAAAABOIFAAAA     18456.89  158.89     14662.38  126.22      1728.11   14.87  11615.7933\n6   AAAAAAAAOOIICAAA      6390.16   84.15     14662.38  193.08      1728.11   22.75   7593.5500\n7   AAAAAAAAMHCLAAAA     14892.82  142.81     14662.38  140.60      1728.11   16.57  10427.7700\n8   AAAAAAAAAEACBAAA     16133.34  148.81     14662.38  135.24      1728.11   15.94  10841.2766\n9   AAAAAAAACEEHCAAA     15917.01  147.80     14662.38  136.15      1728.11   16.04  10769.1666\n10  AAAAAAAAKOANAAAA      9261.33  108.31     14662.38  171.47      1728.11   20.21   8550.6066\n11  AAAAAAAAIMJHCAAA     11463.24  123.46     14662.38  157.92      1728.11   18.61   9284.5766\n12  AAAAAAAAFOHACAAA     20792.67  167.75     14662.38  118.29      1728.11   13.94  12394.3866\n13  AAAAAAAACFICCAAA     12490.84  129.74     14662.38  152.30      1728.11   17.95   9627.1100\n14  AAAAAAAAEPIOCAAA      7079.72   90.49     14662.38  187.41      1728.11   22.08   7823.4033\n15  AAAAAAAAGLIBDAAA     20857.95  167.99     14662.38  118.09      1728.11   13.91  12416.1466\n16  AAAAAAAACPJPCAAA      7583.67   94.89     14662.38  183.47      1728.11   21.62   7991.3866\n17  AAAAAAAACKPICAAA     16392.77  150.01     14662.38  134.17      1728.11   15.81  10927.7533\n18  AAAAAAAAPGBLBAAA     12952.89  132.42     14662.38  149.90      1728.11   17.66   9781.1266\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.056682,
                    "execution_time": 0.028255,
                    "compile_time": 0.017612,
                    "planning_time": 0.008075
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.486025,
                    "execution_time": 0.030038,
                    "compile_time": 3.392346,
                    "planning_time": 0.045835
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAOAPHBAAA      3453.46   52.20     14662.38  221.66      1728.11   26.12   6614.6500\n1   AAAAAAAAOBIGAAAA      5041.29   70.56     14662.38  205.24      1728.11   24.18   7143.9266\n2   AAAAAAAAAKHOBAAA      6964.08   89.45     14662.38  188.34      1728.11   22.19   7784.8566\n3   AAAAAAAAKLENCAAA      3221.33   49.27     14662.38  224.28      1728.11   26.43   6537.2733\n4   AAAAAAAAOMIKCAAA     12941.13  132.36     14662.38  149.96      1728.11   17.67   9777.2066\n5   AAAAAAAABOIFAAAA     18456.89  158.89     14662.38  126.22      1728.11   14.87  11615.7933\n6   AAAAAAAAOOIICAAA      6390.16   84.15     14662.38  193.08      1728.11   22.75   7593.5500\n7   AAAAAAAAMHCLAAAA     14892.82  142.81     14662.38  140.60      1728.11   16.57  10427.7700\n8   AAAAAAAAAEACBAAA     16133.34  148.81     14662.38  135.24      1728.11   15.94  10841.2766\n9   AAAAAAAACEEHCAAA     15917.01  147.80     14662.38  136.15      1728.11   16.04  10769.1666\n10  AAAAAAAAKOANAAAA      9261.33  108.31     14662.38  171.47      1728.11   20.21   8550.6066\n11  AAAAAAAAIMJHCAAA     11463.24  123.46     14662.38  157.92      1728.11   18.61   9284.5766\n12  AAAAAAAAFOHACAAA     20792.67  167.75     14662.38  118.29      1728.11   13.94  12394.3866\n13  AAAAAAAACFICCAAA     12490.84  129.74     14662.38  152.30      1728.11   17.95   9627.1100\n14  AAAAAAAAEPIOCAAA      7079.72   90.49     14662.38  187.41      1728.11   22.08   7823.4033\n15  AAAAAAAAGLIBDAAA     20857.95  167.99     14662.38  118.09      1728.11   13.91  12416.1466\n16  AAAAAAAACPJPCAAA      7583.67   94.89     14662.38  183.47      1728.11   21.62   7991.3866\n17  AAAAAAAACKPICAAA     16392.77  150.01     14662.38  134.17      1728.11   15.81  10927.7533\n18  AAAAAAAAPGBLBAAA     12952.89  132.42     14662.38  149.90      1728.11   17.66   9781.1266\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" CROSS JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAILHCBAAA      8917.72   71.91     18591.05  149.91      9693.32   78.16  12400.6966\n1   AAAAAAAAILHCBAAA      8917.72   84.15     18591.05  175.44      4281.33   40.40  10596.7000\n2   AAAAAAAAILHCBAAA      8917.72   94.60     18591.05  197.23       768.95    8.15   9425.9066\n3   AAAAAAAAILHCBAAA      8917.72   85.62     18591.05  178.50      3735.10   35.86  10414.6233\n4   AAAAAAAAILHCBAAA      8917.72   78.54     18591.05  163.74      6552.57   57.71  11353.7800\n5   AAAAAAAAILHCBAAA      8917.72   95.13     18591.05  198.32       612.75    6.53   9373.8400\n6   AAAAAAAAILHCBAAA      8917.72   97.00     18591.05  202.23        69.66    0.75   9192.8100\n7   AAAAAAAAILHCBAAA      8917.72   88.20     18591.05  183.88      2822.05   27.91  10110.2733\n8   AAAAAAAAILHCBAAA      8917.72   96.43     18591.05  201.03       234.00    2.53   9247.5900\n9   AAAAAAAAILHCBAAA      8917.72   90.48     18591.05  188.63      2057.33   20.87   9855.3666\n10  AAAAAAAAILHCBAAA      8917.72   91.19     18591.05  190.11      1827.60   18.68   9778.7900\n11  AAAAAAAAILHCBAAA      8917.72   88.53     18591.05  184.56      2709.36   26.89  10072.7100\n12  AAAAAAAAILHCBAAA      8917.72   80.68     18591.05  168.20      5649.78   51.11  11052.8500\n13  AAAAAAAAILHCBAAA      8917.72   79.30     18591.05  165.33      6224.32   55.35  11244.3633\n14  AAAAAAAAILHCBAAA      8917.72   75.72     18591.05  157.86      7821.15   66.41  11776.6400\n15  AAAAAAAAILHCBAAA      8917.72   84.21     18591.05  175.55      4260.36   40.23  10589.7100\n16  AAAAAAAAILHCBAAA      8917.72   94.56     18591.05  197.13       782.79    8.30   9430.5200\n17  AAAAAAAAILHCBAAA      8917.72   81.80     18591.05  170.54      5193.87   47.64  10900.8800\n18  AAAAAAAAILHCBAAA      8917.72   63.56     18591.05  132.51     14579.40  103.92  14029.3900\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044648,
                    "execution_time": 0.025413,
                    "compile_time": 0.000139,
                    "planning_time": 0.008597
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.073377,
                    "execution_time": 0.024773,
                    "compile_time": 3.98861,
                    "planning_time": 0.045321
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAILHCBAAA      8917.72   71.91     18591.05  149.91      9693.32   78.16  12400.6966\n1   AAAAAAAAILHCBAAA      8917.72   84.15     18591.05  175.44      4281.33   40.40  10596.7000\n2   AAAAAAAAILHCBAAA      8917.72   94.60     18591.05  197.23       768.95    8.15   9425.9066\n3   AAAAAAAAILHCBAAA      8917.72   85.62     18591.05  178.50      3735.10   35.86  10414.6233\n4   AAAAAAAAILHCBAAA      8917.72   78.54     18591.05  163.74      6552.57   57.71  11353.7800\n5   AAAAAAAAILHCBAAA      8917.72   95.13     18591.05  198.32       612.75    6.53   9373.8400\n6   AAAAAAAAILHCBAAA      8917.72   97.00     18591.05  202.23        69.66    0.75   9192.8100\n7   AAAAAAAAILHCBAAA      8917.72   88.20     18591.05  183.88      2822.05   27.91  10110.2733\n8   AAAAAAAAILHCBAAA      8917.72   96.43     18591.05  201.03       234.00    2.53   9247.5900\n9   AAAAAAAAILHCBAAA      8917.72   90.48     18591.05  188.63      2057.33   20.87   9855.3666\n10  AAAAAAAAILHCBAAA      8917.72   91.19     18591.05  190.11      1827.60   18.68   9778.7900\n11  AAAAAAAAILHCBAAA      8917.72   88.53     18591.05  184.56      2709.36   26.89  10072.7100\n12  AAAAAAAAILHCBAAA      8917.72   80.68     18591.05  168.20      5649.78   51.11  11052.8500\n13  AAAAAAAAILHCBAAA      8917.72   79.30     18591.05  165.33      6224.32   55.35  11244.3633\n14  AAAAAAAAILHCBAAA      8917.72   75.72     18591.05  157.86      7821.15   66.41  11776.6400\n15  AAAAAAAAILHCBAAA      8917.72   84.21     18591.05  175.55      4260.36   40.23  10589.7100\n16  AAAAAAAAILHCBAAA      8917.72   94.56     18591.05  197.13       782.79    8.30   9430.5200\n17  AAAAAAAAILHCBAAA      8917.72   81.80     18591.05  170.54      5193.87   47.64  10900.8800\n18  AAAAAAAAILHCBAAA      8917.72   63.56     18591.05  132.51     14579.40  103.92  14029.3900\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.567487,
                    "execution_time": 0.090359,
                    "compile_time": 0.01568,
                    "planning_time": 0.004141,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.335421,
                    "execution_time": 0.264116,
                    "compile_time": 3.552765,
                    "planning_time": 0.05959,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAADGCIAAAA       962.46   30.45      8225.54  260.24       293.92    9.29   3160.6400\n1   AAAAAAAALJMCAAAA     13811.44  145.00     13204.96  138.63      1558.00   16.35   9524.8000\n2   AAAAAAAAEAFHBAAA      9284.44     NaN          NaN     NaN      3880.98     NaN         NaN\n3   AAAAAAAAODAHCAAA     15592.99     NaN     11415.98     NaN          NaN     NaN         NaN\n4   AAAAAAAAGMDKAAAA     12157.50   79.60     16690.90  109.28     16968.00  111.10  15272.1333\n5   AAAAAAAAEJJHAAAA     14958.08  193.15      5573.53   71.96      2701.16   34.87   7744.2566\n6   AAAAAAAAHPDIBAAA      9558.38  109.21      2336.44   26.69     14361.67  164.09   8752.1633\n7   AAAAAAAABOJABAAA      6902.49   90.18     14553.88  190.16      1503.72   19.64   7653.3633\n8   AAAAAAAAKPHLAAAA     19268.12  240.02      4814.83   59.97         0.00    0.00   8027.6500\n9   AAAAAAAACLKKCAAA      8757.59  171.64      6177.72  121.08       371.13    7.27   5102.1466\n10  AAAAAAAAINNNAAAA     13432.37     NaN      4939.40     NaN          NaN     NaN         NaN\n11  AAAAAAAABENLCAAA     15177.81     NaN      4296.34     NaN          NaN     NaN         NaN\n12  AAAAAAAAEHIHAAAA     36699.08  251.54      4722.00   32.36      2346.89   16.08  14589.3233\n13  AAAAAAAAGPLHCAAA      5267.73   70.76     15707.16  210.99      1358.13   18.24   7444.3400\n14  AAAAAAAAJDFLAAAA     10868.61   73.04     20306.66  136.47     13461.40   90.47  14878.8900\n15  AAAAAAAANBDIAAAA      7469.96     NaN     12759.75     NaN          NaN     NaN         NaN\n16  AAAAAAAAAEJFBAAA     12923.17     NaN     14449.05     NaN          NaN     NaN         NaN\n17  AAAAAAAAEIHKCAAA     12327.30  204.66      2559.48   42.49      3182.74   52.84   6023.1733\n18  AAAAAAAAOAHBDAAA     19956.64  182.26      6366.94   58.14      6524.72   59.58  10949.4333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018437,
                    "execution_time": 0.007819,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004172
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.099535,
                    "execution_time": 0.008201,
                    "compile_time": 0.044846,
                    "planning_time": 0.039821
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAADGCIAAAA       962.46   30.45      8225.54  260.24       293.92    9.29   3160.6400\n1   AAAAAAAALJMCAAAA     13811.44  145.00     13204.96  138.63      1558.00   16.35   9524.8000\n2   AAAAAAAAEAFHBAAA      9284.44     NaN          NaN     NaN      3880.98     NaN         NaN\n3   AAAAAAAAODAHCAAA     15592.99     NaN     11415.98     NaN          NaN     NaN         NaN\n4   AAAAAAAAGMDKAAAA     12157.50   79.60     16690.90  109.28     16968.00  111.10  15272.1333\n5   AAAAAAAAEJJHAAAA     14958.08  193.15      5573.53   71.96      2701.16   34.87   7744.2566\n6   AAAAAAAAHPDIBAAA      9558.38  109.21      2336.44   26.69     14361.67  164.09   8752.1633\n7   AAAAAAAABOJABAAA      6902.49   90.18     14553.88  190.16      1503.72   19.64   7653.3633\n8   AAAAAAAAKPHLAAAA     19268.12  240.02      4814.83   59.97         0.00    0.00   8027.6500\n9   AAAAAAAACLKKCAAA      8757.59  171.64      6177.72  121.08       371.13    7.27   5102.1466\n10  AAAAAAAAINNNAAAA     13432.37     NaN      4939.40     NaN          NaN     NaN         NaN\n11  AAAAAAAABENLCAAA     15177.81     NaN      4296.34     NaN          NaN     NaN         NaN\n12  AAAAAAAAEHIHAAAA     36699.08  251.54      4722.00   32.36      2346.89   16.08  14589.3233\n13  AAAAAAAAGPLHCAAA      5267.73   70.76     15707.16  210.99      1358.13   18.24   7444.3400\n14  AAAAAAAAJDFLAAAA     10868.61   73.04     20306.66  136.47     13461.40   90.47  14878.8900\n15  AAAAAAAANBDIAAAA      7469.96     NaN     12759.75     NaN          NaN     NaN         NaN\n16  AAAAAAAAAEJFBAAA     12923.17     NaN     14449.05     NaN          NaN     NaN         NaN\n17  AAAAAAAAEIHKCAAA     12327.30  204.66      2559.48   42.49      3182.74   52.84   6023.1733\n18  AAAAAAAAOAHBDAAA     19956.64  182.26      6366.94   58.14      6524.72   59.58  10949.4333\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n1   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n2   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n3   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n4   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n5   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n6   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n7   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n8   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n9   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n10  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n11  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n12  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n13  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n14  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n15  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n16  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n17  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n18  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031588,
                    "execution_time": 0.017403,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.006483
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.382417,
                    "execution_time": 0.017669,
                    "compile_time": 3.305946,
                    "planning_time": 0.043085
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n1   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n2   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n3   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n4   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n5   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n6   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n7   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n8   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n9   AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n10  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n11  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n12  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n13  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n14  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n15  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n16  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n17  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n18  AAAAAAAAOAPHBAAA      3453.46   49.95     13813.86   199.8      3473.44   50.24  6913.5866\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n1   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n2   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n3   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n4   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n5   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n6   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n7   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n8   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n9   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n10  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n11  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n12  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n13  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n14  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n15  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n16  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n17  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n18  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.088889,
                    "execution_time": 0.027204,
                    "compile_time": 0.051487,
                    "planning_time": 0.008339
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.313733,
                    "execution_time": 0.026563,
                    "compile_time": 3.235775,
                    "planning_time": 0.045286
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n1   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n2   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n3   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n4   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n5   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n6   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n7   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n8   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n9   AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n10  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n11  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n12  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n13  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n14  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n15  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n16  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n17  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n18  AAAAAAAAIMKCCAAA      7811.13  211.29      2174.06   58.81      1105.05   29.89  3696.7466\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev  average\n0   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n1   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n2   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n3   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n4   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n5   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n6   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n7   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n8   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n9   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n10  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n11  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n12  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n13  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n14  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n15  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n16  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n17  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n18  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.073626,
                    "execution_time": 0.027313,
                    "compile_time": 0.035153,
                    "planning_time": 0.009266
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.352251,
                    "execution_time": 0.027006,
                    "compile_time": 3.271289,
                    "planning_time": 0.046107
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_17\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev  average\n0   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n1   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n2   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n3   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n4   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n5   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n6   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n7   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n8   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n9   AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n10  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n11  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n12  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n13  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n14  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n15  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n16  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n17  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n18  AAAAAAAAKJCBAAAA      2092.04   73.18       5481.6  191.76      1001.65   35.04  2858.43\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.229983,
                    "execution_time": 0.074266,
                    "compile_time": 0.111392,
                    "planning_time": 0.012804,
                    "create_size": 1067
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.736593,
                    "execution_time": 0.084791,
                    "compile_time": 10.540994,
                    "planning_time": 0.071767,
                    "create_size": 1067
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAALGJLAAAA      5267.48   98.78      5313.57   99.64      5416.56  101.57   5332.5366\n1   AAAAAAAAHHPFAAAA      7282.79  100.68      7305.20  100.99      7112.52   98.32   7233.5033\n2   AAAAAAAAMALDAAAA      6406.90   98.73      6587.00  101.51      6472.50   99.74   6488.8000\n3   AAAAAAAACBEHAAAA      5495.78  101.19      5320.31   97.96      5476.08  100.83   5430.7233\n4   AAAAAAAAGEMPAAAA      9821.44   97.70     10501.92  104.47      9833.75   97.82  10052.3700\n5   AAAAAAAAMKPHCAAA      9011.24   95.46      9591.11  101.60      9716.10  102.93   9439.4833\n6   AAAAAAAAGKBPCAAA      3987.83   97.92      4200.37  103.14      4028.39   98.92   4072.1966\n7   AAAAAAAADCIECAAA     10192.20   96.21     10520.56   99.31     11065.58  104.46  10592.7800\n8   AAAAAAAANMPADAAA     12018.63  100.08     11782.00   98.11     12223.08  101.79  12007.9033\n9   AAAAAAAAIGLABAAA      4949.59  105.52      4600.40   98.07      4522.00   96.40   4690.6633\n10  AAAAAAAANAHMCAAA     20563.66  100.33     20769.46  101.33     20152.99   98.32  20495.3700\n11  AAAAAAAAGFFECAAA      6671.33   93.93      7254.48  102.15      7379.38  103.90   7101.7300\n12  AAAAAAAAKGIICAAA     15989.04   97.94     16577.78  101.55     16406.81  100.50  16324.5433\n13  AAAAAAAACNGABAAA      5763.25  101.49      5545.02   97.65      5726.95  100.85   5678.4066\n14  AAAAAAAALOJECAAA      9652.40  101.81      9049.50   95.45      9738.96  102.72   9480.2866\n15  AAAAAAAAKNLECAAA      2035.44  104.63      1860.73   95.65      1939.70   99.71   1945.2900\n16  AAAAAAAAHMFBDAAA      6468.31   96.90      7071.01  105.93      6485.92   97.16   6675.0800\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAAJDLMCAAA      4186.45   94.75      4490.62  101.64      4577.37  103.60   4418.1466\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019076,
                    "execution_time": 0.008501,
                    "compile_time": 5e-05,
                    "planning_time": 0.004157
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05732,
                    "execution_time": 0.0093,
                    "compile_time": 5e-05,
                    "planning_time": 0.039732
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAALGJLAAAA      5267.48   98.78      5313.57   99.64      5416.56  101.57   5332.5366\n1   AAAAAAAAHHPFAAAA      7282.79  100.68      7305.20  100.99      7112.52   98.32   7233.5033\n2   AAAAAAAAMALDAAAA      6406.90   98.73      6587.00  101.51      6472.50   99.74   6488.8000\n3   AAAAAAAACBEHAAAA      5495.78  101.19      5320.31   97.96      5476.08  100.83   5430.7233\n4   AAAAAAAAGEMPAAAA      9821.44   97.70     10501.92  104.47      9833.75   97.82  10052.3700\n5   AAAAAAAAMKPHCAAA      9011.24   95.46      9591.11  101.60      9716.10  102.93   9439.4833\n6   AAAAAAAAGKBPCAAA      3987.83   97.92      4200.37  103.14      4028.39   98.92   4072.1966\n7   AAAAAAAADCIECAAA     10192.20   96.21     10520.56   99.31     11065.58  104.46  10592.7800\n8   AAAAAAAANMPADAAA     12018.63  100.08     11782.00   98.11     12223.08  101.79  12007.9033\n9   AAAAAAAAIGLABAAA      4949.59  105.52      4600.40   98.07      4522.00   96.40   4690.6633\n10  AAAAAAAANAHMCAAA     20563.66  100.33     20769.46  101.33     20152.99   98.32  20495.3700\n11  AAAAAAAAGFFECAAA      6671.33   93.93      7254.48  102.15      7379.38  103.90   7101.7300\n12  AAAAAAAAKGIICAAA     15989.04   97.94     16577.78  101.55     16406.81  100.50  16324.5433\n13  AAAAAAAACNGABAAA      5763.25  101.49      5545.02   97.65      5726.95  100.85   5678.4066\n14  AAAAAAAALOJECAAA      9652.40  101.81      9049.50   95.45      9738.96  102.72   9480.2866\n15  AAAAAAAAKNLECAAA      2035.44  104.63      1860.73   95.65      1939.70   99.71   1945.2900\n16  AAAAAAAAHMFBDAAA      6468.31   96.90      7071.01  105.93      6485.92   97.16   6675.0800\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAAJDLMCAAA      4186.45   94.75      4490.62  101.64      4577.37  103.60   4418.1466\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.766554,
                    "execution_time": 0.48666,
                    "compile_time": 0.190259,
                    "planning_time": 0.006589,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.02418,
                    "execution_time": 1.111881,
                    "compile_time": 9.762627,
                    "planning_time": 0.064306,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAOMNOAAAA     10348.89   97.23     10358.34   97.32     11223.21  105.44  10643.4800\n1   AAAAAAAALFJPAAAA      9757.15  100.54      9652.64   99.46      9704.04   99.99   9704.6100\n2   AAAAAAAAGBHNBAAA     10473.51  104.58      9768.63   97.54      9800.91   97.86  10014.3500\n3   AAAAAAAACKEABAAA      9627.48  105.91      8851.74   97.37      8790.85   96.70   9090.0233\n4   AAAAAAAAOLGBAAAA     10376.60  102.31     10044.65   99.03     10005.27   98.65  10142.1733\n5   AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n6   AAAAAAAAEFOACAAA     10400.93  105.83      9557.10   97.24      9524.85   96.91   9827.6266\n7   AAAAAAAAOHGABAAA     11342.65  104.27     10649.71   97.90     10641.68   97.82  10878.0133\n8   AAAAAAAAGDCAAAAA      9703.40   99.61      9728.78   99.87      9789.44  100.50   9740.5400\n9   AAAAAAAACKDBBAAA      9744.96   99.24      9711.29   98.90     10001.04  101.85   9819.0966\n10  AAAAAAAAFFLNAAAA      9443.87   98.44      9382.85   97.80      9952.81  103.74   9593.1766\n11  AAAAAAAAEHMDCAAA      9430.50  103.18      8626.43   94.38      9362.22  102.43   9139.7166\n12  AAAAAAAAOJLGBAAA     10615.16   96.99     10663.99   97.43     11553.60  105.56  10944.2500\n13  AAAAAAAALOJECAAA      9652.40  101.81      9049.50   95.45      9738.96  102.72   9480.2866\n14  AAAAAAAAMLPGAAAA     10592.34   95.18     11608.88  104.32     11181.72  100.48  11127.6466\n15  AAAAAAAADHJNCAAA     11466.56  101.11     10739.93   94.71     11812.79  104.17  11339.7600\n16  AAAAAAAALKNPAAAA     10367.20   96.30     11378.44  105.69     10550.83   98.00  10765.4900\n17  AAAAAAAAKJJFCAAA      9793.65   95.65     10699.68  104.50     10221.58   99.83  10238.3033\n18  AAAAAAAAIDFNCAAA     10323.62  104.13      9861.43   99.47      9555.91   96.39   9913.6533\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018849,
                    "execution_time": 0.008204,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004156
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0569,
                    "execution_time": 0.008395,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039691
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAOMNOAAAA     10348.89   97.23     10358.34   97.32     11223.21  105.44  10643.4800\n1   AAAAAAAALFJPAAAA      9757.15  100.54      9652.64   99.46      9704.04   99.99   9704.6100\n2   AAAAAAAAGBHNBAAA     10473.51  104.58      9768.63   97.54      9800.91   97.86  10014.3500\n3   AAAAAAAACKEABAAA      9627.48  105.91      8851.74   97.37      8790.85   96.70   9090.0233\n4   AAAAAAAAOLGBAAAA     10376.60  102.31     10044.65   99.03     10005.27   98.65  10142.1733\n5   AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n6   AAAAAAAAEFOACAAA     10400.93  105.83      9557.10   97.24      9524.85   96.91   9827.6266\n7   AAAAAAAAOHGABAAA     11342.65  104.27     10649.71   97.90     10641.68   97.82  10878.0133\n8   AAAAAAAAGDCAAAAA      9703.40   99.61      9728.78   99.87      9789.44  100.50   9740.5400\n9   AAAAAAAACKDBBAAA      9744.96   99.24      9711.29   98.90     10001.04  101.85   9819.0966\n10  AAAAAAAAFFLNAAAA      9443.87   98.44      9382.85   97.80      9952.81  103.74   9593.1766\n11  AAAAAAAAEHMDCAAA      9430.50  103.18      8626.43   94.38      9362.22  102.43   9139.7166\n12  AAAAAAAAOJLGBAAA     10615.16   96.99     10663.99   97.43     11553.60  105.56  10944.2500\n13  AAAAAAAALOJECAAA      9652.40  101.81      9049.50   95.45      9738.96  102.72   9480.2866\n14  AAAAAAAAMLPGAAAA     10592.34   95.18     11608.88  104.32     11181.72  100.48  11127.6466\n15  AAAAAAAADHJNCAAA     11466.56  101.11     10739.93   94.71     11812.79  104.17  11339.7600\n16  AAAAAAAALKNPAAAA     10367.20   96.30     11378.44  105.69     10550.83   98.00  10765.4900\n17  AAAAAAAAKJJFCAAA      9793.65   95.65     10699.68  104.50     10221.58   99.83  10238.3033\n18  AAAAAAAAIDFNCAAA     10323.62  104.13      9861.43   99.47      9555.91   96.39   9913.6533\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.171186,
                    "execution_time": 0.074691,
                    "compile_time": 0.049536,
                    "planning_time": 0.014979,
                    "create_size": 1012
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.210772,
                    "execution_time": 0.083514,
                    "compile_time": 7.014034,
                    "planning_time": 0.073368,
                    "create_size": 1012
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAACFFICAAA      2849.98   95.79      3056.20  102.72      3018.84  101.47   2975.0066\n1   AAAAAAAADOOBCAAA      7184.38   97.60      7167.92   97.37      7730.04  105.01   7360.7800\n2   AAAAAAAAKMHKCAAA     14467.51  104.91     13476.93   97.72     13426.76   97.36  13790.4000\n3   AAAAAAAAKNALAAAA     16340.09  104.79     15313.86   98.21     15123.67   96.99  15592.5400\n4   AAAAAAAAMALDAAAA      6406.90   98.73      6587.00  101.51      6472.50   99.74   6488.8000\n5   AAAAAAAAPKOHAAAA     13921.85   99.89     13331.81   95.65     14556.42  104.44  13936.6933\n6   AAAAAAAALGJLAAAA      5267.48   98.78      5313.57   99.64      5416.56  101.57   5332.5366\n7   AAAAAAAAHHPFAAAA      7282.79  100.68      7305.20  100.99      7112.52   98.32   7233.5033\n8   AAAAAAAAEGDFBAAA      3451.09   95.69      3605.66   99.98      3761.77  104.31   3606.1733\n9   AAAAAAAAMKPHCAAA      9011.24   95.46      9591.11  101.60      9716.10  102.93   9439.4833\n10  AAAAAAAAGKBPCAAA      3987.83   97.92      4200.37  103.14      4028.39   98.92   4072.1966\n11  AAAAAAAAGEMPAAAA      9821.44   97.70     10501.92  104.47      9833.75   97.82  10052.3700\n12  AAAAAAAACBEHAAAA      5495.78  101.19      5320.31   97.96      5476.08  100.83   5430.7233\n13  AAAAAAAAEHMDCAAA      9430.50  103.18      8626.43   94.38      9362.22  102.43   9139.7166\n14  AAAAAAAACKBHCAAA      6830.35   94.30      7508.90  103.66      7390.37  102.03   7243.2066\n15  AAAAAAAAOJIDBAAA      4952.06   96.91      5189.97  101.56      5187.42  101.51   5109.8166\n16  AAAAAAAAMDKDBAAA      4131.41  105.25      3767.50   95.98      3876.83   98.76   3925.2466\n17  AAAAAAAANBHKAAAA      5195.16   97.13      5570.68  104.15      5279.25   98.70   5348.3633\n18  AAAAAAAAKGIICAAA     15989.04   97.94     16577.78  101.55     16406.81  100.50  16324.5433\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019433,
                    "execution_time": 0.008751,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004229
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056721,
                    "execution_time": 0.008845,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039819
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAACFFICAAA      2849.98   95.79      3056.20  102.72      3018.84  101.47   2975.0066\n1   AAAAAAAADOOBCAAA      7184.38   97.60      7167.92   97.37      7730.04  105.01   7360.7800\n2   AAAAAAAAKMHKCAAA     14467.51  104.91     13476.93   97.72     13426.76   97.36  13790.4000\n3   AAAAAAAAKNALAAAA     16340.09  104.79     15313.86   98.21     15123.67   96.99  15592.5400\n4   AAAAAAAAMALDAAAA      6406.90   98.73      6587.00  101.51      6472.50   99.74   6488.8000\n5   AAAAAAAAPKOHAAAA     13921.85   99.89     13331.81   95.65     14556.42  104.44  13936.6933\n6   AAAAAAAALGJLAAAA      5267.48   98.78      5313.57   99.64      5416.56  101.57   5332.5366\n7   AAAAAAAAHHPFAAAA      7282.79  100.68      7305.20  100.99      7112.52   98.32   7233.5033\n8   AAAAAAAAEGDFBAAA      3451.09   95.69      3605.66   99.98      3761.77  104.31   3606.1733\n9   AAAAAAAAMKPHCAAA      9011.24   95.46      9591.11  101.60      9716.10  102.93   9439.4833\n10  AAAAAAAAGKBPCAAA      3987.83   97.92      4200.37  103.14      4028.39   98.92   4072.1966\n11  AAAAAAAAGEMPAAAA      9821.44   97.70     10501.92  104.47      9833.75   97.82  10052.3700\n12  AAAAAAAACBEHAAAA      5495.78  101.19      5320.31   97.96      5476.08  100.83   5430.7233\n13  AAAAAAAAEHMDCAAA      9430.50  103.18      8626.43   94.38      9362.22  102.43   9139.7166\n14  AAAAAAAACKBHCAAA      6830.35   94.30      7508.90  103.66      7390.37  102.03   7243.2066\n15  AAAAAAAAOJIDBAAA      4952.06   96.91      5189.97  101.56      5187.42  101.51   5109.8166\n16  AAAAAAAAMDKDBAAA      4131.41  105.25      3767.50   95.98      3876.83   98.76   3925.2466\n17  AAAAAAAANBHKAAAA      5195.16   97.13      5570.68  104.15      5279.25   98.70   5348.3633\n18  AAAAAAAAKGIICAAA     15989.04   97.94     16577.78  101.55     16406.81  100.50  16324.5433\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAEBCAAAA      5402.22   96.62      5494.10   98.27      5875.85  105.09   5590.7233\n1   AAAAAAAAAFDMAAAA      7154.57   96.89      7658.04  103.71      7339.13   99.39   7383.9133\n2   AAAAAAAAAHPHAAAA      4839.53  100.32      4872.66  101.00      4759.95   98.67   4824.0466\n3   AAAAAAAAAILLCAAA      7701.36   98.34      7537.55   96.25      8253.91  105.40   7830.9400\n4   AAAAAAAAAJEPAAAA      5478.17   99.75      5453.58   99.30      5543.17  100.93   5491.6400\n5   AAAAAAAAAKFHAAAA     12459.05  102.65     11587.04   95.47     12363.76  101.87  12136.6166\n6   AAAAAAAAALJGAAAA     10175.46  102.50      9778.87   98.51      9824.74   98.97   9926.3566\n7   AAAAAAAAAMEBCAAA     11953.05   98.12     12440.00  102.11     12153.00   99.76  12182.0166\n8   AAAAAAAAAMHJBAAA      7337.94  101.87      7135.91   99.06      7135.79   99.06   7203.2133\n9   AAAAAAAAANFPBAAA     15197.37   99.42     15722.03  102.86     14934.87   97.71  15284.7566\n10  AAAAAAAAANJABAAA      4504.78   96.51      4542.38   97.32      4954.88  106.16   4667.3466\n11  AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n12  AAAAAAAAAOKBAAAA      6599.45   96.54      7045.44  103.07      6861.79  100.38   6835.5600\n13  AAAAAAAAAPDNBAAA     15520.12  103.63     15270.37  101.96     14138.10   94.40  14976.1966\n14  AAAAAAAABEBOCAAA      1848.12   97.53      1842.84   97.25      1993.68  105.21   1894.8800\n15  AAAAAAAABIJABAAA     13913.03   96.43     14429.81  100.01     14941.30  103.55  14428.0466\n16  AAAAAAAABLJDBAAA     18600.86  101.62     18038.91   98.55     18268.09   99.81  18302.6200\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAABPCPBAAA     14265.05   94.45     15654.13  103.65     15386.87  101.88  15102.0166\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.049442,
                    "execution_time": 0.010564,
                    "compile_time": 0.028032,
                    "planning_time": 0.004306
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.323478,
                    "execution_time": 0.010179,
                    "compile_time": 4.26973,
                    "planning_time": 0.039702
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAEBCAAAA      5402.22   96.62      5494.10   98.27      5875.85  105.09   5590.7233\n1   AAAAAAAAAFDMAAAA      7154.57   96.89      7658.04  103.71      7339.13   99.39   7383.9133\n2   AAAAAAAAAHPHAAAA      4839.53  100.32      4872.66  101.00      4759.95   98.67   4824.0466\n3   AAAAAAAAAILLCAAA      7701.36   98.34      7537.55   96.25      8253.91  105.40   7830.9400\n4   AAAAAAAAAJEPAAAA      5478.17   99.75      5453.58   99.30      5543.17  100.93   5491.6400\n5   AAAAAAAAAKFHAAAA     12459.05  102.65     11587.04   95.47     12363.76  101.87  12136.6166\n6   AAAAAAAAALJGAAAA     10175.46  102.50      9778.87   98.51      9824.74   98.97   9926.3566\n7   AAAAAAAAAMEBCAAA     11953.05   98.12     12440.00  102.11     12153.00   99.76  12182.0166\n8   AAAAAAAAAMHJBAAA      7337.94  101.87      7135.91   99.06      7135.79   99.06   7203.2133\n9   AAAAAAAAANFPBAAA     15197.37   99.42     15722.03  102.86     14934.87   97.71  15284.7566\n10  AAAAAAAAANJABAAA      4504.78   96.51      4542.38   97.32      4954.88  106.16   4667.3466\n11  AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n12  AAAAAAAAAOKBAAAA      6599.45   96.54      7045.44  103.07      6861.79  100.38   6835.5600\n13  AAAAAAAAAPDNBAAA     15520.12  103.63     15270.37  101.96     14138.10   94.40  14976.1966\n14  AAAAAAAABEBOCAAA      1848.12   97.53      1842.84   97.25      1993.68  105.21   1894.8800\n15  AAAAAAAABIJABAAA     13913.03   96.43     14429.81  100.01     14941.30  103.55  14428.0466\n16  AAAAAAAABLJDBAAA     18600.86  101.62     18038.91   98.55     18268.09   99.81  18302.6200\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAABPCPBAAA     14265.05   94.45     15654.13  103.65     15386.87  101.88  15102.0166\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" , \"SS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAEBCAAAA      5402.22   96.62      5494.10   98.27      5875.85  105.09   5590.7233\n1   AAAAAAAAAFDMAAAA      7154.57   96.89      7658.04  103.71      7339.13   99.39   7383.9133\n2   AAAAAAAAAHPHAAAA      4839.53  100.32      4872.66  101.00      4759.95   98.67   4824.0466\n3   AAAAAAAAAILLCAAA      7701.36   98.34      7537.55   96.25      8253.91  105.40   7830.9400\n4   AAAAAAAAAJEPAAAA      5478.17   99.75      5453.58   99.30      5543.17  100.93   5491.6400\n5   AAAAAAAAAKFHAAAA     12459.05  102.65     11587.04   95.47     12363.76  101.87  12136.6166\n6   AAAAAAAAALJGAAAA     10175.46  102.50      9778.87   98.51      9824.74   98.97   9926.3566\n7   AAAAAAAAAMEBCAAA     11953.05   98.12     12440.00  102.11     12153.00   99.76  12182.0166\n8   AAAAAAAAAMHJBAAA      7337.94  101.87      7135.91   99.06      7135.79   99.06   7203.2133\n9   AAAAAAAAANFPBAAA     15197.37   99.42     15722.03  102.86     14934.87   97.71  15284.7566\n10  AAAAAAAAANJABAAA      4504.78   96.51      4542.38   97.32      4954.88  106.16   4667.3466\n11  AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n12  AAAAAAAAAOKBAAAA      6599.45   96.54      7045.44  103.07      6861.79  100.38   6835.5600\n13  AAAAAAAAAPDNBAAA     15520.12  103.63     15270.37  101.96     14138.10   94.40  14976.1966\n14  AAAAAAAABEBOCAAA      1848.12   97.53      1842.84   97.25      1993.68  105.21   1894.8800\n15  AAAAAAAABIJABAAA     13913.03   96.43     14429.81  100.01     14941.30  103.55  14428.0466\n16  AAAAAAAABLJDBAAA     18600.86  101.62     18038.91   98.55     18268.09   99.81  18302.6200\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAABPCPBAAA     14265.05   94.45     15654.13  103.65     15386.87  101.88  15102.0166\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03542,
                    "execution_time": 0.010175,
                    "compile_time": 0.013984,
                    "planning_time": 0.004491
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.662248,
                    "execution_time": 0.01029,
                    "compile_time": 3.610558,
                    "planning_time": 0.039819
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAEBCAAAA      5402.22   96.62      5494.10   98.27      5875.85  105.09   5590.7233\n1   AAAAAAAAAFDMAAAA      7154.57   96.89      7658.04  103.71      7339.13   99.39   7383.9133\n2   AAAAAAAAAHPHAAAA      4839.53  100.32      4872.66  101.00      4759.95   98.67   4824.0466\n3   AAAAAAAAAILLCAAA      7701.36   98.34      7537.55   96.25      8253.91  105.40   7830.9400\n4   AAAAAAAAAJEPAAAA      5478.17   99.75      5453.58   99.30      5543.17  100.93   5491.6400\n5   AAAAAAAAAKFHAAAA     12459.05  102.65     11587.04   95.47     12363.76  101.87  12136.6166\n6   AAAAAAAAALJGAAAA     10175.46  102.50      9778.87   98.51      9824.74   98.97   9926.3566\n7   AAAAAAAAAMEBCAAA     11953.05   98.12     12440.00  102.11     12153.00   99.76  12182.0166\n8   AAAAAAAAAMHJBAAA      7337.94  101.87      7135.91   99.06      7135.79   99.06   7203.2133\n9   AAAAAAAAANFPBAAA     15197.37   99.42     15722.03  102.86     14934.87   97.71  15284.7566\n10  AAAAAAAAANJABAAA      4504.78   96.51      4542.38   97.32      4954.88  106.16   4667.3466\n11  AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n12  AAAAAAAAAOKBAAAA      6599.45   96.54      7045.44  103.07      6861.79  100.38   6835.5600\n13  AAAAAAAAAPDNBAAA     15520.12  103.63     15270.37  101.96     14138.10   94.40  14976.1966\n14  AAAAAAAABEBOCAAA      1848.12   97.53      1842.84   97.25      1993.68  105.21   1894.8800\n15  AAAAAAAABIJABAAA     13913.03   96.43     14429.81  100.01     14941.30  103.55  14428.0466\n16  AAAAAAAABLJDBAAA     18600.86  101.62     18038.91   98.55     18268.09   99.81  18302.6200\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAABPCPBAAA     14265.05   94.45     15654.13  103.65     15386.87  101.88  15102.0166\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" , \"SS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAEBCAAAA      5402.22   96.62      5494.10   98.27      5875.85  105.09   5590.7233\n1   AAAAAAAAAFDMAAAA      7154.57   96.89      7658.04  103.71      7339.13   99.39   7383.9133\n2   AAAAAAAAAHPHAAAA      4839.53  100.32      4872.66  101.00      4759.95   98.67   4824.0466\n3   AAAAAAAAAILLCAAA      7701.36   98.34      7537.55   96.25      8253.91  105.40   7830.9400\n4   AAAAAAAAAJEPAAAA      5478.17   99.75      5453.58   99.30      5543.17  100.93   5491.6400\n5   AAAAAAAAAKFHAAAA     12459.05  102.65     11587.04   95.47     12363.76  101.87  12136.6166\n6   AAAAAAAAALJGAAAA     10175.46  102.50      9778.87   98.51      9824.74   98.97   9926.3566\n7   AAAAAAAAAMEBCAAA     11953.05   98.12     12440.00  102.11     12153.00   99.76  12182.0166\n8   AAAAAAAAAMHJBAAA      7337.94  101.87      7135.91   99.06      7135.79   99.06   7203.2133\n9   AAAAAAAAANFPBAAA     15197.37   99.42     15722.03  102.86     14934.87   97.71  15284.7566\n10  AAAAAAAAANJABAAA      4504.78   96.51      4542.38   97.32      4954.88  106.16   4667.3466\n11  AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n12  AAAAAAAAAOKBAAAA      6599.45   96.54      7045.44  103.07      6861.79  100.38   6835.5600\n13  AAAAAAAAAPDNBAAA     15520.12  103.63     15270.37  101.96     14138.10   94.40  14976.1966\n14  AAAAAAAABEBOCAAA      1848.12   97.53      1842.84   97.25      1993.68  105.21   1894.8800\n15  AAAAAAAABIJABAAA     13913.03   96.43     14429.81  100.01     14941.30  103.55  14428.0466\n16  AAAAAAAABLJDBAAA     18600.86  101.62     18038.91   98.55     18268.09   99.81  18302.6200\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAABPCPBAAA     14265.05   94.45     15654.13  103.65     15386.87  101.88  15102.0166\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021376,
                    "execution_time": 0.010123,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.00448
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021028,
                    "execution_time": 0.00977,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004463
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAAEBCAAAA      5402.22   96.62      5494.10   98.27      5875.85  105.09   5590.7233\n1   AAAAAAAAAFDMAAAA      7154.57   96.89      7658.04  103.71      7339.13   99.39   7383.9133\n2   AAAAAAAAAHPHAAAA      4839.53  100.32      4872.66  101.00      4759.95   98.67   4824.0466\n3   AAAAAAAAAILLCAAA      7701.36   98.34      7537.55   96.25      8253.91  105.40   7830.9400\n4   AAAAAAAAAJEPAAAA      5478.17   99.75      5453.58   99.30      5543.17  100.93   5491.6400\n5   AAAAAAAAAKFHAAAA     12459.05  102.65     11587.04   95.47     12363.76  101.87  12136.6166\n6   AAAAAAAAALJGAAAA     10175.46  102.50      9778.87   98.51      9824.74   98.97   9926.3566\n7   AAAAAAAAAMEBCAAA     11953.05   98.12     12440.00  102.11     12153.00   99.76  12182.0166\n8   AAAAAAAAAMHJBAAA      7337.94  101.87      7135.91   99.06      7135.79   99.06   7203.2133\n9   AAAAAAAAANFPBAAA     15197.37   99.42     15722.03  102.86     14934.87   97.71  15284.7566\n10  AAAAAAAAANJABAAA      4504.78   96.51      4542.38   97.32      4954.88  106.16   4667.3466\n11  AAAAAAAAANKBBAAA      9769.54   95.63     10319.40  101.01     10558.40  103.35  10215.7800\n12  AAAAAAAAAOKBAAAA      6599.45   96.54      7045.44  103.07      6861.79  100.38   6835.5600\n13  AAAAAAAAAPDNBAAA     15520.12  103.63     15270.37  101.96     14138.10   94.40  14976.1966\n14  AAAAAAAABEBOCAAA      1848.12   97.53      1842.84   97.25      1993.68  105.21   1894.8800\n15  AAAAAAAABIJABAAA     13913.03   96.43     14429.81  100.01     14941.30  103.55  14428.0466\n16  AAAAAAAABLJDBAAA     18600.86  101.62     18038.91   98.55     18268.09   99.81  18302.6200\n17  AAAAAAAABNPMCAAA     14634.84   96.94     15346.02  101.65     15307.34  101.39  15096.0666\n18  AAAAAAAABPCPBAAA     14265.05   94.45     15654.13  103.65     15386.87  101.88  15102.0166\n...*/"
    }
]