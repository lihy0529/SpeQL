[
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store \ngroup by i_manufact_id /*CURSOR_IDENTIFIER*/ ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n1=1 /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and 1=1 /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.105471,
                    "execution_time": 2.028976,
                    "compile_time": 0.00049,
                    "planning_time": 0.049746,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.950562,
                    "execution_time": 2.046742,
                    "compile_time": 8.745108,
                    "planning_time": 0.125114,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    i_manufact_id    sum_sales  avg_quarterly_sales\n0             260  17811456.92          17811456.92\n1             355   8752770.73           8752770.73\n2             461   9990944.55           9990944.55\n3             621   8862740.80           8862740.80\n4             631  10069164.59          10069164.59\n5             655   7663332.99           7663332.99\n6             871   3421852.23           3421852.23\n7             957   2683618.47           2683618.47\n8             969   2294984.72           2294984.72\n9              80  17631536.71          17631536.71\n10            228  18706641.51          18706641.51\n11            399   9515371.28           9515371.28\n12            482   8666933.20           8666933.20\n13            532   7778392.07           7778392.07\n14            561   9933341.96           9933341.96\n15            771   2946075.07           2946075.07\n16            782   3227210.24           3227210.24\n17            903   3108194.30           3108194.30\n18            972   3675828.53           3675828.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.068624,
                    "execution_time": 0.008102,
                    "compile_time": 0.050315,
                    "planning_time": 0.004359
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.111249,
                    "execution_time": 0.007874,
                    "compile_time": 3.054437,
                    "planning_time": 0.040392
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    i_manufact_id    sum_sales  avg_quarterly_sales\n0             260  17811456.92          17811456.92\n1             355   8752770.73           8752770.73\n2             461   9990944.55           9990944.55\n3             621   8862740.80           8862740.80\n4             631  10069164.59          10069164.59\n5             655   7663332.99           7663332.99\n6             871   3421852.23           3421852.23\n7             957   2683618.47           2683618.47\n8             969   2294984.72           2294984.72\n9              80  17631536.71          17631536.71\n10            228  18706641.51          18706641.51\n11            399   9515371.28           9515371.28\n12            482   8666933.20           8666933.20\n13            532   7778392.07           7778392.07\n14            561   9933341.96           9933341.96\n15            771   2946075.07           2946075.07\n16            782   3227210.24           3227210.24\n17            903   3108194.30           3108194.30\n18            972   3675828.53           3675828.53\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) \n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.598999,
                    "execution_time": 0.41459,
                    "compile_time": 0.112387,
                    "planning_time": 0.05008,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.566236,
                    "execution_time": 2.817492,
                    "compile_time": 6.585707,
                    "planning_time": 0.127837,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0             1.0  3539829.10           3539829.10\n1            61.0  3270309.87           3270309.87\n2           148.0  3549781.89           3549781.89\n3           434.0  1961578.53           1961578.53\n4           504.0  1785221.82           1785221.82\n5           522.0  1789012.46           1789012.46\n6           590.0  2050409.64           2050409.64\n7           752.0   730060.32            730060.32\n8           877.0   526850.07            526850.07\n9           946.0   616850.74            616850.74\n10          202.0  3375866.60           3375866.60\n11          652.0  1755935.87           1755935.87\n12          761.0   609130.82            609130.82\n13          811.0   538469.80            538469.80\n14          922.0   734186.08            734186.08\n15            NaN  5121494.13           5121494.13\n16           56.0  3543298.52           3543298.52\n17          135.0  3605304.73           3605304.73\n18          179.0  3800499.88           3800499.88\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017053,
                    "execution_time": 0.00741,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004137
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.094398,
                    "execution_time": 0.007653,
                    "compile_time": 0.040235,
                    "planning_time": 0.040791
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0             1.0  3539829.10           3539829.10\n1            61.0  3270309.87           3270309.87\n2           148.0  3549781.89           3549781.89\n3           434.0  1961578.53           1961578.53\n4           504.0  1785221.82           1785221.82\n5           522.0  1789012.46           1789012.46\n6           590.0  2050409.64           2050409.64\n7           752.0   730060.32            730060.32\n8           877.0   526850.07            526850.07\n9           946.0   616850.74            616850.74\n10          202.0  3375866.60           3375866.60\n11          652.0  1755935.87           1755935.87\n12          761.0   609130.82            609130.82\n13          811.0   538469.80            538469.80\n14          922.0   734186.08            734186.08\n15            NaN  5121494.13           5121494.13\n16           56.0  3543298.52           3543298.52\n17          135.0  3605304.73           3605304.73\n18          179.0  3800499.88           3800499.88\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n(i_category in ('Books','Children','Electronics')) /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.867827,
                    "execution_time": 2.718471,
                    "compile_time": 0.072016,
                    "planning_time": 0.050805,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.266916,
                    "execution_time": 2.727734,
                    "compile_time": 6.381517,
                    "planning_time": 0.126343,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0             181   927432.75            927432.75\n1             183  1088605.49           1088605.49\n2             215  1098570.19           1098570.19\n3             220  1161187.08           1161187.08\n4             285  1185414.77           1185414.77\n5             305  1096165.42           1096165.42\n6             427   643434.91            643434.91\n7             478   575280.53            575280.53\n8             496   500566.78            500566.78\n9             536   477675.02            477675.02\n10            741   134650.95            134650.95\n11            808   271488.84            271488.84\n12            837    96522.36             96522.36\n13              7   986795.51            986795.51\n14             74   879711.03            879711.03\n15            314  1194937.83           1194937.83\n16            322  1029842.98           1029842.98\n17            579   657350.94            657350.94\n18            650   529372.97            529372.97\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018128,
                    "execution_time": 0.008386,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.00416
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053318,
                    "execution_time": 0.00777,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.039845
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ('Books', 'Children', 'Electronics') GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0             181   927432.75            927432.75\n1             183  1088605.49           1088605.49\n2             215  1098570.19           1098570.19\n3             220  1161187.08           1161187.08\n4             285  1185414.77           1185414.77\n5             305  1096165.42           1096165.42\n6             427   643434.91            643434.91\n7             478   575280.53            575280.53\n8             496   500566.78            500566.78\n9             536   477675.02            477675.02\n10            741   134650.95            134650.95\n11            808   271488.84            271488.84\n12            837    96522.36             96522.36\n13              7   986795.51            986795.51\n14             74   879711.03            879711.03\n15            314  1194937.83           1194937.83\n16            322  1029842.98           1029842.98\n17            579   657350.94            657350.94\n18            650   529372.97            529372.97\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') ))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.389416,
                    "execution_time": 0.161097,
                    "compile_time": 0.147867,
                    "planning_time": 0.052825,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.35618,
                    "execution_time": 1.856731,
                    "compile_time": 6.322687,
                    "planning_time": 0.147002,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0           202.0   42651.12             42651.12\n1           652.0   18457.90             18457.90\n2           761.0   18486.23             18486.23\n3             NaN   60430.56             60430.56\n4           260.0   57877.22             57877.22\n5           355.0   78656.98             78656.98\n6           461.0  101658.21            101658.21\n7           621.0   58527.89             58527.89\n8           631.0   97376.90             97376.90\n9           655.0   40054.23             40054.23\n10          871.0   22055.93             22055.93\n11          957.0   18510.63             18510.63\n12          969.0   61936.92             61936.92\n13            1.0  100150.07            100150.07\n14           61.0   79308.72             79308.72\n15          148.0   20009.68             20009.68\n16          434.0   38091.47             38091.47\n17          504.0   17857.01             17857.01\n18          522.0   60318.62             60318.62\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018801,
                    "execution_time": 0.008356,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004322
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0568,
                    "execution_time": 0.007961,
                    "compile_time": 5e-05,
                    "planning_time": 0.040645
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0           202.0   42651.12             42651.12\n1           652.0   18457.90             18457.90\n2           761.0   18486.23             18486.23\n3             NaN   60430.56             60430.56\n4           260.0   57877.22             57877.22\n5           355.0   78656.98             78656.98\n6           461.0  101658.21            101658.21\n7           621.0   58527.89             58527.89\n8           631.0   97376.90             97376.90\n9           655.0   40054.23             40054.23\n10          871.0   22055.93             22055.93\n11          957.0   18510.63             18510.63\n12          969.0   61936.92             61936.92\n13            1.0  100150.07            100150.07\n14           61.0   79308.72             79308.72\n15          148.0   20009.68             20009.68\n16          434.0   38091.47             38091.47\n17          504.0   17857.01             17857.01\n18          522.0   60318.62             60318.62\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) as sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) as avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7')\n)) /*CURSOR_IDENTIFIER*/\ngroup by i_manufact_id\n) as sales_data;",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' ) AND \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' ) AND \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.210277,
                    "execution_time": 0.132337,
                    "compile_time": 0.000524,
                    "planning_time": 0.052495,
                    "create_size": 624
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.328914,
                    "execution_time": 0.129372,
                    "compile_time": 7.034835,
                    "planning_time": 0.130824,
                    "create_size": 624
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             169   19181.84             19181.84\n1             178   19049.92             19049.92\n2             318   18290.20             18290.20\n3             268   19811.24             19811.24\n4               5   21103.10             21103.10\n5              86   21738.94             21738.94\n6             502   19199.85             19199.85\n7             813   18694.76             18694.76\n8             552   19328.70             19328.70\n9             594   19099.25             19099.25\n10            863   19890.70             19890.70\n11            279   19867.94             19867.94\n12             81   18643.47             18643.47\n13             87   38109.81             38109.81\n14            484   19303.95             19303.95\n15            141   39805.31             39805.31\n16            302   18523.68             18523.68\n17            191   20047.38             20047.38\n18            227   19227.69             19227.69\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017716,
                    "execution_time": 0.007598,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004337
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055881,
                    "execution_time": 0.007182,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.040498
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ('scholaramalgamalg #14', 'scholaramalgamalg #7') AND \"ITEM\".\"I_CATEGORY\" IN ('Books', 'Children', 'Electronics') AND \"ITEM\".\"I_CLASS\" IN ('personal', 'portable', 'reference', 'self-help') GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             169   19181.84             19181.84\n1             178   19049.92             19049.92\n2             318   18290.20             18290.20\n3             268   19811.24             19811.24\n4               5   21103.10             21103.10\n5              86   21738.94             21738.94\n6             502   19199.85             19199.85\n7             813   18694.76             18694.76\n8             552   19328.70             19328.70\n9             594   19099.25             19099.25\n10            863   19890.70             19890.70\n11            279   19867.94             19867.94\n12             81   18643.47             18643.47\n13             87   38109.81             38109.81\n14            484   19303.95             19303.95\n15            141   39805.31             39805.31\n16            302   18523.68             18523.68\n17            191   20047.38             20047.38\n18            227   19227.69             19227.69\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') ))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.402296,
                    "execution_time": 0.289776,
                    "compile_time": 0.029956,
                    "planning_time": 0.05503,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.794795,
                    "execution_time": 0.294079,
                    "compile_time": 3.332099,
                    "planning_time": 0.135366,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181  385944.18            385944.18\n1             183  150610.01            150610.01\n2             215  239834.16            239834.16\n3             220  292492.06            292492.06\n4             285  290094.87            290094.87\n5             305  202267.33            202267.33\n6             427  231120.19            231120.19\n7             478  195313.15            195313.15\n8             496  215419.29            215419.29\n9             536  176815.36            176815.36\n10            741   37875.66             37875.66\n11            808   77384.93             77384.93\n12            837   21406.46             21406.46\n13             65  337472.69            337472.69\n14             90  330112.36            330112.36\n15            153  460438.95            460438.95\n16            169  325672.65            325672.65\n17            178  259320.82            259320.82\n18            470  173000.66            173000.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018401,
                    "execution_time": 0.008348,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004296
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054741,
                    "execution_time": 0.008137,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.038687
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181  385944.18            385944.18\n1             183  150610.01            150610.01\n2             215  239834.16            239834.16\n3             220  292492.06            292492.06\n4             285  290094.87            290094.87\n5             305  202267.33            202267.33\n6             427  231120.19            231120.19\n7             478  195313.15            195313.15\n8             496  215419.29            215419.29\n9             536  176815.36            176815.36\n10            741   37875.66             37875.66\n11            808   77384.93             77384.93\n12            837   21406.46             21406.46\n13             65  337472.69            337472.69\n14             90  330112.36            330112.36\n15            153  460438.95            460438.95\n16            169  325672.65            325672.65\n17            178  259320.82            259320.82\n18            470  173000.66            173000.66\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) as sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) as avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor (i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1'))\n)\ngroup by i_manufact_id\n) as sales_data /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.223194,
                    "execution_time": 0.137643,
                    "compile_time": 0.000557,
                    "planning_time": 0.058057,
                    "create_size": 816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.29203,
                    "execution_time": 0.134941,
                    "compile_time": 3.984263,
                    "planning_time": 0.135034,
                    "create_size": 816
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             432   20603.28             20603.28\n1             931   18442.39             18442.39\n2             985   20304.24             20304.24\n3             130   18910.88             18910.88\n4             140   20628.02             20628.02\n5             975   20039.05             20039.05\n6             887   18827.61             18827.61\n7             327   20272.99             20272.99\n8             410   19016.41             19016.41\n9             598   18441.88             18441.88\n10            168   21696.61             21696.61\n11            398   20620.81             20620.81\n12            190   19083.36             19083.36\n13            103   19653.42             19653.42\n14            242   21569.57             21569.57\n15            415   18294.03             18294.03\n16            169   19181.84             19181.84\n17            178   19049.92             19049.92\n18              5   21103.10             21103.10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017234,
                    "execution_time": 0.007294,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004178
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055636,
                    "execution_time": 0.008047,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.039472
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             432   20603.28             20603.28\n1             931   18442.39             18442.39\n2             985   20304.24             20304.24\n3             130   18910.88             18910.88\n4             140   20628.02             20628.02\n5             975   20039.05             20039.05\n6             887   18827.61             18827.61\n7             327   20272.99             20272.99\n8             410   19016.41             19016.41\n9             598   18441.88             18441.88\n10            168   21696.61             21696.61\n11            398   20620.81             20620.81\n12            190   19083.36             19083.36\n13            103   19653.42             19653.42\n14            242   21569.57             21569.57\n15            415   18294.03             18294.03\n16            169   19181.84             19181.84\n17            178   19049.92             19049.92\n18              5   21103.10             21103.10\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.222058,
                    "execution_time": 0.138999,
                    "compile_time": 0.000562,
                    "planning_time": 0.055146,
                    "create_size": 948
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.247865,
                    "execution_time": 0.14249,
                    "compile_time": 3.940827,
                    "planning_time": 0.132857,
                    "create_size": 948
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             285   19797.08             19797.08\n1             169   19181.84             19181.84\n2             178   19049.92             19049.92\n3               5   21103.10             21103.10\n4              86   21738.94             21738.94\n5             396   17442.06             17442.06\n6             268   19811.24             19811.24\n7             879   19526.35             19526.35\n8             961   20022.50             20022.50\n9             813   18694.76             18694.76\n10            863   19890.70             19890.70\n11            279   38653.04             38653.04\n12            116   19148.63             19148.63\n13            453   21203.62             21203.62\n14            302   18523.68             18523.68\n15            312   18057.50             18057.50\n16            316   20275.47             20275.47\n17            113   40446.26             40446.26\n18            191   39379.06             39379.06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019034,
                    "execution_time": 0.008186,
                    "compile_time": 5e-05,
                    "planning_time": 0.00465
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055817,
                    "execution_time": 0.007674,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039724
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             285   19797.08             19797.08\n1             169   19181.84             19181.84\n2             178   19049.92             19049.92\n3               5   21103.10             21103.10\n4              86   21738.94             21738.94\n5             396   17442.06             17442.06\n6             268   19811.24             19811.24\n7             879   19526.35             19526.35\n8             961   20022.50             20022.50\n9             813   18694.76             18694.76\n10            863   19890.70             19890.70\n11            279   38653.04             38653.04\n12            116   19148.63             19148.63\n13            453   21203.62             21203.62\n14            302   18523.68             18523.68\n15            312   18057.50             18057.50\n16            316   20275.47             20275.47\n17            113   40446.26             40446.26\n18            191   39379.06             39379.06\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.401786,
                    "execution_time": 0.145144,
                    "compile_time": 0.197951,
                    "planning_time": 0.055775,
                    "create_size": 948
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.726773,
                    "execution_time": 1.787693,
                    "compile_time": 9.472062,
                    "planning_time": 0.135754,
                    "create_size": 948
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61    2764.33              4976.46\n1              61    8402.63              4976.46\n2              61    2539.22              4976.46\n3              61    6199.66              4976.46\n4             355    4793.99              4788.93\n5             355    3669.49              4788.93\n6             355    8125.32              4788.93\n7             355    2566.95              4788.93\n8             631    3173.57              5008.45\n9             631    9109.02              5008.45\n10            631    2471.68              5008.45\n11            631    5279.54              5008.45\n12            871    5514.43              5085.33\n13            871    2634.16              5085.33\n14            871    3278.74              5085.33\n15            871    8913.99              5085.33\n16             80    9482.45              5506.34\n17             80    5503.24              5506.34\n18             80    3485.33              5506.34\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017176,
                    "execution_time": 0.007197,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004191
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055861,
                    "execution_time": 0.008091,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039505
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61    2764.33              4976.46\n1              61    8402.63              4976.46\n2              61    2539.22              4976.46\n3              61    6199.66              4976.46\n4             355    4793.99              4788.93\n5             355    3669.49              4788.93\n6             355    8125.32              4788.93\n7             355    2566.95              4788.93\n8             631    3173.57              5008.45\n9             631    9109.02              5008.45\n10            631    2471.68              5008.45\n11            631    5279.54              5008.45\n12            871    5514.43              5085.33\n13            871    2634.16              5085.33\n14            871    3278.74              5085.33\n15            871    8913.99              5085.33\n16             80    9482.45              5506.34\n17             80    5503.24              5506.34\n18             80    3485.33              5506.34\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 then 1 else 0 end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.107985,
                    "execution_time": 0.062947,
                    "compile_time": 0.014421,
                    "planning_time": 0.005281,
                    "create_size": 948
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.501341,
                    "execution_time": 0.086324,
                    "compile_time": 3.323966,
                    "planning_time": 0.062447,
                    "create_size": 948
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61    2764.33              4976.46\n1              61    8402.63              4976.46\n2              61    2539.22              4976.46\n3              61    6199.66              4976.46\n4             355    4793.99              4788.93\n5             355    3669.49              4788.93\n6             355    8125.32              4788.93\n7             355    2566.95              4788.93\n8             631    3173.57              5008.45\n9             631    9109.02              5008.45\n10            631    2471.68              5008.45\n11            631    5279.54              5008.45\n12            871    5514.43              5085.33\n13            871    2634.16              5085.33\n14            871    3278.74              5085.33\n15            871    8913.99              5085.33\n16             80    9482.45              5506.34\n17             80    5503.24              5506.34\n18             80    3485.33              5506.34\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017319,
                    "execution_time": 0.007303,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004263
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053064,
                    "execution_time": 0.007678,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039534
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              61    2764.33              4976.46\n1              61    8402.63              4976.46\n2              61    2539.22              4976.46\n3              61    6199.66              4976.46\n4             355    4793.99              4788.93\n5             355    3669.49              4788.93\n6             355    8125.32              4788.93\n7             355    2566.95              4788.93\n8             631    3173.57              5008.45\n9             631    9109.02              5008.45\n10            631    2471.68              5008.45\n11            631    5279.54              5008.45\n12            871    5514.43              5085.33\n13            871    2634.16              5085.33\n14            871    3278.74              5085.33\n15            871    8913.99              5085.33\n16             80    9482.45              5506.34\n17             80    5503.24              5506.34\n18             80    3485.33              5506.34\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales > 0.1 end\n/*CURSOR_IDENTIFIER*/ order by sum_sales desc",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0.1 END ORDER BY \"TMP1\".\"SUM_SALES\" DESC NULLS FIRST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0.1 END",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.127942,
                    "execution_time": 0.059237,
                    "compile_time": 0.036672,
                    "planning_time": 0.006511,
                    "create_size": 948
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.665213,
                    "execution_time": 0.070058,
                    "compile_time": 3.503259,
                    "planning_time": 0.062688,
                    "create_size": 948
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_11\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" DESC LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             141   24470.71             14363.84\n1             113   18980.73             10111.56\n2             191   18938.15              9844.76\n3             315   18328.74              9537.20\n4             135   17634.21              9997.20\n5             318   16704.55              9586.51\n6             494   16698.92              9728.32\n7              87   16220.31              9527.45\n8             141   16202.63             14363.84\n9             279   15206.95              9663.26\n10            279   11953.59              9663.26\n11             86   10582.98              5434.73\n12            259   10431.04              5222.01\n13            658   10430.68              5388.52\n14            462   10099.21              5193.46\n15            333    9825.67              5485.01\n16            118    9792.39              5030.43\n17              5    9770.73              5275.77\n18            146    9708.89              5175.56\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038651,
                    "execution_time": 0.008705,
                    "compile_time": 0.019017,
                    "planning_time": 0.004744
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.719638,
                    "execution_time": 0.009419,
                    "compile_time": 4.66581,
                    "planning_time": 0.039754
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0.1 END ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_11\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             141   24470.71             14363.84\n1             113   18980.73             10111.56\n2             191   18938.15              9844.76\n3             315   18328.74              9537.20\n4             135   17634.21              9997.20\n5             318   16704.55              9586.51\n6             494   16698.92              9728.32\n7              87   16220.31              9527.45\n8             141   16202.63             14363.84\n9             279   15206.95              9663.26\n10            279   11953.59              9663.26\n11             86   10582.98              5434.73\n12            259   10431.04              5222.01\n13            658   10430.68              5388.52\n14            462   10099.21              5193.46\n15            333    9825.67              5485.01\n16            118    9792.39              5030.43\n17              5    9770.73              5275.77\n18            146    9708.89              5175.56\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.110311,
                    "execution_time": 0.061705,
                    "compile_time": 0.017495,
                    "planning_time": 0.006148,
                    "create_size": 948
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.752112,
                    "execution_time": 0.080452,
                    "compile_time": 3.579073,
                    "planning_time": 0.062934,
                    "create_size": 948
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             285    9006.79              4949.27\n1             285    2938.31              4949.27\n2             285    2718.13              4949.27\n3             318    4888.65              9586.51\n4             318    6448.91              9586.51\n5             318   16704.55              9586.51\n6              25    3199.42              4637.09\n7              25    8426.40              4637.09\n8              25    2035.75              4637.09\n9              52    3360.76              5224.62\n10             52    9419.92              5224.62\n11             52    2281.18              5224.62\n12             52    5836.63              5224.62\n13            169    2982.96              4795.46\n14            169    7919.62              4795.46\n15            169    3210.59              4795.46\n16            178    2758.25              4762.48\n17            178    8124.11              4762.48\n18            178    2965.23              4762.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018272,
                    "execution_time": 0.007879,
                    "compile_time": 5e-05,
                    "planning_time": 0.004368
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055929,
                    "execution_time": 0.008137,
                    "compile_time": 5e-05,
                    "planning_time": 0.03948
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             285    9006.79              4949.27\n1             285    2938.31              4949.27\n2             285    2718.13              4949.27\n3             318    4888.65              9586.51\n4             318    6448.91              9586.51\n5             318   16704.55              9586.51\n6              25    3199.42              4637.09\n7              25    8426.40              4637.09\n8              25    2035.75              4637.09\n9              52    3360.76              5224.62\n10             52    9419.92              5224.62\n11             52    2281.18              5224.62\n12             52    5836.63              5224.62\n13            169    2982.96              4795.46\n14            169    7919.62              4795.46\n15            169    3210.59              4795.46\n16            178    2758.25              4762.48\n17            178    8124.11              4762.48\n18            178    2965.23              4762.48\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    7085.71              4056.15\n2             211    4891.55              4056.15\n3             211    2476.46              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    7179.79              4445.83\n8              10    5268.01              4445.83\n9              10    2963.83              4445.83\n10             10    2371.71              4445.83\n11            334    7494.72              4451.61\n12            334    2195.52              4451.61\n13            334    5773.99              4451.61\n14            334    2342.21              4451.61\n15            596    8189.30              4491.75\n16            596    2289.04              4491.75\n17            596    2789.46              4491.75\n18            350    3274.61              4501.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031925,
                    "execution_time": 0.008781,
                    "compile_time": 0.012542,
                    "planning_time": 0.00462
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.450857,
                    "execution_time": 0.009678,
                    "compile_time": 4.388588,
                    "planning_time": 0.03964
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    7085.71              4056.15\n2             211    4891.55              4056.15\n3             211    2476.46              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    7179.79              4445.83\n8              10    5268.01              4445.83\n9              10    2963.83              4445.83\n10             10    2371.71              4445.83\n11            334    7494.72              4451.61\n12            334    2195.52              4451.61\n13            334    5773.99              4451.61\n14            334    2342.21              4451.61\n15            596    8189.30              4491.75\n16            596    2289.04              4491.75\n17            596    2789.46              4491.75\n18            350    3274.61              4501.85\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    2476.46              4056.15\n2             211    4891.55              4056.15\n3             211    7085.71              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    2371.71              4445.83\n8              10    2963.83              4445.83\n9              10    5268.01              4445.83\n10             10    7179.79              4445.83\n11            334    2195.52              4451.61\n12            334    2342.21              4451.61\n13            334    5773.99              4451.61\n14            334    7494.72              4451.61\n15            596    2289.04              4491.75\n16            596    2789.46              4491.75\n17            596    8189.30              4491.75\n18            350    1962.28              4501.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033908,
                    "execution_time": 0.008612,
                    "compile_time": 0.014769,
                    "planning_time": 0.004382
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.531895,
                    "execution_time": 0.009138,
                    "compile_time": 4.478913,
                    "planning_time": 0.039966
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    2476.46              4056.15\n2             211    4891.55              4056.15\n3             211    7085.71              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    2371.71              4445.83\n8              10    2963.83              4445.83\n9              10    5268.01              4445.83\n10             10    7179.79              4445.83\n11            334    2195.52              4451.61\n12            334    2342.21              4451.61\n13            334    5773.99              4451.61\n14            334    7494.72              4451.61\n15            596    2289.04              4491.75\n16            596    2789.46              4491.75\n17            596    8189.30              4491.75\n18            350    1962.28              4501.85\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST , \"TMP1\".\"I_MANUFACT_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    2476.46              4056.15\n2             211    4891.55              4056.15\n3             211    7085.71              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    2371.71              4445.83\n8              10    2963.83              4445.83\n9              10    5268.01              4445.83\n10             10    7179.79              4445.83\n11            334    2195.52              4451.61\n12            334    2342.21              4451.61\n13            334    5773.99              4451.61\n14            334    7494.72              4451.61\n15            596    2289.04              4491.75\n16            596    2789.46              4491.75\n17            596    8189.30              4491.75\n18            350    1962.28              4501.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03523,
                    "execution_time": 0.00897,
                    "compile_time": 0.015527,
                    "planning_time": 0.004732
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.419087,
                    "execution_time": 0.009699,
                    "compile_time": 3.368401,
                    "planning_time": 0.040149
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    2476.46              4056.15\n2             211    4891.55              4056.15\n3             211    7085.71              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    2371.71              4445.83\n8              10    2963.83              4445.83\n9              10    5268.01              4445.83\n10             10    7179.79              4445.83\n11            334    2195.52              4451.61\n12            334    2342.21              4451.61\n13            334    5773.99              4451.61\n14            334    7494.72              4451.61\n15            596    2289.04              4491.75\n16            596    2789.46              4491.75\n17            596    8189.30              4491.75\n18            350    1962.28              4501.85\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST , \"TMP1\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    2476.46              4056.15\n2             211    4891.55              4056.15\n3             211    7085.71              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    2371.71              4445.83\n8              10    2963.83              4445.83\n9              10    5268.01              4445.83\n10             10    7179.79              4445.83\n11            334    2195.52              4451.61\n12            334    2342.21              4451.61\n13            334    5773.99              4451.61\n14            334    7494.72              4451.61\n15            596    2289.04              4491.75\n16            596    2789.46              4491.75\n17            596    8189.30              4491.75\n18            350    1962.28              4501.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019263,
                    "execution_time": 0.008545,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004743
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020511,
                    "execution_time": 0.009427,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             211    1770.90              4056.15\n1             211    2476.46              4056.15\n2             211    4891.55              4056.15\n3             211    7085.71              4056.15\n4             396    2301.18              4360.51\n5             396    2629.22              4360.51\n6             396    7799.82              4360.51\n7              10    2371.71              4445.83\n8              10    2963.83              4445.83\n9              10    5268.01              4445.83\n10             10    7179.79              4445.83\n11            334    2195.52              4451.61\n12            334    2342.21              4451.61\n13            334    5773.99              4451.61\n14            334    7494.72              4451.61\n15            596    2289.04              4491.75\n16            596    2789.46              4491.75\n17            596    8189.30              4491.75\n18            350    1962.28              4501.85\n...*/"
    }
]