[
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere  1=1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.587683,
                    "execution_time": 0.513504,
                    "compile_time": 0.000454,
                    "planning_time": 0.045261,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.004818,
                    "execution_time": 0.524705,
                    "compile_time": 3.333171,
                    "planning_time": 0.112884,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.610745e+12*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015021,
                    "execution_time": 0.006725,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.002862
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051281,
                    "execution_time": 0.007261,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038178
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.610745e+12*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and '1998-02-28'  \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.087547,
                    "execution_time": 0.038281,
                    "compile_time": 0.000261,
                    "planning_time": 0.025988,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.153754,
                    "execution_time": 0.038287,
                    "compile_time": 0.00027,
                    "planning_time": 0.087946,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    excess discount amount\n0             3.610745e+12\n1             3.610745e+12\n2             3.610745e+12\n3             3.610745e+12\n4             3.610745e+12\n5             3.610745e+12\n6             3.610745e+12\n7             3.610745e+12\n8             3.610745e+12\n9             3.610745e+12\n10            3.610745e+12\n11            3.610745e+12\n12            3.610745e+12\n13            3.610745e+12\n14            3.610745e+12\n15            3.610745e+12\n16            3.610745e+12\n17            3.610745e+12\n18            3.610745e+12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015574,
                    "execution_time": 0.006858,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053582,
                    "execution_time": 0.007494,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.037961
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('1998-02-28' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    excess discount amount\n0             3.610745e+12\n1             3.610745e+12\n2             3.610745e+12\n3             3.610745e+12\n4             3.610745e+12\n5             3.610745e+12\n6             3.610745e+12\n7             3.610745e+12\n8             3.610745e+12\n9             3.610745e+12\n10            3.610745e+12\n11            3.610745e+12\n12            3.610745e+12\n13            3.610745e+12\n14            3.610745e+12\n15            3.610745e+12\n16            3.610745e+12\n17            3.610745e+12\n18            3.610745e+12\n...*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            4.498046e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.105571,
                    "execution_time": 0.05681,
                    "compile_time": 0.000192,
                    "planning_time": 0.038024
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.17036,
                    "execution_time": 0.055062,
                    "compile_time": 0.000196,
                    "planning_time": 0.103182
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            4.498046e+09*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1560843.57*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.267913,
                    "execution_time": 0.193876,
                    "compile_time": 0.022266,
                    "planning_time": 0.040005
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.452084,
                    "execution_time": 0.20137,
                    "compile_time": 3.12564,
                    "planning_time": 0.111065
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1560843.57*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > 0 LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1560843.57*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.292136,
                    "execution_time": 0.209236,
                    "compile_time": 0.032824,
                    "planning_time": 0.039047
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.595758,
                    "execution_time": 0.212118,
                    "compile_time": 3.259071,
                    "planning_time": 0.10938
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1560843.57*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n/*CURSOR_IDENTIFIER*/ \n         0\n         )",
        "optimize": [
            "SELECT 0 AS \"0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT 0 AS \"0\" LIMIT 21",
                "preview": "\n/*   0\n0  0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.709205,
                    "execution_time": 0.503023,
                    "compile_time": 0.000374,
                    "planning_time": 0.073927
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.742351,
                    "execution_time": 0.538027,
                    "compile_time": 0.000313,
                    "planning_time": 0.074276
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 0 AS \"0\"",
                "rewrite": "SELECT 0 AS \"0\""
            }
        ],
        "preview": "\n/*   0\n0  0*/"
    },
    {
        "input": "select /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_item_sk = ws_item_sk \nand d_date_sk = ws_sold_date_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales\n         WHERE \n            ws_ext_discount_amt IS NOT NULL\n       ) /* Closing the open subquery */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE NOT \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" IS NULL ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE NOT \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.403808,
                    "execution_time": 0.337708,
                    "compile_time": 0.01576,
                    "planning_time": 0.025147,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.52653,
                    "execution_time": 0.337767,
                    "compile_time": 3.068699,
                    "planning_time": 0.089036,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_ITEM_SK = WS_ITEM_SK AND D_DATE_SK = WS_SOLD_DATE_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES WHERE NOT WS_EXT_DISCOUNT_AMT IS NULL ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.685663e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.386333,
                    "execution_time": 0.178114,
                    "compile_time": 0.148926,
                    "planning_time": 0.044213
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.911076,
                    "execution_time": 0.438529,
                    "compile_time": 3.337526,
                    "planning_time": 0.115132
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.685663e+09*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\nitem.i_manufact_id = 992\nand item.i_item_sk = ws_item_sk \nand date_dim.d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand date_dim.d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n         web_sales\n/*CURSOR_IDENTIFIER*/  )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.115759,
                    "execution_time": 0.065863,
                    "compile_time": 0.000293,
                    "planning_time": 0.024973,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.181322,
                    "execution_time": 0.066564,
                    "compile_time": 0.000273,
                    "planning_time": 0.089576,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE ITEM.I_MANUFACT_ID = 992 AND ITEM.I_ITEM_SK = WS_ITEM_SK AND DATE_DIM.D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND DATE_DIM.D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1123790.84*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.221403,
                    "execution_time": 0.146666,
                    "compile_time": 0.015415,
                    "planning_time": 0.044422
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.594395,
                    "execution_time": 0.148745,
                    "compile_time": 3.313469,
                    "planning_time": 0.112839
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1123790.84*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n    ,date_dim\nwhere\nd_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n         where ws_ext_discount_amt > 0\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0 ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.340841,
                    "execution_time": 0.250428,
                    "compile_time": 0.035941,
                    "planning_time": 0.028619,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.673588,
                    "execution_time": 0.252037,
                    "compile_time": 3.301526,
                    "planning_time": 0.089869,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , DATE_DIM WHERE D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES WHERE WS_EXT_DISCOUNT_AMT > 0 ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.668109e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.282163,
                    "execution_time": 0.159946,
                    "compile_time": 0.070263,
                    "planning_time": 0.038511
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.801166,
                    "execution_time": 0.336356,
                    "compile_time": 3.342596,
                    "planning_time": 0.104142
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.668109e+09*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n           WHERE d_date_sk = ws_sold_date_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.232185,
                    "execution_time": 1.154665,
                    "compile_time": 0.016127,
                    "planning_time": 0.033989,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.581074,
                    "execution_time": 1.167091,
                    "compile_time": 3.279925,
                    "planning_time": 0.101398,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1123790.84*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.250033,
                    "execution_time": 1.166258,
                    "compile_time": 0.019215,
                    "planning_time": 0.047943
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.678136,
                    "execution_time": 1.168259,
                    "compile_time": 3.367796,
                    "planning_time": 0.119609
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1123790.84*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE d_date_sk = ws_sold_date_sk\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1123790.84*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.25628,
                    "execution_time": 0.143109,
                    "compile_time": 0.045478,
                    "planning_time": 0.050564
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.230194,
                    "execution_time": 1.16619,
                    "compile_time": 0.000355,
                    "planning_time": 0.046821
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1123790.84*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\"",
                "rewrite": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n         dateadd(day,90,cast('1998-02-02' as date))\n         )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1109455.01*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.214685,
                    "execution_time": 0.07369,
                    "compile_time": 0.049403,
                    "planning_time": 0.069687
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.408763,
                    "execution_time": 1.668256,
                    "compile_time": 4.564342,
                    "planning_time": 0.147897
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1109455.01*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1109455.01*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.166239,
                    "execution_time": 0.076554,
                    "compile_time": 0.000477,
                    "planning_time": 0.068436
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.168059,
                    "execution_time": 0.075105,
                    "compile_time": 0.00051,
                    "planning_time": 0.070389
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1109455.01*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.605787,
                    "execution_time": 1.32382,
                    "compile_time": 0.000265,
                    "planning_time": 0.026943,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.672793,
                    "execution_time": 1.309275,
                    "compile_time": 0.00027,
                    "planning_time": 0.08764,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1117842.85*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.378005,
                    "execution_time": 0.253048,
                    "compile_time": 0.034837,
                    "planning_time": 0.068376
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.933183,
                    "execution_time": 0.252256,
                    "compile_time": 3.514039,
                    "planning_time": 0.141094
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1117842.85*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1117842.85*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.347967,
                    "execution_time": 0.255953,
                    "compile_time": 0.00052,
                    "planning_time": 0.068771
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.345806,
                    "execution_time": 0.250815,
                    "compile_time": 0.000481,
                    "planning_time": 0.072424
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1117842.85*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ORDER BY SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) ORDER BY SUM ( WS_EXT_DISCOUNT_AMT ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1117842.85*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.131947,
                    "execution_time": 0.037404,
                    "compile_time": 0.000497,
                    "planning_time": 0.0705
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.382689,
                    "execution_time": 0.038371,
                    "compile_time": 0.180849,
                    "planning_time": 0.140422
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1117842.85*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ORDER BY SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) ORDER BY SUM ( WS_EXT_DISCOUNT_AMT ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1117842.85*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.128903,
                    "execution_time": 0.037528,
                    "compile_time": 0.000468,
                    "planning_time": 0.069195
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.131955,
                    "execution_time": 0.039606,
                    "compile_time": 0.000519,
                    "planning_time": 0.06957
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1117842.85*/"
    }
]