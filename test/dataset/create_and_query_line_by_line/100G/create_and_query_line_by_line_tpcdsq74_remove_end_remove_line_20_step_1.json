[
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_firstyear.customer_id, t_s_firstyear.customer_first_name, t_s_firstyear.customer_last_name\n from year_total t_s_firstyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.842278,
                    "execution_time": 0.423193,
                    "compile_time": 0.052619,
                    "planning_time": 0.023173,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.163105,
                    "execution_time": 0.444896,
                    "compile_time": 3.283057,
                    "planning_time": 0.083991,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.116673,
                    "execution_time": 0.031896,
                    "compile_time": 0.036278,
                    "planning_time": 0.024839,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.398308,
                    "execution_time": 0.031446,
                    "compile_time": 3.253685,
                    "planning_time": 0.085652,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.527451,
                    "execution_time": 3.107532,
                    "compile_time": 0.061912,
                    "planning_time": 0.043853,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 21.779447,
                    "execution_time": 3.427741,
                    "compile_time": 18.030781,
                    "planning_time": 0.135744,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPAHKAAAA              Mickey              Maple\n1   AAAAAAAALGEDMAAA              Efrain               Redd\n2   AAAAAAAAOIIJFAAA              Sandra            Canales\n3   AAAAAAAABFMMMBAA              Walter              Avila\n4   AAAAAAAAGJHEKBAA             Saundra              Smith\n5   AAAAAAAAIGOMNAAA                Glen            Coleman\n6   AAAAAAAAHMOLNAAA                Myra            Holland\n7   AAAAAAAAPBLPKBAA               Debra            Chapman\n8   AAAAAAAAIFBDDBAA              Joseph             Martin\n9   AAAAAAAAJJCCGAAA               Delia              Perez\n10  AAAAAAAAGIGAKAAA                 Amy            Francis\n11  AAAAAAAAPPDOABAA             Bradley           Williams\n12  AAAAAAAALHHCCAAA              Dustin             Aviles\n13  AAAAAAAANMKHCAAA              Thomas           Holloway\n14  AAAAAAAAIGPPGBAA             Alberta            Leblanc\n15  AAAAAAAAPFLBNBAA              Meagan               Dunn\n16  AAAAAAAANDMOFAAA              Elaine            Hoskins\n17  AAAAAAAAGIHDAAAA                Josh                Cox\n18  AAAAAAAALEHOHBAA             Juanita            Carrico\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044471,
                    "execution_time": 0.008384,
                    "compile_time": 0.026554,
                    "planning_time": 0.003449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.168012,
                    "execution_time": 0.007949,
                    "compile_time": 3.099861,
                    "planning_time": 0.038537
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\"",
                "rewrite": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPAHKAAAA              Mickey              Maple\n1   AAAAAAAALGEDMAAA              Efrain               Redd\n2   AAAAAAAAOIIJFAAA              Sandra            Canales\n3   AAAAAAAABFMMMBAA              Walter              Avila\n4   AAAAAAAAGJHEKBAA             Saundra              Smith\n5   AAAAAAAAIGOMNAAA                Glen            Coleman\n6   AAAAAAAAHMOLNAAA                Myra            Holland\n7   AAAAAAAAPBLPKBAA               Debra            Chapman\n8   AAAAAAAAIFBDDBAA              Joseph             Martin\n9   AAAAAAAAJJCCGAAA               Delia              Perez\n10  AAAAAAAAGIGAKAAA                 Amy            Francis\n11  AAAAAAAAPPDOABAA             Bradley           Williams\n12  AAAAAAAALHHCCAAA              Dustin             Aviles\n13  AAAAAAAANMKHCAAA              Thomas           Holloway\n14  AAAAAAAAIGPPGBAA             Alberta            Leblanc\n15  AAAAAAAAPFLBNBAA              Meagan               Dunn\n16  AAAAAAAANDMOFAAA              Elaine            Hoskins\n17  AAAAAAAAGIHDAAAA                Josh                Cox\n18  AAAAAAAALEHOHBAA             Juanita            Carrico\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAGIAOIAAA              Marian              Berry\n1   AAAAAAAAGIAOIAAA              Marian              Berry\n2   AAAAAAAAGIAOIAAA              Marian              Berry\n3   AAAAAAAAGIAOIAAA              Marian              Berry\n4   AAAAAAAAGIAOIAAA              Marian              Berry\n5   AAAAAAAAGIAOIAAA              Marian              Berry\n6   AAAAAAAAGIAOIAAA              Marian              Berry\n7   AAAAAAAAGIAOIAAA              Marian              Berry\n8   AAAAAAAAGIAOIAAA              Marian              Berry\n9   AAAAAAAAGIAOIAAA              Marian              Berry\n10  AAAAAAAAGIAOIAAA              Marian              Berry\n11  AAAAAAAAGIAOIAAA              Marian              Berry\n12  AAAAAAAAGIAOIAAA              Marian              Berry\n13  AAAAAAAAGIAOIAAA              Marian              Berry\n14  AAAAAAAAGIAOIAAA              Marian              Berry\n15  AAAAAAAAGIAOIAAA              Marian              Berry\n16  AAAAAAAAGIAOIAAA              Marian              Berry\n17  AAAAAAAAGIAOIAAA              Marian              Berry\n18  AAAAAAAAGIAOIAAA              Marian              Berry\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.073156,
                    "execution_time": 0.044297,
                    "compile_time": 0.051816,
                    "planning_time": 0.004434
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.198022,
                    "execution_time": 0.037487,
                    "compile_time": 3.139973,
                    "planning_time": 0.039619
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAGIAOIAAA              Marian              Berry\n1   AAAAAAAAGIAOIAAA              Marian              Berry\n2   AAAAAAAAGIAOIAAA              Marian              Berry\n3   AAAAAAAAGIAOIAAA              Marian              Berry\n4   AAAAAAAAGIAOIAAA              Marian              Berry\n5   AAAAAAAAGIAOIAAA              Marian              Berry\n6   AAAAAAAAGIAOIAAA              Marian              Berry\n7   AAAAAAAAGIAOIAAA              Marian              Berry\n8   AAAAAAAAGIAOIAAA              Marian              Berry\n9   AAAAAAAAGIAOIAAA              Marian              Berry\n10  AAAAAAAAGIAOIAAA              Marian              Berry\n11  AAAAAAAAGIAOIAAA              Marian              Berry\n12  AAAAAAAAGIAOIAAA              Marian              Berry\n13  AAAAAAAAGIAOIAAA              Marian              Berry\n14  AAAAAAAAGIAOIAAA              Marian              Berry\n15  AAAAAAAAGIAOIAAA              Marian              Berry\n16  AAAAAAAAGIAOIAAA              Marian              Berry\n17  AAAAAAAAGIAOIAAA              Marian              Berry\n18  AAAAAAAAGIAOIAAA              Marian              Berry\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAJFEIAAA              Robert              Adams\n1   AAAAAAAAAJFEIAAA              Robert              Adams\n2   AAAAAAAAAJFEIAAA              Robert              Adams\n3   AAAAAAAAAJFEIAAA              Robert              Adams\n4   AAAAAAAAAJFEIAAA              Robert              Adams\n5   AAAAAAAAAJFEIAAA              Robert              Adams\n6   AAAAAAAAAJFEIAAA              Robert              Adams\n7   AAAAAAAAAJFEIAAA              Robert              Adams\n8   AAAAAAAAAJFEIAAA              Robert              Adams\n9   AAAAAAAAAJFEIAAA              Robert              Adams\n10  AAAAAAAAAJFEIAAA              Robert              Adams\n11  AAAAAAAAAJFEIAAA              Robert              Adams\n12  AAAAAAAAAJFEIAAA              Robert              Adams\n13  AAAAAAAAAJFEIAAA              Robert              Adams\n14  AAAAAAAAAJFEIAAA              Robert              Adams\n15  AAAAAAAAAJFEIAAA              Robert              Adams\n16  AAAAAAAAAJFEIAAA              Robert              Adams\n17  AAAAAAAAAJFEIAAA              Robert              Adams\n18  AAAAAAAAAJFEIAAA              Robert              Adams\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.090729,
                    "execution_time": 0.077381,
                    "compile_time": 0.027416,
                    "planning_time": 0.005163
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.202142,
                    "execution_time": 0.079947,
                    "compile_time": 3.092911,
                    "planning_time": 0.040218
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAJFEIAAA              Robert              Adams\n1   AAAAAAAAAJFEIAAA              Robert              Adams\n2   AAAAAAAAAJFEIAAA              Robert              Adams\n3   AAAAAAAAAJFEIAAA              Robert              Adams\n4   AAAAAAAAAJFEIAAA              Robert              Adams\n5   AAAAAAAAAJFEIAAA              Robert              Adams\n6   AAAAAAAAAJFEIAAA              Robert              Adams\n7   AAAAAAAAAJFEIAAA              Robert              Adams\n8   AAAAAAAAAJFEIAAA              Robert              Adams\n9   AAAAAAAAAJFEIAAA              Robert              Adams\n10  AAAAAAAAAJFEIAAA              Robert              Adams\n11  AAAAAAAAAJFEIAAA              Robert              Adams\n12  AAAAAAAAAJFEIAAA              Robert              Adams\n13  AAAAAAAAAJFEIAAA              Robert              Adams\n14  AAAAAAAAAJFEIAAA              Robert              Adams\n15  AAAAAAAAAJFEIAAA              Robert              Adams\n16  AAAAAAAAAJFEIAAA              Robert              Adams\n17  AAAAAAAAAJFEIAAA              Robert              Adams\n18  AAAAAAAAAJFEIAAA              Robert              Adams\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAALDOFGAAA              Norman                   \n1   AAAAAAAALDOFGAAA              Norman                   \n2   AAAAAAAALDOFGAAA              Norman                   \n3   AAAAAAAALDOFGAAA              Norman                   \n4   AAAAAAAALDOFGAAA              Norman                   \n5   AAAAAAAALDOFGAAA              Norman                   \n6   AAAAAAAALDOFGAAA              Norman                   \n7   AAAAAAAALDOFGAAA              Norman                   \n8   AAAAAAAALDOFGAAA              Norman                   \n9   AAAAAAAALDOFGAAA              Norman                   \n10  AAAAAAAALDOFGAAA              Norman                   \n11  AAAAAAAALDOFGAAA              Norman                   \n12  AAAAAAAALDOFGAAA              Norman                   \n13  AAAAAAAALDOFGAAA              Norman                   \n14  AAAAAAAALDOFGAAA              Norman                   \n15  AAAAAAAALDOFGAAA              Norman                   \n16  AAAAAAAALDOFGAAA              Norman                   \n17  AAAAAAAALDOFGAAA              Norman                   \n18  AAAAAAAALDOFGAAA              Norman                   \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.126553,
                    "execution_time": 0.104436,
                    "compile_time": 0.036856,
                    "planning_time": 0.005945
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.424109,
                    "execution_time": 0.106286,
                    "compile_time": 3.295539,
                    "planning_time": 0.041338
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAALDOFGAAA              Norman                   \n1   AAAAAAAALDOFGAAA              Norman                   \n2   AAAAAAAALDOFGAAA              Norman                   \n3   AAAAAAAALDOFGAAA              Norman                   \n4   AAAAAAAALDOFGAAA              Norman                   \n5   AAAAAAAALDOFGAAA              Norman                   \n6   AAAAAAAALDOFGAAA              Norman                   \n7   AAAAAAAALDOFGAAA              Norman                   \n8   AAAAAAAALDOFGAAA              Norman                   \n9   AAAAAAAALDOFGAAA              Norman                   \n10  AAAAAAAALDOFGAAA              Norman                   \n11  AAAAAAAALDOFGAAA              Norman                   \n12  AAAAAAAALDOFGAAA              Norman                   \n13  AAAAAAAALDOFGAAA              Norman                   \n14  AAAAAAAALDOFGAAA              Norman                   \n15  AAAAAAAALDOFGAAA              Norman                   \n16  AAAAAAAALDOFGAAA              Norman                   \n17  AAAAAAAALDOFGAAA              Norman                   \n18  AAAAAAAALDOFGAAA              Norman                   \n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.874031,
                    "execution_time": 4.555939,
                    "compile_time": 0.000445,
                    "planning_time": 0.007002,
                    "create_size": 7639
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.717762,
                    "execution_time": 4.7106,
                    "compile_time": 4.60949,
                    "planning_time": 0.064568,
                    "create_size": 7639
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABFMMMBAA              Walter              Avila\n1   AAAAAAAABFMMMBAA              Walter              Avila\n2   AAAAAAAABFMMMBAA              Walter              Avila\n3   AAAAAAAABFMMMBAA              Walter              Avila\n4   AAAAAAAABFMMMBAA              Walter              Avila\n5   AAAAAAAABFMMMBAA              Walter              Avila\n6   AAAAAAAABFMMMBAA              Walter              Avila\n7   AAAAAAAABFMMMBAA              Walter              Avila\n8   AAAAAAAAGJHEKBAA             Saundra              Smith\n9   AAAAAAAAGJHEKBAA             Saundra              Smith\n10  AAAAAAAAGJHEKBAA             Saundra              Smith\n11  AAAAAAAAGJHEKBAA             Saundra              Smith\n12  AAAAAAAAGJHEKBAA             Saundra              Smith\n13  AAAAAAAAGJHEKBAA             Saundra              Smith\n14  AAAAAAAAGJHEKBAA             Saundra              Smith\n15  AAAAAAAAGJHEKBAA             Saundra              Smith\n16  AAAAAAAAGJHEKBAA             Saundra              Smith\n17  AAAAAAAAGJHEKBAA             Saundra              Smith\n18  AAAAAAAAGJHEKBAA             Saundra              Smith\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017657,
                    "execution_time": 0.007951,
                    "compile_time": 5e-05,
                    "planning_time": 0.003463
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.136613,
                    "execution_time": 0.008051,
                    "compile_time": 0.082294,
                    "planning_time": 0.038576
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABFMMMBAA              Walter              Avila\n1   AAAAAAAABFMMMBAA              Walter              Avila\n2   AAAAAAAABFMMMBAA              Walter              Avila\n3   AAAAAAAABFMMMBAA              Walter              Avila\n4   AAAAAAAABFMMMBAA              Walter              Avila\n5   AAAAAAAABFMMMBAA              Walter              Avila\n6   AAAAAAAABFMMMBAA              Walter              Avila\n7   AAAAAAAABFMMMBAA              Walter              Avila\n8   AAAAAAAAGJHEKBAA             Saundra              Smith\n9   AAAAAAAAGJHEKBAA             Saundra              Smith\n10  AAAAAAAAGJHEKBAA             Saundra              Smith\n11  AAAAAAAAGJHEKBAA             Saundra              Smith\n12  AAAAAAAAGJHEKBAA             Saundra              Smith\n13  AAAAAAAAGJHEKBAA             Saundra              Smith\n14  AAAAAAAAGJHEKBAA             Saundra              Smith\n15  AAAAAAAAGJHEKBAA             Saundra              Smith\n16  AAAAAAAAGJHEKBAA             Saundra              Smith\n17  AAAAAAAAGJHEKBAA             Saundra              Smith\n18  AAAAAAAAGJHEKBAA             Saundra              Smith\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.642854,
                    "execution_time": 3.177654,
                    "compile_time": 0.078147,
                    "planning_time": 0.042043,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.440629,
                    "execution_time": 3.512428,
                    "compile_time": 9.969543,
                    "planning_time": 0.126794,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.353001,
                    "execution_time": 3.018587,
                    "compile_time": 0.000625,
                    "planning_time": 0.008525,
                    "create_size": 4646
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.774379,
                    "execution_time": 2.978834,
                    "compile_time": 4.425603,
                    "planning_time": 0.064857,
                    "create_size": 4646
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAADHLMFBAA              Walter            Edwards\n1   AAAAAAAADHLMFBAA              Walter            Edwards\n2   AAAAAAAADHLMFBAA              Walter            Edwards\n3   AAAAAAAADHLMFBAA              Walter            Edwards\n4   AAAAAAAADHLMFBAA              Walter            Edwards\n5   AAAAAAAADHLMFBAA              Walter            Edwards\n6   AAAAAAAADHLMFBAA              Walter            Edwards\n7   AAAAAAAADHLMFBAA              Walter            Edwards\n8   AAAAAAAADHLMFBAA              Walter            Edwards\n9   AAAAAAAADHLMFBAA              Walter            Edwards\n10  AAAAAAAADHLMFBAA              Walter            Edwards\n11  AAAAAAAADHLMFBAA              Walter            Edwards\n12  AAAAAAAADHLMFBAA              Walter            Edwards\n13  AAAAAAAADHLMFBAA              Walter            Edwards\n14  AAAAAAAADHLMFBAA              Walter            Edwards\n15  AAAAAAAADHLMFBAA              Walter            Edwards\n16  AAAAAAAADHLMFBAA              Walter            Edwards\n17  AAAAAAAADHLMFBAA              Walter            Edwards\n18  AAAAAAAADHLMFBAA              Walter            Edwards\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01689,
                    "execution_time": 0.007454,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003479
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055392,
                    "execution_time": 0.008079,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038718
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAADHLMFBAA              Walter            Edwards\n1   AAAAAAAADHLMFBAA              Walter            Edwards\n2   AAAAAAAADHLMFBAA              Walter            Edwards\n3   AAAAAAAADHLMFBAA              Walter            Edwards\n4   AAAAAAAADHLMFBAA              Walter            Edwards\n5   AAAAAAAADHLMFBAA              Walter            Edwards\n6   AAAAAAAADHLMFBAA              Walter            Edwards\n7   AAAAAAAADHLMFBAA              Walter            Edwards\n8   AAAAAAAADHLMFBAA              Walter            Edwards\n9   AAAAAAAADHLMFBAA              Walter            Edwards\n10  AAAAAAAADHLMFBAA              Walter            Edwards\n11  AAAAAAAADHLMFBAA              Walter            Edwards\n12  AAAAAAAADHLMFBAA              Walter            Edwards\n13  AAAAAAAADHLMFBAA              Walter            Edwards\n14  AAAAAAAADHLMFBAA              Walter            Edwards\n15  AAAAAAAADHLMFBAA              Walter            Edwards\n16  AAAAAAAADHLMFBAA              Walter            Edwards\n17  AAAAAAAADHLMFBAA              Walter            Edwards\n18  AAAAAAAADHLMFBAA              Walter            Edwards\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAIAPBNAAA             William              White\n1   AAAAAAAAIAPBNAAA             William              White\n2   AAAAAAAAIAPBNAAA             William              White\n3   AAAAAAAAIAPBNAAA             William              White\n4   AAAAAAAAIAPBNAAA             William              White\n5   AAAAAAAAIAPBNAAA             William              White\n6   AAAAAAAAIAPBNAAA             William              White\n7   AAAAAAAAIAPBNAAA             William              White\n8   AAAAAAAAIAPBNAAA             William              White\n9   AAAAAAAAIAPBNAAA             William              White\n10  AAAAAAAAIAPBNAAA             William              White\n11  AAAAAAAAIAPBNAAA             William              White\n12  AAAAAAAAIAPBNAAA             William              White\n13  AAAAAAAAIAPBNAAA             William              White\n14  AAAAAAAAIAPBNAAA             William              White\n15  AAAAAAAAIAPBNAAA             William              White\n16  AAAAAAAAIAPBNAAA             William              White\n17  AAAAAAAAIAPBNAAA             William              White\n18  AAAAAAAAIAPBNAAA             William              White\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03539,
                    "execution_time": 0.023054,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.005013
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.176916,
                    "execution_time": 0.022456,
                    "compile_time": 0.115596,
                    "planning_time": 0.041403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAIAPBNAAA             William              White\n1   AAAAAAAAIAPBNAAA             William              White\n2   AAAAAAAAIAPBNAAA             William              White\n3   AAAAAAAAIAPBNAAA             William              White\n4   AAAAAAAAIAPBNAAA             William              White\n5   AAAAAAAAIAPBNAAA             William              White\n6   AAAAAAAAIAPBNAAA             William              White\n7   AAAAAAAAIAPBNAAA             William              White\n8   AAAAAAAAIAPBNAAA             William              White\n9   AAAAAAAAIAPBNAAA             William              White\n10  AAAAAAAAIAPBNAAA             William              White\n11  AAAAAAAAIAPBNAAA             William              White\n12  AAAAAAAAIAPBNAAA             William              White\n13  AAAAAAAAIAPBNAAA             William              White\n14  AAAAAAAAIAPBNAAA             William              White\n15  AAAAAAAAIAPBNAAA             William              White\n16  AAAAAAAAIAPBNAAA             William              White\n17  AAAAAAAAIAPBNAAA             William              White\n18  AAAAAAAAIAPBNAAA             William              White\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAADMJBAAA               Wanda              Reyes\n1   AAAAAAAAADMJBAAA               Wanda              Reyes\n2   AAAAAAAAADMJBAAA               Wanda              Reyes\n3   AAAAAAAAADMJBAAA               Wanda              Reyes\n4   AAAAAAAAADMJBAAA               Wanda              Reyes\n5   AAAAAAAAADMJBAAA               Wanda              Reyes\n6   AAAAAAAAADMJBAAA               Wanda              Reyes\n7   AAAAAAAAADMJBAAA               Wanda              Reyes\n8   AAAAAAAAADMJBAAA               Wanda              Reyes\n9   AAAAAAAAADMJBAAA               Wanda              Reyes\n10  AAAAAAAAADMJBAAA               Wanda              Reyes\n11  AAAAAAAAADMJBAAA               Wanda              Reyes\n12  AAAAAAAAADMJBAAA               Wanda              Reyes\n13  AAAAAAAAADMJBAAA               Wanda              Reyes\n14  AAAAAAAAADMJBAAA               Wanda              Reyes\n15  AAAAAAAAADMJBAAA               Wanda              Reyes\n16  AAAAAAAAADMJBAAA               Wanda              Reyes\n17  AAAAAAAAADMJBAAA               Wanda              Reyes\n18  AAAAAAAAPLDGBAAA               James              Gallo\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 6.299087,
                    "execution_time": 6.284099,
                    "compile_time": 0.000162,
                    "planning_time": 0.006377
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.074123,
                    "execution_time": 5.989147,
                    "compile_time": 0.048863,
                    "planning_time": 0.042103
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAADMJBAAA               Wanda              Reyes\n1   AAAAAAAAADMJBAAA               Wanda              Reyes\n2   AAAAAAAAADMJBAAA               Wanda              Reyes\n3   AAAAAAAAADMJBAAA               Wanda              Reyes\n4   AAAAAAAAADMJBAAA               Wanda              Reyes\n5   AAAAAAAAADMJBAAA               Wanda              Reyes\n6   AAAAAAAAADMJBAAA               Wanda              Reyes\n7   AAAAAAAAADMJBAAA               Wanda              Reyes\n8   AAAAAAAAADMJBAAA               Wanda              Reyes\n9   AAAAAAAAADMJBAAA               Wanda              Reyes\n10  AAAAAAAAADMJBAAA               Wanda              Reyes\n11  AAAAAAAAADMJBAAA               Wanda              Reyes\n12  AAAAAAAAADMJBAAA               Wanda              Reyes\n13  AAAAAAAAADMJBAAA               Wanda              Reyes\n14  AAAAAAAAADMJBAAA               Wanda              Reyes\n15  AAAAAAAAADMJBAAA               Wanda              Reyes\n16  AAAAAAAAADMJBAAA               Wanda              Reyes\n17  AAAAAAAAADMJBAAA               Wanda              Reyes\n18  AAAAAAAAPLDGBAAA               James              Gallo\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAIAPBNAAA             William              White\n1   AAAAAAAAIAPBNAAA             William              White\n2   AAAAAAAAIAPBNAAA             William              White\n3   AAAAAAAAIAPBNAAA             William              White\n4   AAAAAAAAIAPBNAAA             William              White\n5   AAAAAAAAIAPBNAAA             William              White\n6   AAAAAAAAIAPBNAAA             William              White\n7   AAAAAAAAIAPBNAAA             William              White\n8   AAAAAAAAIAPBNAAA             William              White\n9   AAAAAAAAIAPBNAAA             William              White\n10  AAAAAAAAIAPBNAAA             William              White\n11  AAAAAAAAIAPBNAAA             William              White\n12  AAAAAAAAIAPBNAAA             William              White\n13  AAAAAAAAIAPBNAAA             William              White\n14  AAAAAAAAIAPBNAAA             William              White\n15  AAAAAAAAIAPBNAAA             William              White\n16  AAAAAAAAIAPBNAAA             William              White\n17  AAAAAAAAIAPBNAAA             William              White\n18  AAAAAAAAJKKGJBAA              Robert           Williams\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 6.615104,
                    "execution_time": 6.597438,
                    "compile_time": 0.000211,
                    "planning_time": 0.007841
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.699138,
                    "execution_time": 6.61293,
                    "compile_time": 0.042448,
                    "planning_time": 0.043494
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAIAPBNAAA             William              White\n1   AAAAAAAAIAPBNAAA             William              White\n2   AAAAAAAAIAPBNAAA             William              White\n3   AAAAAAAAIAPBNAAA             William              White\n4   AAAAAAAAIAPBNAAA             William              White\n5   AAAAAAAAIAPBNAAA             William              White\n6   AAAAAAAAIAPBNAAA             William              White\n7   AAAAAAAAIAPBNAAA             William              White\n8   AAAAAAAAIAPBNAAA             William              White\n9   AAAAAAAAIAPBNAAA             William              White\n10  AAAAAAAAIAPBNAAA             William              White\n11  AAAAAAAAIAPBNAAA             William              White\n12  AAAAAAAAIAPBNAAA             William              White\n13  AAAAAAAAIAPBNAAA             William              White\n14  AAAAAAAAIAPBNAAA             William              White\n15  AAAAAAAAIAPBNAAA             William              White\n16  AAAAAAAAIAPBNAAA             William              White\n17  AAAAAAAAIAPBNAAA             William              White\n18  AAAAAAAAJKKGJBAA              Robert           Williams\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.82385,
                    "execution_time": 3.335022,
                    "compile_time": 0.065063,
                    "planning_time": 0.043329,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.43473,
                    "execution_time": 3.657077,
                    "compile_time": 11.690589,
                    "planning_time": 0.160423,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.093766,
                    "execution_time": 0.779708,
                    "compile_time": 0.000477,
                    "planning_time": 0.010735,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.128915,
                    "execution_time": 0.788694,
                    "compile_time": 7.030967,
                    "planning_time": 0.069812,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAALEAOBAA                Mari             Cowell\n1   AAAAAAAABFLMIBAA               Scott             Mullen\n2   AAAAAAAAJKJFOAAA               Helen             Austin\n3   AAAAAAAAJKJFOAAA               Helen             Austin\n4   AAAAAAAAJKJFOAAA               Helen             Austin\n5   AAAAAAAAJKJFOAAA               Helen             Austin\n6   AAAAAAAAOHKAFBAA               Glory          Hernandez\n7   AAAAAAAAHLLPNAAA            Jennifer            Nichols\n8   AAAAAAAAEHPOEBAA             Richard         Schweitzer\n9   AAAAAAAAEHPOEBAA             Richard         Schweitzer\n10  AAAAAAAAEHPOEBAA             Richard         Schweitzer\n11  AAAAAAAAEHPOEBAA             Richard         Schweitzer\n12  AAAAAAAAHDNAHBAA              Eunice             Walker\n13  AAAAAAAAHDNAHBAA              Eunice             Walker\n14  AAAAAAAAHDNAHBAA              Eunice             Walker\n15  AAAAAAAAHDNAHBAA              Eunice             Walker\n16  AAAAAAAAMIPHHBAA                Ivan               Sims\n17  AAAAAAAAMIPHHBAA                Ivan               Sims\n18  AAAAAAAAMIPHHBAA                Ivan               Sims\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017033,
                    "execution_time": 0.008001,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.00325
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055329,
                    "execution_time": 0.008052,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038849
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAALEAOBAA                Mari             Cowell\n1   AAAAAAAABFLMIBAA               Scott             Mullen\n2   AAAAAAAAJKJFOAAA               Helen             Austin\n3   AAAAAAAAJKJFOAAA               Helen             Austin\n4   AAAAAAAAJKJFOAAA               Helen             Austin\n5   AAAAAAAAJKJFOAAA               Helen             Austin\n6   AAAAAAAAOHKAFBAA               Glory          Hernandez\n7   AAAAAAAAHLLPNAAA            Jennifer            Nichols\n8   AAAAAAAAEHPOEBAA             Richard         Schweitzer\n9   AAAAAAAAEHPOEBAA             Richard         Schweitzer\n10  AAAAAAAAEHPOEBAA             Richard         Schweitzer\n11  AAAAAAAAEHPOEBAA             Richard         Schweitzer\n12  AAAAAAAAHDNAHBAA              Eunice             Walker\n13  AAAAAAAAHDNAHBAA              Eunice             Walker\n14  AAAAAAAAHDNAHBAA              Eunice             Walker\n15  AAAAAAAAHDNAHBAA              Eunice             Walker\n16  AAAAAAAAMIPHHBAA                Ivan               Sims\n17  AAAAAAAAMIPHHBAA                Ivan               Sims\n18  AAAAAAAAMIPHHBAA                Ivan               Sims\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n1   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n2   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n3   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n4   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n5   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n6   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n7   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n8   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n9   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n10  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n11  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n12  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n13  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n14  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n15  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n16  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n17  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n18  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038122,
                    "execution_time": 0.02609,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.004904
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.077158,
                    "execution_time": 0.026838,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.040387
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n1   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n2   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n3   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n4   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n5   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n6   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n7   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n8   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n9   AAAAAAAACNKJKBAA               Bruce          Mcpherson\n10  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n11  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n12  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n13  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n14  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n15  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n16  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n17  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n18  AAAAAAAACNKJKBAA               Bruce          Mcpherson\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABCIKLBAA           Christine             George\n1   AAAAAAAABCIKLBAA           Christine             George\n2   AAAAAAAALMDANAAA               Jerry          Fernandes\n3   AAAAAAAANOIKDBAA              Vivian               Pham\n4   AAAAAAAACIEHOBAA             Raymond           Register\n5   AAAAAAAAGGOODBAA               Nancy           Weathers\n6   AAAAAAAAGGOODBAA               Nancy           Weathers\n7   AAAAAAAAGGOODBAA               Nancy           Weathers\n8   AAAAAAAAGGOODBAA               Nancy           Weathers\n9   AAAAAAAAGEIBFAAA              Andrew                Tam\n10  AAAAAAAANNNEIBAA               Betty             Miller\n11  AAAAAAAAHOFKMBAA             Timothy             Howell\n12  AAAAAAAAHOFKMBAA             Timothy             Howell\n13  AAAAAAAAHOFKMBAA             Timothy             Howell\n14  AAAAAAAAHOFKMBAA             Timothy             Howell\n15  AAAAAAAAFONJBBAA                                 Baxter\n16  AAAAAAAAJOJMPAAA             Felicia         Villalobos\n17  AAAAAAAAFPNGIBAA                Jill              Jones\n18  AAAAAAAANCKFNAAA               David               Shaw\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.406004,
                    "execution_time": 0.367657,
                    "compile_time": 0.040793,
                    "planning_time": 0.006355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.422663,
                    "execution_time": 0.3049,
                    "compile_time": 3.079756,
                    "planning_time": 0.041798
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABCIKLBAA           Christine             George\n1   AAAAAAAABCIKLBAA           Christine             George\n2   AAAAAAAALMDANAAA               Jerry          Fernandes\n3   AAAAAAAANOIKDBAA              Vivian               Pham\n4   AAAAAAAACIEHOBAA             Raymond           Register\n5   AAAAAAAAGGOODBAA               Nancy           Weathers\n6   AAAAAAAAGGOODBAA               Nancy           Weathers\n7   AAAAAAAAGGOODBAA               Nancy           Weathers\n8   AAAAAAAAGGOODBAA               Nancy           Weathers\n9   AAAAAAAAGEIBFAAA              Andrew                Tam\n10  AAAAAAAANNNEIBAA               Betty             Miller\n11  AAAAAAAAHOFKMBAA             Timothy             Howell\n12  AAAAAAAAHOFKMBAA             Timothy             Howell\n13  AAAAAAAAHOFKMBAA             Timothy             Howell\n14  AAAAAAAAHOFKMBAA             Timothy             Howell\n15  AAAAAAAAFONJBBAA                                 Baxter\n16  AAAAAAAAJOJMPAAA             Felicia         Villalobos\n17  AAAAAAAAFPNGIBAA                Jill              Jones\n18  AAAAAAAANCKFNAAA               David               Shaw\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABCIKLBAA           Christine             George\n1   AAAAAAAABCIKLBAA           Christine             George\n2   AAAAAAAABCIKLBAA           Christine             George\n3   AAAAAAAABCIKLBAA           Christine             George\n4   AAAAAAAABCIKLBAA           Christine             George\n5   AAAAAAAABCIKLBAA           Christine             George\n6   AAAAAAAABCIKLBAA           Christine             George\n7   AAAAAAAABCIKLBAA           Christine             George\n8   AAAAAAAABCIKLBAA           Christine             George\n9   AAAAAAAABCIKLBAA           Christine             George\n10  AAAAAAAABCIKLBAA           Christine             George\n11  AAAAAAAABCIKLBAA           Christine             George\n12  AAAAAAAABCIKLBAA           Christine             George\n13  AAAAAAAABCIKLBAA           Christine             George\n14  AAAAAAAABCIKLBAA           Christine             George\n15  AAAAAAAABCIKLBAA           Christine             George\n16  AAAAAAAABCIKLBAA           Christine             George\n17  AAAAAAAABCIKLBAA           Christine             George\n18  AAAAAAAABCIKLBAA           Christine             George\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.144735,
                    "execution_time": 0.109785,
                    "compile_time": 0.015949,
                    "planning_time": 0.008006
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.256378,
                    "execution_time": 0.113057,
                    "compile_time": 3.133267,
                    "planning_time": 0.043878
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABCIKLBAA           Christine             George\n1   AAAAAAAABCIKLBAA           Christine             George\n2   AAAAAAAABCIKLBAA           Christine             George\n3   AAAAAAAABCIKLBAA           Christine             George\n4   AAAAAAAABCIKLBAA           Christine             George\n5   AAAAAAAABCIKLBAA           Christine             George\n6   AAAAAAAABCIKLBAA           Christine             George\n7   AAAAAAAABCIKLBAA           Christine             George\n8   AAAAAAAABCIKLBAA           Christine             George\n9   AAAAAAAABCIKLBAA           Christine             George\n10  AAAAAAAABCIKLBAA           Christine             George\n11  AAAAAAAABCIKLBAA           Christine             George\n12  AAAAAAAABCIKLBAA           Christine             George\n13  AAAAAAAABCIKLBAA           Christine             George\n14  AAAAAAAABCIKLBAA           Christine             George\n15  AAAAAAAABCIKLBAA           Christine             George\n16  AAAAAAAABCIKLBAA           Christine             George\n17  AAAAAAAABCIKLBAA           Christine             George\n18  AAAAAAAABCIKLBAA           Christine             George\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.099061,
                    "execution_time": 3.503049,
                    "compile_time": 0.000933,
                    "planning_time": 0.044179,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.946751,
                    "execution_time": 4.084231,
                    "compile_time": 16.254026,
                    "planning_time": 0.1294,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.633262,
                    "execution_time": 0.300722,
                    "compile_time": 0.000629,
                    "planning_time": 0.012993,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.539863,
                    "execution_time": 0.279419,
                    "compile_time": 14.864181,
                    "planning_time": 0.07174,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKIAGFBAA              Stuart               Dean\n1   AAAAAAAAKPGCFBAA                 Joe               Harp\n2   AAAAAAAAEBPBEAAA             Gilbert              Gross\n3   AAAAAAAAFNIGNAAA              Robert             Thomas\n4   AAAAAAAAEOEMPAAA                John            Quillen\n5   AAAAAAAAGLIFOAAA             Crystal             Medina\n6   AAAAAAAAPHEPMBAA             Timothy           Williams\n7   AAAAAAAAICLDKAAA               Keiko            Jackson\n8   AAAAAAAAEKNKAAAA               April              Anaya\n9   AAAAAAAAOKFHBBAA               Clyde             Armijo\n10  AAAAAAAAIJJJMBAA            Santiago            Redding\n11  AAAAAAAAHPDMFBAA                Eric              Singh\n12  AAAAAAAAEHKCGBAA             Colleen              Davis\n13  AAAAAAAACPCKLBAA             Mildred              Perez\n14  AAAAAAAAGGPNPAAA                 Ann              Reyes\n15  AAAAAAAAPDHFMAAA                 Ted            Bigelow\n16  AAAAAAAAAPPIOAAA           Francisco           Troutman\n17  AAAAAAAAMENBJAAA             Horacio               Ford\n18  AAAAAAAAAKGNMBAA             William             Fisher\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017222,
                    "execution_time": 0.008019,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003268
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054514,
                    "execution_time": 0.00807,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038712
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKIAGFBAA              Stuart               Dean\n1   AAAAAAAAKPGCFBAA                 Joe               Harp\n2   AAAAAAAAEBPBEAAA             Gilbert              Gross\n3   AAAAAAAAFNIGNAAA              Robert             Thomas\n4   AAAAAAAAEOEMPAAA                John            Quillen\n5   AAAAAAAAGLIFOAAA             Crystal             Medina\n6   AAAAAAAAPHEPMBAA             Timothy           Williams\n7   AAAAAAAAICLDKAAA               Keiko            Jackson\n8   AAAAAAAAEKNKAAAA               April              Anaya\n9   AAAAAAAAOKFHBBAA               Clyde             Armijo\n10  AAAAAAAAIJJJMBAA            Santiago            Redding\n11  AAAAAAAAHPDMFBAA                Eric              Singh\n12  AAAAAAAAEHKCGBAA             Colleen              Davis\n13  AAAAAAAACPCKLBAA             Mildred              Perez\n14  AAAAAAAAGGPNPAAA                 Ann              Reyes\n15  AAAAAAAAPDHFMAAA                 Ted            Bigelow\n16  AAAAAAAAAPPIOAAA           Francisco           Troutman\n17  AAAAAAAAMENBJAAA             Horacio               Ford\n18  AAAAAAAAAKGNMBAA             William             Fisher\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNCFEAAA            Virginia             Norton\n1   AAAAAAAAOOGCLBAA            Marjorie               Ball\n2   AAAAAAAAAGHHDAAA              Steven            Roberts\n3   AAAAAAAADHCBDAAA           Josephine              Dyson\n4   AAAAAAAACJKGOBAA              Robert             Bolden\n5   AAAAAAAAFKDKLBAA                John         Mclaughlin\n6   AAAAAAAALHNKCAAA              Teresa          Davenport\n7   AAAAAAAAJHFMJAAA                Jack             Pitman\n8   AAAAAAAAOPHHKAAA             Cynthia              Manzo\n9   AAAAAAAANPPOKAAA             Charles            Sanders\n10  AAAAAAAABLINBAAA                Lisa          Alexander\n11  AAAAAAAABLHBJBAA                               Bradbury\n12  AAAAAAAAIPKJPAAA                Jodi            Parrish\n13  AAAAAAAABGFJJBAA             Stephen              Mintz\n14  AAAAAAAAMGLAJAAA                Cara              Cloud\n15  AAAAAAAACAIOCAAA              Robert            Cormier\n16  AAAAAAAAHDDKBBAA               Linda             Mccune\n17  AAAAAAAAKHBKOAAA             Raymond             Weaver\n18  AAAAAAAAEEBFCAAA              Samuel             Girard\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.069533,
                    "execution_time": 0.034898,
                    "compile_time": 0.046517,
                    "planning_time": 0.005459
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.212451,
                    "execution_time": 0.041865,
                    "compile_time": 3.151482,
                    "planning_time": 0.040577
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNCFEAAA            Virginia             Norton\n1   AAAAAAAAOOGCLBAA            Marjorie               Ball\n2   AAAAAAAAAGHHDAAA              Steven            Roberts\n3   AAAAAAAADHCBDAAA           Josephine              Dyson\n4   AAAAAAAACJKGOBAA              Robert             Bolden\n5   AAAAAAAAFKDKLBAA                John         Mclaughlin\n6   AAAAAAAALHNKCAAA              Teresa          Davenport\n7   AAAAAAAAJHFMJAAA                Jack             Pitman\n8   AAAAAAAAOPHHKAAA             Cynthia              Manzo\n9   AAAAAAAANPPOKAAA             Charles            Sanders\n10  AAAAAAAABLINBAAA                Lisa          Alexander\n11  AAAAAAAABLHBJBAA                               Bradbury\n12  AAAAAAAAIPKJPAAA                Jodi            Parrish\n13  AAAAAAAABGFJJBAA             Stephen              Mintz\n14  AAAAAAAAMGLAJAAA                Cara              Cloud\n15  AAAAAAAACAIOCAAA              Robert            Cormier\n16  AAAAAAAAHDDKBBAA               Linda             Mccune\n17  AAAAAAAAKHBKOAAA             Raymond             Weaver\n18  AAAAAAAAEEBFCAAA              Samuel             Girard\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0 end > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.623413,
                    "execution_time": 0.29542,
                    "compile_time": 0.000699,
                    "planning_time": 0.015078,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.363712,
                    "execution_time": 0.313155,
                    "compile_time": 10.656643,
                    "planning_time": 0.072453,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACEICFAAA             Anthony            Morales\n1   AAAAAAAAGEOLMAAA             Suzanne               Cato\n2   AAAAAAAAAHMJIAAA             Lincoln           Mcdonald\n3   AAAAAAAALEFKCBAA             Jessica               Ford\n4   AAAAAAAABEPJMBAA             Anthony             Alston\n5   AAAAAAAACNAMDAAA                Rosa           Phillips\n6   AAAAAAAANELFJAAA                Earl              Hurst\n7   AAAAAAAAEJEMMAAA               Julia           Sinclair\n8   AAAAAAAAOHBDEBAA                Mona             Taylor\n9   AAAAAAAAGFIFMBAA              Robert            Holland\n10  AAAAAAAAHOAELAAA                 Luz              Davis\n11  AAAAAAAABHHJIBAA              Gloria             Mangum\n12  AAAAAAAACPCMOAAA         Christopher             Harris\n13  AAAAAAAADAFNBAAA              Judith           Morrison\n14  AAAAAAAAFDCBKAAA               Craig            Waldron\n15  AAAAAAAAHPINNAAA               James                Day\n16  AAAAAAAABACNNBAA              Conrad               Dill\n17  AAAAAAAACNMFLBAA               James                   \n18  AAAAAAAAADDAJAAA              Sandra            Jackson\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017072,
                    "execution_time": 0.007658,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00346
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055355,
                    "execution_time": 0.008179,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038727
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAACEICFAAA             Anthony            Morales\n1   AAAAAAAAGEOLMAAA             Suzanne               Cato\n2   AAAAAAAAAHMJIAAA             Lincoln           Mcdonald\n3   AAAAAAAALEFKCBAA             Jessica               Ford\n4   AAAAAAAABEPJMBAA             Anthony             Alston\n5   AAAAAAAACNAMDAAA                Rosa           Phillips\n6   AAAAAAAANELFJAAA                Earl              Hurst\n7   AAAAAAAAEJEMMAAA               Julia           Sinclair\n8   AAAAAAAAOHBDEBAA                Mona             Taylor\n9   AAAAAAAAGFIFMBAA              Robert            Holland\n10  AAAAAAAAHOAELAAA                 Luz              Davis\n11  AAAAAAAABHHJIBAA              Gloria             Mangum\n12  AAAAAAAACPCMOAAA         Christopher             Harris\n13  AAAAAAAADAFNBAAA              Judith           Morrison\n14  AAAAAAAAFDCBKAAA               Craig            Waldron\n15  AAAAAAAAHPINNAAA               James                Day\n16  AAAAAAAABACNNBAA              Conrad               Dill\n17  AAAAAAAACNMFLBAA               James                   \n18  AAAAAAAAADDAJAAA              Sandra            Jackson\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.528971,
                    "execution_time": 0.202909,
                    "compile_time": 0.031599,
                    "planning_time": 0.016015,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 19.609447,
                    "execution_time": 0.208274,
                    "compile_time": 19.047812,
                    "planning_time": 0.074124,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNCFEAAA            Virginia             Norton\n1   AAAAAAAAOOGCLBAA            Marjorie               Ball\n2   AAAAAAAABLINBAAA                Lisa          Alexander\n3   AAAAAAAABLHBJBAA                               Bradbury\n4   AAAAAAAABGFJJBAA             Stephen              Mintz\n5   AAAAAAAAKLBFBAAA              Jeremy            Jackson\n6   AAAAAAAAKMEEPAAA              Sandra        Chamberlain\n7   AAAAAAAANBHKBBAA             Leonora             Muller\n8   AAAAAAAACMANOAAA               Ollie           Anderson\n9   AAAAAAAAIEMEMBAA           Elizabeth             Dubose\n10  AAAAAAAAJPNKNBAA                Paul               Dodd\n11  AAAAAAAAEEBFCAAA              Samuel             Girard\n12  AAAAAAAAOGEEOBAA               Wayne              Black\n13  AAAAAAAAGDPOABAA               James             Crosby\n14  AAAAAAAANABBMBAA             Chelsea              Smith\n15  AAAAAAAACDOEKBAA               Louis           Williams\n16  AAAAAAAALKJGKAAA               David            Andrews\n17  AAAAAAAACFCIBBAA             Heather              Riley\n18  AAAAAAAAAOICJAAA               Amber            Roberts\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0166,
                    "execution_time": 0.007349,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003354
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054117,
                    "execution_time": 0.007624,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038838
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAPNCFEAAA            Virginia             Norton\n1   AAAAAAAAOOGCLBAA            Marjorie               Ball\n2   AAAAAAAABLINBAAA                Lisa          Alexander\n3   AAAAAAAABLHBJBAA                               Bradbury\n4   AAAAAAAABGFJJBAA             Stephen              Mintz\n5   AAAAAAAAKLBFBAAA              Jeremy            Jackson\n6   AAAAAAAAKMEEPAAA              Sandra        Chamberlain\n7   AAAAAAAANBHKBBAA             Leonora             Muller\n8   AAAAAAAACMANOAAA               Ollie           Anderson\n9   AAAAAAAAIEMEMBAA           Elizabeth             Dubose\n10  AAAAAAAAJPNKNBAA                Paul               Dodd\n11  AAAAAAAAEEBFCAAA              Samuel             Girard\n12  AAAAAAAAOGEEOBAA               Wayne              Black\n13  AAAAAAAAGDPOABAA               James             Crosby\n14  AAAAAAAANABBMBAA             Chelsea              Smith\n15  AAAAAAAACDOEKBAA               Louis           Williams\n16  AAAAAAAALKJGKAAA               David            Andrews\n17  AAAAAAAACFCIBBAA             Heather              Riley\n18  AAAAAAAAAOICJAAA               Amber            Roberts\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER_LAST_NAME\" , \"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAANJAAA                                       \n1   AAAAAAAAAABLCAAA                                       \n2   AAAAAAAAAACNBBAA                                       \n3   AAAAAAAAAADJABAA                                       \n4   AAAAAAAAAAFLNAAA                                       \n5   AAAAAAAAAAFNHBAA                                       \n6   AAAAAAAAAAGBJBAA                                       \n7   AAAAAAAAAAJJCBAA                                       \n8   AAAAAAAAAAKBLBAA                                       \n9   AAAAAAAAAAKINBAA                                       \n10  AAAAAAAAAAMGNBAA                                       \n11  AAAAAAAAAAMJGBAA                                       \n12  AAAAAAAAAAONGBAA                                       \n13  AAAAAAAAAAPCEAAA                                       \n14  AAAAAAAAAAPDGBAA                                       \n15  AAAAAAAAAAPNLAAA                                       \n16  AAAAAAAAAAPOCAAA                                       \n17  AAAAAAAAABBAHBAA                                       \n18  AAAAAAAAABCBABAA                                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040118,
                    "execution_time": 0.013778,
                    "compile_time": 0.016661,
                    "planning_time": 0.00365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.523527,
                    "execution_time": 0.013796,
                    "compile_time": 4.471062,
                    "planning_time": 0.039264
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAANJAAA                                       \n1   AAAAAAAAAABLCAAA                                       \n2   AAAAAAAAAACNBBAA                                       \n3   AAAAAAAAAADJABAA                                       \n4   AAAAAAAAAAFLNAAA                                       \n5   AAAAAAAAAAFNHBAA                                       \n6   AAAAAAAAAAGBJBAA                                       \n7   AAAAAAAAAAJJCBAA                                       \n8   AAAAAAAAAAKBLBAA                                       \n9   AAAAAAAAAAKINBAA                                       \n10  AAAAAAAAAAMGNBAA                                       \n11  AAAAAAAAAAMJGBAA                                       \n12  AAAAAAAAAAONGBAA                                       \n13  AAAAAAAAAAPCEAAA                                       \n14  AAAAAAAAAAPDGBAA                                       \n15  AAAAAAAAAAPNLAAA                                       \n16  AAAAAAAAAAPOCAAA                                       \n17  AAAAAAAAABBAHBAA                                       \n18  AAAAAAAAABCBABAA                                       \n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER_LAST_NAME\" , \"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAANJAAA                                       \n1   AAAAAAAAAABLCAAA                                       \n2   AAAAAAAAAACNBBAA                                       \n3   AAAAAAAAAADJABAA                                       \n4   AAAAAAAAAAFLNAAA                                       \n5   AAAAAAAAAAFNHBAA                                       \n6   AAAAAAAAAAGBJBAA                                       \n7   AAAAAAAAAAJJCBAA                                       \n8   AAAAAAAAAAKBLBAA                                       \n9   AAAAAAAAAAKINBAA                                       \n10  AAAAAAAAAAMGNBAA                                       \n11  AAAAAAAAAAMJGBAA                                       \n12  AAAAAAAAAAONGBAA                                       \n13  AAAAAAAAAAPCEAAA                                       \n14  AAAAAAAAAAPDGBAA                                       \n15  AAAAAAAAAAPNLAAA                                       \n16  AAAAAAAAAAPOCAAA                                       \n17  AAAAAAAAABBAHBAA                                       \n18  AAAAAAAAABCBABAA                                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022821,
                    "execution_time": 0.013212,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.00365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023178,
                    "execution_time": 0.013358,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.00378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAANJAAA                                       \n1   AAAAAAAAAABLCAAA                                       \n2   AAAAAAAAAACNBBAA                                       \n3   AAAAAAAAAADJABAA                                       \n4   AAAAAAAAAAFLNAAA                                       \n5   AAAAAAAAAAFNHBAA                                       \n6   AAAAAAAAAAGBJBAA                                       \n7   AAAAAAAAAAJJCBAA                                       \n8   AAAAAAAAAAKBLBAA                                       \n9   AAAAAAAAAAKINBAA                                       \n10  AAAAAAAAAAMGNBAA                                       \n11  AAAAAAAAAAMJGBAA                                       \n12  AAAAAAAAAAONGBAA                                       \n13  AAAAAAAAAAPCEAAA                                       \n14  AAAAAAAAAAPDGBAA                                       \n15  AAAAAAAAAAPNLAAA                                       \n16  AAAAAAAAAAPOCAAA                                       \n17  AAAAAAAAABBAHBAA                                       \n18  AAAAAAAAABCBABAA                                       \n...*/"
    }
]