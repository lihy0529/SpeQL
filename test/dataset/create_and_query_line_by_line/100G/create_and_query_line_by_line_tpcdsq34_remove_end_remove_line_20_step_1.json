[
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n          from store_sales\n          group by ss_ticket_number, ss_customer_sk) as subquery\njoin customer on customer.c_customer_sk = subquery.ss_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.330899,
                    "execution_time": 2.16227,
                    "compile_time": 0.000301,
                    "planning_time": 0.023316,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.570591,
                    "execution_time": 2.247311,
                    "compile_time": 4.073998,
                    "planning_time": 0.092075,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.081301,
                    "execution_time": 1.548363,
                    "compile_time": 0.075881,
                    "planning_time": 0.025008,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.51355,
                    "execution_time": 2.879842,
                    "compile_time": 11.09281,
                    "planning_time": 0.08785,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Foreman        Frank          Sir                     N          17073568    8\n1       Chavez      Matthew          Mr.                     Y          16299095   10\n2     Reynolds       Dianne          Dr.                     N          23522628   16\n3        Hicks         Joel          Sir                     Y          17077204   11\n4       Sutton         Ryan          Dr.                     N           6273990   15\n5        Gomes         Jeff          Dr.                     N           4343219   11\n6        Evans    Catherine         Miss                     N           4024772   16\n7       Hester         Juan          Mr.                     N           7356587   10\n8     Alvarado    Christine         Mrs.                     N           8826029   14\n9        Ortiz         John          Mr.                     N          15276872    7\n10      Sharpe     Gretchen         Miss                     Y          22020225   11\n11      Hanson       Daniel          Mr.                     Y           9000420   10\n12    Hairston       Jannie          Dr.                     Y           7030431   16\n13    Reynolds          Lee          Mr.                     Y           6752217   14\n14     Ellison        James          Sir                     Y          19780469    9\n15        Jose       Marcus          Dr.                     N           3003304   13\n16    Erickson         Ruth         Miss                     N           3269825   10\n17                                                           Y           5253930   13\n18       Smith         Ruth          Ms.                     Y          16019790   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.078838,
                    "execution_time": 0.008396,
                    "compile_time": 0.060361,
                    "planning_time": 0.003792
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.351435,
                    "execution_time": 0.008216,
                    "compile_time": 3.294471,
                    "planning_time": 0.039019
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Foreman        Frank          Sir                     N          17073568    8\n1       Chavez      Matthew          Mr.                     Y          16299095   10\n2     Reynolds       Dianne          Dr.                     N          23522628   16\n3        Hicks         Joel          Sir                     Y          17077204   11\n4       Sutton         Ryan          Dr.                     N           6273990   15\n5        Gomes         Jeff          Dr.                     N           4343219   11\n6        Evans    Catherine         Miss                     N           4024772   16\n7       Hester         Juan          Mr.                     N           7356587   10\n8     Alvarado    Christine         Mrs.                     N           8826029   14\n9        Ortiz         John          Mr.                     N          15276872    7\n10      Sharpe     Gretchen         Miss                     Y          22020225   11\n11      Hanson       Daniel          Mr.                     Y           9000420   10\n12    Hairston       Jannie          Dr.                     Y           7030431   16\n13    Reynolds          Lee          Mr.                     Y           6752217   14\n14     Ellison        James          Sir                     Y          19780469    9\n15        Jose       Marcus          Dr.                     N           3003304   13\n16    Erickson         Ruth         Miss                     N           3269825   10\n17                                                           Y           5253930   13\n18       Smith         Ruth          Ms.                     Y          16019790   10\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       \n       \n       \n       \n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.777643,
                    "execution_time": 0.663931,
                    "compile_time": 0.000262,
                    "planning_time": 0.00287,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.922942,
                    "execution_time": 0.642358,
                    "compile_time": 0.097918,
                    "planning_time": 0.058579,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  cnt\n0           13877964   16\n1            6254986   10\n2            4748993   14\n3           17632190   13\n4            4748993    2\n5           20507941   11\n6           19135499    9\n7           20652804   10\n8            9253456   14\n9           16902414    7\n10           1752244   15\n11          16902414    1\n12          17639426   10\n13          13177307   11\n14          22004418   11\n15            403636   11\n16           9255315    9\n17           1013004   12\n18           7893408   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016453,
                    "execution_time": 0.00751,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003069
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.14348,
                    "execution_time": 0.007594,
                    "compile_time": 0.088091,
                    "planning_time": 0.038206
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  cnt\n0           13877964   16\n1            6254986   10\n2            4748993   14\n3           17632190   13\n4            4748993    2\n5           20507941   11\n6           19135499    9\n7           20652804   10\n8            9253456   14\n9           16902414    7\n10           1752244   15\n11          16902414    1\n12          17639426   10\n13          13177307   11\n14          22004418   11\n15            403636   11\n16           9255315    9\n17           1013004   12\n18           7893408   15\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk\n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    group by ss_ticket_number, ss_customer_sk\n   ) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.269737,
                    "execution_time": 3.063793,
                    "compile_time": 0.000395,
                    "planning_time": 0.044225,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.766602,
                    "execution_time": 3.322276,
                    "compile_time": 4.147885,
                    "planning_time": 0.124654,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.933484,
                    "execution_time": 1.489307,
                    "compile_time": 0.000449,
                    "planning_time": 0.024351,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.957079,
                    "execution_time": 1.448784,
                    "compile_time": 0.000476,
                    "planning_time": 0.085962,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Brown       Thelma         Miss                     N          15203153   13\n1     Mccauley         John          Dr.                     N          13554497   14\n2       Lawson      Bernice         Mrs.                     N          12970050   15\n3     Gonzalez          Joe          Mr.                     Y          20314073    7\n4         Jude       Sherri          Ms.                     Y          21065778    8\n5      Branham        Gavin          Dr.                     N          17457803    9\n6       Noland       Pamela          Ms.                     Y          18067285   16\n7     Randolph         Josh          Mr.                     N           6970036    9\n8        Smith        Cecil          Dr.                     N          15220356   12\n9       Taylor       George          Dr.                     Y          21816729   14\n10       Petit        Ralph          Mr.                     N          15965114    7\n11     Beavers        Kathy         Miss                     N           2316975   11\n12       Lynch       George          Mr.                     Y          14471603   15\n13    Williams      Anthony         Mrs.                     N          18068372    7\n14     Dillard      Charles          Mr.                     N           9979548   10\n15     Stewart        Mario          Dr.                     N           5316938   14\n16       Smart       Angela         Mrs.                     N           9229697   16\n17     Swanson        Clara          Ms.                     Y           6075119   13\n18        Ward        Linda         Mrs.                     N          12238939   13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017376,
                    "execution_time": 0.00756,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003655
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.274525,
                    "execution_time": 0.00824,
                    "compile_time": 0.220571,
                    "planning_time": 0.03926
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Brown       Thelma         Miss                     N          15203153   13\n1     Mccauley         John          Dr.                     N          13554497   14\n2       Lawson      Bernice         Mrs.                     N          12970050   15\n3     Gonzalez          Joe          Mr.                     Y          20314073    7\n4         Jude       Sherri          Ms.                     Y          21065778    8\n5      Branham        Gavin          Dr.                     N          17457803    9\n6       Noland       Pamela          Ms.                     Y          18067285   16\n7     Randolph         Josh          Mr.                     N           6970036    9\n8        Smith        Cecil          Dr.                     N          15220356   12\n9       Taylor       George          Dr.                     Y          21816729   14\n10       Petit        Ralph          Mr.                     N          15965114    7\n11     Beavers        Kathy         Miss                     N           2316975   11\n12       Lynch       George          Mr.                     Y          14471603   15\n13    Williams      Anthony         Mrs.                     N          18068372    7\n14     Dillard      Charles          Mr.                     N           9979548   10\n15     Stewart        Mario          Dr.                     N           5316938   14\n16       Smart       Angela         Mrs.                     N           9229697   16\n17     Swanson        Clara          Ms.                     Y           6075119   13\n18        Ward        Linda         Mrs.                     N          12238939   13\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    where (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    group by ss_ticket_number, ss_customer_sk) as subquery_name\njoin customer on subquery_name.ss_customer_sk = customer.c_customer_sk\nwhere customer.c_preferred_cust_flag = 'Y'\nand subquery_name.cnt > 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY_NAME\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY_NAME\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY_NAME\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY_NAME\" AS \"SUBQUERY_NAME\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY_NAME\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SUBQUERY_NAME\".\"CNT\" > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.589784,
                    "execution_time": 1.379413,
                    "compile_time": 0.00039,
                    "planning_time": 0.048442,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.427786,
                    "execution_time": 1.391087,
                    "compile_time": 7.747112,
                    "planning_time": 0.122041,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.22135,
                    "execution_time": 0.675009,
                    "compile_time": 0.116515,
                    "planning_time": 0.025351,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.121398,
                    "execution_time": 0.985075,
                    "compile_time": 6.635835,
                    "planning_time": 0.085261,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Hill        Bruce          Sir                     Y           5286854   11\n1                                                            Y          10383780   10\n2     Harrison        Sarah         Mrs.                     Y          10538096   12\n3   Farrington    Lawerence          Sir                     Y          11226920   12\n4         Nagy         Mark          Dr.                     Y           8230253   13\n5       Puente       Thomas          Dr.                     Y           7929507    9\n6      Latimer        James          Sir                     Y          12728830   15\n7         Boyd         Luis          Dr.                     Y           2690163    8\n8    Alexander      William          Mr.                     Y          22927191   14\n9                                                            Y           5236148    8\n10     Chapman      Michael          Sir                     Y          19959318   13\n11     Addison       Marina         Miss                     Y          23238091   13\n12       Brown        Janet         Miss                     Y           5241955   11\n13      Hollis          Ray          Mr.                     Y           2236602   16\n14    Peterson      Kenneth          Dr.                     Y          18450205   14\n15      Wilson        Mable         Mrs.                     Y          15896902   14\n16        Peel        Karen          Ms.                     Y          22932214    9\n17      Carden      Maryann         Miss                     Y           6452626   11\n18       Lamar     Gilberto          Sir                     Y           7651205    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018139,
                    "execution_time": 0.008353,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003721
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055876,
                    "execution_time": 0.008009,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.039453
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Hill        Bruce          Sir                     Y           5286854   11\n1                                                            Y          10383780   10\n2     Harrison        Sarah         Mrs.                     Y          10538096   12\n3   Farrington    Lawerence          Sir                     Y          11226920   12\n4         Nagy         Mark          Dr.                     Y           8230253   13\n5       Puente       Thomas          Dr.                     Y           7929507    9\n6      Latimer        James          Sir                     Y          12728830   15\n7         Boyd         Luis          Dr.                     Y           2690163    8\n8    Alexander      William          Mr.                     Y          22927191   14\n9                                                            Y           5236148    8\n10     Chapman      Michael          Sir                     Y          19959318   13\n11     Addison       Marina         Miss                     Y          23238091   13\n12       Brown        Janet         Miss                     Y           5241955   11\n13      Hollis          Ray          Mr.                     Y           2236602   16\n14    Peterson      Kenneth          Dr.                     Y          18450205   14\n15      Wilson        Mable         Mrs.                     Y          15896902   14\n16        Peel        Karen          Ms.                     Y          22932214    9\n17      Carden      Maryann         Miss                     Y           6452626   11\n18       Lamar     Gilberto          Sir                     Y           7651205    8\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n          household_demographics.hd_buy_potential = '1001-1500')\n    group by ss_ticket_number, ss_customer_sk) as sales_data\n   join customer on sales_data.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_DATA\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_DATA\".\"CNT\" AS \"CNT\" FROM \"SALES_DATA\" AS \"SALES_DATA\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_DATA\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.932214,
                    "execution_time": 0.721597,
                    "compile_time": 0.000401,
                    "planning_time": 0.047608,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.035885,
                    "execution_time": 0.902328,
                    "compile_time": 7.840504,
                    "planning_time": 0.121149,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.068907,
                    "execution_time": 0.5418,
                    "compile_time": 0.088452,
                    "planning_time": 0.024625,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.493169,
                    "execution_time": 0.569974,
                    "compile_time": 6.408815,
                    "planning_time": 0.08513,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                     Garry          Sir                     Y          15125300    9\n1       Murray          Liz         Miss                     Y           9177612   12\n2     Schubert      Charles          Dr.                     N          14344045   11\n3       Garcia        Penny         Mrs.                     Y           9446883   14\n4         Dyer     Benjamin          Sir                     N          15272620   13\n5                     James                                  Y          15505843   13\n6        Ennis       Herman          Sir                     N          21771383   12\n7       Hixson        David          Mr.                     N          23643724    8\n8         Main      Jessica                                  N           3414079   11\n9      Barrows       Margie         Miss                     Y          22609970   11\n10     Mcclain         Mike          Mr.                     Y          19801450   14\n11     Mcclain         Mike          Mr.                     Y          23873072   13\n12     Mcclain         Mike          Mr.                     Y           3609112    8\n13      Murphy      William          Mr.                     Y          14916362    8\n14      Dennis       Jennie         Mrs.                     N          17787020    8\n15        Crow       Victor          Mr.                     Y          12293069   12\n16       Ramey         Leon          Dr.                     N           9858608   13\n17       Crowe       Dennis          Mr.                     Y           5345301    8\n18      Prince         Gary          Mr.                     Y           2464657    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017669,
                    "execution_time": 0.007692,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003743
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055773,
                    "execution_time": 0.008052,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039422
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0                     Garry          Sir                     Y          15125300    9\n1       Murray          Liz         Miss                     Y           9177612   12\n2     Schubert      Charles          Dr.                     N          14344045   11\n3       Garcia        Penny         Mrs.                     Y           9446883   14\n4         Dyer     Benjamin          Sir                     N          15272620   13\n5                     James                                  Y          15505843   13\n6        Ennis       Herman          Sir                     N          21771383   12\n7       Hixson        David          Mr.                     N          23643724    8\n8         Main      Jessica                                  N           3414079   11\n9      Barrows       Margie         Miss                     Y          22609970   11\n10     Mcclain         Mike          Mr.                     Y          19801450   14\n11     Mcclain         Mike          Mr.                     Y          23873072   13\n12     Mcclain         Mike          Mr.                     Y           3609112    8\n13      Murphy      William          Mr.                     Y          14916362    8\n14      Dennis       Jennie         Mrs.                     N          17787020    8\n15        Crow       Victor          Mr.                     Y          12293069   12\n16       Ramey         Leon          Dr.                     N           9858608   13\n17       Crowe       Dennis          Mr.                     Y           5345301    8\n18      Prince         Gary          Mr.                     Y           2464657    8\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n   ) as subquery_name\n   join customer on subquery_name.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SUBQUERY_NAME\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY_NAME\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY_NAME\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY_NAME\" AS \"SUBQUERY_NAME\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY_NAME\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.993715,
                    "execution_time": 0.785291,
                    "compile_time": 0.000402,
                    "planning_time": 0.046738,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.113497,
                    "execution_time": 0.823551,
                    "compile_time": 0.000407,
                    "planning_time": 0.124026,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.971134,
                    "execution_time": 0.518713,
                    "compile_time": 0.000437,
                    "planning_time": 0.033881,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.244209,
                    "execution_time": 0.632218,
                    "compile_time": 0.107874,
                    "planning_time": 0.085894,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Perez        Frank          Sir                     Y          23694043   13\n1        Perez        Frank          Sir                     Y          21005598   15\n2      Edwards       Mattie          Ms.                     N           8276095   14\n3      Buckley       Albert         Miss                     N           4250084   12\n4      Buckley       Albert         Miss                     N           4517981   10\n5       Eckert        Verla         Mrs.                     N          15188923   11\n6      Windham                       Sir                                16590621    9\n7      Roberts          Amy          Ms.                     Y           9508680   13\n8      Fellows       Nicole          Ms.                     N          15696972    9\n9        Swann      Mildred         Mrs.                     Y           4572745   15\n10    Melendez      Suzanne         Miss                     N          19901770    9\n11        Moon  Christopher          Dr.                     N           4100600   12\n12        Moon  Christopher          Dr.                     N          20851954   10\n13        Moon  Christopher          Dr.                     N          23215041   12\n14    Marshall      Crystal          Dr.                     N           1465010    9\n15       Hodge      Gilbert          Sir                     Y          15550991   12\n16      Miller         John          Sir                     Y          18688579    8\n17       Olson         Nora          Ms.                     N          10366116   11\n18       Embry       Robert          Dr.                                 5728212   11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017667,
                    "execution_time": 0.0077,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003758
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056132,
                    "execution_time": 0.008634,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039356
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Perez        Frank          Sir                     Y          23694043   13\n1        Perez        Frank          Sir                     Y          21005598   15\n2      Edwards       Mattie          Ms.                     N           8276095   14\n3      Buckley       Albert         Miss                     N           4250084   12\n4      Buckley       Albert         Miss                     N           4517981   10\n5       Eckert        Verla         Mrs.                     N          15188923   11\n6      Windham                       Sir                                16590621    9\n7      Roberts          Amy          Ms.                     Y           9508680   13\n8      Fellows       Nicole          Ms.                     N          15696972    9\n9        Swann      Mildred         Mrs.                     Y           4572745   15\n10    Melendez      Suzanne         Miss                     N          19901770    9\n11        Moon  Christopher          Dr.                     N           4100600   12\n12        Moon  Christopher          Dr.                     N          20851954   10\n13        Moon  Christopher          Dr.                     N          23215041   12\n14    Marshall      Crystal          Dr.                     N           1465010    9\n15       Hodge      Gilbert          Sir                     Y          15550991   12\n16      Miller         John          Sir                     Y          18688579    8\n17       Olson         Nora          Ms.                     N          10366116   11\n18       Embry       Robert          Dr.                                 5728212   11\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt \nfrom\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    group by ss_ticket_number, ss_customer_sk) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.93963,
                    "execution_time": 0.72822,
                    "compile_time": 0.000415,
                    "planning_time": 0.048198,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.973503,
                    "execution_time": 0.938884,
                    "compile_time": 3.741748,
                    "planning_time": 0.124924,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.924957,
                    "execution_time": 0.479538,
                    "compile_time": 0.000448,
                    "planning_time": 0.024589,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.440638,
                    "execution_time": 0.93374,
                    "compile_time": 0.000452,
                    "planning_time": 0.085404,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Flynn       Donald          Sir                     Y           3283407   11\n1      Johnson         Gene          Dr.                     N          16337112   12\n2      Council         Beau          Mr.                     Y           8138437   11\n3     Andersen                                               Y          21686824   15\n4       Taylor        Billy          Dr.                     N          18896230    8\n5      Collins     Alphonso          Mr.                     Y          19558426   12\n6      Collins     Alphonso          Mr.                     Y           9043962    8\n7      Beasley     Clarence          Sir                     N           6755834   15\n8      Beasley     Clarence          Sir                     N           1952979   15\n9      Beasley     Clarence          Sir                     N          18804323   16\n10     Beasley     Clarence          Sir                     N          17838214    7\n11     Mueller        Allen         Miss                     Y           6840550   15\n12     Mccrary      William          Dr.                     Y          22091943   10\n13      Harper       Robert          Dr.                     Y          17357715    8\n14     Gregory        Ivory          Mr.                     Y          20387299   11\n15     Gregory        Ivory          Mr.                     Y           6964583    9\n16     Madison        Sarah         Miss                     Y           2265595   10\n17        Moss      Timothy          Sir                     Y          23511293   12\n18      Rivard         Bill          Dr.                     N           9043845    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017921,
                    "execution_time": 0.00785,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003857
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055369,
                    "execution_time": 0.008424,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.03921
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Flynn       Donald          Sir                     Y           3283407   11\n1      Johnson         Gene          Dr.                     N          16337112   12\n2      Council         Beau          Mr.                     Y           8138437   11\n3     Andersen                                               Y          21686824   15\n4       Taylor        Billy          Dr.                     N          18896230    8\n5      Collins     Alphonso          Mr.                     Y          19558426   12\n6      Collins     Alphonso          Mr.                     Y           9043962    8\n7      Beasley     Clarence          Sir                     N           6755834   15\n8      Beasley     Clarence          Sir                     N           1952979   15\n9      Beasley     Clarence          Sir                     N          18804323   16\n10     Beasley     Clarence          Sir                     N          17838214    7\n11     Mueller        Allen         Miss                     Y           6840550   15\n12     Mccrary      William          Dr.                     Y          22091943   10\n13      Harper       Robert          Dr.                     Y          17357715    8\n14     Gregory        Ivory          Mr.                     Y          20387299   11\n15     Gregory        Ivory          Mr.                     Y           6964583    9\n16     Madison        Sarah         Miss                     Y           2265595   10\n17        Moss      Timothy          Sir                     Y          23511293   12\n18      Rivard         Bill          Dr.                     N           9043845    9\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 then 1 else 0 end) = 1 \n    group by ss_ticket_number, ss_customer_sk) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN 1 ELSE 0 END = 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN 1 ELSE 0 END = 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.947583,
                    "execution_time": 0.736021,
                    "compile_time": 0.000396,
                    "planning_time": 0.049045,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.901715,
                    "execution_time": 0.802275,
                    "compile_time": 3.807689,
                    "planning_time": 0.124277,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.914962,
                    "execution_time": 0.468837,
                    "compile_time": 0.000467,
                    "planning_time": 0.02455,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.088531,
                    "execution_time": 0.582643,
                    "compile_time": 0.000457,
                    "planning_time": 0.085384,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Barnett       Harold          Sir                     Y           7174347   11\n1      Mcclain       Robert          Mr.                     Y           6200679   14\n2       Mcneal       Ronald          Mr.                     N          14407264   14\n3        Mintz       Steven          Dr.                     Y          16486410   13\n4       Slater    Christina          Ms.                     N          18913605   14\n5       Hooker       Phoebe          Dr.                     N          10026491   12\n6                  Jennifer         Miss                     Y          11956345   10\n7                  Jennifer         Miss                     Y           3521966   13\n8                  Jennifer         Miss                     Y          20944365   14\n9                  Jennifer         Miss                     Y          14445535    8\n10     Schultz       Gerald          Dr.                     Y            617634   14\n11      Austin      Cynthia          Ms.                     Y          20987663    9\n12      Austin      Cynthia          Ms.                     Y          10806544   15\n13       Stout         Mark          Sir                     Y          19410414   12\n14       Stout         Mark          Sir                     Y           4555558   13\n15      Wright         Gary          Sir                     N          19839864   13\n16      Wright         Gary          Sir                     N           3397297   10\n17                   Sylvia                                  Y           1285560   12\n18                   Sylvia                                  Y           3543169   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018331,
                    "execution_time": 0.008386,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003796
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054502,
                    "execution_time": 0.008242,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039782
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Barnett       Harold          Sir                     Y           7174347   11\n1      Mcclain       Robert          Mr.                     Y           6200679   14\n2       Mcneal       Ronald          Mr.                     N          14407264   14\n3        Mintz       Steven          Dr.                     Y          16486410   13\n4       Slater    Christina          Ms.                     N          18913605   14\n5       Hooker       Phoebe          Dr.                     N          10026491   12\n6                  Jennifer         Miss                     Y          11956345   10\n7                  Jennifer         Miss                     Y           3521966   13\n8                  Jennifer         Miss                     Y          20944365   14\n9                  Jennifer         Miss                     Y          14445535    8\n10     Schultz       Gerald          Dr.                     Y            617634   14\n11      Austin      Cynthia          Ms.                     Y          20987663    9\n12      Austin      Cynthia          Ms.                     Y          10806544   15\n13       Stout         Mark          Sir                     Y          19410414   12\n14       Stout         Mark          Sir                     Y           4555558   13\n15      Wright         Gary          Sir                     N          19839864   13\n16      Wright         Gary          Sir                     N           3397297   10\n17                   Sylvia                                  Y           1285560   12\n18                   Sylvia                                  Y           3543169   10\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \nelse 0 end) > 0\n    group by ss_ticket_number, ss_customer_sk\n) as agg_query\njoin customer on agg_query.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"AGG_QUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE 0 END > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"AGG_QUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"AGG_QUERY\".\"CNT\" AS \"CNT\" FROM \"AGG_QUERY\" AS \"AGG_QUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"AGG_QUERY\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE 0 END > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.93002,
                    "execution_time": 0.715729,
                    "compile_time": 0.000434,
                    "planning_time": 0.050042,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.996228,
                    "execution_time": 0.92928,
                    "compile_time": 3.758056,
                    "planning_time": 0.126052,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.916965,
                    "execution_time": 0.463667,
                    "compile_time": 0.000472,
                    "planning_time": 0.026135,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.012402,
                    "execution_time": 0.489094,
                    "compile_time": 0.000491,
                    "planning_time": 0.08739,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Smith       Janice          Ms.                     Y          20836249   10\n1       Mccain        Terry          Dr.                     Y          22868815    9\n2       Mccain        Terry          Dr.                     Y          21083719    9\n3                    Audrey                                              7551721   10\n4                    Audrey                                              1618721   11\n5         Reed      Bernard          Dr.                     N           9976277    7\n6      Walters     Clarence          Sir                     N           6583194   10\n7       Rogers       Robert          Dr.                     N          21181688    9\n8        Capps      Tiffany         Miss                     Y          10141812    7\n9                                    Mr.                                19427852    8\n10     Hawkins        James          Mr.                     N          17551620   11\n11        Wang        James          Dr.                     Y          19451471    9\n12        Bass      Ricardo          Dr.                     N          12184904    9\n13        Hart        Steve          Mr.                     Y          19909046   13\n14    Mahaffey       Steven          Dr.                     Y          20390029   13\n15  Hutchinson        James          Dr.                     Y          16392769   13\n16  Hutchinson        James          Dr.                     Y           1323772   11\n17  Hutchinson        James          Dr.                     Y          10242362   11\n18        Pace      Jeffrey          Dr.                     N           2974619   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01857,
                    "execution_time": 0.008306,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003969
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056159,
                    "execution_time": 0.008407,
                    "compile_time": 5e-05,
                    "planning_time": 0.039472
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Smith       Janice          Ms.                     Y          20836249   10\n1       Mccain        Terry          Dr.                     Y          22868815    9\n2       Mccain        Terry          Dr.                     Y          21083719    9\n3                    Audrey                                              7551721   10\n4                    Audrey                                              1618721   11\n5         Reed      Bernard          Dr.                     N           9976277    7\n6      Walters     Clarence          Sir                     N           6583194   10\n7       Rogers       Robert          Dr.                     N          21181688    9\n8        Capps      Tiffany         Miss                     Y          10141812    7\n9                                    Mr.                                19427852    8\n10     Hawkins        James          Mr.                     N          17551620   11\n11        Wang        James          Dr.                     Y          19451471    9\n12        Bass      Ricardo          Dr.                     N          12184904    9\n13        Hart        Steve          Mr.                     Y          19909046   13\n14    Mahaffey       Steven          Dr.                     Y          20390029   13\n15  Hutchinson        James          Dr.                     Y          16392769   13\n16  Hutchinson        James          Dr.                     Y           1323772   11\n17  Hutchinson        James          Dr.                     Y          10242362   11\n18        Pace      Jeffrey          Dr.                     N           2974619   15\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.917485,
                    "execution_time": 0.686981,
                    "compile_time": 0.017708,
                    "planning_time": 0.050413,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.532945,
                    "execution_time": 0.723326,
                    "compile_time": 3.51494,
                    "planning_time": 0.126045,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.874982,
                    "execution_time": 0.433342,
                    "compile_time": 0.00045,
                    "planning_time": 0.025234,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.01884,
                    "execution_time": 0.512425,
                    "compile_time": 0.000456,
                    "planning_time": 0.082963,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Drummond      Shameka          Dr.                     Y          13103643    9\n1     Drummond      Shameka          Dr.                     Y          21247065    9\n2      Gregory      Deborah          Dr.                     Y           6344631   10\n3       Deleon       Arturo          Mr.                     Y          10820056   12\n4         Hunt        Marcy         Miss                     N           1978716   12\n5       Duncan         Lisa         Miss                     Y           4381199   12\n6   Washington      Abraham                                             13677521   15\n7        Jones       Carole         Miss                     Y          18885923   14\n8        Jones       Carole         Miss                     Y          22579050   11\n9        Jones       Carole         Miss                     Y          21291638   11\n10     Barrera       Sylvia         Miss                     Y          23597746    8\n11       Swift    Christina          Ms.                     Y          13972034   10\n12       Brock          Ann          Ms.                     Y          21707734   11\n13     Watkins      Mildred          Ms.                     N          10946124    9\n14       Aaron                                                           8149805    9\n15       Aaron                                                           1034649   15\n16      Cooper                                                          21235919   11\n17      Cooper                                                            879419   11\n18      Cooper                                                          18664302   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017475,
                    "execution_time": 0.007428,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003791
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055565,
                    "execution_time": 0.008177,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039137
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Drummond      Shameka          Dr.                     Y          13103643    9\n1     Drummond      Shameka          Dr.                     Y          21247065    9\n2      Gregory      Deborah          Dr.                     Y           6344631   10\n3       Deleon       Arturo          Mr.                     Y          10820056   12\n4         Hunt        Marcy         Miss                     N           1978716   12\n5       Duncan         Lisa         Miss                     Y           4381199   12\n6   Washington      Abraham                                             13677521   15\n7        Jones       Carole         Miss                     Y          18885923   14\n8        Jones       Carole         Miss                     Y          22579050   11\n9        Jones       Carole         Miss                     Y          21291638   11\n10     Barrera       Sylvia         Miss                     Y          23597746    8\n11       Swift    Christina          Ms.                     Y          13972034   10\n12       Brock          Ann          Ms.                     Y          21707734   11\n13     Watkins      Mildred          Ms.                     N          10946124    9\n14       Aaron                                                           8149805    9\n15       Aaron                                                           1034649   15\n16      Cooper                                                          21235919   11\n17      Cooper                                                            879419   11\n18      Cooper                                                          18664302   15\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.829221,
                    "execution_time": 0.481004,
                    "compile_time": 0.135406,
                    "planning_time": 0.05119,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.001203,
                    "execution_time": 5.938454,
                    "compile_time": 6.727435,
                    "planning_time": 0.167011,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_20\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.773015,
                    "execution_time": 0.32927,
                    "compile_time": 0.000446,
                    "planning_time": 0.024475,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.878425,
                    "execution_time": 0.371031,
                    "compile_time": 0.000437,
                    "planning_time": 0.086283,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_21\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Whitley        Alyce          Ms.                     N          14450420    7\n1       Walton         Noel          Mr.                     N          16899610    9\n2     Atchison         Paul          Mr.                     N          14212899   14\n3     Atchison         Paul          Mr.                     N          17118122   12\n4      Bartels      Timothy          Mr.                     Y           8273592   12\n5     Williams       Donald          Mr.                     Y          13665816   11\n6         Rice      Jasmine          Ms.                     Y          15149320   11\n7     Holbrook      Latanya         Miss                     N           4684644    9\n8      Morales     Benjamin          Sir                     N           4985845    9\n9     Paquette        Eddie          Dr.                     Y          23308740    8\n10      Harmon      Harriet          Ms.                     N           6338785   12\n11      Weaver      Jessica          Ms.                     Y           2094601   10\n12       Russo         Dawn         Miss                     Y          11273531   13\n13                                                                      18309806   11\n14                    Lissa          Dr.                                10312021   14\n15      Holmes     Jonathan          Sir                     Y          13138776   12\n16      Watson        Sarah         Miss                     N          14987790   13\n17                    Diane         Miss                                22409678    7\n18                    Diane         Miss                                 9166341   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017774,
                    "execution_time": 0.00774,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003741
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056033,
                    "execution_time": 0.008509,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039239
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_20\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_21\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Whitley        Alyce          Ms.                     N          14450420    7\n1       Walton         Noel          Mr.                     N          16899610    9\n2     Atchison         Paul          Mr.                     N          14212899   14\n3     Atchison         Paul          Mr.                     N          17118122   12\n4      Bartels      Timothy          Mr.                     Y           8273592   12\n5     Williams       Donald          Mr.                     Y          13665816   11\n6         Rice      Jasmine          Ms.                     Y          15149320   11\n7     Holbrook      Latanya         Miss                     N           4684644    9\n8      Morales     Benjamin          Sir                     N           4985845    9\n9     Paquette        Eddie          Dr.                     Y          23308740    8\n10      Harmon      Harriet          Ms.                     N           6338785   12\n11      Weaver      Jessica          Ms.                     Y           2094601   10\n12       Russo         Dawn         Miss                     Y          11273531   13\n13                                                                      18309806   11\n14                    Lissa          Dr.                                10312021   14\n15      Holmes     Jonathan          Sir                     Y          13138776   12\n16      Watson        Sarah         Miss                     N          14987790   13\n17                    Diane         Miss                                22409678    7\n18                    Diane         Miss                                 9166341   12\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County')\n    \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n   ) as sales_summary\n   join customer on sales_summary.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120597,
                    "execution_time": 0.036107,
                    "compile_time": 0.00037,
                    "planning_time": 0.053789,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.495986,
                    "execution_time": 0.17389,
                    "compile_time": 8.139815,
                    "planning_time": 0.147183,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.099849,
                    "execution_time": 0.037181,
                    "compile_time": 0.01374,
                    "planning_time": 0.025163,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.802894,
                    "execution_time": 0.038622,
                    "compile_time": 3.624818,
                    "planning_time": 0.097197,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_23\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017843,
                    "execution_time": 0.007218,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004674
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055196,
                    "execution_time": 0.007867,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039926
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_23\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120615,
                    "execution_time": 0.035411,
                    "compile_time": 0.00037,
                    "planning_time": 0.054629,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.378169,
                    "execution_time": 0.039178,
                    "compile_time": 4.174545,
                    "planning_time": 0.132049,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08897,
                    "execution_time": 0.038538,
                    "compile_time": 0.000256,
                    "planning_time": 0.025826,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.216434,
                    "execution_time": 0.038096,
                    "compile_time": 0.068226,
                    "planning_time": 0.085725,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018953,
                    "execution_time": 0.007344,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004852
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053307,
                    "execution_time": 0.007158,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040003
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060004,
                    "execution_time": 0.034265,
                    "compile_time": 0.000187,
                    "planning_time": 0.004025,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.118014,
                    "execution_time": 0.034748,
                    "compile_time": 0.000185,
                    "planning_time": 0.05957,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.118548,
                    "execution_time": 0.073436,
                    "compile_time": 0.000258,
                    "planning_time": 0.024776,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.656408,
                    "execution_time": 0.073337,
                    "compile_time": 3.472523,
                    "planning_time": 0.084665,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_27\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_27\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01798,
                    "execution_time": 0.007203,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004785
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05371,
                    "execution_time": 0.007347,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.040254
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_27\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_27\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01764,
                    "execution_time": 0.007291,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004601
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053179,
                    "execution_time": 0.007318,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.039828
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_28\" AS SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101608,
                    "execution_time": 0.034925,
                    "compile_time": 0.038419,
                    "planning_time": 0.005738,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.269733,
                    "execution_time": 0.034304,
                    "compile_time": 3.128006,
                    "planning_time": 0.080932,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_28\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_28\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_28\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018576,
                    "execution_time": 0.007838,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004718
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053615,
                    "execution_time": 0.007791,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039786
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_28\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_28\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_28\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" DESC , \"SS_TICKET_NUMBER\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035973,
                    "execution_time": 0.008419,
                    "compile_time": 0.01466,
                    "planning_time": 0.006466
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.66112,
                    "execution_time": 0.009246,
                    "compile_time": 4.605108,
                    "planning_time": 0.041921
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" DESC , \"SS_TICKET_NUMBER\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021122,
                    "execution_time": 0.008208,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.006351
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022157,
                    "execution_time": 0.008997,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.006569
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    }
]