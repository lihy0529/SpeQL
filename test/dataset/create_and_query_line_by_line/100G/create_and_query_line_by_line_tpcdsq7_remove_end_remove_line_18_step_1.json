[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and 1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and 1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query7.tpl 0.2 */ i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk\n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.975997,
                    "execution_time": 6.580432,
                    "compile_time": 0.059695,
                    "planning_time": 0.050895,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 20.450292,
                    "execution_time": 10.165942,
                    "compile_time": 9.87421,
                    "planning_time": 0.125939,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAHFNCBAAA    51  75.64  197.45  37.01\n1   AAAAAAAABGFABAAA    49  75.95  193.65  38.12\n2   AAAAAAAAMCGOAAAA    50  75.10  182.48  37.97\n3   AAAAAAAAMKFJCAAA    50  77.43  186.57  39.64\n4   AAAAAAAAPLNCCAAA    50  74.13  203.38  37.50\n5   AAAAAAAADLJDCAAA    51  76.22  183.83  37.47\n6   AAAAAAAAICAOBAAA    50  76.66  196.98  38.09\n7   AAAAAAAAKAPFBAAA    50  75.72  186.23  37.12\n8   AAAAAAAALJCAAAAA    49  77.06  170.09  39.23\n9   AAAAAAAAKCEOBAAA    51  76.88  199.49  37.92\n10  AAAAAAAAKMEPCAAA    50  75.20  192.55  36.92\n11  AAAAAAAAHMEPCAAA    50  76.17  196.95  37.80\n12  AAAAAAAAAJIHCAAA    50  73.93  185.41  36.76\n13  AAAAAAAAOILCCAAA    51  74.89  191.61  37.76\n14  AAAAAAAACEMCCAAA    51  74.99  178.62  37.96\n15  AAAAAAAAICOBBAAA    50  75.23  180.73  36.97\n16  AAAAAAAAABCBBAAA    51  76.82  234.26  39.05\n17  AAAAAAAAMJDEAAAA    50  77.07  192.44  37.85\n18  AAAAAAAABNEGBAAA    52  73.92  216.23  38.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046956,
                    "execution_time": 0.008377,
                    "compile_time": 0.028962,
                    "planning_time": 0.003489
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.361044,
                    "execution_time": 0.008127,
                    "compile_time": 3.305828,
                    "planning_time": 0.038498
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAHFNCBAAA    51  75.64  197.45  37.01\n1   AAAAAAAABGFABAAA    49  75.95  193.65  38.12\n2   AAAAAAAAMCGOAAAA    50  75.10  182.48  37.97\n3   AAAAAAAAMKFJCAAA    50  77.43  186.57  39.64\n4   AAAAAAAAPLNCCAAA    50  74.13  203.38  37.50\n5   AAAAAAAADLJDCAAA    51  76.22  183.83  37.47\n6   AAAAAAAAICAOBAAA    50  76.66  196.98  38.09\n7   AAAAAAAAKAPFBAAA    50  75.72  186.23  37.12\n8   AAAAAAAALJCAAAAA    49  77.06  170.09  39.23\n9   AAAAAAAAKCEOBAAA    51  76.88  199.49  37.92\n10  AAAAAAAAKMEPCAAA    50  75.20  192.55  36.92\n11  AAAAAAAAHMEPCAAA    50  76.17  196.95  37.80\n12  AAAAAAAAAJIHCAAA    50  73.93  185.41  36.76\n13  AAAAAAAAOILCCAAA    51  74.89  191.61  37.76\n14  AAAAAAAACEMCCAAA    51  74.99  178.62  37.96\n15  AAAAAAAAICOBBAAA    50  75.23  180.73  36.97\n16  AAAAAAAAABCBBAAA    51  76.82  234.26  39.05\n17  AAAAAAAAMJDEAAAA    50  77.07  192.44  37.85\n18  AAAAAAAABNEGBAAA    52  73.92  216.23  38.24\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.208501,
                    "execution_time": 4.879819,
                    "compile_time": 0.000547,
                    "planning_time": 0.05166,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15.81873,
                    "execution_time": 5.329073,
                    "compile_time": 10.078919,
                    "planning_time": 0.129947,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAFMBABAAA    51  78.18  201.33  39.13\n1   AAAAAAAAGJDGCAAA    49  75.65  194.35  36.85\n2   AAAAAAAAKELNAAAA    51  76.25  191.57  38.48\n3   AAAAAAAAOEDABAAA    51  74.24  196.19  36.71\n4   AAAAAAAANGHPCAAA    48  77.51  196.80  39.12\n5   AAAAAAAAEKHBBAAA    50  75.00  208.24  36.61\n6   AAAAAAAAEOEOCAAA    51  74.93  176.10  38.77\n7   AAAAAAAAHBMDCAAA    50  75.94  201.50  38.23\n8   AAAAAAAAGNBCAAAA    50  74.31  163.85  37.38\n9   AAAAAAAACDKHBAAA    50  77.24  187.43  38.06\n10  AAAAAAAAKBPLBAAA    49  74.37  183.08  37.12\n11  AAAAAAAALAFMAAAA    51  76.11  193.82  38.13\n12  AAAAAAAAINMDCAAA    50  74.62  165.34  37.76\n13  AAAAAAAAIDLHAAAA    50  77.71  169.51  39.26\n14  AAAAAAAAINAABAAA    49  74.59  187.89  36.19\n15  AAAAAAAADLNEAAAA    50  74.89  204.54  37.40\n16  AAAAAAAAFDGPCAAA    50  76.90  190.61  38.27\n17  AAAAAAAAOKDNAAAA    50  77.93  202.20  38.33\n18  AAAAAAAAFELIAAAA    50  77.66  181.65  39.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018745,
                    "execution_time": 0.00815,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003511
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.163768,
                    "execution_time": 0.00875,
                    "compile_time": 0.109854,
                    "planning_time": 0.038694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAFMBABAAA    51  78.18  201.33  39.13\n1   AAAAAAAAGJDGCAAA    49  75.65  194.35  36.85\n2   AAAAAAAAKELNAAAA    51  76.25  191.57  38.48\n3   AAAAAAAAOEDABAAA    51  74.24  196.19  36.71\n4   AAAAAAAANGHPCAAA    48  77.51  196.80  39.12\n5   AAAAAAAAEKHBBAAA    50  75.00  208.24  36.61\n6   AAAAAAAAEOEOCAAA    51  74.93  176.10  38.77\n7   AAAAAAAAHBMDCAAA    50  75.94  201.50  38.23\n8   AAAAAAAAGNBCAAAA    50  74.31  163.85  37.38\n9   AAAAAAAACDKHBAAA    50  77.24  187.43  38.06\n10  AAAAAAAAKBPLBAAA    49  74.37  183.08  37.12\n11  AAAAAAAALAFMAAAA    51  76.11  193.82  38.13\n12  AAAAAAAAINMDCAAA    50  74.62  165.34  37.76\n13  AAAAAAAAIDLHAAAA    50  77.71  169.51  39.26\n14  AAAAAAAAINAABAAA    49  74.59  187.89  36.19\n15  AAAAAAAADLNEAAAA    50  74.89  204.54  37.40\n16  AAAAAAAAFDGPCAAA    50  76.90  190.61  38.27\n17  AAAAAAAAOKDNAAAA    50  77.93  202.20  38.33\n18  AAAAAAAAFELIAAAA    50  77.66  181.65  39.53\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.485315,
                    "execution_time": 2.154327,
                    "compile_time": 0.000536,
                    "planning_time": 0.05274,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.318903,
                    "execution_time": 2.543116,
                    "compile_time": 3.358398,
                    "planning_time": 0.140644,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAEOKIBAAA    50  72.43  191.15  37.21\n1   AAAAAAAAEFHLCAAA    47  74.32  223.43  39.65\n2   AAAAAAAAOGAOAAAA    48  77.29  233.94  40.50\n3   AAAAAAAAJOGMCAAA    48  82.07  216.58  41.15\n4   AAAAAAAAGBMDBAAA    48  75.84  175.02  37.26\n5   AAAAAAAAKPLEBAAA    52  72.33  141.69  34.81\n6   AAAAAAAALPMACAAA    50  74.10  114.21  32.85\n7   AAAAAAAAIPDFBAAA    48  73.83  172.94  35.24\n8   AAAAAAAAICJMBAAA    49  74.28  213.18  36.98\n9   AAAAAAAAMNIMCAAA    54  77.80  250.53  41.38\n10  AAAAAAAANBECCAAA    48  73.21  226.49  36.88\n11  AAAAAAAAKAFOCAAA    52  75.57  257.55  37.77\n12  AAAAAAAAIAMJAAAA    50  78.59  268.40  38.03\n13  AAAAAAAANFOJCAAA    51  75.04  278.72  40.43\n14  AAAAAAAAGLHMCAAA    52  76.95  192.17  36.99\n15  AAAAAAAAKBEPBAAA    49  79.30  116.42  38.14\n16  AAAAAAAACLJADAAA    54  73.62  197.68  36.92\n17  AAAAAAAACAPJAAAA    48  79.21  194.40  37.46\n18  AAAAAAAAGOJACAAA    51  75.54  196.13  36.31\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017219,
                    "execution_time": 0.007769,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003457
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052955,
                    "execution_time": 0.007799,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.038638
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAEOKIBAAA    50  72.43  191.15  37.21\n1   AAAAAAAAEFHLCAAA    47  74.32  223.43  39.65\n2   AAAAAAAAOGAOAAAA    48  77.29  233.94  40.50\n3   AAAAAAAAJOGMCAAA    48  82.07  216.58  41.15\n4   AAAAAAAAGBMDBAAA    48  75.84  175.02  37.26\n5   AAAAAAAAKPLEBAAA    52  72.33  141.69  34.81\n6   AAAAAAAALPMACAAA    50  74.10  114.21  32.85\n7   AAAAAAAAIPDFBAAA    48  73.83  172.94  35.24\n8   AAAAAAAAICJMBAAA    49  74.28  213.18  36.98\n9   AAAAAAAAMNIMCAAA    54  77.80  250.53  41.38\n10  AAAAAAAANBECCAAA    48  73.21  226.49  36.88\n11  AAAAAAAAKAFOCAAA    52  75.57  257.55  37.77\n12  AAAAAAAAIAMJAAAA    50  78.59  268.40  38.03\n13  AAAAAAAANFOJCAAA    51  75.04  278.72  40.43\n14  AAAAAAAAGLHMCAAA    52  76.95  192.17  36.99\n15  AAAAAAAAKBEPBAAA    49  79.30  116.42  38.14\n16  AAAAAAAACLJADAAA    54  73.62  197.68  36.92\n17  AAAAAAAACAPJAAAA    48  79.21  194.40  37.46\n18  AAAAAAAAGOJACAAA    51  75.54  196.13  36.31\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.102779,
                    "execution_time": 0.767179,
                    "compile_time": 0.000553,
                    "planning_time": 0.054282,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.097059,
                    "execution_time": 1.271251,
                    "compile_time": 9.40241,
                    "planning_time": 0.131531,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAIFHOBAAA    50  73.65  356.71  28.66\n1   AAAAAAAANFMGBAAA    52  80.10  280.40  40.14\n2   AAAAAAAAIFMCBAAA    58  70.91  265.03  30.43\n3   AAAAAAAAOACGBAAA    52  67.24  204.87  32.51\n4   AAAAAAAACEPPBAAA    54  73.74  315.00  33.68\n5   AAAAAAAAGNGKCAAA    52  86.15  117.32  39.36\n6   AAAAAAAALOIMBAAA    60  81.47   23.06  43.83\n7   AAAAAAAALAPLAAAA    42  84.55   54.18  43.08\n8   AAAAAAAACDEJCAAA    50  81.47  443.20  41.25\n9   AAAAAAAANFJPBAAA    49  78.48  356.01  40.20\n10  AAAAAAAAKBCPAAAA    52  72.99   57.42  34.47\n11  AAAAAAAAJAOMCAAA    57  77.16  217.84  42.94\n12  AAAAAAAAMOECCAAA    51  84.45  184.47  38.18\n13  AAAAAAAAEBCPAAAA    47  87.79  230.94  44.09\n14  AAAAAAAAMBIHAAAA    44  64.26   66.09  27.47\n15  AAAAAAAAHEEOCAAA    51  78.28   65.82  35.92\n16  AAAAAAAADOCAAAAA    49  71.03   91.29  29.34\n17  AAAAAAAAAAALCAAA    53  66.33  158.93  28.89\n18  AAAAAAAAONBCBAAA    44  79.47   85.51  39.67\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017729,
                    "execution_time": 0.008186,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003532
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053137,
                    "execution_time": 0.008214,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038583
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAIFHOBAAA    50  73.65  356.71  28.66\n1   AAAAAAAANFMGBAAA    52  80.10  280.40  40.14\n2   AAAAAAAAIFMCBAAA    58  70.91  265.03  30.43\n3   AAAAAAAAOACGBAAA    52  67.24  204.87  32.51\n4   AAAAAAAACEPPBAAA    54  73.74  315.00  33.68\n5   AAAAAAAAGNGKCAAA    52  86.15  117.32  39.36\n6   AAAAAAAALOIMBAAA    60  81.47   23.06  43.83\n7   AAAAAAAALAPLAAAA    42  84.55   54.18  43.08\n8   AAAAAAAACDEJCAAA    50  81.47  443.20  41.25\n9   AAAAAAAANFJPBAAA    49  78.48  356.01  40.20\n10  AAAAAAAAKBCPAAAA    52  72.99   57.42  34.47\n11  AAAAAAAAJAOMCAAA    57  77.16  217.84  42.94\n12  AAAAAAAAMOECCAAA    51  84.45  184.47  38.18\n13  AAAAAAAAEBCPAAAA    47  87.79  230.94  44.09\n14  AAAAAAAAMBIHAAAA    44  64.26   66.09  27.47\n15  AAAAAAAAHEEOCAAA    51  78.28   65.82  35.92\n16  AAAAAAAADOCAAAAA    49  71.03   91.29  29.34\n17  AAAAAAAAAAALCAAA    53  66.33  158.93  28.89\n18  AAAAAAAAONBCBAAA    44  79.47   85.51  39.67\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N')\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.08915,
                    "execution_time": 0.75443,
                    "compile_time": 0.000579,
                    "planning_time": 0.055538,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.104636,
                    "execution_time": 1.026145,
                    "compile_time": 9.649001,
                    "planning_time": 0.138956,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAOJMLBAAA    55  72.24  342.45  35.49\n1   AAAAAAAAGGBCBAAA    55  80.71  312.26  41.09\n2   AAAAAAAAHONECAAA    58  90.35  309.39  39.82\n3   AAAAAAAAMLFLCAAA    47  58.95  209.19  29.73\n4   AAAAAAAAIKEABAAA    52  71.34  194.79  33.97\n5   AAAAAAAADGBCBAAA    54  68.34   61.71  21.32\n6   AAAAAAAAACGJAAAA    50  79.91  157.06  49.55\n7   AAAAAAAAJECLCAAA    55  72.19  143.24  33.45\n8   AAAAAAAAOAMIAAAA    46  76.51  133.21  40.50\n9   AAAAAAAAABEEBAAA    44  88.82  306.83  41.10\n10  AAAAAAAAMJINBAAA    50  72.77  165.47  32.73\n11  AAAAAAAACMEKAAAA    62  88.78  187.08  32.09\n12  AAAAAAAAKJAMAAAA    45  72.51   74.01  34.81\n13  AAAAAAAAFJMPCAAA    54  83.23  226.39  37.36\n14  AAAAAAAAHEFKCAAA    51  85.40  221.29  39.71\n15  AAAAAAAAEADICAAA    51  74.24  120.85  37.73\n16  AAAAAAAAMLGBCAAA    53  69.44  336.58  35.32\n17  AAAAAAAAOODBDAAA    44  62.93  223.15  34.87\n18  AAAAAAAABICEBAAA    45  78.70   33.44  34.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018115,
                    "execution_time": 0.008144,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.00369
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053177,
                    "execution_time": 0.008222,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038711
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAOJMLBAAA    55  72.24  342.45  35.49\n1   AAAAAAAAGGBCBAAA    55  80.71  312.26  41.09\n2   AAAAAAAAHONECAAA    58  90.35  309.39  39.82\n3   AAAAAAAAMLFLCAAA    47  58.95  209.19  29.73\n4   AAAAAAAAIKEABAAA    52  71.34  194.79  33.97\n5   AAAAAAAADGBCBAAA    54  68.34   61.71  21.32\n6   AAAAAAAAACGJAAAA    50  79.91  157.06  49.55\n7   AAAAAAAAJECLCAAA    55  72.19  143.24  33.45\n8   AAAAAAAAOAMIAAAA    46  76.51  133.21  40.50\n9   AAAAAAAAABEEBAAA    44  88.82  306.83  41.10\n10  AAAAAAAAMJINBAAA    50  72.77  165.47  32.73\n11  AAAAAAAACMEKAAAA    62  88.78  187.08  32.09\n12  AAAAAAAAKJAMAAAA    45  72.51   74.01  34.81\n13  AAAAAAAAFJMPCAAA    54  83.23  226.39  37.36\n14  AAAAAAAAHEFKCAAA    51  85.40  221.29  39.71\n15  AAAAAAAAEADICAAA    51  74.24  120.85  37.73\n16  AAAAAAAAMLGBCAAA    53  69.44  336.58  35.32\n17  AAAAAAAAOODBDAAA    44  62.93  223.15  34.87\n18  AAAAAAAABICEBAAA    45  78.70   33.44  34.72\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.584883,
                    "execution_time": 0.241951,
                    "compile_time": 0.000555,
                    "planning_time": 0.057808,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.894,
                    "execution_time": 0.250934,
                    "compile_time": 5.229866,
                    "planning_time": 0.134407,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAAJBKJCAAA    66   66.12  381.92  37.91\n1   AAAAAAAAMKBLAAAA    48   86.61   63.40  57.22\n2   AAAAAAAAILOKAAAA    56   55.22    0.00  30.72\n3   AAAAAAAAMHKKCAAA    58   60.35  248.83  25.08\n4   AAAAAAAAONAACAAA    59   82.93    3.30  28.13\n5   AAAAAAAAADFDAAAA    46   53.16    3.58  22.44\n6   AAAAAAAAOHFBBAAA    54   74.17  168.54  32.36\n7   AAAAAAAAPOIIBAAA    52   95.32  131.01  41.26\n8   AAAAAAAACHLDAAAA    41  105.89   89.33  42.26\n9   AAAAAAAAAGGHAAAA    62   76.99    0.00  36.27\n10  AAAAAAAAEGDMAAAA    57   57.23    0.00  30.02\n11  AAAAAAAAJPHPAAAA    55   73.82  912.67  24.82\n12  AAAAAAAACCECBAAA    45  114.83   12.67  56.15\n13  AAAAAAAAAEFCAAAA    44   67.49    0.00  14.92\n14  AAAAAAAAGJMGBAAA    22   78.04  226.40  55.33\n15  AAAAAAAAOALAAAAA    42   43.49  142.16  25.88\n16  AAAAAAAAPPHLBAAA    60   86.74  307.92  45.74\n17  AAAAAAAAIHAJBAAA    49   75.63  395.16  39.75\n18  AAAAAAAAIGMDAAAA    51   91.53  374.85  52.70\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017725,
                    "execution_time": 0.008366,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003413
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053339,
                    "execution_time": 0.008015,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038531
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAAJBKJCAAA    66   66.12  381.92  37.91\n1   AAAAAAAAMKBLAAAA    48   86.61   63.40  57.22\n2   AAAAAAAAILOKAAAA    56   55.22    0.00  30.72\n3   AAAAAAAAMHKKCAAA    58   60.35  248.83  25.08\n4   AAAAAAAAONAACAAA    59   82.93    3.30  28.13\n5   AAAAAAAAADFDAAAA    46   53.16    3.58  22.44\n6   AAAAAAAAOHFBBAAA    54   74.17  168.54  32.36\n7   AAAAAAAAPOIIBAAA    52   95.32  131.01  41.26\n8   AAAAAAAACHLDAAAA    41  105.89   89.33  42.26\n9   AAAAAAAAAGGHAAAA    62   76.99    0.00  36.27\n10  AAAAAAAAEGDMAAAA    57   57.23    0.00  30.02\n11  AAAAAAAAJPHPAAAA    55   73.82  912.67  24.82\n12  AAAAAAAACCECBAAA    45  114.83   12.67  56.15\n13  AAAAAAAAAEFCAAAA    44   67.49    0.00  14.92\n14  AAAAAAAAGJMGBAAA    22   78.04  226.40  55.33\n15  AAAAAAAAOALAAAAA    42   43.49  142.16  25.88\n16  AAAAAAAAPPHLBAAA    60   86.74  307.92  45.74\n17  AAAAAAAAIHAJBAAA    49   75.63  395.16  39.75\n18  AAAAAAAAIGMDAAAA    51   91.53  374.85  52.70\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAKBABBAAA    59   67.98     5.30  15.20\n1   AAAAAAAAAMHADAAA    46   63.64    25.62  11.05\n2   AAAAAAAAENMPCAAA    70   82.21   427.29  43.49\n3   AAAAAAAAMIFPBAAA    70   81.77   409.75  25.06\n4   AAAAAAAAOOBPAAAA    52   63.27     0.00  43.67\n5   AAAAAAAACNJDCAAA    51   61.31    51.27  43.54\n6   AAAAAAAACLMDBAAA    59   40.34     0.00  12.74\n7   AAAAAAAAFPDLAAAA    45   88.18     6.56  36.56\n8   AAAAAAAAGBINAAAA    49   43.16     0.00  16.06\n9   AAAAAAAAKBCDBAAA    58   55.99   465.71  38.54\n10  AAAAAAAAEMDICAAA    61   91.29  1100.10  42.20\n11  AAAAAAAAKLEMBAAA    44   78.59   370.48  44.44\n12  AAAAAAAAJBMLBAAA    37   82.96    58.53  39.91\n13  AAAAAAAAKBPKBAAA    60   69.30     0.00  46.35\n14  AAAAAAAAIAFNCAAA    52   66.77   224.99  29.46\n15  AAAAAAAAMJNHCAAA    38   81.57    10.53  33.68\n16  AAAAAAAACKIHCAAA    65   74.26     7.42  27.55\n17  AAAAAAAABMNNBAAA    29   63.76     0.00  12.19\n18  AAAAAAAAGMDKBAAA    34   62.66    60.44  28.67\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016649,
                    "execution_time": 0.007513,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00325
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051887,
                    "execution_time": 0.007706,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038188
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAKBABBAAA    59   67.98     5.30  15.20\n1   AAAAAAAAAMHADAAA    46   63.64    25.62  11.05\n2   AAAAAAAAENMPCAAA    70   82.21   427.29  43.49\n3   AAAAAAAAMIFPBAAA    70   81.77   409.75  25.06\n4   AAAAAAAAOOBPAAAA    52   63.27     0.00  43.67\n5   AAAAAAAACNJDCAAA    51   61.31    51.27  43.54\n6   AAAAAAAACLMDBAAA    59   40.34     0.00  12.74\n7   AAAAAAAAFPDLAAAA    45   88.18     6.56  36.56\n8   AAAAAAAAGBINAAAA    49   43.16     0.00  16.06\n9   AAAAAAAAKBCDBAAA    58   55.99   465.71  38.54\n10  AAAAAAAAEMDICAAA    61   91.29  1100.10  42.20\n11  AAAAAAAAKLEMBAAA    44   78.59   370.48  44.44\n12  AAAAAAAAJBMLBAAA    37   82.96    58.53  39.91\n13  AAAAAAAAKBPKBAAA    60   69.30     0.00  46.35\n14  AAAAAAAAIAFNCAAA    52   66.77   224.99  29.46\n15  AAAAAAAAMJNHCAAA    38   81.57    10.53  33.68\n16  AAAAAAAACKIHCAAA    65   74.26     7.42  27.55\n17  AAAAAAAABMNNBAAA    29   63.76     0.00  12.19\n18  AAAAAAAAGMDKBAAA    34   62.66    60.44  28.67\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n order by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA    49   77.46   133.13  39.06\n1   AAAAAAAAAAAACAAA    52   68.35     2.75  31.32\n2   AAAAAAAAAAABAAAA    62  104.03   247.70  35.40\n3   AAAAAAAAAAABBAAA    54   87.67    23.24  40.06\n4   AAAAAAAAAAABDAAA    55   59.84     0.00  31.03\n5   AAAAAAAAAAACAAAA    47   72.94    96.47  31.89\n6   AAAAAAAAAAACCAAA    49   72.69   601.94  31.02\n7   AAAAAAAAAAADBAAA    39   83.81   302.21  22.98\n8   AAAAAAAAAAADCAAA    56   71.18   360.26  29.99\n9   AAAAAAAAAAAEAAAA    53   63.93     0.00  24.85\n10  AAAAAAAAAAAEBAAA    52   80.00   251.08  49.81\n11  AAAAAAAAAAAFAAAA    53   94.63   257.48  40.61\n12  AAAAAAAAAAAFCAAA    47   59.78   152.06  29.99\n13  AAAAAAAAAAAGBAAA    27   69.42    58.78  37.40\n14  AAAAAAAAAAAGCAAA    53   57.18  1200.63  42.19\n15  AAAAAAAAAAAHAAAA    52   54.79    22.74  22.74\n16  AAAAAAAAAAAHBAAA    52   70.99    53.70  36.65\n17  AAAAAAAAAAAIAAAA    56   53.26    49.89  13.88\n18  AAAAAAAAAAAICAAA    58   94.29   323.93  43.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.037137,
                    "execution_time": 0.010934,
                    "compile_time": 0.016417,
                    "planning_time": 0.003699
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.418643,
                    "execution_time": 0.011371,
                    "compile_time": 3.367956,
                    "planning_time": 0.038694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA    49   77.46   133.13  39.06\n1   AAAAAAAAAAAACAAA    52   68.35     2.75  31.32\n2   AAAAAAAAAAABAAAA    62  104.03   247.70  35.40\n3   AAAAAAAAAAABBAAA    54   87.67    23.24  40.06\n4   AAAAAAAAAAABDAAA    55   59.84     0.00  31.03\n5   AAAAAAAAAAACAAAA    47   72.94    96.47  31.89\n6   AAAAAAAAAAACCAAA    49   72.69   601.94  31.02\n7   AAAAAAAAAAADBAAA    39   83.81   302.21  22.98\n8   AAAAAAAAAAADCAAA    56   71.18   360.26  29.99\n9   AAAAAAAAAAAEAAAA    53   63.93     0.00  24.85\n10  AAAAAAAAAAAEBAAA    52   80.00   251.08  49.81\n11  AAAAAAAAAAAFAAAA    53   94.63   257.48  40.61\n12  AAAAAAAAAAAFCAAA    47   59.78   152.06  29.99\n13  AAAAAAAAAAAGBAAA    27   69.42    58.78  37.40\n14  AAAAAAAAAAAGCAAA    53   57.18  1200.63  42.19\n15  AAAAAAAAAAAHAAAA    52   54.79    22.74  22.74\n16  AAAAAAAAAAAHBAAA    52   70.99    53.70  36.65\n17  AAAAAAAAAAAIAAAA    56   53.26    49.89  13.88\n18  AAAAAAAAAAAICAAA    58   94.29   323.93  43.09\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n order by i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA    49   77.46   133.13  39.06\n1   AAAAAAAAAAAACAAA    52   68.35     2.75  31.32\n2   AAAAAAAAAAABAAAA    62  104.03   247.70  35.40\n3   AAAAAAAAAAABBAAA    54   87.67    23.24  40.06\n4   AAAAAAAAAAABDAAA    55   59.84     0.00  31.03\n5   AAAAAAAAAAACAAAA    47   72.94    96.47  31.89\n6   AAAAAAAAAAACCAAA    49   72.69   601.94  31.02\n7   AAAAAAAAAAADBAAA    39   83.81   302.21  22.98\n8   AAAAAAAAAAADCAAA    56   71.18   360.26  29.99\n9   AAAAAAAAAAAEAAAA    53   63.93     0.00  24.85\n10  AAAAAAAAAAAEBAAA    52   80.00   251.08  49.81\n11  AAAAAAAAAAAFAAAA    53   94.63   257.48  40.61\n12  AAAAAAAAAAAFCAAA    47   59.78   152.06  29.99\n13  AAAAAAAAAAAGBAAA    27   69.42    58.78  37.40\n14  AAAAAAAAAAAGCAAA    53   57.18  1200.63  42.19\n15  AAAAAAAAAAAHAAAA    52   54.79    22.74  22.74\n16  AAAAAAAAAAAHBAAA    52   70.99    53.70  36.65\n17  AAAAAAAAAAAIAAAA    56   53.26    49.89  13.88\n18  AAAAAAAAAAAICAAA    58   94.29   323.93  43.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021574,
                    "execution_time": 0.011871,
                    "compile_time": 6.7e-05,
                    "planning_time": 0.003679
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021797,
                    "execution_time": 0.011692,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.0038
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAAAAABAAA    49   77.46   133.13  39.06\n1   AAAAAAAAAAAACAAA    52   68.35     2.75  31.32\n2   AAAAAAAAAAABAAAA    62  104.03   247.70  35.40\n3   AAAAAAAAAAABBAAA    54   87.67    23.24  40.06\n4   AAAAAAAAAAABDAAA    55   59.84     0.00  31.03\n5   AAAAAAAAAAACAAAA    47   72.94    96.47  31.89\n6   AAAAAAAAAAACCAAA    49   72.69   601.94  31.02\n7   AAAAAAAAAAADBAAA    39   83.81   302.21  22.98\n8   AAAAAAAAAAADCAAA    56   71.18   360.26  29.99\n9   AAAAAAAAAAAEAAAA    53   63.93     0.00  24.85\n10  AAAAAAAAAAAEBAAA    52   80.00   251.08  49.81\n11  AAAAAAAAAAAFAAAA    53   94.63   257.48  40.61\n12  AAAAAAAAAAAFCAAA    47   59.78   152.06  29.99\n13  AAAAAAAAAAAGBAAA    27   69.42    58.78  37.40\n14  AAAAAAAAAAAGCAAA    53   57.18  1200.63  42.19\n15  AAAAAAAAAAAHAAAA    52   54.79    22.74  22.74\n16  AAAAAAAAAAAHBAAA    52   70.99    53.70  36.65\n17  AAAAAAAAAAAIAAAA    56   53.26    49.89  13.88\n18  AAAAAAAAAAAICAAA    58   94.29   323.93  43.09\n...*/"
    }
]