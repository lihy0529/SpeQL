[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n/*CURSOR_IDENTIFIER*/\n          ,count(*) as cnt\n     from store_sales\n     group by ss_ticket_number, ss_customer_sk\n   ) subquery\njoin customer on subquery.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.274042,
                    "execution_time": 2.103929,
                    "compile_time": 0.000293,
                    "planning_time": 0.024599,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.399433,
                    "execution_time": 2.164602,
                    "compile_time": 0.00028,
                    "planning_time": 0.086715,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0           17434185        848853.0   15\n1           23281437       1636174.0   12\n2           17434185             NaN    1\n3            2440815       1841739.0   14\n4            2281251        758987.0   10\n5             781525       1079416.0   12\n6            1689194        815492.0   15\n7             781525             NaN    1\n8           21042261        168236.0    8\n9            3943971        514265.0    9\n10             42852       1849831.0   11\n11           1690683       1722253.0    8\n12          15050185        830521.0   15\n13           7692974       1854099.0   11\n14          15199908        434872.0   12\n15          18053393        980298.0   11\n16          15199908             NaN    1\n17          10551682       1980660.0   11\n18          14449641        577405.0   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.058023,
                    "execution_time": 0.008521,
                    "compile_time": 0.03982,
                    "planning_time": 0.003396
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.152624,
                    "execution_time": 0.008033,
                    "compile_time": 3.094226,
                    "planning_time": 0.039464
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", COUNT(*) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0           17434185        848853.0   15\n1           23281437       1636174.0   12\n2           17434185             NaN    1\n3            2440815       1841739.0   14\n4            2281251        758987.0   10\n5             781525       1079416.0   12\n6            1689194        815492.0   15\n7             781525             NaN    1\n8           21042261        168236.0    8\n9            3943971        514265.0    9\n10             42852       1849831.0   11\n11           1690683       1722253.0    8\n12          15050185        830521.0   15\n13           7692974       1854099.0   11\n14          15199908        434872.0   12\n15          18053393        980298.0   11\n16          15199908             NaN    1\n17          10551682       1980660.0   11\n18          14449641        577405.0   12\n...*/"
    },
    {
        "input": "select /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) as cnt\n          from store_sales\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/\n   join customer\n   on ss_customer_sk = c_customer_sk",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.961308,
                    "execution_time": 1.507387,
                    "compile_time": 0.000483,
                    "planning_time": 0.025553,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.046643,
                    "execution_time": 1.515633,
                    "compile_time": 0.000478,
                    "planning_time": 0.087249,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0           Lew     Benjamin          Dr.                     N          14082241    9\n1        Miller      Barbara          Dr.                     Y           4019868   13\n2          Hall     Cornelia         Mrs.                     N          17831140    9\n3        Garcia      Felicia         Mrs.                     Y          10022429   14\n4        Bailey          Iva         Mrs.                     N          13413663    9\n5          Cote       Joseph          Mr.                     Y           8087444   12\n6        Guzman       Andrew          Ms.                     N          10023542   10\n7        Dorsey     Rosemary          Ms.                     N          23523372    8\n8       Leonard     Caroline          Dr.                     Y          20136266   15\n9     Patterson         Lani         Miss                     N          23524386   13\n10       Mathis         John          Dr.                     N          23090935    9\n11       Carson       Edward          Mr.                     Y          19019407    9\n12         Ward       Gloria         Mrs.                     Y           7400543    9\n13     Schwartz        David          Sir                     Y          10770693   13\n14  Christensen        Cecil          Dr.                     Y          15646999    9\n15      Emerson        Shane          Sir                     N          11525705   12\n16  Brandenburg      Bernard          Dr.                     Y          23103398   10\n17      Baumann       George          Dr.                     N           7035519   13\n18       Knight        Julie         Mrs.                     N           4399224   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018564,
                    "execution_time": 0.008091,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003904
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054639,
                    "execution_time": 0.008369,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039805
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0           Lew     Benjamin          Dr.                     N          14082241    9\n1        Miller      Barbara          Dr.                     Y           4019868   13\n2          Hall     Cornelia         Mrs.                     N          17831140    9\n3        Garcia      Felicia         Mrs.                     Y          10022429   14\n4        Bailey          Iva         Mrs.                     N          13413663    9\n5          Cote       Joseph          Mr.                     Y           8087444   12\n6        Guzman       Andrew          Ms.                     N          10023542   10\n7        Dorsey     Rosemary          Ms.                     N          23523372    8\n8       Leonard     Caroline          Dr.                     Y          20136266   15\n9     Patterson         Lani         Miss                     N          23524386   13\n10       Mathis         John          Dr.                     N          23090935    9\n11       Carson       Edward          Mr.                     Y          19019407    9\n12         Ward       Gloria         Mrs.                     Y           7400543    9\n13     Schwartz        David          Sir                     Y          10770693   13\n14  Christensen        Cecil          Dr.                     Y          15646999    9\n15      Emerson        Shane          Sir                     N          11525705   12\n16  Brandenburg      Bernard          Dr.                     Y          23103398   10\n17      Baumann       George          Dr.                     N           7035519   13\n18       Knight        Julie         Mrs.                     N           4399224   15\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\"",
                "rewrite": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\"",
                "rewrite": "WITH T AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.233988,
                    "execution_time": 3.024039,
                    "compile_time": 0.000433,
                    "planning_time": 0.046075,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.355818,
                    "execution_time": 3.067563,
                    "compile_time": 0.000412,
                    "planning_time": 0.118425,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.887924,
                    "execution_time": 1.430968,
                    "compile_time": 0.000482,
                    "planning_time": 0.026253,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.019754,
                    "execution_time": 1.48637,
                    "compile_time": 0.000506,
                    "planning_time": 0.087379,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Harms       Alexis         Miss                     Y          16943368    9\n1     Bradshaw        James          Sir                     N          18629141    7\n2       Rivers        Kevin          Dr.                     Y          20865680    9\n3      Jackson         Olga         Mrs.                     N           1931437   14\n4     Schiller     Jennifer         Miss                     Y           8096533   10\n5    Patterson    Nathaniel          Mr.                     N          10938257    8\n6       Nowlin       Alfred          Dr.                     Y          11094210    9\n7          Fox       Vallie          Ms.                     Y           1937724   10\n8       Marcus        David          Dr.                     N          14877676   11\n9         Beck       Arlene         Miss                     Y          22201102   12\n10        Bass        Kevin          Dr.                     N          12598789   14\n11   Scroggins       Bryant          Mr.                     Y          12447020    8\n12      Ahrens        Karen         Miss                     Y          22372393   14\n13      Starks        Brian          Dr.                     N          23717514    6\n14       Jones      Vanessa         Miss                     Y           8713828    8\n15        Boyd       Sandra         Miss                     N          17851811   10\n16     Jimenez        Donna          Dr.                     N          10223991   15\n17    Mcmillan       Jordan          Mr.                     Y          18647400   11\n18        Jett       Andrew         Mrs.                     Y           2717998   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017942,
                    "execution_time": 0.007615,
                    "compile_time": 5e-05,
                    "planning_time": 0.004017
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054136,
                    "execution_time": 0.008466,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039235
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Harms       Alexis         Miss                     Y          16943368    9\n1     Bradshaw        James          Sir                     N          18629141    7\n2       Rivers        Kevin          Dr.                     Y          20865680    9\n3      Jackson         Olga         Mrs.                     N           1931437   14\n4     Schiller     Jennifer         Miss                     Y           8096533   10\n5    Patterson    Nathaniel          Mr.                     N          10938257    8\n6       Nowlin       Alfred          Dr.                     Y          11094210    9\n7          Fox       Vallie          Ms.                     Y           1937724   10\n8       Marcus        David          Dr.                     N          14877676   11\n9         Beck       Arlene         Miss                     Y          22201102   12\n10        Bass        Kevin          Dr.                     N          12598789   14\n11   Scroggins       Bryant          Mr.                     Y          12447020    8\n12      Ahrens        Karen         Miss                     Y          22372393   14\n13      Starks        Brian          Dr.                     N          23717514    6\n14       Jones      Vanessa         Miss                     Y           8713828    8\n15        Boyd       Sandra         Miss                     N          17851811   10\n16     Jimenez        Donna          Dr.                     N          10223991   15\n17    Mcmillan       Jordan          Mr.                     Y          18647400   11\n18        Jett       Andrew         Mrs.                     Y           2717998   12\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.907312,
                    "execution_time": 0.696575,
                    "compile_time": 0.000407,
                    "planning_time": 0.047942,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.998586,
                    "execution_time": 0.703557,
                    "compile_time": 0.000413,
                    "planning_time": 0.127087,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.96058,
                    "execution_time": 0.502194,
                    "compile_time": 0.000499,
                    "planning_time": 0.025974,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.038526,
                    "execution_time": 0.516818,
                    "compile_time": 0.000476,
                    "planning_time": 0.087664,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Perez        Frank          Sir                     Y           4063134   10\n1      Edwards       Mattie          Ms.                     N           5433252    7\n2      Buckley       Albert         Miss                     N           4517981   10\n3       Eckert        Verla         Mrs.                     N          15188923   11\n4                   Kaitlyn         Mrs.                                22678754   14\n5      Roberts          Amy          Ms.                     Y           9508680   13\n6      Fellows       Nicole          Ms.                     N          17093190   15\n7        Bowen        Roxie         Miss                     N           8939798    8\n8        Swann      Mildred         Mrs.                     Y          12262947    8\n9     Melendez      Suzanne         Miss                     N           6867948   10\n10        Moon  Christopher          Dr.                     N          20851954   10\n11      Miller         John          Sir                     Y          16178470    6\n12     Barnett        Essie          Ms.                     Y           6792622    8\n13       Olson         Nora          Ms.                     N          10366116   11\n14       Embry       Robert          Dr.                                 5728212   11\n15   Etheridge        Chris          Dr.                     N          13409327    9\n16        Hess      Leonard          Sir                     Y           5614842   11\n17        Hess      Leonard          Sir                     Y          19084133   14\n18        Dove      Kristel          Dr.                     N           2474863   15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018852,
                    "execution_time": 0.008431,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003998
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057021,
                    "execution_time": 0.008587,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039346
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Perez        Frank          Sir                     Y           4063134   10\n1      Edwards       Mattie          Ms.                     N           5433252    7\n2      Buckley       Albert         Miss                     N           4517981   10\n3       Eckert        Verla         Mrs.                     N          15188923   11\n4                   Kaitlyn         Mrs.                                22678754   14\n5      Roberts          Amy          Ms.                     Y           9508680   13\n6      Fellows       Nicole          Ms.                     N          17093190   15\n7        Bowen        Roxie         Miss                     N           8939798    8\n8        Swann      Mildred         Mrs.                     Y          12262947    8\n9     Melendez      Suzanne         Miss                     N           6867948   10\n10        Moon  Christopher          Dr.                     N          20851954   10\n11      Miller         John          Sir                     Y          16178470    6\n12     Barnett        Essie          Ms.                     Y           6792622    8\n13       Olson         Nora          Ms.                     N          10366116   11\n14       Embry       Robert          Dr.                                 5728212   11\n15   Etheridge        Chris          Dr.                     N          13409327    9\n16        Hess      Leonard          Sir                     Y           5614842   11\n17        Hess      Leonard          Sir                     Y          19084133   14\n18        Dove      Kristel          Dr.                     N           2474863   15\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n/*CURSOR_IDENTIFIER*/\n    household_demographics.hd_buy_potential = '1001-1500')\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.701044,
                    "execution_time": 0.488492,
                    "compile_time": 0.000409,
                    "planning_time": 0.049689,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.788605,
                    "execution_time": 0.484891,
                    "compile_time": 0.000428,
                    "planning_time": 0.124476,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0           15754508         55229.0    8\n1           12289066       1796233.0   12\n2            9759064       1341827.0    9\n3            7794363         83948.0    7\n4           11266674       1644054.0   12\n5           13805026       1371887.0    9\n6           19536856        851015.0   13\n7           14286946        331408.0   10\n8           14286946             NaN    1\n9           22541214        107596.0   13\n10           9793429        702592.0    9\n11          19547342       1797120.0   10\n12          14297868        156330.0   15\n13          12327321        258522.0    6\n14          12330764       1207723.0   11\n15          22550266        496805.0    8\n16          19552954       1258207.0   16\n17           8303731        967734.0   13\n18            805645       1716502.0    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016554,
                    "execution_time": 0.007341,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003307
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.193016,
                    "execution_time": 0.007633,
                    "compile_time": 0.137986,
                    "planning_time": 0.03856
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", COUNT(*) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON (\"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000') AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  ss_customer_sk  cnt\n0           15754508         55229.0    8\n1           12289066       1796233.0   12\n2            9759064       1341827.0    9\n3            7794363         83948.0    7\n4           11266674       1644054.0   12\n5           13805026       1371887.0    9\n6           19536856        851015.0   13\n7           14286946        331408.0   10\n8           14286946             NaN    1\n9           22541214        107596.0   13\n10           9793429        702592.0    9\n11          19547342       1797120.0   10\n12          14297868        156330.0   15\n13          12327321        258522.0    6\n14          12330764       1207723.0   11\n15          22550266        496805.0    8\n16          19552954       1258207.0   16\n17           8303731        967734.0   13\n18            805645       1716502.0    9\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.816862,
                    "execution_time": 0.606234,
                    "compile_time": 0.000419,
                    "planning_time": 0.048242,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.890962,
                    "execution_time": 0.600226,
                    "compile_time": 0.000418,
                    "planning_time": 0.123017,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.893984,
                    "execution_time": 0.440822,
                    "compile_time": 0.000468,
                    "planning_time": 0.026221,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.951818,
                    "execution_time": 0.434033,
                    "compile_time": 0.000474,
                    "planning_time": 0.086232,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Smith      Vanessa          Dr.                     Y          22106621   14\n1     Driscoll        Jimmy          Sir                     N          23017559   12\n2      Richard        James          Mr.                     N          19688577    8\n3          Lee       Alexis          Ms.                     Y            331635    7\n4        Wells         Lois         Miss                     N          13444615   10\n5       Osborn       Harold          Dr.                     Y          18446749   14\n6      Wheaton         Lena          Ms.                     Y          19921260    7\n7       Coffey       Joseph          Mr.                     Y          17809692   11\n8       Coffey       Joseph          Mr.                     Y          17214508   10\n9        Ahmed        David          Sir                     N           1461197   15\n10       Frank        Larry                                             18549337   10\n11                                                                       4795973   12\n12        Main        Katie          Ms.                     N           1306211   11\n13     Carlson        James          Mr.                     N          22468559   11\n14     Carlson        James          Mr.                     N          20308731    9\n15     Delgado        Brian          Dr.                     N          21723420   11\n16     Delgado        Brian          Dr.                     N            253741   12\n17      Damron       Robert          Dr.                     N           2883825    9\n18  Williamson       Arthur          Dr.                     N           4831851   11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018375,
                    "execution_time": 0.008112,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003944
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056132,
                    "execution_time": 0.007973,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039125
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Smith      Vanessa          Dr.                     Y          22106621   14\n1     Driscoll        Jimmy          Sir                     N          23017559   12\n2      Richard        James          Mr.                     N          19688577    8\n3          Lee       Alexis          Ms.                     Y            331635    7\n4        Wells         Lois         Miss                     N          13444615   10\n5       Osborn       Harold          Dr.                     Y          18446749   14\n6      Wheaton         Lena          Ms.                     Y          19921260    7\n7       Coffey       Joseph          Mr.                     Y          17809692   11\n8       Coffey       Joseph          Mr.                     Y          17214508   10\n9        Ahmed        David          Sir                     N           1461197   15\n10       Frank        Larry                                             18549337   10\n11                                                                       4795973   12\n12        Main        Katie          Ms.                     N           1306211   11\n13     Carlson        James          Mr.                     N          22468559   11\n14     Carlson        James          Mr.                     N          20308731    9\n15     Delgado        Brian          Dr.                     N          21723420   11\n16     Delgado        Brian          Dr.                     N            253741   12\n17      Damron       Robert          Dr.                     N           2883825    9\n18  Williamson       Arthur          Dr.                     N           4831851   11\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.764663,
                    "execution_time": 0.552303,
                    "compile_time": 0.000412,
                    "planning_time": 0.049425,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.873884,
                    "execution_time": 0.577457,
                    "compile_time": 0.000423,
                    "planning_time": 0.128798,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.767357,
                    "execution_time": 0.31302,
                    "compile_time": 0.000515,
                    "planning_time": 0.02576,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.271148,
                    "execution_time": 0.747299,
                    "compile_time": 0.000473,
                    "planning_time": 0.095492,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Collins    Elizabeth         Miss                     N           7549282    8\n1        Davis       Joseph          Sir                     Y           7854854    9\n2      Elliott        Betty         Mrs.                     Y           9586857   15\n3      Herring         Cora         Mrs.                     N            750612   10\n4         Rose       Carole         Miss                     N           5398349    5\n5    Rodriguez        Ciera          Dr.                     N           3998244    8\n6      Simpson        Emily          Dr.                     N           8122376   13\n7       Phipps        Doris         Mrs.                     Y           5206975    6\n8        Dietz      Leonard          Sir                     N           9036113    9\n9       Thomas  Christopher          Sir                     Y           8495759   10\n10   Jorgenson       Esther         Miss                     N          19216906   10\n11      Murphy      Yolanda          Ms.                     N          15398859   14\n12    Williams       Victor          Sir                     Y          16562594   13\n13    Mcmillan        Caryn          Dr.                     Y          19946252   13\n14      Rogers       Robert          Dr.                     N          21181688    9\n15  Hutchinson        James          Dr.                     Y          16392769   13\n16        Pace      Jeffrey          Dr.                     N          14750576    8\n17        Peck       Edward          Sir                     N          12599131   11\n18      Bryant         Reva         Miss                     Y           7315721    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019279,
                    "execution_time": 0.008456,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.0039
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056469,
                    "execution_time": 0.008226,
                    "compile_time": 5e-05,
                    "planning_time": 0.039357
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Collins    Elizabeth         Miss                     N           7549282    8\n1        Davis       Joseph          Sir                     Y           7854854    9\n2      Elliott        Betty         Mrs.                     Y           9586857   15\n3      Herring         Cora         Mrs.                     N            750612   10\n4         Rose       Carole         Miss                     N           5398349    5\n5    Rodriguez        Ciera          Dr.                     N           3998244    8\n6      Simpson        Emily          Dr.                     N           8122376   13\n7       Phipps        Doris         Mrs.                     Y           5206975    6\n8        Dietz      Leonard          Sir                     N           9036113    9\n9       Thomas  Christopher          Sir                     Y           8495759   10\n10   Jorgenson       Esther         Miss                     N          19216906   10\n11      Murphy      Yolanda          Ms.                     N          15398859   14\n12    Williams       Victor          Sir                     Y          16562594   13\n13    Mcmillan        Caryn          Dr.                     Y          19946252   13\n14      Rogers       Robert          Dr.                     N          21181688    9\n15  Hutchinson        James          Dr.                     Y          16392769   13\n16        Pace      Jeffrey          Dr.                     N          14750576    8\n17        Peck       Edward          Sir                     N          12599131   11\n18      Bryant         Reva         Miss                     Y           7315721    8\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt \nfrom\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    group by ss_ticket_number, ss_customer_sk\n   ) subquery\njoin customer\non subquery.ss_customer_sk = customer.c_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Mccants        Peter          Sir                     N          23143481    8\n1      Jackson       Alicia          Dr.                     N          18787155    9\n2        Jones         Gene          Sir                     Y          19799389    9\n3         Rohr        Bobby          Mr.                     N          12371407    8\n4       Clarke       Lionel          Sir                     N             76074   11\n5    Davenport      Timothy          Sir                     Y          12344866   13\n6       Guzman      Charles          Sir                     N          19361070    9\n7       Zimmer       Carole         Mrs.                     Y           8955300   10\n8      Brunson       Albert          Ms.                     N           4949988   14\n9       Farias          Lee          Mr.                     Y           7996696   11\n10        Shaw       Eunice         Miss                     N           5989266   13\n11      Albert         John          Sir                     Y           7591337   10\n12   Middleton        Linda         Miss                     Y          22308997   15\n13   Middleton        Linda         Miss                     Y           5953931   15\n14     Orourke         Toni         Mrs.                     N          15341943   11\n15     Schuler       Marian          Dr.                     N          11902881    8\n16       White     Virginia          Dr.                     Y          11382916    9\n17      Ingram      Tiffany          Dr.                     N          23182047   10\n18         Kim       Virgil          Mr.                     Y           5954811   13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017732,
                    "execution_time": 0.007628,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003881
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052779,
                    "execution_time": 0.007915,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.038581
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Mccants        Peter          Sir                     N          23143481    8\n1      Jackson       Alicia          Dr.                     N          18787155    9\n2        Jones         Gene          Sir                     Y          19799389    9\n3         Rohr        Bobby          Mr.                     N          12371407    8\n4       Clarke       Lionel          Sir                     N             76074   11\n5    Davenport      Timothy          Sir                     Y          12344866   13\n6       Guzman      Charles          Sir                     N          19361070    9\n7       Zimmer       Carole         Mrs.                     Y           8955300   10\n8      Brunson       Albert          Ms.                     N           4949988   14\n9       Farias          Lee          Mr.                     Y           7996696   11\n10        Shaw       Eunice         Miss                     N           5989266   13\n11      Albert         John          Sir                     Y           7591337   10\n12   Middleton        Linda         Miss                     Y          22308997   15\n13   Middleton        Linda         Miss                     Y           5953931   15\n14     Orourke         Toni         Mrs.                     N          15341943   11\n15     Schuler       Marian          Dr.                     N          11902881    8\n16       White     Virginia          Dr.                     Y          11382916    9\n17      Ingram      Tiffany          Dr.                     N          23182047   10\n18         Kim       Virgil          Mr.                     Y           5954811   13\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.634024,
                    "execution_time": 0.428057,
                    "compile_time": 0.000436,
                    "planning_time": 0.0508,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.922882,
                    "execution_time": 0.519215,
                    "compile_time": 0.118253,
                    "planning_time": 0.126276,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.571873,
                    "execution_time": 0.128451,
                    "compile_time": 0.043222,
                    "planning_time": 0.026033,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.17281,
                    "execution_time": 0.378748,
                    "compile_time": 3.32306,
                    "planning_time": 0.087406,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Marble        Mario          Dr.                     N           1033771   11\n1         Rice     Germaine          Dr.                     N          14708148   13\n2     Mcintosh        Frank          Sir                     Y          13543717   11\n3     Harrison      Lucille          Ms.                     Y          14014951   12\n4      Ramirez         Rene          Sir                     N           9564090    9\n5         King       Robert          Sir                     Y          12272671   11\n6         King       Robert          Sir                     Y           1318469    7\n7     Clemmons       Tyrone          Mr.                     Y          13407276   13\n8       Martin          Jon          Dr.                     N           3666840   11\n9       Joseph        Lloyd          Mr.                     N          15367821   15\n10     Canales        Cathi         Mrs.                     Y          18802211   13\n11        Cook       Andrea          Dr.                     N          22008070   14\n12  Whitehurst        Peter          Sir                     Y          10910648   13\n13                                   Sir                     N           3152294   14\n14      Murphy       Rodney          Sir                     N          14527309    8\n15       Olson      Michael          Dr.                     N           8244414   13\n16       Davis     Clarence          Sir                     Y          10962332   11\n17     Barrera         John          Dr.                     Y          21460216   13\n18        Rose    Katherine         Mrs.                     Y          12474274   10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017813,
                    "execution_time": 0.007495,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004017
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056162,
                    "execution_time": 0.007887,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039302
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Marble        Mario          Dr.                     N           1033771   11\n1         Rice     Germaine          Dr.                     N          14708148   13\n2     Mcintosh        Frank          Sir                     Y          13543717   11\n3     Harrison      Lucille          Ms.                     Y          14014951   12\n4      Ramirez         Rene          Sir                     N           9564090    9\n5         King       Robert          Sir                     Y          12272671   11\n6         King       Robert          Sir                     Y           1318469    7\n7     Clemmons       Tyrone          Mr.                     Y          13407276   13\n8       Martin          Jon          Dr.                     N           3666840   11\n9       Joseph        Lloyd          Mr.                     N          15367821   15\n10     Canales        Cathi         Mrs.                     Y          18802211   13\n11        Cook       Andrea          Dr.                     N          22008070   14\n12  Whitehurst        Peter          Sir                     Y          10910648   13\n13                                   Sir                     N           3152294   14\n14      Murphy       Rodney          Sir                     N          14527309    8\n15       Olson      Michael          Dr.                     N           8244414   13\n16       Davis     Clarence          Sir                     Y          10962332   11\n17     Barrera         John          Dr.                     Y          21460216   13\n18        Rose    Katherine         Mrs.                     Y          12474274   10\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.510006,
                    "execution_time": 0.28226,
                    "compile_time": 0.076988,
                    "planning_time": 0.051236,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.995308,
                    "execution_time": 5.233891,
                    "compile_time": 3.523705,
                    "planning_time": 0.132594,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.383396,
                    "execution_time": 0.112712,
                    "compile_time": 0.03114,
                    "planning_time": 0.026509,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.838437,
                    "execution_time": 0.244993,
                    "compile_time": 3.283134,
                    "planning_time": 0.091179,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Marble        Mario          Dr.                     N           1033771   11\n1     Harrison      Lucille          Ms.                     Y          14014951   12\n2      Ramirez         Rene          Sir                     N           9564090    9\n3         King       Robert          Sir                     Y           1318469    7\n4     Clemmons       Tyrone          Mr.                     Y          13407276   13\n5       Martin          Jon          Dr.                     N           3666840   11\n6                                    Sir                     N           3152294   14\n7        Davis     Clarence          Sir                     Y          10962332   11\n8       Minton         Lisa         Miss                     Y          14672568   11\n9        Smith       Ashley          Ms.                     N           3600580    7\n10    Carrillo         John          Dr.                     N           8592185   15\n11       Meade        Brian          Sir                     N          14603900    7\n12      Walker      Georgia          Ms.                     N           1410600   13\n13      Potter          Kay         Mrs.                     N          22010117    8\n14     Houston       Maxine          Ms.                     N          15416619   14\n15     Carrion      Douglas          Sir                     N          13726225   14\n16      Watson      Jeffrey          Mr.                     Y          14729568   13\n17        Hall    Christina         Mrs.                     N           9465526    8\n18       Hazel      Kenneth          Mr.                     N           4241969    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017809,
                    "execution_time": 0.007544,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003907
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054931,
                    "execution_time": 0.00774,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.039158
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Marble        Mario          Dr.                     N           1033771   11\n1     Harrison      Lucille          Ms.                     Y          14014951   12\n2      Ramirez         Rene          Sir                     N           9564090    9\n3         King       Robert          Sir                     Y           1318469    7\n4     Clemmons       Tyrone          Mr.                     Y          13407276   13\n5       Martin          Jon          Dr.                     N           3666840   11\n6                                    Sir                     N           3152294   14\n7        Davis     Clarence          Sir                     Y          10962332   11\n8       Minton         Lisa         Miss                     Y          14672568   11\n9        Smith       Ashley          Ms.                     N           3600580    7\n10    Carrillo         John          Dr.                     N           8592185   15\n11       Meade        Brian          Sir                     N          14603900    7\n12      Walker      Georgia          Ms.                     N           1410600   13\n13      Potter          Kay         Mrs.                     N          22010117    8\n14     Houston       Maxine          Ms.                     N          15416619   14\n15     Carrion      Douglas          Sir                     N          13726225   14\n16      Watson      Jeffrey          Mr.                     Y          14729568   13\n17        Hall    Christina         Mrs.                     N           9465526    8\n18       Hazel      Kenneth          Mr.                     N           4241969    8\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n    ) as t\n    join customer on t.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"T\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"T\".\"CNT\" AS \"CNT\" FROM \"T\" AS \"T\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"T\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.402244,
                    "execution_time": 0.249761,
                    "compile_time": 0.060859,
                    "planning_time": 0.052663,
                    "create_size": 96
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.953885,
                    "execution_time": 5.461968,
                    "compile_time": 3.315447,
                    "planning_time": 0.130225,
                    "create_size": 96
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.145694,
                    "execution_time": 0.075225,
                    "compile_time": 0.000348,
                    "planning_time": 0.025787,
                    "create_size": 144
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.256136,
                    "execution_time": 0.080491,
                    "compile_time": 0.041322,
                    "planning_time": 0.086705,
                    "create_size": 144
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Burnham        Scott          Sir                     N             70070   13\n1         Wynn          Leo          Dr.                     N           8976769    9\n2        Stone      Juanita         Mrs.                     N          23263365   13\n3        Smith       Dennis          Sir                     Y          16756028   13\n4      Michaud        Norma         Miss                     Y           3754374   11\n5       Palmer        Kevin          Dr.                     Y          21371465   10\n6      Mcclure         Kurt          Mr.                     Y           7855072    9\n7      Johnson       Arnold          Dr.                     Y          23829831   11\n8        Woods      Antonio          Dr.                     Y          18903245    9\n9         King       Gerard          Sir                     N          13428670   13\n10      Graves        Tracy          Sir                     N          22574508   11\n11     Carrier      Michell         Miss                     N          21130197    9\n12        Hunt       Bryant          Mr.                     N          21469230   10\n13      Bender     Charlene          Ms.                     N           9497041   10\n14    Cosgrove       Steven          Mr.                     Y          11647374   15\n15       Adams  Christopher          Mr.                     N           4543823   12\n16       Wells     Kimberly                                  N           4042512   14\n17     Brannon      Orville          Dr.                     N          16152301    8\n18    Clements      William          Sir                     Y          13493612   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017496,
                    "execution_time": 0.007298,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004057
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054762,
                    "execution_time": 0.007521,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039218
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Burnham        Scott          Sir                     N             70070   13\n1         Wynn          Leo          Dr.                     N           8976769    9\n2        Stone      Juanita         Mrs.                     N          23263365   13\n3        Smith       Dennis          Sir                     Y          16756028   13\n4      Michaud        Norma         Miss                     Y           3754374   11\n5       Palmer        Kevin          Dr.                     Y          21371465   10\n6      Mcclure         Kurt          Mr.                     Y           7855072    9\n7      Johnson       Arnold          Dr.                     Y          23829831   11\n8        Woods      Antonio          Dr.                     Y          18903245    9\n9         King       Gerard          Sir                     N          13428670   13\n10      Graves        Tracy          Sir                     N          22574508   11\n11     Carrier      Michell         Miss                     N          21130197    9\n12        Hunt       Bryant          Mr.                     N          21469230   10\n13      Bender     Charlene          Ms.                     N           9497041   10\n14    Cosgrove       Steven          Mr.                     Y          11647374   15\n15       Adams  Christopher          Mr.                     N           4543823   12\n16       Wells     Kimberly                                  N           4042512   14\n17     Brannon      Orville          Dr.                     N          16152301    8\n18    Clements      William          Sir                     Y          13493612   12\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.069814,
                    "execution_time": 0.038364,
                    "compile_time": 0.000248,
                    "planning_time": 0.003128,
                    "create_size": 100
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.141899,
                    "execution_time": 0.048661,
                    "compile_time": 0.000248,
                    "planning_time": 0.059659,
                    "create_size": 80
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Johnson        Holly          Ms.                     N          15933611    9\n1      Johnson        Holly          Ms.                     N            384206    9\n2      Johnson        Holly          Ms.                     N          13015313   15\n3      Johnson        Holly          Ms.                     N            441296   11\n4      Johnson        Holly          Ms.                     N          17678350   11\n5      Johnson        Holly          Ms.                     N          21035462   14\n6      Johnson        Holly          Ms.                     N           2756100   14\n7      Johnson        Holly          Ms.                     N          14777074   14\n8      Johnson        Holly          Ms.                     N           9530124    7\n9      Johnson        Holly          Ms.                     N          12559410   12\n10     Johnson        Holly          Ms.                     N           4352712    9\n11     Johnson        Holly          Ms.                     N          15697213   12\n12     Johnson        Holly          Ms.                     N           8709823   13\n13     Johnson        Holly          Ms.                     N           8709823    1\n14     Johnson        Holly          Ms.                     N          20130090   13\n15     Johnson        Holly          Ms.                     N          18499792   14\n16     Johnson        Holly          Ms.                     N          21559363   10\n17     Johnson        Holly          Ms.                     N          15746524    9\n18     Johnson        Holly          Ms.                     N          20467852   13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.044771,
                    "execution_time": 0.013091,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.024304
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.580384,
                    "execution_time": 0.024654,
                    "compile_time": 3.482604,
                    "planning_time": 0.080362
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Johnson        Holly          Ms.                     N          15933611    9\n1      Johnson        Holly          Ms.                     N            384206    9\n2      Johnson        Holly          Ms.                     N          13015313   15\n3      Johnson        Holly          Ms.                     N            441296   11\n4      Johnson        Holly          Ms.                     N          17678350   11\n5      Johnson        Holly          Ms.                     N          21035462   14\n6      Johnson        Holly          Ms.                     N           2756100   14\n7      Johnson        Holly          Ms.                     N          14777074   14\n8      Johnson        Holly          Ms.                     N           9530124    7\n9      Johnson        Holly          Ms.                     N          12559410   12\n10     Johnson        Holly          Ms.                     N           4352712    9\n11     Johnson        Holly          Ms.                     N          15697213   12\n12     Johnson        Holly          Ms.                     N           8709823   13\n13     Johnson        Holly          Ms.                     N           8709823    1\n14     Johnson        Holly          Ms.                     N          20130090   13\n15     Johnson        Holly          Ms.                     N          18499792   14\n16     Johnson        Holly          Ms.                     N          21559363   10\n17     Johnson        Holly          Ms.                     N          15746524    9\n18     Johnson        Holly          Ms.                     N          20467852   13\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Delossantos         Levi          Dr.                     N          10763595   10\n1         Hicks    Charlotte          Dr.                     Y          16035742   14\n2                      Frank                                              4018803   12\n3      Martinez      Michael          Dr.                     Y          10776946    5\n4         Mills         Mark          Mr.                     N          17247937    9\n5      Lavender         Alma          Ms.                     N          15487061   14\n6       Jackson         John          Sir                     N          19551526   10\n7       Antoine      Michele         Mrs.                     N          23294222   13\n8        Walter      Darlene         Mrs.                     N          22881205   12\n9        Beeler       Sandra          Ms.                     Y          17373444    7\n10        Usher       Johnny          Mr.                     N          15050069    7\n11      Crowder        James          Sir                     Y           2318750    8\n12        Bland        Diane          Dr.                     N            793878   10\n13        Glynn        Laura          Ms.                     Y          11329381   10\n14       Hudson      Michael          Sir                     Y           4605979   13\n15     Williams       Dennis          Sir                     Y          11905536    6\n16      Swanson      Charles          Mr.                     Y          22014485   10\n17      Stuckey        Helen          Ms.                     Y          21226217    8\n18       Obrien       Andrew         Miss                     N           1388212    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017028,
                    "execution_time": 0.007282,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003803
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051736,
                    "execution_time": 0.007182,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038596
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0   Delossantos         Levi          Dr.                     N          10763595   10\n1         Hicks    Charlotte          Dr.                     Y          16035742   14\n2                      Frank                                              4018803   12\n3      Martinez      Michael          Dr.                     Y          10776946    5\n4         Mills         Mark          Mr.                     N          17247937    9\n5      Lavender         Alma          Ms.                     N          15487061   14\n6       Jackson         John          Sir                     N          19551526   10\n7       Antoine      Michele         Mrs.                     N          23294222   13\n8        Walter      Darlene         Mrs.                     N          22881205   12\n9        Beeler       Sandra          Ms.                     Y          17373444    7\n10        Usher       Johnny          Mr.                     N          15050069    7\n11      Crowder        James          Sir                     Y           2318750    8\n12        Bland        Diane          Dr.                     N            793878   10\n13        Glynn        Laura          Ms.                     Y          11329381   10\n14       Hudson      Michael          Sir                     Y           4605979   13\n15     Williams       Dennis          Sir                     Y          11905536    6\n16      Swanson      Charles          Mr.                     Y          22014485   10\n17      Stuckey        Helen          Ms.                     Y          21226217    8\n18       Obrien       Andrew         Miss                     N           1388212    8\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\" WHERE \"DJ\".\"CNT\" <= 5 AND \"DJ\".\"CNT\" >= 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.067199,
                    "execution_time": 0.03638,
                    "compile_time": 0.000258,
                    "planning_time": 0.004867,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.267697,
                    "execution_time": 0.047787,
                    "compile_time": 0.130371,
                    "planning_time": 0.060502,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0          Pak       Judith          Dr.                     N          12791590    5\n1        Wells        Sheri          Dr.                     N          17729579    5\n2      Shelton       Ashley         Miss                     N          20290585    4\n3     Chandler        Linda          Ms.                     Y          16048233    5\n4     Williams     Michelle          Ms.                     N          10700451    5\n5         Hand      Rosalyn          Ms.                     N          12534655    5\n6        Oneal       Emmett          Sir                     N          12881988    5\n7      Michael      Dorothy          Dr.                     N            400314    5\n8       Wright                      Miss                                17152919    5\n9        Davis      William          Mr.                     N           6499453    5\n10        Khan     Marshall          Dr.                     Y          21211528    5\n11      Pruitt       Gladys         Miss                     Y           4721717    5\n12        Tran       Dessie         Mrs.                     N           6957206    5\n13    Anderson        David          Mr.                     Y           8281731    5\n14      Warner      Barbara          Dr.                     Y          18069201    4\n15       Vance       Sophia         Mrs.                     N          18690668    4\n16    Thurston        Harry          Dr.                     Y           6747823    5\n17      Marino      Cristen          Dr.                     N           4326868    5\n18    Harrison         John          Dr.                     Y          20518382    5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017435,
                    "execution_time": 0.007254,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.00387
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054626,
                    "execution_time": 0.007381,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.03918
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" >= 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0          Pak       Judith          Dr.                     N          12791590    5\n1        Wells        Sheri          Dr.                     N          17729579    5\n2      Shelton       Ashley         Miss                     N          20290585    4\n3     Chandler        Linda          Ms.                     Y          16048233    5\n4     Williams     Michelle          Ms.                     N          10700451    5\n5         Hand      Rosalyn          Ms.                     N          12534655    5\n6        Oneal       Emmett          Sir                     N          12881988    5\n7      Michael      Dorothy          Dr.                     N            400314    5\n8       Wright                      Miss                                17152919    5\n9        Davis      William          Mr.                     N           6499453    5\n10        Khan     Marshall          Dr.                     Y          21211528    5\n11      Pruitt       Gladys         Miss                     Y           4721717    5\n12        Tran       Dessie         Mrs.                     N           6957206    5\n13    Anderson        David          Mr.                     Y           8281731    5\n14      Warner      Barbara          Dr.                     Y          18069201    4\n15       Vance       Sophia         Mrs.                     N          18690668    4\n16    Thurston        Harry          Dr.                     Y           6747823    5\n17      Marino      Cristen          Dr.                     N           4326868    5\n18    Harrison         John          Dr.                     Y          20518382    5\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\" WHERE \"DJ\".\"CNT\" <= 5 AND \"DJ\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC , \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Anderson        David          Mr.                     Y           8281731    5\n1        Baron          Sue         Mrs.                     Y          13359936    5\n2       Borges         Cole          Dr.                     N          12750582    5\n3     Chandler        Linda          Ms.                     Y          16048233    5\n4         Cook       Bessie          Ms.                     N          17816331    5\n5     Crutcher      Anthony         Miss                     N           2956217    5\n6        Davis      William          Mr.                     N           6499453    5\n7    Gutierrez       Stella         Miss                     N           8192997    5\n8         Hand      Rosalyn          Ms.                     N          12534655    5\n9     Harrison         John          Dr.                     Y          20518382    5\n10        Hart      Matthew          Sir                     N           8540096    5\n11       Henry       Donald          Dr.                     Y          14676184    5\n12     Jenkins        Jason          Sir                     Y          22353085    5\n13        Khan     Marshall          Dr.                     Y          21211528    5\n14        Lara      Charles          Sir                     N          23589854    5\n15      Marino      Cristen          Dr.                     N           4326868    5\n16    Martinez      Michael          Dr.                     Y          10776946    5\n17   Mcfarlane      Timothy          Dr.                     N          14213315    5\n18     Michael      Dorothy          Dr.                     N            400314    5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035632,
                    "execution_time": 0.009252,
                    "compile_time": 0.01448,
                    "planning_time": 0.005301
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.148907,
                    "execution_time": 0.009649,
                    "compile_time": 5.094534,
                    "planning_time": 0.040381
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Anderson        David          Mr.                     Y           8281731    5\n1        Baron          Sue         Mrs.                     Y          13359936    5\n2       Borges         Cole          Dr.                     N          12750582    5\n3     Chandler        Linda          Ms.                     Y          16048233    5\n4         Cook       Bessie          Ms.                     N          17816331    5\n5     Crutcher      Anthony         Miss                     N           2956217    5\n6        Davis      William          Mr.                     N           6499453    5\n7    Gutierrez       Stella         Miss                     N           8192997    5\n8         Hand      Rosalyn          Ms.                     N          12534655    5\n9     Harrison         John          Dr.                     Y          20518382    5\n10        Hart      Matthew          Sir                     N           8540096    5\n11       Henry       Donald          Dr.                     Y          14676184    5\n12     Jenkins        Jason          Sir                     Y          22353085    5\n13        Khan     Marshall          Dr.                     Y          21211528    5\n14        Lara      Charles          Sir                     N          23589854    5\n15      Marino      Cristen          Dr.                     N           4326868    5\n16    Martinez      Michael          Dr.                     Y          10776946    5\n17   Mcfarlane      Timothy          Dr.                     N          14213315    5\n18     Michael      Dorothy          Dr.                     N            400314    5\n...*/"
    },
    {
        "input": "-- start template query73.tpl query 79 in stream 0\nselect /* TPC-DS query73.tpl 0.79 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Richland County','Wadena County','Terrell County','Huron County')\n    group by ss_ticket_number,ss_customer_sk) dj,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DJ\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOM\" <= 2 AND \"DATE_DIM\".\"D_DOM\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 , 2000 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Richland County' , 'Wadena County' , 'Terrell County' , 'Huron County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DJ\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DJ\".\"CNT\" AS \"CNT\" FROM \"DJ\" AS \"DJ\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DJ\".\"SS_CUSTOMER_SK\" WHERE \"DJ\".\"CNT\" <= 5 AND \"DJ\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC , \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Anderson        David          Mr.                     Y           8281731    5\n1        Baron          Sue         Mrs.                     Y          13359936    5\n2       Borges         Cole          Dr.                     N          12750582    5\n3     Chandler        Linda          Ms.                     Y          16048233    5\n4         Cook       Bessie          Ms.                     N          17816331    5\n5     Crutcher      Anthony         Miss                     N           2956217    5\n6        Davis      William          Mr.                     N           6499453    5\n7    Gutierrez       Stella         Miss                     N           8192997    5\n8         Hand      Rosalyn          Ms.                     N          12534655    5\n9     Harrison         John          Dr.                     Y          20518382    5\n10        Hart      Matthew          Sir                     N           8540096    5\n11       Henry       Donald          Dr.                     Y          14676184    5\n12     Jenkins        Jason          Sir                     Y          22353085    5\n13        Khan     Marshall          Dr.                     Y          21211528    5\n14        Lara      Charles          Sir                     N          23589854    5\n15      Marino      Cristen          Dr.                     N           4326868    5\n16    Martinez      Michael          Dr.                     Y          10776946    5\n17   Mcfarlane      Timothy          Dr.                     N          14213315    5\n18     Michael      Dorothy          Dr.                     N            400314    5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020577,
                    "execution_time": 0.008642,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.005225
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021795,
                    "execution_time": 0.009625,
                    "compile_time": 8e-05,
                    "planning_time": 0.005322
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" WHERE \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" <= 5 AND \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" >= 1 ORDER BY \"CNT\" DESC NULLS FIRST , \"C_LAST_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0     Anderson        David          Mr.                     Y           8281731    5\n1        Baron          Sue         Mrs.                     Y          13359936    5\n2       Borges         Cole          Dr.                     N          12750582    5\n3     Chandler        Linda          Ms.                     Y          16048233    5\n4         Cook       Bessie          Ms.                     N          17816331    5\n5     Crutcher      Anthony         Miss                     N           2956217    5\n6        Davis      William          Mr.                     N           6499453    5\n7    Gutierrez       Stella         Miss                     N           8192997    5\n8         Hand      Rosalyn          Ms.                     N          12534655    5\n9     Harrison         John          Dr.                     Y          20518382    5\n10        Hart      Matthew          Sir                     N           8540096    5\n11       Henry       Donald          Dr.                     Y          14676184    5\n12     Jenkins        Jason          Sir                     Y          22353085    5\n13        Khan     Marshall          Dr.                     Y          21211528    5\n14        Lara      Charles          Sir                     N          23589854    5\n15      Marino      Cristen          Dr.                     N           4326868    5\n16    Martinez      Michael          Dr.                     Y          10776946    5\n17   Mcfarlane      Timothy          Dr.                     N          14213315    5\n18     Michael      Dorothy          Dr.                     N            400314    5\n...*/"
    }
]