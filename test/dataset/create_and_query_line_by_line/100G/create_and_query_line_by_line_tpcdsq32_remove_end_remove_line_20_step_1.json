[
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ncs_sold_date_sk = d_date_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.789154,
                    "execution_time": 4.718987,
                    "compile_time": 0.000428,
                    "planning_time": 0.039921,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.426453,
                    "execution_time": 4.753203,
                    "compile_time": 5.522399,
                    "planning_time": 0.118033,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            4.039427e+13*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015558,
                    "execution_time": 0.00706,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002988
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051201,
                    "execution_time": 0.007555,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.037964
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   excess discount amount\n0            4.039427e+13*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and '1999-03-22' \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1999-03-22' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1999-03-22' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117719,
                    "execution_time": 0.038696,
                    "compile_time": 0.030078,
                    "planning_time": 0.025452,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.236837,
                    "execution_time": 0.039688,
                    "compile_time": 3.081758,
                    "planning_time": 0.087624,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    excess discount amount\n0             4.039427e+13\n1             4.039427e+13\n2             4.039427e+13\n3             4.039427e+13\n4             4.039427e+13\n5             4.039427e+13\n6             4.039427e+13\n7             4.039427e+13\n8             4.039427e+13\n9             4.039427e+13\n10            4.039427e+13\n11            4.039427e+13\n12            4.039427e+13\n13            4.039427e+13\n14            4.039427e+13\n15            4.039427e+13\n16            4.039427e+13\n17            4.039427e+13\n18            4.039427e+13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016349,
                    "execution_time": 0.007771,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.00286
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052924,
                    "execution_time": 0.007743,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.037668
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('1999-03-22' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    excess discount amount\n0             4.039427e+13\n1             4.039427e+13\n2             4.039427e+13\n3             4.039427e+13\n4             4.039427e+13\n5             4.039427e+13\n6             4.039427e+13\n7             4.039427e+13\n8             4.039427e+13\n9             4.039427e+13\n10            4.039427e+13\n11            4.039427e+13\n12            4.039427e+13\n13            4.039427e+13\n14            4.039427e+13\n15            4.039427e+13\n16            4.039427e+13\n17            4.039427e+13\n18            4.039427e+13\n...*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            5.032072e+10*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.163465,
                    "execution_time": 0.108916,
                    "compile_time": 0.000202,
                    "planning_time": 0.043445
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.225626,
                    "execution_time": 0.109212,
                    "compile_time": 0.000207,
                    "planning_time": 0.103509
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            5.032072e+10*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              15607846.5*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.112974,
                    "execution_time": 0.02252,
                    "compile_time": 0.042013,
                    "planning_time": 0.038645
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.36768,
                    "execution_time": 0.033199,
                    "compile_time": 6.21669,
                    "planning_time": 0.104517
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              15607846.5*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt IS NOT NULL \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 WHERE NOT \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND NOT CS_EXT_DISCOUNT_AMT IS NULL LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              15607846.5*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.520199,
                    "execution_time": 0.45553,
                    "compile_time": 0.014849,
                    "planning_time": 0.038309
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.86506,
                    "execution_time": 0.457779,
                    "compile_time": 3.288717,
                    "planning_time": 0.103437
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 WHERE NOT \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              15607846.5*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \nwhere\ncs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n         where \n            cs_sold_date_sk between (select min(cs_sold_date_sk) from catalog_sales) and \n            dateadd(day,90,cast('1999-02-22' as date))\n        )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT MIN ( \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"_U_1\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" <= \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" WHERE \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES WHERE CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES WHERE CS_SOLD_DATE_SK BETWEEN ( SELECT MIN ( CS_SOLD_DATE_SK ) FROM CATALOG_SALES ) AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*  excess discount amount\n0                   None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 7.099234,
                    "execution_time": 7.050052,
                    "compile_time": 0.000287,
                    "planning_time": 0.0349
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.731295,
                    "execution_time": 7.062778,
                    "compile_time": 3.546216,
                    "planning_time": 0.097704
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*  excess discount amount\n0                   None*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n         d_date_sk = cs_sold_date_sk\n         )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.35406,
                    "execution_time": 0.293878,
                    "compile_time": 0.000334,
                    "planning_time": 0.032888,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.727092,
                    "execution_time": 0.295677,
                    "compile_time": 3.298226,
                    "planning_time": 0.10109,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             11051117.48*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.62565,
                    "execution_time": 0.481974,
                    "compile_time": 0.078403,
                    "planning_time": 0.047834
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 9.443626,
                    "execution_time": 2.690624,
                    "compile_time": 6.615689,
                    "planning_time": 0.114079
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0             11051117.48*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,date_dim\nwhere\nd_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_sold_date_sk = d_date_sk \n/*CURSOR_IDENTIFIER*/ \n           )",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.171227,
                    "execution_time": 1.940839,
                    "compile_time": 0.000253,
                    "planning_time": 0.025725,
                    "create_size": 2432
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.219866,
                    "execution_time": 1.929217,
                    "compile_time": 0.000236,
                    "planning_time": 0.086034,
                    "create_size": 2432
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.328302,
                    "execution_time": 0.273135,
                    "compile_time": 0.000356,
                    "planning_time": 0.026229,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.750848,
                    "execution_time": 0.27429,
                    "compile_time": 3.339865,
                    "planning_time": 0.092036,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , DATE_DIM WHERE D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            7.293886e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.557692,
                    "execution_time": 0.482851,
                    "compile_time": 0.017875,
                    "planning_time": 0.041583
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.881339,
                    "execution_time": 0.485654,
                    "compile_time": 3.271937,
                    "planning_time": 0.104518
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            7.293886e+09*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n              dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n     )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.884336,
                    "execution_time": 2.500193,
                    "compile_time": 0.106744,
                    "planning_time": 0.023569,
                    "create_size": 3072
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.900707,
                    "execution_time": 7.086421,
                    "compile_time": 3.449303,
                    "planning_time": 0.086032,
                    "create_size": 3072
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             10953949.83*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.284913,
                    "execution_time": 0.053366,
                    "compile_time": 0.14256,
                    "planning_time": 0.068268
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.619351,
                    "execution_time": 0.542099,
                    "compile_time": 9.912499,
                    "planning_time": 0.1356
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0             10953949.83*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             11053040.96*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.36507,
                    "execution_time": 0.14132,
                    "compile_time": 0.136939,
                    "planning_time": 0.06612
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.200314,
                    "execution_time": 3.493363,
                    "compile_time": 6.536612,
                    "planning_time": 0.139068
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0             11053040.96*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n/*CURSOR_IDENTIFIER*/\n     )",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             10953949.83*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.13976,
                    "execution_time": 0.051665,
                    "compile_time": 0.000464,
                    "planning_time": 0.066249
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.142969,
                    "execution_time": 0.053135,
                    "compile_time": 0.000471,
                    "planning_time": 0.06575
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0             10953949.83*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n      ) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             10953949.83*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.140178,
                    "execution_time": 0.04973,
                    "compile_time": 0.000476,
                    "planning_time": 0.067619
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.139238,
                    "execution_time": 0.048756,
                    "compile_time": 0.000462,
                    "planning_time": 0.068271
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0             10953949.83*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n      ) \nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0             10953949.83*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.139076,
                    "execution_time": 0.051904,
                    "compile_time": 0.000446,
                    "planning_time": 0.065501
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.140182,
                    "execution_time": 0.051276,
                    "compile_time": 0.000454,
                    "planning_time": 0.066734
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0             10953949.83*/"
    }
]