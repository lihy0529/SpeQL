[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*SS_SALES_PRICE\n                                                            else (ss_quantity*SS_SALES_PRICE) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n            ) /*CURSOR_IDENTIFIER*/\n      ) as sales\n      group by ss_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LIMIT 21",
                "preview": "\n/*    ss_item_sk  ss_ticket_number  ss_customer_sk  act_sales\n0       148525           6007643         1094113    2725.78\n1       148525           6007643         1094113    3447.31\n2       148525           6007643         1094113    -721.53\n3       148525           6007643         1094113    3046.46\n4       148525           6007643         1094113   -1042.21\n5       148525           6007643         1094113     481.02\n6       148525           6007643         1094113    3687.82\n7       148525           6007643         1094113    3607.65\n8       148525           6007643         1094113    2084.42\n9       148525           6007643         1094113    2966.29\n10      148525           6007643         1094113    3447.31\n11      148525           6007643         1094113     721.53\n12      148525           6007643         1094113    1443.06\n13      148525           6007643         1094113    2244.76\n14      148525           6007643         1094113     320.68\n15      148525           6007643         1094113     -80.17\n16      148525           6007643         1094113    3767.99\n17      148525           6007643         1094113    3607.65\n18      148525           6007643         1094113     481.02\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.861525,
                    "execution_time": 2.81586,
                    "compile_time": 0.000142,
                    "planning_time": 0.034915
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.21971,
                    "execution_time": 2.900734,
                    "compile_time": 3.209137,
                    "planning_time": 0.093271
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\", \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\""
            }
        ],
        "preview": "\n/*    ss_item_sk  ss_ticket_number  ss_customer_sk  act_sales\n0       148525           6007643         1094113    2725.78\n1       148525           6007643         1094113    3447.31\n2       148525           6007643         1094113    -721.53\n3       148525           6007643         1094113    3046.46\n4       148525           6007643         1094113   -1042.21\n5       148525           6007643         1094113     481.02\n6       148525           6007643         1094113    3687.82\n7       148525           6007643         1094113    3607.65\n8       148525           6007643         1094113    2084.42\n9       148525           6007643         1094113    2966.29\n10      148525           6007643         1094113    3447.31\n11      148525           6007643         1094113     721.53\n12      148525           6007643         1094113    1443.06\n13      148525           6007643         1094113    2244.76\n14      148525           6007643         1094113     320.68\n15      148525           6007643         1094113     -80.17\n16      148525           6007643         1094113    3767.99\n17      148525           6007643         1094113    3607.65\n18      148525           6007643         1094113     481.02\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*SS_SALES_PRICE\n                                                            else (ss_quantity*SS_SALES_PRICE) end act_sales\n            from store_sales left outer join store_returns on (SR_ITEM_SK = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n           ) derived_table1\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.53079,
                    "execution_time": 4.259094,
                    "compile_time": 0.000373,
                    "planning_time": 0.034041,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.4596,
                    "execution_time": 4.295503,
                    "compile_time": 6.818224,
                    "planning_time": 0.10395,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk   sumsales\n0          1755928  249509.79\n1           514080  350828.69\n2           403458  341504.35\n3          1799267  219543.26\n4           647786  305564.83\n5          1029555  202391.78\n6          1201734  166440.55\n7          1994113  373615.89\n8          1028263  205320.85\n9           605551  328397.74\n10            9205  313851.73\n11          848523  222676.89\n12          251837  279371.00\n13          473931  205814.08\n14           24952  318328.56\n15         1412624  310606.79\n16          396452  283321.30\n17          553082  349008.63\n18          110193  287305.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021236,
                    "execution_time": 0.011842,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003364
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053476,
                    "execution_time": 0.007275,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038742
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk   sumsales\n0          1755928  249509.79\n1           514080  350828.69\n2           403458  341504.35\n3          1799267  219543.26\n4           647786  305564.83\n5          1029555  202391.78\n6          1201734  166440.55\n7          1994113  373615.89\n8          1028263  205320.85\n9           605551  328397.74\n10            9205  313851.73\n11          848523  222676.89\n12          251837  279371.00\n13          473931  205814.08\n14           24952  318328.56\n15         1412624  310606.79\n16          396452  283321.30\n17          553082  349008.63\n18          110193  287305.36\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,ss_quantity\n                  ,ss_sales_price\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n            ) as sales_data\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk      sumsales\n0              NaN  5.887354e+09\n1        1205594.0  2.191911e+05\n2          77602.0  2.631520e+05\n3         634775.0  3.105683e+05\n4         430050.0  2.793320e+05\n5         669376.0  2.385759e+05\n6         328902.0  3.214120e+05\n7         908243.0  1.974616e+05\n8         515429.0  2.771673e+05\n9        1561040.0  2.873006e+05\n10       1250096.0  3.573875e+05\n11       1122500.0  3.864704e+05\n12       1921843.0  2.599422e+05\n13        346722.0  2.470864e+05\n14       1994690.0  3.038954e+05\n15        557281.0  1.424872e+05\n16        936819.0  2.366964e+05\n17        843712.0  1.456687e+05\n18        266282.0  3.706073e+05\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016222,
                    "execution_time": 0.007136,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003044
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052306,
                    "execution_time": 0.00804,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038304
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk      sumsales\n0              NaN  5.887354e+09\n1        1205594.0  2.191911e+05\n2          77602.0  2.631520e+05\n3         634775.0  3.105683e+05\n4         430050.0  2.793320e+05\n5         669376.0  2.385759e+05\n6         328902.0  3.214120e+05\n7         908243.0  1.974616e+05\n8         515429.0  2.771673e+05\n9        1561040.0  2.873006e+05\n10       1250096.0  3.573875e+05\n11       1122500.0  3.864704e+05\n12       1921843.0  2.599422e+05\n13        346722.0  2.470864e+05\n14       1994690.0  3.038954e+05\n15        557281.0  1.424872e+05\n16        936819.0  2.366964e+05\n17        843712.0  1.456687e+05\n18        266282.0  3.706073e+05\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n/*CURSOR_IDENTIFIER*/\n            ) as sales_data\n      group by ss_customer_sk\n",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.243805,
                    "execution_time": 2.96724,
                    "compile_time": 0.000414,
                    "planning_time": 0.041266,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.01518,
                    "execution_time": 3.682542,
                    "compile_time": 7.98625,
                    "planning_time": 0.109501,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0           845945  16702.27\n1           705953  17292.61\n2           182620  11123.54\n3            60571   7621.44\n4           459992  24232.49\n5           596221  11038.47\n6          1485965   6476.77\n7          1909794  12662.08\n8          1233294  26029.19\n9           953329  14332.42\n10         1299554  26811.64\n11          377031   9922.30\n12          438710   5854.24\n13         1474078  12691.72\n14         1032347  25915.26\n15           38414   8313.94\n16         1038670  21290.34\n17         1172105  15160.01\n18          979151  14491.08\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016907,
                    "execution_time": 0.007537,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003218
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054691,
                    "execution_time": 0.007587,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039475
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0           845945  16702.27\n1           705953  17292.61\n2           182620  11123.54\n3            60571   7621.44\n4           459992  24232.49\n5           596221  11038.47\n6          1485965   6476.77\n7          1909794  12662.08\n8          1233294  26029.19\n9           953329  14332.42\n10         1299554  26811.64\n11          377031   9922.30\n12          438710   5854.24\n13         1474078  12691.72\n14         1032347  25915.26\n15           38414   8313.94\n16         1038670  21290.34\n17         1172105  15160.01\n18          979151  14491.08\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\ngroup by ss_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.868013,
                    "execution_time": 0.591377,
                    "compile_time": 0.000447,
                    "planning_time": 0.042439,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.073582,
                    "execution_time": 0.586982,
                    "compile_time": 11.138533,
                    "planning_time": 0.111057,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk    sumsales\n0              NaN  5517462.17\n1         892725.0        0.00\n2        1969424.0     1113.92\n3        1025532.0      565.02\n4        1102529.0       16.91\n5        1129722.0       93.26\n6        1833208.0     4068.90\n7          60986.0      820.10\n8        1968198.0       16.94\n9         622494.0     1114.56\n10         10630.0       18.60\n11        863020.0      314.05\n12        703061.0      182.10\n13       1589813.0      300.30\n14        517994.0     1218.78\n15        527399.0     2432.72\n16       1402874.0      199.35\n17        437983.0     3382.56\n18       1258339.0     1301.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015992,
                    "execution_time": 0.00729,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003094
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053906,
                    "execution_time": 0.007684,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038697
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_customer_sk    sumsales\n0              NaN  5517462.17\n1         892725.0        0.00\n2        1969424.0     1113.92\n3        1025532.0      565.02\n4        1102529.0       16.91\n5        1129722.0       93.26\n6        1833208.0     4068.90\n7          60986.0      820.10\n8        1968198.0       16.94\n9         622494.0     1114.56\n10         10630.0       18.60\n11        863020.0      314.05\n12        703061.0      182.10\n13       1589813.0      300.30\n14        517994.0     1218.78\n15        527399.0     2432.72\n16       1402874.0      199.35\n17        437983.0     3382.56\n18       1258339.0     1301.04\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk    sumsales\n0              NaN  5517462.17\n1         892725.0        0.00\n2        1969424.0     1113.92\n3        1025532.0      565.02\n4        1102529.0       16.91\n5        1129722.0       93.26\n6        1833208.0     4068.90\n7          60986.0      820.10\n8        1968198.0       16.94\n9         622494.0     1114.56\n10         10630.0       18.60\n11        863020.0      314.05\n12        703061.0      182.10\n13       1589813.0      300.30\n14        517994.0     1218.78\n15        527399.0     2432.72\n16       1402874.0      199.35\n17        437983.0     3382.56\n18       1258339.0     1301.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0169,
                    "execution_time": 0.007967,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003165
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051564,
                    "execution_time": 0.007187,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038427
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_customer_sk    sumsales\n0              NaN  5517462.17\n1         892725.0        0.00\n2        1969424.0     1113.92\n3        1025532.0      565.02\n4        1102529.0       16.91\n5        1129722.0       93.26\n6        1833208.0     4068.90\n7          60986.0      820.10\n8        1968198.0       16.94\n9         622494.0     1114.56\n10         10630.0       18.60\n11        863020.0      314.05\n12        703061.0      182.10\n13       1589813.0      300.30\n14        517994.0     1218.78\n15        527399.0     2432.72\n16       1402874.0      199.35\n17        437983.0     3382.56\n18       1258339.0     1301.04\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n      order by sumsales, ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" , \"SS_CUSTOMER_SK\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0              100       0.0\n1              117       0.0\n2              259       0.0\n3              303       0.0\n4              373       0.0\n5              595       0.0\n6              603       0.0\n7              848       0.0\n8             1282       0.0\n9             1346       0.0\n10            1373       0.0\n11            1594       0.0\n12            1626       0.0\n13            1912       0.0\n14            1992       0.0\n15            2015       0.0\n16            2258       0.0\n17            2299       0.0\n18            2318       0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.038828,
                    "execution_time": 0.011112,
                    "compile_time": 0.018352,
                    "planning_time": 0.003501
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.353127,
                    "execution_time": 0.011136,
                    "compile_time": 3.302527,
                    "planning_time": 0.038582
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST, \"SS_CUSTOMER_SK\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST"
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0              100       0.0\n1              117       0.0\n2              259       0.0\n3              303       0.0\n4              373       0.0\n5              595       0.0\n6              603       0.0\n7              848       0.0\n8             1282       0.0\n9             1346       0.0\n10            1373       0.0\n11            1594       0.0\n12            1626       0.0\n13            1912       0.0\n14            1992       0.0\n15            2015       0.0\n16            2258       0.0\n17            2299       0.0\n18            2318       0.0\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n      order by sumsales, ss_customer_sk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" , \"SS_CUSTOMER_SK\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0              100       0.0\n1              117       0.0\n2              259       0.0\n3              303       0.0\n4              373       0.0\n5              595       0.0\n6              603       0.0\n7              848       0.0\n8             1282       0.0\n9             1346       0.0\n10            1373       0.0\n11            1594       0.0\n12            1626       0.0\n13            1912       0.0\n14            1992       0.0\n15            2015       0.0\n16            2258       0.0\n17            2299       0.0\n18            2318       0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020963,
                    "execution_time": 0.011532,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003471
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021672,
                    "execution_time": 0.011176,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.00441
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST, \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0              100       0.0\n1              117       0.0\n2              259       0.0\n3              303       0.0\n4              373       0.0\n5              595       0.0\n6              603       0.0\n7              848       0.0\n8             1282       0.0\n9             1346       0.0\n10            1373       0.0\n11            1594       0.0\n12            1626       0.0\n13            1912       0.0\n14            1992       0.0\n15            2015       0.0\n16            2258       0.0\n17            2299       0.0\n18            2318       0.0\n...*/"
    }
]