[
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,(select d_date_sk, d_month_seq from date_dim) d1\n   ,(select i_item_sk, i_category, i_class from item) i\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i.i_item_sk  = ws_item_sk\n group by i_category,i_class\n )\nselect * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1216 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1216 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.462338,
                    "execution_time": 0.171748,
                    "compile_time": 0.213575,
                    "planning_time": 0.044201,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.405474,
                    "execution_time": 1.79802,
                    "compile_time": 6.450318,
                    "planning_time": 0.116286,
                    "create_size": 64
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category         i_class  g_category  g_class\n0   8.015094e+08        Shoes            mens           0        0\n1   1.964363e+08      Jewelry         earings           0        0\n2   7.747733e+08          Men           pants           0        0\n3   8.374682e+08        Women       maternity           0        0\n4   8.315852e+08        Shoes        athletic           0        0\n5   2.122494e+08        Books  entertainments           0        0\n6   2.133033e+08         Home   blinds/shades           0        0\n7   2.041143e+08        Books       parenting           0        0\n8   1.937590e+08       Sports          tennis           0        0\n9   2.118928e+08      Jewelry    womens watch           0        0\n10  1.922189e+08      Jewelry    loose stones           0        0\n11  2.069351e+08       Sports        baseball           0        0\n12  2.157930e+08        Books         history           0        0\n13  4.225234e+07                                        0        0\n14  7.253073e+05                 loose stones           0        0\n15  2.820307e+05                    maternity           0        0\n16  7.494168e+05                       memory           0        0\n17  2.299734e+05               athletic shoes           0        0\n18  2.559611e+05                         rugs           0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.049391,
                    "execution_time": 0.007486,
                    "compile_time": 0.032304,
                    "planning_time": 0.00368
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.142432,
                    "execution_time": 0.00782,
                    "compile_time": 3.086296,
                    "planning_time": 0.038838
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*       total_sum   i_category         i_class  g_category  g_class\n0   8.015094e+08        Shoes            mens           0        0\n1   1.964363e+08      Jewelry         earings           0        0\n2   7.747733e+08          Men           pants           0        0\n3   8.374682e+08        Women       maternity           0        0\n4   8.315852e+08        Shoes        athletic           0        0\n5   2.122494e+08        Books  entertainments           0        0\n6   2.133033e+08         Home   blinds/shades           0        0\n7   2.041143e+08        Books       parenting           0        0\n8   1.937590e+08       Sports          tennis           0        0\n9   2.118928e+08      Jewelry    womens watch           0        0\n10  1.922189e+08      Jewelry    loose stones           0        0\n11  2.069351e+08       Sports        baseball           0        0\n12  2.157930e+08        Books         history           0        0\n13  4.225234e+07                                        0        0\n14  7.253073e+05                 loose stones           0        0\n15  2.820307e+05                    maternity           0        0\n16  7.494168e+05                       memory           0        0\n17  2.299734e+05               athletic shoes           0        0\n18  2.559611e+05                         rugs           0        0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) \nselect * from results\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.247155,
                    "execution_time": 0.170054,
                    "compile_time": 0.000415,
                    "planning_time": 0.044014,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.351466,
                    "execution_time": 0.168952,
                    "compile_time": 0.03735,
                    "planning_time": 0.113695,
                    "create_size": 64
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class\n0   8.032242e+08        Women          dresses           0        0\n1   8.065787e+08     Children          newborn           0        0\n2   8.315142e+08        Music          country           0        0\n3   2.175166e+08  Electronics  dvd/vcr players           0        0\n4   2.111049e+08        Books        reference           0        0\n5   8.140558e+08        Women         swimwear           0        0\n6   2.107086e+08      Jewelry             gold           0        0\n7   2.266389e+08      Jewelry    jewelry boxes           0        0\n8   8.073283e+08     Children  school-uniforms           0        0\n9   2.049191e+08  Electronics          musical           0        0\n10  2.030835e+08      Jewelry          costume           0        0\n11  2.012493e+08      Jewelry           custom           0        0\n12  2.127243e+08      Jewelry       mens watch           0        0\n13  1.957046e+08         Home            decor           0        0\n14  2.083960e+08         Home         flatware           0        0\n15  2.035953e+08  Electronics         portable           0        0\n16  2.015230e+08  Electronics       camcorders           0        0\n17  2.071130e+08      Jewelry         pendants           0        0\n18  2.019448e+08         Home            paint           0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016693,
                    "execution_time": 0.006952,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003729
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.131798,
                    "execution_time": 0.007448,
                    "compile_time": 0.079219,
                    "planning_time": 0.038928
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class\n0   8.032242e+08        Women          dresses           0        0\n1   8.065787e+08     Children          newborn           0        0\n2   8.315142e+08        Music          country           0        0\n3   2.175166e+08  Electronics  dvd/vcr players           0        0\n4   2.111049e+08        Books        reference           0        0\n5   8.140558e+08        Women         swimwear           0        0\n6   2.107086e+08      Jewelry             gold           0        0\n7   2.266389e+08      Jewelry    jewelry boxes           0        0\n8   8.073283e+08     Children  school-uniforms           0        0\n9   2.049191e+08  Electronics          musical           0        0\n10  2.030835e+08      Jewelry          costume           0        0\n11  2.012493e+08      Jewelry           custom           0        0\n12  2.127243e+08      Jewelry       mens watch           0        0\n13  1.957046e+08         Home            decor           0        0\n14  2.083960e+08         Home         flatware           0        0\n15  2.035953e+08  Electronics         portable           0        0\n16  2.015230e+08  Electronics       camcorders           0        0\n17  2.071130e+08      Jewelry         pendants           0        0\n18  2.019448e+08         Home            paint           0        0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n)\nselect * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.137869e+08        Books       fiction           0        0             0\n1   1.983822e+08         Home        tables           0        0             0\n2   1.994336e+08         Home        accent           0        0             0\n3   8.092738e+08        Music          rock           0        0             0\n4   2.234310e+08       Sports          golf           0        0             0\n5   2.089042e+08  Electronics        karoke           0        0             0\n6   3.728832e+06       Sports                         0        0             0\n7   3.825182e+05                  glassware           0        0             0\n8   5.471631e+05                  reference           0        0             0\n9   3.030947e+05                     estate           0        0             0\n10  3.367202e+05                  self-help           0        0             0\n11  2.486338e+05                       kids           0        0             0\n12  8.979965e+04                  parenting           0        0             0\n13  2.041143e+08        Books     parenting           0        0             0\n14  8.374682e+08        Women     maternity           0        0             0\n15  7.747733e+08          Men         pants           0        0             0\n16  2.118928e+08      Jewelry  womens watch           0        0             0\n17  4.225234e+07                                      0        0             0\n18  1.922189e+08      Jewelry  loose stones           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.056433,
                    "execution_time": 0.008028,
                    "compile_time": 0.037816,
                    "planning_time": 0.004111
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.161195,
                    "execution_time": 0.008079,
                    "compile_time": 3.106814,
                    "planning_time": 0.038648
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*       total_sum   i_category       i_class  g_category  g_class  lochierarchy\n0   2.137869e+08        Books       fiction           0        0             0\n1   1.983822e+08         Home        tables           0        0             0\n2   1.994336e+08         Home        accent           0        0             0\n3   8.092738e+08        Music          rock           0        0             0\n4   2.234310e+08       Sports          golf           0        0             0\n5   2.089042e+08  Electronics        karoke           0        0             0\n6   3.728832e+06       Sports                         0        0             0\n7   3.825182e+05                  glassware           0        0             0\n8   5.471631e+05                  reference           0        0             0\n9   3.030947e+05                     estate           0        0             0\n10  3.367202e+05                  self-help           0        0             0\n11  2.486338e+05                       kids           0        0             0\n12  8.979965e+04                  parenting           0        0             0\n13  2.041143e+08        Books     parenting           0        0             0\n14  8.374682e+08        Women     maternity           0        0             0\n15  7.747733e+08          Men         pants           0        0             0\n16  2.118928e+08      Jewelry  womens watch           0        0             0\n17  4.225234e+07                                      0        0             0\n18  1.922189e+08      Jewelry  loose stones           0        0             0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n)\nselect * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.313657,
                    "execution_time": 0.051802,
                    "compile_time": 0.234698,
                    "planning_time": 0.00695,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.582408,
                    "execution_time": 0.049967,
                    "compile_time": 9.452577,
                    "planning_time": 0.049216,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  g_category  g_class  lochierarchy\n0   2.068833e+08         Home    furniture           0        0             0\n1   2.963427e+05                   science           0        0             0\n2   2.150884e+08      Jewelry        rings           0        0             0\n3   2.055364e+08        Books      romance           0        0             0\n4   1.933123e+08  Electronics      cameras           0        0             0\n5   3.421404e+05                 computers           0        0             0\n6   1.257853e+06                     pants           0        0             0\n7   1.850004e+05                   romance           0        0             0\n8   3.268762e+09      Jewelry         None           0        1             1\n9   2.107086e+08      Jewelry         gold           0        0             0\n10  2.012493e+08      Jewelry       custom           0        0             0\n11  2.054808e+08  Electronics     scanners           0        0             0\n12  3.274327e+09         Home         None           0        1             1\n13  1.896200e+08      Jewelry     diamonds           0        0             0\n14  2.206069e+08  Electronics  televisions           0        0             0\n15  2.072396e+08        Books       travel           0        0             0\n16  2.069351e+08       Sports     baseball           0        0             0\n17  2.157930e+08        Books      history           0        0             0\n18  3.332718e+09       Sports         None           0        1             1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.086924,
                    "execution_time": 0.007483,
                    "compile_time": 0.069693,
                    "planning_time": 0.003693
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.130154,
                    "execution_time": 0.008209,
                    "compile_time": 3.073508,
                    "planning_time": 0.038989
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  g_category  g_class  lochierarchy\n0   2.068833e+08         Home    furniture           0        0             0\n1   2.963427e+05                   science           0        0             0\n2   2.150884e+08      Jewelry        rings           0        0             0\n3   2.055364e+08        Books      romance           0        0             0\n4   1.933123e+08  Electronics      cameras           0        0             0\n5   3.421404e+05                 computers           0        0             0\n6   1.257853e+06                     pants           0        0             0\n7   1.850004e+05                   romance           0        0             0\n8   3.268762e+09      Jewelry         None           0        1             1\n9   2.107086e+08      Jewelry         gold           0        0             0\n10  2.012493e+08      Jewelry       custom           0        0             0\n11  2.054808e+08  Electronics     scanners           0        0             0\n12  3.274327e+09         Home         None           0        1             1\n13  1.896200e+08      Jewelry     diamonds           0        0             0\n14  2.206069e+08  Electronics  televisions           0        0             0\n15  2.072396e+08        Books       travel           0        0             0\n16  2.069351e+08       Sports     baseball           0        0             0\n17  2.157930e+08        Books      history           0        0             0\n18  3.332718e+09       Sports         None           0        1             1\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n/*CURSOR_IDENTIFIER*/\nselect * from results_rollup",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.191688,
                    "execution_time": 0.062933,
                    "compile_time": 0.084805,
                    "planning_time": 0.010392,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.113427,
                    "execution_time": 0.058852,
                    "compile_time": 2.966386,
                    "planning_time": 0.051397,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   8.244003e+08          Men           shirts           0        0             0\n1   3.910403e+05                   televisions           0        0             0\n2   3.222352e+05                        tables           0        0             0\n3   8.065787e+08     Children          newborn           0        0             0\n4   8.315142e+08        Music          country           0        0             0\n5   2.111049e+08        Books        reference           0        0             0\n6   2.015230e+08  Electronics       camcorders           0        0             0\n7   3.619072e+06        Women                            0        0             0\n8   3.852324e+06         Home                            0        0             0\n9   1.973240e+05                          arts           0        0             0\n10  3.763214e+05               curtains/drapes           0        0             0\n11  1.074103e+05                        birdal           0        0             0\n12  1.818782e+06                       dresses           0        0             0\n13  2.613208e+05                        tennis           0        0             0\n14  2.080474e+08       Sports          camping           0        0             0\n15  1.997818e+08      Jewelry      consignment           0        0             0\n16  2.565237e+05                      scanners           0        0             0\n17  2.646680e+05                        stereo           0        0             0\n18  2.137869e+08        Books          fiction           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016583,
                    "execution_time": 0.007139,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003688
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.157868,
                    "execution_time": 0.007413,
                    "compile_time": 0.103767,
                    "planning_time": 0.03907
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   8.244003e+08          Men           shirts           0        0             0\n1   3.910403e+05                   televisions           0        0             0\n2   3.222352e+05                        tables           0        0             0\n3   8.065787e+08     Children          newborn           0        0             0\n4   8.315142e+08        Music          country           0        0             0\n5   2.111049e+08        Books        reference           0        0             0\n6   2.015230e+08  Electronics       camcorders           0        0             0\n7   3.619072e+06        Women                            0        0             0\n8   3.852324e+06         Home                            0        0             0\n9   1.973240e+05                          arts           0        0             0\n10  3.763214e+05               curtains/drapes           0        0             0\n11  1.074103e+05                        birdal           0        0             0\n12  1.818782e+06                       dresses           0        0             0\n13  2.613208e+05                        tennis           0        0             0\n14  2.080474e+08       Sports          camping           0        0             0\n15  1.997818e+08      Jewelry      consignment           0        0             0\n16  2.565237e+05                      scanners           0        0             0\n17  2.646680e+05                        stereo           0        0             0\n18  2.137869e+08        Books          fiction           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   8.244003e+08          Men           shirts           0        0             0\n1   3.910403e+05                   televisions           0        0             0\n2   3.222352e+05                        tables           0        0             0\n3   8.065787e+08     Children          newborn           0        0             0\n4   8.315142e+08        Music          country           0        0             0\n5   2.111049e+08        Books        reference           0        0             0\n6   2.015230e+08  Electronics       camcorders           0        0             0\n7   3.619072e+06        Women                            0        0             0\n8   3.852324e+06         Home                            0        0             0\n9   1.973240e+05                          arts           0        0             0\n10  3.763214e+05               curtains/drapes           0        0             0\n11  1.074103e+05                        birdal           0        0             0\n12  1.818782e+06                       dresses           0        0             0\n13  2.613208e+05                        tennis           0        0             0\n14  2.080474e+08       Sports          camping           0        0             0\n15  1.997818e+08      Jewelry      consignment           0        0             0\n16  2.565237e+05                      scanners           0        0             0\n17  2.646680e+05                        stereo           0        0             0\n18  2.137869e+08        Books          fiction           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017105,
                    "execution_time": 0.007113,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003921
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017154,
                    "execution_time": 0.007312,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003836
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   8.244003e+08          Men           shirts           0        0             0\n1   3.910403e+05                   televisions           0        0             0\n2   3.222352e+05                        tables           0        0             0\n3   8.065787e+08     Children          newborn           0        0             0\n4   8.315142e+08        Music          country           0        0             0\n5   2.111049e+08        Books        reference           0        0             0\n6   2.015230e+08  Electronics       camcorders           0        0             0\n7   3.619072e+06        Women                            0        0             0\n8   3.852324e+06         Home                            0        0             0\n9   1.973240e+05                          arts           0        0             0\n10  3.763214e+05               curtains/drapes           0        0             0\n11  1.074103e+05                        birdal           0        0             0\n12  1.818782e+06                       dresses           0        0             0\n13  2.613208e+05                        tennis           0        0             0\n14  2.080474e+08       Sports          camping           0        0             0\n15  1.997818e+08      Jewelry      consignment           0        0             0\n16  2.565237e+05                      scanners           0        0             0\n17  2.646680e+05                        stereo           0        0             0\n18  2.137869e+08        Books          fiction           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy\n0   8.244003e+08          Men           shirts             0\n1   3.910403e+05                   televisions             0\n2   3.222352e+05                        tables             0\n3   8.065787e+08     Children          newborn             0\n4   8.315142e+08        Music          country             0\n5   2.111049e+08        Books        reference             0\n6   2.015230e+08  Electronics       camcorders             0\n7   3.619072e+06        Women                              0\n8   3.852324e+06         Home                              0\n9   1.973240e+05                          arts             0\n10  3.763214e+05               curtains/drapes             0\n11  1.074103e+05                        birdal             0\n12  1.818782e+06                       dresses             0\n13  2.613208e+05                        tennis             0\n14  2.080474e+08       Sports          camping             0\n15  1.997818e+08      Jewelry      consignment             0\n16  2.565237e+05                      scanners             0\n17  2.646680e+05                        stereo             0\n18  2.137869e+08        Books          fiction             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.076797,
                    "execution_time": 0.008285,
                    "compile_time": 0.0591,
                    "planning_time": 0.003503
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.155661,
                    "execution_time": 0.008307,
                    "compile_time": 3.099585,
                    "planning_time": 0.03834
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy\n0   8.244003e+08          Men           shirts             0\n1   3.910403e+05                   televisions             0\n2   3.222352e+05                        tables             0\n3   8.065787e+08     Children          newborn             0\n4   8.315142e+08        Music          country             0\n5   2.111049e+08        Books        reference             0\n6   2.015230e+08  Electronics       camcorders             0\n7   3.619072e+06        Women                              0\n8   3.852324e+06         Home                              0\n9   1.973240e+05                          arts             0\n10  3.763214e+05               curtains/drapes             0\n11  1.074103e+05                        birdal             0\n12  1.818782e+06                       dresses             0\n13  2.613208e+05                        tennis             0\n14  2.080474e+08       Sports          camping             0\n15  1.997818e+08      Jewelry      consignment             0\n16  2.565237e+05                      scanners             0\n17  2.646680e+05                        stereo             0\n18  2.137869e+08        Books          fiction             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (order by total_sum desc) as total_rank\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup;",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  total_rank\n0   3.294251e+10         None         None             2           1\n1   3.332718e+09       Sports         None             1           2\n2   3.295124e+09     Children         None             1           3\n3   3.293035e+09        Music         None             1           4\n4   3.292112e+09  Electronics         None             1           5\n5   3.287496e+09        Women         None             1           6\n6   3.281394e+09        Books         None             1           7\n7   3.277926e+09        Shoes         None             1           8\n8   3.274327e+09         Home         None             1           9\n9   3.268762e+09      Jewelry         None             1          10\n10  3.257970e+09          Men         None             1          11\n11  8.465069e+08     Children      infants             0          12\n12  8.374682e+08        Women    maternity             0          13\n13  8.371936e+08          Men  accessories             0          14\n14  8.371296e+08        Music    classical             0          15\n15  8.315852e+08        Shoes     athletic             0          16\n16  8.315142e+08        Music      country             0          17\n17  8.305741e+08     Children     toddlers             0          18\n18  8.291282e+08        Women   fragrances             0          19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.141889,
                    "execution_time": 0.009773,
                    "compile_time": 0.121006,
                    "planning_time": 0.004224
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.919467,
                    "execution_time": 0.010383,
                    "compile_time": 4.863271,
                    "planning_time": 0.039535
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  total_rank\n0   3.294251e+10         None         None             2           1\n1   3.332718e+09       Sports         None             1           2\n2   3.295124e+09     Children         None             1           3\n3   3.293035e+09        Music         None             1           4\n4   3.292112e+09  Electronics         None             1           5\n5   3.287496e+09        Women         None             1           6\n6   3.281394e+09        Books         None             1           7\n7   3.277926e+09        Shoes         None             1           8\n8   3.274327e+09         Home         None             1           9\n9   3.268762e+09      Jewelry         None             1          10\n10  3.257970e+09          Men         None             1          11\n11  8.465069e+08     Children      infants             0          12\n12  8.374682e+08        Women    maternity             0          13\n13  8.371936e+08          Men  accessories             0          14\n14  8.371296e+08        Music    classical             0          15\n15  8.315852e+08        Shoes     athletic             0          16\n16  8.315142e+08        Music      country             0          17\n17  8.305741e+08     Children     toddlers             0          18\n18  8.291282e+08        Women   fragrances             0          19\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim as d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\nresults_rollup as\n( select total_sum, i_category, i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum, i_category, i_class, lochierarchy \n   ,rank() over (\n    partition by lochierarchy\n    order by total_sum desc) as rnk\n from results_rollup\n /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rnk\n0   3.332718e+09       Sports         None             1    1\n1   3.295124e+09     Children         None             1    2\n2   3.293035e+09        Music         None             1    3\n3   3.292112e+09  Electronics         None             1    4\n4   3.287496e+09        Women         None             1    5\n5   3.281394e+09        Books         None             1    6\n6   3.277926e+09        Shoes         None             1    7\n7   3.274327e+09         Home         None             1    8\n8   3.268762e+09      Jewelry         None             1    9\n9   3.257970e+09          Men         None             1   10\n10  8.165172e+07                      None             1   11\n11  3.294251e+10         None         None             2    1\n12  8.465069e+08     Children      infants             0    1\n13  8.374682e+08        Women    maternity             0    2\n14  8.371936e+08          Men  accessories             0    3\n15  8.371296e+08        Music    classical             0    4\n16  8.315852e+08        Shoes     athletic             0    5\n17  8.315142e+08        Music      country             0    6\n18  8.305741e+08     Children     toddlers             0    7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.141768,
                    "execution_time": 0.009354,
                    "compile_time": 0.12087,
                    "planning_time": 0.004391
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.015804,
                    "execution_time": 0.010912,
                    "compile_time": 4.959421,
                    "planning_time": 0.039947
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rnk\n0   3.332718e+09       Sports         None             1    1\n1   3.295124e+09     Children         None             1    2\n2   3.293035e+09        Music         None             1    3\n3   3.292112e+09  Electronics         None             1    4\n4   3.287496e+09        Women         None             1    5\n5   3.281394e+09        Books         None             1    6\n6   3.277926e+09        Shoes         None             1    7\n7   3.274327e+09         Home         None             1    8\n8   3.268762e+09      Jewelry         None             1    9\n9   3.257970e+09          Men         None             1   10\n10  8.165172e+07                      None             1   11\n11  3.294251e+10         None         None             2    1\n12  8.465069e+08     Children      infants             0    1\n13  8.374682e+08        Women    maternity             0    2\n14  8.371936e+08          Men  accessories             0    3\n15  8.371296e+08        Music    classical             0    4\n16  8.315852e+08        Shoes     athletic             0    5\n17  8.315142e+08        Music      country             0    6\n18  8.305741e+08     Children     toddlers             0    7\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category else NULL end\n ) as rank_value /*CURSOR_IDENTIFIER*/\n from results_rollup",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_value\n0   8.165172e+07                          None             1           1\n1   3.274327e+09         Home             None             1           1\n2   3.268762e+09      Jewelry             None             1           1\n3   3.332718e+09       Sports             None             1           1\n4   3.292112e+09  Electronics             None             1           1\n5   3.281394e+09        Books             None             1           1\n6   3.293035e+09        Music             None             1           1\n7   3.277926e+09        Shoes             None             1           1\n8   3.287496e+09        Women             None             1           1\n9   3.257970e+09          Men             None             1           1\n10  3.295124e+09     Children             None             1           1\n11  3.910403e+05                   televisions             0           1\n12  3.222352e+05                        tables             0           1\n13  1.973240e+05                          arts             0           1\n14  3.763214e+05               curtains/drapes             0           1\n15  1.074103e+05                        birdal             0           1\n16  1.818782e+06                       dresses             0           1\n17  2.613208e+05                        tennis             0           1\n18  2.565237e+05                      scanners             0           1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.093769,
                    "execution_time": 0.009842,
                    "compile_time": 0.071174,
                    "planning_time": 0.004949
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.944349,
                    "execution_time": 0.009963,
                    "compile_time": 4.888953,
                    "planning_time": 0.040589
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_value\n0   8.165172e+07                          None             1           1\n1   3.274327e+09         Home             None             1           1\n2   3.268762e+09      Jewelry             None             1           1\n3   3.332718e+09       Sports             None             1           1\n4   3.292112e+09  Electronics             None             1           1\n5   3.281394e+09        Books             None             1           1\n6   3.293035e+09        Music             None             1           1\n7   3.277926e+09        Shoes             None             1           1\n8   3.287496e+09        Women             None             1           1\n9   3.257970e+09          Men             None             1           1\n10  3.295124e+09     Children             None             1           1\n11  3.910403e+05                   televisions             0           1\n12  3.222352e+05                        tables             0           1\n13  1.973240e+05                          arts             0           1\n14  3.763214e+05               curtains/drapes             0           1\n15  1.074103e+05                        birdal             0           1\n16  1.818782e+06                       dresses             0           1\n17  2.613208e+05                        tennis             0           1\n18  2.565237e+05                      scanners             0           1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum i_category          i_class  lochierarchy  rank_within_parent\n0   8.465069e+08   Children          infants             0                   1\n1   8.305741e+08   Children         toddlers             0                   2\n2   8.073283e+08   Children  school-uniforms             0                   3\n3   8.065787e+08   Children          newborn             0                   4\n4   4.136299e+06   Children                              0                   5\n5   2.204609e+08       Home          bedding             0                   1\n6   2.138972e+08       Home  curtains/drapes             0                   2\n7   2.133033e+08       Home    blinds/shades             0                   3\n8   2.089186e+08       Home         bathroom             0                   4\n9   2.087533e+08       Home             kids             0                   5\n10  2.083960e+08       Home         flatware             0                   6\n11  2.069309e+08       Home             rugs             0                   7\n12  2.068833e+08       Home        furniture             0                   8\n13  2.026844e+08       Home       mattresses             0                   9\n14  2.019448e+08       Home            paint             0                  10\n15  1.994336e+08       Home           accent             0                  11\n16  1.983822e+08       Home           tables             0                  12\n17  1.977924e+08       Home        glassware             0                  13\n18  1.964104e+08       Home         lighting             0                  14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033299,
                    "execution_time": 0.01002,
                    "compile_time": 0.017084,
                    "planning_time": 0.0051
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.170258,
                    "execution_time": 0.010507,
                    "compile_time": 3.116856,
                    "planning_time": 0.040714
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum i_category          i_class  lochierarchy  rank_within_parent\n0   8.465069e+08   Children          infants             0                   1\n1   8.305741e+08   Children         toddlers             0                   2\n2   8.073283e+08   Children  school-uniforms             0                   3\n3   8.065787e+08   Children          newborn             0                   4\n4   4.136299e+06   Children                              0                   5\n5   2.204609e+08       Home          bedding             0                   1\n6   2.138972e+08       Home  curtains/drapes             0                   2\n7   2.133033e+08       Home    blinds/shades             0                   3\n8   2.089186e+08       Home         bathroom             0                   4\n9   2.087533e+08       Home             kids             0                   5\n10  2.083960e+08       Home         flatware             0                   6\n11  2.069309e+08       Home             rugs             0                   7\n12  2.068833e+08       Home        furniture             0                   8\n13  2.026844e+08       Home       mattresses             0                   9\n14  2.019448e+08       Home            paint             0                  10\n15  1.994336e+08       Home           accent             0                  11\n16  1.983822e+08       Home           tables             0                  12\n17  1.977924e+08       Home        glassware             0                  13\n18  1.964104e+08       Home         lighting             0                  14\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum i_category          i_class  lochierarchy  rank_within_parent\n0   2.204609e+08       Home          bedding             0                   1\n1   2.138972e+08       Home  curtains/drapes             0                   2\n2   2.133033e+08       Home    blinds/shades             0                   3\n3   2.089186e+08       Home         bathroom             0                   4\n4   2.087533e+08       Home             kids             0                   5\n5   2.083960e+08       Home         flatware             0                   6\n6   2.069309e+08       Home             rugs             0                   7\n7   2.068833e+08       Home        furniture             0                   8\n8   2.026844e+08       Home       mattresses             0                   9\n9   2.019448e+08       Home            paint             0                  10\n10  1.994336e+08       Home           accent             0                  11\n11  1.983822e+08       Home           tables             0                  12\n12  1.977924e+08       Home        glassware             0                  13\n13  1.964104e+08       Home         lighting             0                  14\n14  1.957046e+08       Home            decor             0                  15\n15  1.905783e+08       Home        wallpaper             0                  16\n16  3.852324e+06       Home                              0                  17\n17  8.371296e+08      Music        classical             0                   1\n18  8.315142e+08      Music          country             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022541,
                    "execution_time": 0.009559,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.005128
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022414,
                    "execution_time": 0.009483,
                    "compile_time": 0.0001,
                    "planning_time": 0.005139
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum i_category          i_class  lochierarchy  rank_within_parent\n0   2.204609e+08       Home          bedding             0                   1\n1   2.138972e+08       Home  curtains/drapes             0                   2\n2   2.133033e+08       Home    blinds/shades             0                   3\n3   2.089186e+08       Home         bathroom             0                   4\n4   2.087533e+08       Home             kids             0                   5\n5   2.083960e+08       Home         flatware             0                   6\n6   2.069309e+08       Home             rugs             0                   7\n7   2.068833e+08       Home        furniture             0                   8\n8   2.026844e+08       Home       mattresses             0                   9\n9   2.019448e+08       Home            paint             0                  10\n10  1.994336e+08       Home           accent             0                  11\n11  1.983822e+08       Home           tables             0                  12\n12  1.977924e+08       Home        glassware             0                  13\n13  1.964104e+08       Home         lighting             0                  14\n14  1.957046e+08       Home            decor             0                  15\n15  1.905783e+08       Home        wallpaper             0                  16\n16  3.852324e+06       Home                              0                  17\n17  8.371296e+08      Music        classical             0                   1\n18  8.315142e+08      Music          country             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by total_sum desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC LIMIT 21",
                "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None         None             2                   1\n1   3.332718e+09       Sports         None             1                   1\n2   3.295124e+09     Children         None             1                   2\n3   3.293035e+09        Music         None             1                   3\n4   3.292112e+09  Electronics         None             1                   4\n5   3.287496e+09        Women         None             1                   5\n6   3.281394e+09        Books         None             1                   6\n7   3.277926e+09        Shoes         None             1                   7\n8   3.274327e+09         Home         None             1                   8\n9   3.268762e+09      Jewelry         None             1                   9\n10  3.257970e+09          Men         None             1                  10\n11  8.465069e+08     Children      infants             0                   1\n12  8.374682e+08        Women    maternity             0                   1\n13  8.371936e+08          Men  accessories             0                   1\n14  8.371296e+08        Music    classical             0                   1\n15  8.315852e+08        Shoes     athletic             0                   1\n16  8.315142e+08        Music      country             0                   2\n17  8.305741e+08     Children     toddlers             0                   2\n18  8.291282e+08        Women   fragrances             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031716,
                    "execution_time": 0.011496,
                    "compile_time": 0.013828,
                    "planning_time": 0.005339
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.163055,
                    "execution_time": 0.012407,
                    "compile_time": 3.106328,
                    "planning_time": 0.040671
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*       total_sum   i_category      i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None         None             2                   1\n1   3.332718e+09       Sports         None             1                   1\n2   3.295124e+09     Children         None             1                   2\n3   3.293035e+09        Music         None             1                   3\n4   3.292112e+09  Electronics         None             1                   4\n5   3.287496e+09        Women         None             1                   5\n6   3.281394e+09        Books         None             1                   6\n7   3.277926e+09        Shoes         None             1                   7\n8   3.274327e+09         Home         None             1                   8\n9   3.268762e+09      Jewelry         None             1                   9\n10  3.257970e+09          Men         None             1                  10\n11  8.465069e+08     Children      infants             0                   1\n12  8.374682e+08        Women    maternity             0                   1\n13  8.371936e+08          Men  accessories             0                   1\n14  8.371296e+08        Music    classical             0                   1\n15  8.315852e+08        Shoes     athletic             0                   1\n16  8.315142e+08        Music      country             0                   2\n17  8.305741e+08     Children     toddlers             0                   2\n18  8.291282e+08        Women   fragrances             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None             None             2                   1\n1   3.295124e+09     Children             None             1                   2\n2   3.293035e+09        Music             None             1                   3\n3   3.292112e+09  Electronics             None             1                   4\n4   3.287496e+09        Women             None             1                   5\n5   3.281394e+09        Books             None             1                   6\n6   3.277926e+09        Shoes             None             1                   7\n7   3.274327e+09         Home             None             1                   8\n8   3.268762e+09      Jewelry             None             1                   9\n9   3.257970e+09          Men             None             1                  10\n10  8.165172e+07                          None             1                  11\n11  3.332718e+09       Sports             None             1                   1\n12  8.140558e+08        Women         swimwear             0                   3\n13  2.138972e+08         Home  curtains/drapes             0                   2\n14  8.032242e+08        Women          dresses             0                   4\n15  2.133033e+08         Home    blinds/shades             0                   3\n16  3.619072e+06        Women                              0                   5\n17  2.089186e+08         Home         bathroom             0                   4\n18  8.291282e+08        Women       fragrances             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.029952,
                    "execution_time": 0.011068,
                    "compile_time": 0.013029,
                    "planning_time": 0.004979
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.112032,
                    "execution_time": 0.011313,
                    "compile_time": 3.057348,
                    "planning_time": 0.040896
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None             None             2                   1\n1   3.295124e+09     Children             None             1                   2\n2   3.293035e+09        Music             None             1                   3\n3   3.292112e+09  Electronics             None             1                   4\n4   3.287496e+09        Women             None             1                   5\n5   3.281394e+09        Books             None             1                   6\n6   3.277926e+09        Shoes             None             1                   7\n7   3.274327e+09         Home             None             1                   8\n8   3.268762e+09      Jewelry             None             1                   9\n9   3.257970e+09          Men             None             1                  10\n10  8.165172e+07                          None             1                  11\n11  3.332718e+09       Sports             None             1                   1\n12  8.140558e+08        Women         swimwear             0                   3\n13  2.138972e+08         Home  curtains/drapes             0                   2\n14  8.032242e+08        Women          dresses             0                   4\n15  2.133033e+08         Home    blinds/shades             0                   3\n16  3.619072e+06        Women                              0                   5\n17  2.089186e+08         Home         bathroom             0                   4\n18  8.291282e+08        Women       fragrances             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim d1\n   ,item i\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i.i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.245136,
                    "execution_time": 0.170963,
                    "compile_time": 0.000396,
                    "planning_time": 0.0424,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.323312,
                    "execution_time": 0.171799,
                    "compile_time": 0.000405,
                    "planning_time": 0.118464,
                    "create_size": 64
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103552,
                    "execution_time": 0.061499,
                    "compile_time": 0.000515,
                    "planning_time": 0.010056,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.14249,
                    "execution_time": 0.057533,
                    "compile_time": 0.000501,
                    "planning_time": 0.051915,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None        None             2                   1\n1   3.295124e+09     Children        None             1                   2\n2   3.293035e+09        Music        None             1                   3\n3   3.292112e+09  Electronics        None             1                   4\n4   3.287496e+09        Women        None             1                   5\n5   3.281394e+09        Books        None             1                   6\n6   3.277926e+09        Shoes        None             1                   7\n7   3.274327e+09         Home        None             1                   8\n8   3.268762e+09      Jewelry        None             1                   9\n9   3.257970e+09          Men        None             1                  10\n10  8.165172e+07                     None             1                  11\n11  3.332718e+09       Sports        None             1                   1\n12  1.818782e+06                  dresses             0                   2\n13  1.724469e+06                 swimwear             0                   3\n14  1.597705e+06                   womens             0                   4\n15  1.448090e+06                 athletic             0                   5\n16  1.422952e+06                  newborn             0                   6\n17  1.395445e+06               fragrances             0                   7\n18  1.316213e+06                 toddlers             0                   8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.057053,
                    "execution_time": 0.010567,
                    "compile_time": 0.032903,
                    "planning_time": 0.005413
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.995547,
                    "execution_time": 0.011497,
                    "compile_time": 5.938742,
                    "planning_time": 0.041383
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None        None             2                   1\n1   3.295124e+09     Children        None             1                   2\n2   3.293035e+09        Music        None             1                   3\n3   3.292112e+09  Electronics        None             1                   4\n4   3.287496e+09        Women        None             1                   5\n5   3.281394e+09        Books        None             1                   6\n6   3.277926e+09        Shoes        None             1                   7\n7   3.274327e+09         Home        None             1                   8\n8   3.268762e+09      Jewelry        None             1                   9\n9   3.257970e+09          Men        None             1                  10\n10  8.165172e+07                     None             1                  11\n11  3.332718e+09       Sports        None             1                   1\n12  1.818782e+06                  dresses             0                   2\n13  1.724469e+06                 swimwear             0                   3\n14  1.597705e+06                   womens             0                   4\n15  1.448090e+06                 athletic             0                   5\n16  1.422952e+06                  newborn             0                   6\n17  1.395445e+06               fragrances             0                   7\n18  1.316213e+06                 toddlers             0                   8\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end,\n   rank_within_parent \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END , \"RANK_WITHIN_PARENT\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None        None             2                   1\n1   3.332718e+09       Sports        None             1                   1\n2   3.295124e+09     Children        None             1                   2\n3   3.293035e+09        Music        None             1                   3\n4   3.292112e+09  Electronics        None             1                   4\n5   3.287496e+09        Women        None             1                   5\n6   3.281394e+09        Books        None             1                   6\n7   3.277926e+09        Shoes        None             1                   7\n8   3.274327e+09         Home        None             1                   8\n9   3.268762e+09      Jewelry        None             1                   9\n10  3.257970e+09          Men        None             1                  10\n11  8.165172e+07                     None             1                  11\n12  4.225234e+07                                      0                   1\n13  1.818782e+06                  dresses             0                   2\n14  1.724469e+06                 swimwear             0                   3\n15  1.597705e+06                   womens             0                   4\n16  1.448090e+06                 athletic             0                   5\n17  1.422952e+06                  newborn             0                   6\n18  1.395445e+06               fragrances             0                   7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.039225,
                    "execution_time": 0.010568,
                    "compile_time": 0.021281,
                    "planning_time": 0.006
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.148221,
                    "execution_time": 0.01123,
                    "compile_time": 3.092625,
                    "planning_time": 0.041586
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None        None             2                   1\n1   3.332718e+09       Sports        None             1                   1\n2   3.295124e+09     Children        None             1                   2\n3   3.293035e+09        Music        None             1                   3\n4   3.292112e+09  Electronics        None             1                   4\n5   3.287496e+09        Women        None             1                   5\n6   3.281394e+09        Books        None             1                   6\n7   3.277926e+09        Shoes        None             1                   7\n8   3.274327e+09         Home        None             1                   8\n9   3.268762e+09      Jewelry        None             1                   9\n10  3.257970e+09          Men        None             1                  10\n11  8.165172e+07                     None             1                  11\n12  4.225234e+07                                      0                   1\n13  1.818782e+06                  dresses             0                   2\n14  1.724469e+06                 swimwear             0                   3\n15  1.597705e+06                   womens             0                   4\n16  1.448090e+06                 athletic             0                   5\n17  1.422952e+06                  newborn             0                   6\n18  1.395445e+06               fragrances             0                   7\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end,\n   rank_within_parent \n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END , \"RANK_WITHIN_PARENT\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None        None             2                   1\n1   3.332718e+09       Sports        None             1                   1\n2   3.295124e+09     Children        None             1                   2\n3   3.293035e+09        Music        None             1                   3\n4   3.292112e+09  Electronics        None             1                   4\n5   3.287496e+09        Women        None             1                   5\n6   3.281394e+09        Books        None             1                   6\n7   3.277926e+09        Shoes        None             1                   7\n8   3.274327e+09         Home        None             1                   8\n9   3.268762e+09      Jewelry        None             1                   9\n10  3.257970e+09          Men        None             1                  10\n11  8.165172e+07                     None             1                  11\n12  4.225234e+07                                      0                   1\n13  1.818782e+06                  dresses             0                   2\n14  1.724469e+06                 swimwear             0                   3\n15  1.597705e+06                   womens             0                   4\n16  1.448090e+06                 athletic             0                   5\n17  1.422952e+06                  newborn             0                   6\n18  1.395445e+06               fragrances             0                   7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025075,
                    "execution_time": 0.010824,
                    "compile_time": 0.000132,
                    "planning_time": 0.006049
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.025302,
                    "execution_time": 0.010631,
                    "compile_time": 0.000138,
                    "planning_time": 0.006314
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       total_sum   i_category     i_class  lochierarchy  rank_within_parent\n0   3.294251e+10         None        None             2                   1\n1   3.332718e+09       Sports        None             1                   1\n2   3.295124e+09     Children        None             1                   2\n3   3.293035e+09        Music        None             1                   3\n4   3.292112e+09  Electronics        None             1                   4\n5   3.287496e+09        Women        None             1                   5\n6   3.281394e+09        Books        None             1                   6\n7   3.277926e+09        Shoes        None             1                   7\n8   3.274327e+09         Home        None             1                   8\n9   3.268762e+09      Jewelry        None             1                   9\n10  3.257970e+09          Men        None             1                  10\n11  8.165172e+07                     None             1                  11\n12  4.225234e+07                                      0                   1\n13  1.818782e+06                  dresses             0                   2\n14  1.724469e+06                 swimwear             0                   3\n15  1.597705e+06                   womens             0                   4\n16  1.448090e+06                 athletic             0                   5\n17  1.422952e+06                  newborn             0                   6\n18  1.395445e+06               fragrances             0                   7\n...*/"
    }
]