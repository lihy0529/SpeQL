[
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.184046,
                    "execution_time": 0.566105,
                    "compile_time": 0.000369,
                    "planning_time": 0.022663,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.36484,
                    "execution_time": 0.570204,
                    "compile_time": 0.104753,
                    "planning_time": 0.081692,
                    "create_size": 1408
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.100379,
                    "execution_time": 0.039295,
                    "compile_time": 0.000219,
                    "planning_time": 0.022811,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.164875,
                    "execution_time": 0.040244,
                    "compile_time": 0.000238,
                    "planning_time": 0.084512,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.744571,
                    "execution_time": 8.315624,
                    "compile_time": 0.000771,
                    "planning_time": 0.04251,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.017107,
                    "execution_time": 8.388998,
                    "compile_time": 0.228873,
                    "planning_time": 0.123906,
                    "create_size": 1792
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name       customer_email_address\n0   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n1   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n2   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n3   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n4   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n5   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n6   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n7   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n8   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n9   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n10  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n11  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n12  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n13  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n14  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n15  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n16  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n17  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n18  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.271132,
                    "execution_time": 0.255988,
                    "compile_time": 0.02723,
                    "planning_time": 0.006154
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.297202,
                    "execution_time": 0.254951,
                    "compile_time": 3.075603,
                    "planning_time": 0.041701
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name       customer_email_address\n0   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n1   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n2   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n3   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n4   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n5   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n6   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n7   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n8   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n9   AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n10  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n11  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n12  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n13  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n14  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n15  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n16  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n17  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n18  AAAAAAAAFIIIKBAA               Jonas           Williams  Jonas.Williams@4jC1CpsI.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n1   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n2   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n3   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n4   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n5   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n6   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n7   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n8   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n9   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n10  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n11  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n12  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n13  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n14  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n15  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n16  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n17  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n18  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.747942,
                    "execution_time": 0.728051,
                    "compile_time": 0.000239,
                    "planning_time": 0.007449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.463827,
                    "execution_time": 0.778255,
                    "compile_time": 2.626864,
                    "planning_time": 0.043518
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n1   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n2   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n3   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n4   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n5   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n6   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n7   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n8   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n9   AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n10  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n11  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n12  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n13  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n14  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n15  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n16  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n17  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n18  AAAAAAAAMPAIAAAA              Leanne          Underwood  Leanne.Underwood@0Khp1TthtSJT.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.189696,
                    "execution_time": 8.69842,
                    "compile_time": 0.00094,
                    "planning_time": 0.0432,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.936389,
                    "execution_time": 8.366511,
                    "compile_time": 0.000873,
                    "planning_time": 0.124601,
                    "create_size": 1920
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n1   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n2   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n3   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n4   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n5   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n6   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n7   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n8   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n9   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n10  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n11  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n12  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n13  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n14  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n15  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n16  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n17  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n18  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.788335,
                    "execution_time": 0.765154,
                    "compile_time": 0.0003,
                    "planning_time": 0.008661
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.914827,
                    "execution_time": 0.853013,
                    "compile_time": 0.000303,
                    "planning_time": 0.044297
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n1   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n2   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n3   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n4   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n5   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n6   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n7   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n8   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n9   AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n10  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n11  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n12  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n13  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n14  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n15  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n16  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n17  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n18  AAAAAAAAFNHCJBAA                Tina              Moore   Tina.Moore@xclfX.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n1   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n2   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n3   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n4   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n5   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n6   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n7   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n8   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n9   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n10  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n11  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n12  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n13  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n14  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n15  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n16  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n17  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n18  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.67788,
                    "execution_time": 0.653968,
                    "compile_time": 0.000322,
                    "planning_time": 0.009209
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.250611,
                    "execution_time": 0.654892,
                    "compile_time": 3.532805,
                    "planning_time": 0.045196
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n1   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n2   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n3   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n4   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n5   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n6   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n7   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n8   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n9   AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n10  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n11  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n12  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n13  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n14  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n15  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n16  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n17  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n18  AAAAAAAAJLCGPAAA                 Rey            Johnson  Rey.Johnson@mkc4YZ170E9U7RvtE.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n1   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n2   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n3   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n4   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n5   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n6   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n7   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n8   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n9   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n10  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n11  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n12  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n13  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n14  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n15  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n16  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n17  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n18  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.598483,
                    "execution_time": 0.573447,
                    "compile_time": 0.000356,
                    "planning_time": 0.009539
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.75171,
                    "execution_time": 0.67811,
                    "compile_time": 0.000367,
                    "planning_time": 0.045515
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n1   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n2   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n3   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n4   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n5   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n6   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n7   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n8   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n9   AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n10  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n11  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n12  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n13  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n14  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n15  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n16  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n17  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n18  AAAAAAAAECMKCBAA              Monica            Sherrod   Monica.Sherrod@7.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 19.977775,
                    "execution_time": 19.563783,
                    "compile_time": 0.000659,
                    "planning_time": 0.010139,
                    "create_size": 20141
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 27.457777,
                    "execution_time": 26.990043,
                    "compile_time": 0.000649,
                    "planning_time": 0.067507,
                    "create_size": 20141
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n1   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n2   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n3   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n4   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n5   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n6   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n7   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n8   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n9   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n10  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n11  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n12  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n13  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n14  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n15  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n16  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n17  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n18  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018296,
                    "execution_time": 0.008585,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003555
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056121,
                    "execution_time": 0.010254,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038568
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n1   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n2   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n3   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n4   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n5   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n6   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n7   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n8   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n9   AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n10  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n11  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n12  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n13  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n14  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n15  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n16  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n17  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n18  AAAAAAAANAHNEBAA                Jose            Peachey  Jose.Peachey@YnFa.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.960799,
                    "execution_time": 8.42848,
                    "compile_time": 0.000887,
                    "planning_time": 0.044359,
                    "create_size": 2048
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.763066,
                    "execution_time": 10.136915,
                    "compile_time": 0.00091,
                    "planning_time": 0.125499,
                    "create_size": 2048
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.140747,
                    "execution_time": 3.736667,
                    "compile_time": 0.00045,
                    "planning_time": 0.011259,
                    "create_size": 4480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 16.845456,
                    "execution_time": 6.455647,
                    "compile_time": 10.13345,
                    "planning_time": 0.069287,
                    "create_size": 4480
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name           customer_email_address\n0   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n1   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n2   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n3   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n4   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n5   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n6   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n7   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n8   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n9   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n10  AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n11  AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n12  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n13  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n14  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n15  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n16  AAAAAAAAGAEJCBAA                Irma             Currie  Irma.Currie@7a2EzggUrNY1FYD.edu\n17  AAAAAAAAGAEJCBAA                Irma             Currie  Irma.Currie@7a2EzggUrNY1FYD.edu\n18  AAAAAAAAGAEJCBAA                Irma             Currie  Irma.Currie@7a2EzggUrNY1FYD.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017596,
                    "execution_time": 0.007812,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003606
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05399,
                    "execution_time": 0.007796,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038863
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name           customer_email_address\n0   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n1   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n2   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n3   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n4   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n5   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n6   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n7   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n8   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n9   AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n10  AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n11  AAAAAAAAKMOHGBAA             Valerie             Morris            Valerie.Morris@IF.org\n12  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n13  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n14  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n15  AAAAAAAAPBLBLBAA           Christine          Macmillan   Christine.Macmillan@I4Zmf3.edu\n16  AAAAAAAAGAEJCBAA                Irma             Currie  Irma.Currie@7a2EzggUrNY1FYD.edu\n17  AAAAAAAAGAEJCBAA                Irma             Currie  Irma.Currie@7a2EzggUrNY1FYD.edu\n18  AAAAAAAAGAEJCBAA                Irma             Currie  Irma.Currie@7a2EzggUrNY1FYD.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n1   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n2   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n3   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n4   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n5   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n6   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n7   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n8   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n9   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n10  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n11  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n12  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n13  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n14  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n15  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n16  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n17  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n18  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040002,
                    "execution_time": 0.027658,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.005033
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.204545,
                    "execution_time": 0.028918,
                    "compile_time": 0.134009,
                    "planning_time": 0.040075
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n1   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n2   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n3   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n4   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n5   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n6   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n7   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n8   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n9   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n10  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n11  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n12  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n13  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n14  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n15  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n16  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n17  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n18  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAMAMBEAAA             Derrick              Soule      Derrick.Soule@g8vxjOy.edu\n1   AAAAAAAAGMFGOBAA            Michelle             Barker          Michelle.Barker@n.com\n2   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n3   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n4   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n5   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n6   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n7   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n8   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n9   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n10  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n11  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n12  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n13  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n14  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n15  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n16  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n17  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n18  AAAAAAAAGKAOLBAA             Michael             Porter  Michael.Porter@b2RP0DfQVO.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 6.040135,
                    "execution_time": 6.025225,
                    "compile_time": 0.000149,
                    "planning_time": 0.00633
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.458194,
                    "execution_time": 5.406092,
                    "compile_time": 0.000153,
                    "planning_time": 0.042102
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAMAMBEAAA             Derrick              Soule      Derrick.Soule@g8vxjOy.edu\n1   AAAAAAAAGMFGOBAA            Michelle             Barker          Michelle.Barker@n.com\n2   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n3   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n4   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n5   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n6   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n7   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n8   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n9   AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n10  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n11  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n12  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n13  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n14  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n15  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n16  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n17  AAAAAAAAGGALHBAA               Cathy              Shore       Cathy.Shore@OXd69GDH.edu\n18  AAAAAAAAGKAOLBAA             Michael             Porter  Michael.Porter@b2RP0DfQVO.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n1   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n2   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n3   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n4   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n5   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n6   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n7   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n8   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n9   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n10  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n11  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n12  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n13  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n14  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n15  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n16  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n17  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n18  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.124037,
                    "execution_time": 0.104202,
                    "compile_time": 0.000222,
                    "planning_time": 0.008377
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.171729,
                    "execution_time": 0.103525,
                    "compile_time": 0.000233,
                    "planning_time": 0.043872
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n1   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n2   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n3   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n4   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n5   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n6   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n7   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n8   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n9   AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n10  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n11  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n12  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n13  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n14  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n15  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n16  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n17  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n18  AAAAAAAALFDOAAAA              Pamela             Conley  Pamela.Conley@tgosAkBX1sQ.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                     customer_email_address\n0   AAAAAAAAONEOEBAA           Josephine              Nance                     Josephine.Nance@uN.com\n1   AAAAAAAAHLFMDAAA              Tyrone           Ferguson                     Tyrone.Ferguson@Y1.com\n2   AAAAAAAAOAGONAAA                Kurt            Blakely                Kurt.Blakely@UxGY9fqKOf.com\n3   AAAAAAAAEMFOLBAA                Lynn             Rogers                         Lynn.Rogers@LR.com\n4   AAAAAAAACFFPHAAA              Marlen             Lawson                  Marlen.Lawson@XoUAuly.edu\n5   AAAAAAAAMJPNLAAA                John             Herron                       John.Herron@7grT.com\n6   AAAAAAAAHAHPKAAA              Donald               Hill           Donald.Hill@rlsG4cz2K331ZX3H.org\n7   AAAAAAAADNOHKBAA               Renee            Mcclain            Renee.Mcclain@QvHGnlMHZ5hO2.com\n8   AAAAAAAADBOCIAAA                 Jay              Mount                         Jay.Mount@BMiP.edu\n9   AAAAAAAAONFPPAAA              Daniel           Reinhart            Daniel.Reinhart@x1ps7cGziqt.com\n10  AAAAAAAAAMHPIBAA         Christopher              Scott  Christopher.Scott@Pk0l8u52eU9sBI3TnI7.com\n11  AAAAAAAAADHMPAAA             Melissa              Fusco             Melissa.Fusco@JpEmIQAboqbk.com\n12  AAAAAAAALMPAGBAA               David            Grissom                   David.Grissom@2Uylkl.org\n13  AAAAAAAADHIBPAAA             Barbara             Lawson          Barbara.Lawson@qFJlcnEto4CArD.edu\n14  AAAAAAAAJDLAPAAA            Michelle             Moreno      Michelle.Moreno@gmpG5REcHBixUEPdm.org\n15  AAAAAAAADGEHIAAA               Jenna             Tucker                     Jenna.Tucker@eQaU6.org\n16  AAAAAAAALIJNHBAA              Jerome           Williams           Jerome.Williams@7NfA6vp8JJPe.org\n17  AAAAAAAACEDHNAAA              Pamela               Cook              Pamela.Cook@97cK6OL05Esrj.com\n18  AAAAAAAAOGKGOAAA               Brian            Kennedy                      Brian.Kennedy@vdM.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 4.100084,
                    "execution_time": 3.747798,
                    "compile_time": 0.141199,
                    "planning_time": 0.148752
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 17.267102,
                    "execution_time": 10.18706,
                    "compile_time": 6.909719,
                    "planning_time": 0.212873
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "WITH YEAR_TOTAL AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                     customer_email_address\n0   AAAAAAAAONEOEBAA           Josephine              Nance                     Josephine.Nance@uN.com\n1   AAAAAAAAHLFMDAAA              Tyrone           Ferguson                     Tyrone.Ferguson@Y1.com\n2   AAAAAAAAOAGONAAA                Kurt            Blakely                Kurt.Blakely@UxGY9fqKOf.com\n3   AAAAAAAAEMFOLBAA                Lynn             Rogers                         Lynn.Rogers@LR.com\n4   AAAAAAAACFFPHAAA              Marlen             Lawson                  Marlen.Lawson@XoUAuly.edu\n5   AAAAAAAAMJPNLAAA                John             Herron                       John.Herron@7grT.com\n6   AAAAAAAAHAHPKAAA              Donald               Hill           Donald.Hill@rlsG4cz2K331ZX3H.org\n7   AAAAAAAADNOHKBAA               Renee            Mcclain            Renee.Mcclain@QvHGnlMHZ5hO2.com\n8   AAAAAAAADBOCIAAA                 Jay              Mount                         Jay.Mount@BMiP.edu\n9   AAAAAAAAONFPPAAA              Daniel           Reinhart            Daniel.Reinhart@x1ps7cGziqt.com\n10  AAAAAAAAAMHPIBAA         Christopher              Scott  Christopher.Scott@Pk0l8u52eU9sBI3TnI7.com\n11  AAAAAAAAADHMPAAA             Melissa              Fusco             Melissa.Fusco@JpEmIQAboqbk.com\n12  AAAAAAAALMPAGBAA               David            Grissom                   David.Grissom@2Uylkl.org\n13  AAAAAAAADHIBPAAA             Barbara             Lawson          Barbara.Lawson@qFJlcnEto4CArD.edu\n14  AAAAAAAAJDLAPAAA            Michelle             Moreno      Michelle.Moreno@gmpG5REcHBixUEPdm.org\n15  AAAAAAAADGEHIAAA               Jenna             Tucker                     Jenna.Tucker@eQaU6.org\n16  AAAAAAAALIJNHBAA              Jerome           Williams           Jerome.Williams@7NfA6vp8JJPe.org\n17  AAAAAAAACEDHNAAA              Pamela               Cook              Pamela.Cook@97cK6OL05Esrj.com\n18  AAAAAAAAOGKGOAAA               Brian            Kennedy                      Brian.Kennedy@vdM.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 10.292595,
                    "execution_time": 9.61129,
                    "compile_time": 0.000922,
                    "planning_time": 0.046218,
                    "create_size": 2304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.292569,
                    "execution_time": 9.590392,
                    "compile_time": 0.000913,
                    "planning_time": 0.045726,
                    "create_size": 2304
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.877863,
                    "execution_time": 0.460698,
                    "compile_time": 0.000487,
                    "planning_time": 0.014379,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.250857,
                    "execution_time": 0.443499,
                    "compile_time": 9.471406,
                    "planning_time": 0.071692,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                   customer_email_address\n0   AAAAAAAADDEIABAA                Mike             Cooper               Mike.Cooper@NNT5HxyJkH.edu\n1   AAAAAAAAPKGJGBAA             Barbara               Root                       Barbara.Root@s.edu\n2   AAAAAAAAPCBAKAAA                Dane             Weaver                        Dane.Weaver@j.edu\n3   AAAAAAAAEEAGOAAA              Martin         Farrington        Martin.Farrington@xRUeoqlSG6S.com\n4   AAAAAAAAAMHNABAA                Carl            Sharkey             Carl.Sharkey@aBYqJqPJQKU.com\n5   AAAAAAAADDFLCAAA            Salvador           Robinson  Salvador.Robinson@Kqeukjx5Hduizgren.edu\n6   AAAAAAAANIGNABAA            Jonathon             Boothe         Jonathon.Boothe@DlVy2bppu0If.org\n7   AAAAAAAABJOEDBAA               Leroy             Montes              Leroy.Montes@NYeQBR073K.edu\n8   AAAAAAAALMNJCAAA             Freddie              Keefe                    Freddie.Keefe@PZz.com\n9   AAAAAAAAFKCPGBAA             Phillip           Phillips           Phillip.Phillips@s1JtEdxip.org\n10  AAAAAAAAKFFDKBAA                Lois               Ball           Lois.Ball@d8tCaSe8doJMQAGR.com\n11  AAAAAAAADOCHAAAA               James               Tate            James.Tate@JTeABgjT7pkgSb.org\n12  AAAAAAAACEHPDAAA               Karen             Snyder                  Karen.Snyder@F8QJUZ.org\n13  AAAAAAAAGKHHDBAA              Arthur           Franklin                Arthur.Franklin@0HbNj.org\n14  AAAAAAAAPAMEOBAA           Stephanie             Rivera         Stephanie.Rivera@BGgjn7opdX0.edu\n15  AAAAAAAAHIGGHAAA               Ralph              Scott            Ralph.Scott@9gJeMUKtZdt07.com\n16  AAAAAAAAMHKBCAAA                Lori                                                            \n17  AAAAAAAACBMMPAAA             William               Lamb                William.Lamb@dy1QaQic.org\n18  AAAAAAAAGBAGBBAA              Thelma            Flowers          Thelma.Flowers@15Ft0g9lLvT6.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017866,
                    "execution_time": 0.007775,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.003659
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053552,
                    "execution_time": 0.007797,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038763
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                   customer_email_address\n0   AAAAAAAADDEIABAA                Mike             Cooper               Mike.Cooper@NNT5HxyJkH.edu\n1   AAAAAAAAPKGJGBAA             Barbara               Root                       Barbara.Root@s.edu\n2   AAAAAAAAPCBAKAAA                Dane             Weaver                        Dane.Weaver@j.edu\n3   AAAAAAAAEEAGOAAA              Martin         Farrington        Martin.Farrington@xRUeoqlSG6S.com\n4   AAAAAAAAAMHNABAA                Carl            Sharkey             Carl.Sharkey@aBYqJqPJQKU.com\n5   AAAAAAAADDFLCAAA            Salvador           Robinson  Salvador.Robinson@Kqeukjx5Hduizgren.edu\n6   AAAAAAAANIGNABAA            Jonathon             Boothe         Jonathon.Boothe@DlVy2bppu0If.org\n7   AAAAAAAABJOEDBAA               Leroy             Montes              Leroy.Montes@NYeQBR073K.edu\n8   AAAAAAAALMNJCAAA             Freddie              Keefe                    Freddie.Keefe@PZz.com\n9   AAAAAAAAFKCPGBAA             Phillip           Phillips           Phillip.Phillips@s1JtEdxip.org\n10  AAAAAAAAKFFDKBAA                Lois               Ball           Lois.Ball@d8tCaSe8doJMQAGR.com\n11  AAAAAAAADOCHAAAA               James               Tate            James.Tate@JTeABgjT7pkgSb.org\n12  AAAAAAAACEHPDAAA               Karen             Snyder                  Karen.Snyder@F8QJUZ.org\n13  AAAAAAAAGKHHDBAA              Arthur           Franklin                Arthur.Franklin@0HbNj.org\n14  AAAAAAAAPAMEOBAA           Stephanie             Rivera         Stephanie.Rivera@BGgjn7opdX0.edu\n15  AAAAAAAAHIGGHAAA               Ralph              Scott            Ralph.Scott@9gJeMUKtZdt07.com\n16  AAAAAAAAMHKBCAAA                Lori                                                            \n17  AAAAAAAACBMMPAAA             William               Lamb                William.Lamb@dy1QaQic.org\n18  AAAAAAAAGBAGBBAA              Thelma            Flowers          Thelma.Flowers@15Ft0g9lLvT6.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and (case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end) > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.856511,
                    "execution_time": 0.443243,
                    "compile_time": 0.000494,
                    "planning_time": 0.015187,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.634161,
                    "execution_time": 0.463876,
                    "compile_time": 10.791148,
                    "planning_time": 0.073977,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAIKHLAAAA               Sarah             Landry                    Sarah.Landry@7.org\n1   AAAAAAAAJEJPEBAA            Jennifer            Garrett         Jennifer.Garrett@6TS13pll.edu\n2   AAAAAAAAIAMDGBAA               Alvin           Gonzalez     Alvin.Gonzalez@jGqaTN8KgMbsis.edu\n3   AAAAAAAACCKOHAAA             Charles             Thomas         Charles.Thomas@vBEdyXHKj7.com\n4   AAAAAAAALKHMNBAA              Joseph           Lawrence   Joseph.Lawrence@uZdHhiyQQGrXVZh.edu\n5   AAAAAAAACDOBGBAA              Suanne               Nagy            Suanne.Nagy@DN2RunrDRj.com\n6   AAAAAAAAKGBIFBAA              Alfred             Lowell               Alfred.Lowell@cE68L.org\n7   AAAAAAAAKDFAGAAA                Fred                Lee                        Fred.Lee@I.edu\n8   AAAAAAAAPECJMBAA              Marsha          Stevenson   Marsha.Stevenson@vM41ymx8CLiSzh.org\n9   AAAAAAAAHMEFDAAA               Donna               Hall                     Donna.Hall@RR.edu\n10  AAAAAAAAOFAAHBAA         Christopher             Wright  Christopher.Wright@vEtHfrdN7apdM.edu\n11  AAAAAAAACCBLPAAA            Michelle             Dailey           Michelle.Dailey@Fc9onxp.edu\n12  AAAAAAAAEFBOAAAA               Erika           Montalvo       Erika.Montalvo@OVa0F0XapNNd.edu\n13  AAAAAAAAAHHCMBAA              Angela             Romero                                      \n14  AAAAAAAAPGMDKAAA             Marilyn           Bautista     Marilyn.Bautista@hPD6CS6RLDcf.com\n15  AAAAAAAACOJHDBAA                                   Hunt                                      \n16  AAAAAAAAECHPOAAA                Anne               Camp             Anne.Camp@jbBO7TuzPvj.org\n17  AAAAAAAAANPPFAAA                 Ann              Moore        Ann.Moore@ydsgCCAVqepGONRA.com\n18  AAAAAAAAAADCOBAA            Brittany               Hill            Brittany.Hill@d8jaz43P.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017094,
                    "execution_time": 0.007587,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003565
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053316,
                    "execution_time": 0.008333,
                    "compile_time": 5e-05,
                    "planning_time": 0.038875
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAIKHLAAAA               Sarah             Landry                    Sarah.Landry@7.org\n1   AAAAAAAAJEJPEBAA            Jennifer            Garrett         Jennifer.Garrett@6TS13pll.edu\n2   AAAAAAAAIAMDGBAA               Alvin           Gonzalez     Alvin.Gonzalez@jGqaTN8KgMbsis.edu\n3   AAAAAAAACCKOHAAA             Charles             Thomas         Charles.Thomas@vBEdyXHKj7.com\n4   AAAAAAAALKHMNBAA              Joseph           Lawrence   Joseph.Lawrence@uZdHhiyQQGrXVZh.edu\n5   AAAAAAAACDOBGBAA              Suanne               Nagy            Suanne.Nagy@DN2RunrDRj.com\n6   AAAAAAAAKGBIFBAA              Alfred             Lowell               Alfred.Lowell@cE68L.org\n7   AAAAAAAAKDFAGAAA                Fred                Lee                        Fred.Lee@I.edu\n8   AAAAAAAAPECJMBAA              Marsha          Stevenson   Marsha.Stevenson@vM41ymx8CLiSzh.org\n9   AAAAAAAAHMEFDAAA               Donna               Hall                     Donna.Hall@RR.edu\n10  AAAAAAAAOFAAHBAA         Christopher             Wright  Christopher.Wright@vEtHfrdN7apdM.edu\n11  AAAAAAAACCBLPAAA            Michelle             Dailey           Michelle.Dailey@Fc9onxp.edu\n12  AAAAAAAAEFBOAAAA               Erika           Montalvo       Erika.Montalvo@OVa0F0XapNNd.edu\n13  AAAAAAAAAHHCMBAA              Angela             Romero                                      \n14  AAAAAAAAPGMDKAAA             Marilyn           Bautista     Marilyn.Bautista@hPD6CS6RLDcf.com\n15  AAAAAAAACOJHDBAA                                   Hunt                                      \n16  AAAAAAAAECHPOAAA                Anne               Camp             Anne.Camp@jbBO7TuzPvj.org\n17  AAAAAAAAANPPFAAA                 Ann              Moore        Ann.Moore@ydsgCCAVqepGONRA.com\n18  AAAAAAAAAADCOBAA            Brittany               Hill            Brittany.Hill@d8jaz43P.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.847925,
                    "execution_time": 0.497631,
                    "compile_time": 0.000473,
                    "planning_time": 0.016205,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.5616,
                    "execution_time": 0.471055,
                    "compile_time": 9.892695,
                    "planning_time": 0.085472,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                   customer_email_address\n0   AAAAAAAAOLOPMAAA              Mathew            Barrera        Mathew.Barrera@B2ZexSKTz4sHgA.com\n1   AAAAAAAAHOIICBAA              Melody          Cornelius         Melody.Cornelius@RsZSpfagsQv.com\n2   AAAAAAAABGLELBAA              Marita              Heard                   Marita.Heard@Bo4iY.org\n3   AAAAAAAAPPGMNBAA            Virginia            Johnson        Virginia.Johnson@vK9TQUMPUKUs.org\n4   AAAAAAAAIPCLEBAA              Roland              Estes         Roland.Estes@6F0l1rlQkM0GmhJ.org\n5   AAAAAAAALLALAAAA            Jonathan             Taylor                  Jonathan.Taylor@i0n.com\n6   AAAAAAAAOGNAAAAA             Carlota            Coleman           Carlota.Coleman@1lnYbuOP61.org\n7   AAAAAAAAGLEODAAA                Troy            Braxton                    Troy.Braxton@v3ZJ.edu\n8   AAAAAAAAFGOBAAAA              Barbra              Allen                      Barbra.Allen@Kk.org\n9   AAAAAAAAPJDJLAAA              Thomas           Reynolds            Thomas.Reynolds@fkLFxipEx.edu\n10  AAAAAAAAHIFNGBAA                                                 Fernando.Washington@3nccqdj.edu\n11  AAAAAAAAJOLNDAAA                Jeff               East                Jeff.East@cQlvF4EC1DN.org\n12  AAAAAAAACFFDDBAA             Rebecca              Henry           Rebecca.Henry@EFUjTsjsNtJO.com\n13  AAAAAAAAGBCCHBAA                 Sue             Thomas                Sue.Thomas@UKhyj6xra1.com\n14  AAAAAAAAIJLBABAA             William            Hoskins  William.Hoskins@NLcYtvuLoSTH8jfmAVX.org\n15  AAAAAAAAPINPHBAA                Ilda           Gallegos              Ilda.Gallegos@1DUsP9UGT.com\n16  AAAAAAAAHGKKIAAA               Tyler           Crawford          Tyler.Crawford@J2G2pOz3LPxL.com\n17  AAAAAAAANLFCHBAA             Rogelio              Jones               Rogelio.Jones@htnCPaCd.edu\n18  AAAAAAAADNJFGBAA                 Lee            Parrish           Lee.Parrish@l3vRjJxs03fBB5.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016752,
                    "execution_time": 0.007494,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003357
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053973,
                    "execution_time": 0.008138,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038467
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                   customer_email_address\n0   AAAAAAAAOLOPMAAA              Mathew            Barrera        Mathew.Barrera@B2ZexSKTz4sHgA.com\n1   AAAAAAAAHOIICBAA              Melody          Cornelius         Melody.Cornelius@RsZSpfagsQv.com\n2   AAAAAAAABGLELBAA              Marita              Heard                   Marita.Heard@Bo4iY.org\n3   AAAAAAAAPPGMNBAA            Virginia            Johnson        Virginia.Johnson@vK9TQUMPUKUs.org\n4   AAAAAAAAIPCLEBAA              Roland              Estes         Roland.Estes@6F0l1rlQkM0GmhJ.org\n5   AAAAAAAALLALAAAA            Jonathan             Taylor                  Jonathan.Taylor@i0n.com\n6   AAAAAAAAOGNAAAAA             Carlota            Coleman           Carlota.Coleman@1lnYbuOP61.org\n7   AAAAAAAAGLEODAAA                Troy            Braxton                    Troy.Braxton@v3ZJ.edu\n8   AAAAAAAAFGOBAAAA              Barbra              Allen                      Barbra.Allen@Kk.org\n9   AAAAAAAAPJDJLAAA              Thomas           Reynolds            Thomas.Reynolds@fkLFxipEx.edu\n10  AAAAAAAAHIFNGBAA                                                 Fernando.Washington@3nccqdj.edu\n11  AAAAAAAAJOLNDAAA                Jeff               East                Jeff.East@cQlvF4EC1DN.org\n12  AAAAAAAACFFDDBAA             Rebecca              Henry           Rebecca.Henry@EFUjTsjsNtJO.com\n13  AAAAAAAAGBCCHBAA                 Sue             Thomas                Sue.Thomas@UKhyj6xra1.com\n14  AAAAAAAAIJLBABAA             William            Hoskins  William.Hoskins@NLcYtvuLoSTH8jfmAVX.org\n15  AAAAAAAAPINPHBAA                Ilda           Gallegos              Ilda.Gallegos@1DUsP9UGT.com\n16  AAAAAAAAHGKKIAAA               Tyler           Crawford          Tyler.Crawford@J2G2pOz3LPxL.com\n17  AAAAAAAANLFCHBAA             Rogelio              Jones               Rogelio.Jones@htnCPaCd.edu\n18  AAAAAAAADNJFGBAA                 Lee            Parrish           Lee.Parrish@l3vRjJxs03fBB5.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021007,
                    "execution_time": 0.010473,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003621
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.186837,
                    "execution_time": 0.010178,
                    "compile_time": 0.130779,
                    "planning_time": 0.038649
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019732,
                    "execution_time": 0.009872,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.003739
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.15459,
                    "execution_time": 0.009979,
                    "compile_time": 0.099863,
                    "planning_time": 0.03866
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020271,
                    "execution_time": 0.010086,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.003912
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.154267,
                    "execution_time": 0.010359,
                    "compile_time": 0.098436,
                    "planning_time": 0.039003
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020992,
                    "execution_time": 0.010661,
                    "compile_time": 8e-05,
                    "planning_time": 0.004012
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.155208,
                    "execution_time": 0.010732,
                    "compile_time": 0.098712,
                    "planning_time": 0.039244
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021223,
                    "execution_time": 0.010765,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.003996
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020472,
                    "execution_time": 0.010105,
                    "compile_time": 8e-05,
                    "planning_time": 0.00397
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/"
    }
]