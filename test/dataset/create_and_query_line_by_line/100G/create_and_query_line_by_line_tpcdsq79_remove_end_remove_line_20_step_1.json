[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name, c_first_name, substring(s_city, 1, 30), ss_ticket_number, amt, profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n          ,customer.c_last_name\n          ,customer.c_first_name\n    from store_sales, date_dim, store, household_demographics, customer\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_customer_sk = customer.c_customer_sk\n    group by ss_ticket_number, ss_customer_sk, store.s_city, customer.c_last_name, customer.c_first_name\n   ) as derived_table\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_TABLE\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_TABLE\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 6.726694,
                    "execution_time": 5.900829,
                    "compile_time": 0.14122,
                    "planning_time": 0.055659,
                    "create_size": 2304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 24.259863,
                    "execution_time": 8.075747,
                    "compile_time": 15.39408,
                    "planning_time": 0.139787,
                    "create_size": 2304
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0       Gruber       Teresa         Bethel          22633357   393.60  -6357.63\n1                                Greenwood          21977393  1383.46 -10737.53\n2        Jones     Margaret          Salem          21141977     0.00  -9098.00\n3       Bailey      Natacha       Fairview           9140122  1124.96  -8449.18\n4     Anderson       Justin    Centerville          18233949   632.70  -8110.69\n5       Decker        Glenn       Fairview          15238704  1189.49 -14157.45\n6      Farrell     Gretchen        Liberty           7641350  2155.30 -16420.43\n7       Murphy        James  Pleasant Hill          19744277  3104.04 -15295.85\n8     Boudreau       Thomas    Centerville           8977810  2134.01  -7629.88\n9       Siegel          Ann          Union          17950293  7423.83 -12702.23\n10        Ruiz        Cindy        Liberty          22736689   106.39   1736.15\n11   Gilchrist        Brian       Fairview          23995438  4336.28 -12791.44\n12      Fender      Yolanda        Liberty          21994814    12.83    312.16\n13      Brooks       Walter  Pleasant Hill          12701737   388.65  -8283.05\n14       Stone        Alice         Midway          12245804  6499.47  -7030.51\n15      Garcia       Piedad       Fairview           8983738  5691.13 -21553.28\n16    Woodward         Saul          Union          13749424     0.00  -3267.62\n17       Salas         Lois    Five Points           4749270  1545.35 -11753.46\n18       Barry       Jimmie         Midway          20995054    65.77  -3963.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046075,
                    "execution_time": 0.008075,
                    "compile_time": 0.02722,
                    "planning_time": 0.004152
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.153797,
                    "execution_time": 0.008302,
                    "compile_time": 3.094428,
                    "planning_time": 0.039791
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0       Gruber       Teresa         Bethel          22633357   393.60  -6357.63\n1                                Greenwood          21977393  1383.46 -10737.53\n2        Jones     Margaret          Salem          21141977     0.00  -9098.00\n3       Bailey      Natacha       Fairview           9140122  1124.96  -8449.18\n4     Anderson       Justin    Centerville          18233949   632.70  -8110.69\n5       Decker        Glenn       Fairview          15238704  1189.49 -14157.45\n6      Farrell     Gretchen        Liberty           7641350  2155.30 -16420.43\n7       Murphy        James  Pleasant Hill          19744277  3104.04 -15295.85\n8     Boudreau       Thomas    Centerville           8977810  2134.01  -7629.88\n9       Siegel          Ann          Union          17950293  7423.83 -12702.23\n10        Ruiz        Cindy        Liberty          22736689   106.39   1736.15\n11   Gilchrist        Brian       Fairview          23995438  4336.28 -12791.44\n12      Fender      Yolanda        Liberty          21994814    12.83    312.16\n13      Brooks       Walter  Pleasant Hill          12701737   388.65  -8283.05\n14       Stone        Alice         Midway          12245804  6499.47  -7030.51\n15      Garcia       Piedad       Fairview           8983738  5691.13 -21553.28\n16    Woodward         Saul          Union          13749424     0.00  -3267.62\n17       Salas         Lois    Five Points           4749270  1545.35 -11753.46\n18       Barry       Jimmie         Midway          20995054    65.77  -3963.53\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city\n   ) as derived_table",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.27636,
                    "execution_time": 2.780699,
                    "compile_time": 0.00042,
                    "planning_time": 0.05816,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.474849,
                    "execution_time": 2.781885,
                    "compile_time": 8.090941,
                    "planning_time": 0.129545,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*            _col_0  ss_ticket_number      amt    profit\n0      Shady Grove          23197709      NaN   -582.66\n1        Greenwood           8203813  4899.66 -10659.15\n2            Salem           7401834  1009.86  -9303.38\n3   Pleasant Grove           5974847  4083.10  -5733.11\n4         Fairview          22370477    29.43  -4392.60\n5      Centerville           3615846   533.86  -7830.13\n6         Fairview           4404202   695.97  -9341.64\n7      Centerville           5223813   383.38  -4724.31\n8           Bethel          23114216  1825.40 -19758.52\n9                           16490638   429.71  -8419.84\n10        New Hope          19369789   458.58  -2056.98\n11         Oakland          10417863   251.38  -8327.68\n12         Oakland          10417863     0.00       NaN\n13          Bethel          14247858     0.00  -1104.67\n14        Fairview          11399120  2034.32    674.03\n15     Centerville           6657096     0.00  -4559.73\n16          Bethel          18896256  3640.18 -11480.33\n17       Riverside          12905846  4571.74  -7034.31\n18          Bethel          15897351  4538.19  -4906.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.131815,
                    "execution_time": 0.008218,
                    "compile_time": 0.113011,
                    "planning_time": 0.003954
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.399007,
                    "execution_time": 0.008242,
                    "compile_time": 3.340385,
                    "planning_time": 0.039327
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*            _col_0  ss_ticket_number      amt    profit\n0      Shady Grove          23197709      NaN   -582.66\n1        Greenwood           8203813  4899.66 -10659.15\n2            Salem           7401834  1009.86  -9303.38\n3   Pleasant Grove           5974847  4083.10  -5733.11\n4         Fairview          22370477    29.43  -4392.60\n5      Centerville           3615846   533.86  -7830.13\n6         Fairview           4404202   695.97  -9341.64\n7      Centerville           5223813   383.38  -4724.31\n8           Bethel          23114216  1825.40 -19758.52\n9                           16490638   429.71  -8419.84\n10        New Hope          19369789   458.58  -2056.98\n11         Oakland          10417863   251.38  -8327.68\n12         Oakland          10417863     0.00       NaN\n13          Bethel          14247858     0.00  -1104.67\n14        Fairview          11399120  2034.32    674.03\n15     Centerville           6657096     0.00  -4559.73\n16          Bethel          18896256  3640.18 -11480.33\n17       Riverside          12905846  4571.74  -7034.31\n18          Bethel          15897351  4538.19  -4906.33\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city\n   ) as derived_table",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.424668,
                    "execution_time": 0.914961,
                    "compile_time": 0.000434,
                    "planning_time": 0.050874,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.088421,
                    "execution_time": 0.919187,
                    "compile_time": 8.590169,
                    "planning_time": 0.127894,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*             _col_0  ss_ticket_number      amt    profit\n0       Five Points          15316427   218.22 -17865.90\n1            Bethel           5852393     0.00  -3754.70\n2          New Hope           4067344  1826.28 -13413.17\n3           Oakland           8563464   254.15  -9020.92\n4           Oakland          20866718     0.00  -8556.31\n5           Oakland           8563464      NaN  -3881.78\n6    Pleasant Grove          15325878    77.21  -1435.89\n7    Pleasant Grove          15325878     0.00  -1276.80\n8           Liberty           5864024  1171.08  -9581.25\n9       Shady Grove           4819290     0.00  -5417.69\n10      Centerville          20145479  6926.52 -17149.71\n11    Pleasant Hill           4822882     0.00 -12585.67\n12           Midway           5574146  1002.62  -8928.30\n13        Riverside           8579191   107.56    193.99\n14   Mount Pleasant          19843530  1933.64  -1264.07\n15    Pleasant Hill          20897278  1848.58  -8558.93\n16    Pleasant Hill          20897278      NaN       NaN\n17  Pleasant Valley           1842928  4529.44 -12545.68\n18      Five Points           3627608  9539.39 -14038.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018011,
                    "execution_time": 0.007559,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004123
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.137472,
                    "execution_time": 0.007834,
                    "compile_time": 0.080739,
                    "planning_time": 0.039693
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*             _col_0  ss_ticket_number      amt    profit\n0       Five Points          15316427   218.22 -17865.90\n1            Bethel           5852393     0.00  -3754.70\n2          New Hope           4067344  1826.28 -13413.17\n3           Oakland           8563464   254.15  -9020.92\n4           Oakland          20866718     0.00  -8556.31\n5           Oakland           8563464      NaN  -3881.78\n6    Pleasant Grove          15325878    77.21  -1435.89\n7    Pleasant Grove          15325878     0.00  -1276.80\n8           Liberty           5864024  1171.08  -9581.25\n9       Shady Grove           4819290     0.00  -5417.69\n10      Centerville          20145479  6926.52 -17149.71\n11    Pleasant Hill           4822882     0.00 -12585.67\n12           Midway           5574146  1002.62  -8928.30\n13        Riverside           8579191   107.56    193.99\n14   Mount Pleasant          19843530  1933.64  -1264.07\n15    Pleasant Hill          20897278  1848.58  -8558.93\n16    Pleasant Hill          20897278      NaN       NaN\n17  Pleasant Valley           1842928  4529.44 -12545.68\n18      Five Points           3627608  9539.39 -14038.42\n...*/"
    },
    {
        "input": "select /* TPC-DS query79.tpl 0.89 */ \n  c_last_name, c_first_name, substring(s_city,1,30), ss_ticket_number, amt, profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n          ,customer.c_last_name\n          ,customer.c_first_name\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    join customer on store_sales.ss_customer_sk = customer.c_customer_sk\n    where (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999, 1999+1, 1999+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city, customer.c_last_name, customer.c_first_name\n   ) derived_alias",
        "optimize": [
            "WITH \"DERIVED_ALIAS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_ALIAS\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_ALIAS\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_ALIAS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_ALIAS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_ALIAS\".\"AMT\" AS \"AMT\" , \"DERIVED_ALIAS\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_ALIAS\" AS \"DERIVED_ALIAS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.747089,
                    "execution_time": 1.045906,
                    "compile_time": 0.000642,
                    "planning_time": 0.059472,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.19612,
                    "execution_time": 1.052003,
                    "compile_time": 9.343963,
                    "planning_time": 0.140845,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name          _col_2  ss_ticket_number      amt    profit\n0      Dickens        David  Pleasant Grove           3682480  1775.06 -13924.36\n1         Bell       Pamela        New Hope          15736360  1128.19  -4885.41\n2     Williams      Charles        Fairview          21524508  2851.59 -15455.94\n3       Parker      Marilyn           Union          14187349  5397.67  -5125.57\n4       Sutton      Darrell  Pleasant Grove          12495585    71.04 -11017.57\n5      Brennan        Wilma   Pleasant Hill          12685789   200.11  -9688.98\n6     Martinez        Lydia     Five Points           4485444  1656.99 -13220.02\n7         King       Pamela     Five Points           8966759   987.16  -6610.35\n8        Wiley        Debra        New Hope           6525801  5507.33 -22449.96\n9        Perry        Pedro     Five Points          19444210  1052.85  -3327.14\n10    Lombardo      Kathryn          Bethel           9899911   263.46 -12612.46\n11      Finley        Joyce        New Hope           5403533   981.88   2921.19\n12     Navarro       Sandra  Pleasant Grove           3910720  2281.87 -15171.96\n13      Morton       Milton           Union           7658424   932.76 -20668.63\n14    Brownlee         Jodi          Midway           4295591  1023.00  -2902.73\n15        Lowe          Amy         Liberty          21911516    51.92 -10917.31\n16   Sylvester                  Shady Grove           5785052  1273.36 -13316.41\n17                     Leah        Fairview          21168727     0.00  -7582.07\n18      Barber        Jerri           Salem          10667258  6762.60 -10092.87\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018273,
                    "execution_time": 0.007732,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004043
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.199327,
                    "execution_time": 0.00803,
                    "compile_time": 0.142344,
                    "planning_time": 0.039709
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name          _col_2  ss_ticket_number      amt    profit\n0      Dickens        David  Pleasant Grove           3682480  1775.06 -13924.36\n1         Bell       Pamela        New Hope          15736360  1128.19  -4885.41\n2     Williams      Charles        Fairview          21524508  2851.59 -15455.94\n3       Parker      Marilyn           Union          14187349  5397.67  -5125.57\n4       Sutton      Darrell  Pleasant Grove          12495585    71.04 -11017.57\n5      Brennan        Wilma   Pleasant Hill          12685789   200.11  -9688.98\n6     Martinez        Lydia     Five Points           4485444  1656.99 -13220.02\n7         King       Pamela     Five Points           8966759   987.16  -6610.35\n8        Wiley        Debra        New Hope           6525801  5507.33 -22449.96\n9        Perry        Pedro     Five Points          19444210  1052.85  -3327.14\n10    Lombardo      Kathryn          Bethel           9899911   263.46 -12612.46\n11      Finley        Joyce        New Hope           5403533   981.88   2921.19\n12     Navarro       Sandra  Pleasant Grove           3910720  2281.87 -15171.96\n13      Morton       Milton           Union           7658424   932.76 -20668.63\n14    Brownlee         Jodi          Midway           4295591  1023.00  -2902.73\n15        Lowe          Amy         Liberty          21911516    51.92 -10917.31\n16   Sylvester                  Shady Grove           5785052  1273.36 -13316.41\n17                     Leah        Fairview          21168727     0.00  -7582.07\n18      Barber        Jerri           Salem          10667258  6762.60 -10092.87\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    where (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number, ss_customer_sk, store.s_city /* Ensure non-aggregated columns are included here */\n/*CURSOR_IDENTIFIER*/) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n;",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SALES_SUMMARY\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"AMT\" AS \"AMT\" , \"SALES_SUMMARY\".\"PROFIT\" AS \"PROFIT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.439238,
                    "execution_time": 0.900012,
                    "compile_time": 0.00056,
                    "planning_time": 0.051037,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.144789,
                    "execution_time": 1.159368,
                    "compile_time": 8.339367,
                    "planning_time": 0.137245,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.313398,
                    "execution_time": 0.503556,
                    "compile_time": 0.155474,
                    "planning_time": 0.026097,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.965258,
                    "execution_time": 0.611317,
                    "compile_time": 6.636705,
                    "planning_time": 0.086227,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name           _col_2  ss_ticket_number      amt    profit\n0      Williams     Jennifer        Riverside          13836918  4102.91 -12070.36\n1      Blackmon        Doris      Shady Grove          13214312  2009.19    529.25\n2      Blackmon        Doris      Centerville          17528049  1485.60 -12281.23\n3         Doyle         Fred           Midway          20486135  9096.95  -6014.60\n4        Foster      William          Oakland           5344327  5273.29 -12137.68\n5       Stewart         Reba   Mount Pleasant          20648966     0.00  -6632.34\n6        Morton       Miguel            Union          19906838    25.63  -5636.71\n7         Jones     Claribel          Liberty          16279768  2566.60 -12840.28\n8        Howard        Erika   Pleasant Grove           8048914  1977.40  -2675.80\n9        Waters                   Shady Grove           6018586   536.82  -8605.47\n10        Lloyd         John    Pleasant Hill           3961756    25.64   1974.95\n11         Cole       Howard        Oak Grove          13483876     0.00  -8401.57\n12      Collins      Timothy  Pleasant Valley           4853958  1917.65  -7984.07\n13        Bates         Inez      Shady Grove          23482623  2601.96 -12502.11\n14  Christopher       Teresa           Bethel           9641088  4043.00 -17769.07\n15      Johnson      Marilyn           Midway           6325111  5743.59 -12611.87\n16     Whitmore      Rebecca           Bethel          14034523   418.60  -7933.20\n17        Swank         Anne           Midway           3160257   159.66  -5446.25\n18       Osgood      Carolyn            Union          23327837  3161.01 -12979.19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0511,
                    "execution_time": 0.00847,
                    "compile_time": 0.032469,
                    "planning_time": 0.003909
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.125168,
                    "execution_time": 0.008174,
                    "compile_time": 3.067987,
                    "planning_time": 0.039474
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name           _col_2  ss_ticket_number      amt    profit\n0      Williams     Jennifer        Riverside          13836918  4102.91 -12070.36\n1      Blackmon        Doris      Shady Grove          13214312  2009.19    529.25\n2      Blackmon        Doris      Centerville          17528049  1485.60 -12281.23\n3         Doyle         Fred           Midway          20486135  9096.95  -6014.60\n4        Foster      William          Oakland           5344327  5273.29 -12137.68\n5       Stewart         Reba   Mount Pleasant          20648966     0.00  -6632.34\n6        Morton       Miguel            Union          19906838    25.63  -5636.71\n7         Jones     Claribel          Liberty          16279768  2566.60 -12840.28\n8        Howard        Erika   Pleasant Grove           8048914  1977.40  -2675.80\n9        Waters                   Shady Grove           6018586   536.82  -8605.47\n10        Lloyd         John    Pleasant Hill           3961756    25.64   1974.95\n11         Cole       Howard        Oak Grove          13483876     0.00  -8401.57\n12      Collins      Timothy  Pleasant Valley           4853958  1917.65  -7984.07\n13        Bates         Inez      Shady Grove          23482623  2601.96 -12502.11\n14  Christopher       Teresa           Bethel           9641088  4043.00 -17769.07\n15      Johnson      Marilyn           Midway           6325111  5743.59 -12611.87\n16     Whitmore      Rebecca           Bethel          14034523   418.60  -7933.20\n17        Swank         Anne           Midway           3160257   159.66  -5446.25\n18       Osgood      Carolyn            Union          23327837  3161.01 -12979.19\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.189601,
                    "execution_time": 0.7126,
                    "compile_time": 0.000432,
                    "planning_time": 0.051934,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.027651,
                    "execution_time": 0.75643,
                    "compile_time": 4.711117,
                    "planning_time": 0.126205,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name           _col_2  ss_ticket_number      amt    profit\n0        Young         Fred           Bethel          19306699   320.88  -7589.60\n1        Young         Fred  Pleasant Valley          23856868     0.00  -4388.56\n2        Young         Fred  Pleasant Valley          23856868      NaN    620.31\n3        Young         Fred           Midway          10366918   959.30 -13934.62\n4        Young         Fred        Oak Grove          14561514  3275.75 -16453.85\n5        Young         Fred           Midway           2847919   463.82  -6738.47\n6        Young         Fred         New Hope           4365764  1875.29  -5129.17\n7        Young         Fred           Midway           9310942  1170.91  -4607.49\n8        Young         Fred      Centerville          23075188  6138.70 -14313.72\n9        Young         Fred   Pleasant Grove           4370212  2661.25  -2128.39\n10       Young         Fred            Salem          15630865   846.52  -8946.98\n11       Young         Fred           Midway          17836589     0.00  -1951.72\n12       Young         Fred      Five Points           7830770  5378.39 -16111.58\n13       Young         Fred   Pleasant Grove           8092433  2838.83  -2041.70\n14       Young         Fred   Pleasant Grove           8092433      NaN       NaN\n15       Young         Fred   Pleasant Grove            621633  6409.95  -9538.34\n16       Young         Fred      Centerville           9343470  1125.01  -7882.95\n17       Young         Fred      Centerville          12346694     0.00  -5704.17\n18       Young         Fred            Union           2102614  1677.37 -13591.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.116669,
                    "execution_time": 0.082378,
                    "compile_time": 0.071553,
                    "planning_time": 0.0262
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.212839,
                    "execution_time": 0.088584,
                    "compile_time": 3.114354,
                    "planning_time": 0.080371
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name           _col_2  ss_ticket_number      amt    profit\n0        Young         Fred           Bethel          19306699   320.88  -7589.60\n1        Young         Fred  Pleasant Valley          23856868     0.00  -4388.56\n2        Young         Fred  Pleasant Valley          23856868      NaN    620.31\n3        Young         Fred           Midway          10366918   959.30 -13934.62\n4        Young         Fred        Oak Grove          14561514  3275.75 -16453.85\n5        Young         Fred           Midway           2847919   463.82  -6738.47\n6        Young         Fred         New Hope           4365764  1875.29  -5129.17\n7        Young         Fred           Midway           9310942  1170.91  -4607.49\n8        Young         Fred      Centerville          23075188  6138.70 -14313.72\n9        Young         Fred   Pleasant Grove           4370212  2661.25  -2128.39\n10       Young         Fred            Salem          15630865   846.52  -8946.98\n11       Young         Fred           Midway          17836589     0.00  -1951.72\n12       Young         Fred      Five Points           7830770  5378.39 -16111.58\n13       Young         Fred   Pleasant Grove           8092433  2838.83  -2041.70\n14       Young         Fred   Pleasant Grove           8092433      NaN       NaN\n15       Young         Fred   Pleasant Grove            621633  6409.95  -9538.34\n16       Young         Fred      Centerville           9343470  1125.01  -7882.95\n17       Young         Fred      Centerville          12346694     0.00  -5704.17\n18       Young         Fred            Union           2102614  1677.37 -13591.37\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.419324,
                    "execution_time": 0.87436,
                    "compile_time": 0.000566,
                    "planning_time": 0.05185,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.924689,
                    "execution_time": 0.9036,
                    "compile_time": 4.377923,
                    "planning_time": 0.148566,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.194153,
                    "execution_time": 0.467902,
                    "compile_time": 0.000481,
                    "planning_time": 0.075843,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.301883,
                    "execution_time": 0.479586,
                    "compile_time": 0.080747,
                    "planning_time": 0.089294,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name          _col_2  ss_ticket_number      amt    profit\n0       Wesley        Linda          Midway          19249541  1602.13 -13246.42\n1      Johnson       Robert  Pleasant Grove           9414116  3268.54 -12144.14\n2                                 Oak Grove           9899760  2056.52 -13907.57\n3     Crabtree      Melissa         Oakland           1714991   664.87 -13639.03\n4     Hatfield         Lori       Oak Grove          13009852   176.43 -13059.10\n5       Nguyen      Patrice       Oak Grove           1540031    11.77  -7169.40\n6       Murphy      William       Riverside          11947542   279.38  -4402.69\n7         Crow       Victor          Midway          12350889  5120.58  -5784.20\n8         Crow       Victor        New Hope           4486282  1349.55 -15945.51\n9        Smith      Natalie     Centerville          20317305   732.98 -10186.64\n10        Nash                     Fairview           3693080     0.00   4360.47\n11       Evans        Susan         Liberty           5306907    18.21 -11354.56\n12       Evans        Susan     Shady Grove          11117953   332.10  -5928.00\n13      Miller      Randall  Pleasant Grove          17077823   884.46 -14109.37\n14    Thompson       Sandra     Five Points          21722397  3112.41    671.01\n15       Drake       Nicole         Liberty           5691410   612.39   2519.65\n16       Garza          Tim          Bethel           5025222  1928.35 -29685.67\n17       Jones      Barbara  Pleasant Grove          13767158  3081.17  -9502.65\n18      Flores       Robert         Oakland           8536148   147.90  -5215.46\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018951,
                    "execution_time": 0.008482,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.003984
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.089335,
                    "execution_time": 0.007754,
                    "compile_time": 0.03308,
                    "planning_time": 0.039622
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name          _col_2  ss_ticket_number      amt    profit\n0       Wesley        Linda          Midway          19249541  1602.13 -13246.42\n1      Johnson       Robert  Pleasant Grove           9414116  3268.54 -12144.14\n2                                 Oak Grove           9899760  2056.52 -13907.57\n3     Crabtree      Melissa         Oakland           1714991   664.87 -13639.03\n4     Hatfield         Lori       Oak Grove          13009852   176.43 -13059.10\n5       Nguyen      Patrice       Oak Grove           1540031    11.77  -7169.40\n6       Murphy      William       Riverside          11947542   279.38  -4402.69\n7         Crow       Victor          Midway          12350889  5120.58  -5784.20\n8         Crow       Victor        New Hope           4486282  1349.55 -15945.51\n9        Smith      Natalie     Centerville          20317305   732.98 -10186.64\n10        Nash                     Fairview           3693080     0.00   4360.47\n11       Evans        Susan         Liberty           5306907    18.21 -11354.56\n12       Evans        Susan     Shady Grove          11117953   332.10  -5928.00\n13      Miller      Randall  Pleasant Grove          17077823   884.46 -14109.37\n14    Thompson       Sandra     Five Points          21722397  3112.41    671.01\n15       Drake       Nicole         Liberty           5691410   612.39   2519.65\n16       Garza          Tim          Bethel           5025222  1928.35 -29685.67\n17       Jones      Barbara  Pleasant Grove          13767158  3081.17  -9502.65\n18      Flores       Robert         Oakland           8536148   147.90  -5215.46\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) , \"PROFIT\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number      amt    profit\n0                                            3681245  3988.15 -25899.01\n1                                           14967548  7381.82 -22784.12\n2                                           22797904   391.38 -21455.17\n3                                           15743643  6636.76 -21451.14\n4                                           17696835  3219.38 -21165.92\n5                                           20417943   572.97 -19803.21\n6                                            1439863  7778.54 -17798.51\n7                                           18860115  2148.48 -17317.83\n8                                            5514766   624.37 -17211.37\n9                                            3220026  4522.20 -16846.21\n10                                          22755435  2931.56 -15420.54\n11                                          10271259  1961.26 -14463.57\n12                                           4936005   533.72 -14054.81\n13                                          19205573   233.73 -13526.86\n14                                          11099729  3472.33 -12959.88\n15                                          22478272  2015.50 -12695.69\n16                                           5311316  3236.58 -12381.87\n17                                           2788710   143.55 -12205.86\n18                                          10337932  6201.68 -12017.32\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.194748,
                    "execution_time": 0.142131,
                    "compile_time": 0.01515,
                    "planning_time": 0.027375
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.183743,
                    "execution_time": 0.141724,
                    "compile_time": 5.053265,
                    "planning_time": 0.083988
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number      amt    profit\n0                                            3681245  3988.15 -25899.01\n1                                           14967548  7381.82 -22784.12\n2                                           22797904   391.38 -21455.17\n3                                           15743643  6636.76 -21451.14\n4                                           17696835  3219.38 -21165.92\n5                                           20417943   572.97 -19803.21\n6                                            1439863  7778.54 -17798.51\n7                                           18860115  2148.48 -17317.83\n8                                            5514766   624.37 -17211.37\n9                                            3220026  4522.20 -16846.21\n10                                          22755435  2931.56 -15420.54\n11                                          10271259  1961.26 -14463.57\n12                                           4936005   533.72 -14054.81\n13                                          19205573   233.73 -13526.86\n14                                          11099729  3472.33 -12959.88\n15                                          22478272  2015.50 -12695.69\n16                                           5311316  3236.58 -12381.87\n17                                           2788710   143.55 -12205.86\n18                                          10337932  6201.68 -12017.32\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) , \"PROFIT\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number      amt    profit\n0                                            3681245  3988.15 -25899.01\n1                                           14967548  7381.82 -22784.12\n2                                           22797904   391.38 -21455.17\n3                                           15743643  6636.76 -21451.14\n4                                           17696835  3219.38 -21165.92\n5                                           20417943   572.97 -19803.21\n6                                            1439863  7778.54 -17798.51\n7                                           18860115  2148.48 -17317.83\n8                                            5514766   624.37 -17211.37\n9                                            3220026  4522.20 -16846.21\n10                                          22755435  2931.56 -15420.54\n11                                          10271259  1961.26 -14463.57\n12                                           4936005   533.72 -14054.81\n13                                          19205573   233.73 -13526.86\n14                                          11099729  3472.33 -12959.88\n15                                          22478272  2015.50 -12695.69\n16                                           5311316  3236.58 -12381.87\n17                                           2788710   143.55 -12205.86\n18                                          10337932  6201.68 -12017.32\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.182099,
                    "execution_time": 0.143932,
                    "compile_time": 0.000172,
                    "planning_time": 0.027768
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.177689,
                    "execution_time": 0.139767,
                    "compile_time": 0.000362,
                    "planning_time": 0.02718
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name _col_2  ss_ticket_number      amt    profit\n0                                            3681245  3988.15 -25899.01\n1                                           14967548  7381.82 -22784.12\n2                                           22797904   391.38 -21455.17\n3                                           15743643  6636.76 -21451.14\n4                                           17696835  3219.38 -21165.92\n5                                           20417943   572.97 -19803.21\n6                                            1439863  7778.54 -17798.51\n7                                           18860115  2148.48 -17317.83\n8                                            5514766   624.37 -17211.37\n9                                            3220026  4522.20 -16846.21\n10                                          22755435  2931.56 -15420.54\n11                                          10271259  1961.26 -14463.57\n12                                           4936005   533.72 -14054.81\n13                                          19205573   233.73 -13526.86\n14                                          11099729  3472.33 -12959.88\n15                                          22478272  2015.50 -12695.69\n16                                           5311316  3236.58 -12381.87\n17                                           2788710   143.55 -12205.86\n18                                          10337932  6201.68 -12017.32\n...*/"
    }
]