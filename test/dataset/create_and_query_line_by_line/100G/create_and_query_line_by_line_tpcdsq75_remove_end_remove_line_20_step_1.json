[
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT * FROM all_sales /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"D_YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"ALL_SALES\".\"SALES_CNT\" AS \"SALES_CNT\" , \"ALL_SALES\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"ALL_SALES\" AS \"ALL_SALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.113931,
                    "execution_time": 0.047039,
                    "compile_time": 0.000241,
                    "planning_time": 0.02588,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.170965,
                    "execution_time": 0.043559,
                    "compile_time": 0.000239,
                    "planning_time": 0.086339,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.182841,
                    "execution_time": 0.054998,
                    "compile_time": 0.052399,
                    "planning_time": 0.033116,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.660509,
                    "execution_time": 0.091031,
                    "compile_time": 3.432871,
                    "planning_time": 0.087098,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.201101,
                    "execution_time": 7.684788,
                    "compile_time": 0.001199,
                    "planning_time": 0.10795,
                    "create_size": 2304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 28.930613,
                    "execution_time": 10.028747,
                    "compile_time": 19.835287,
                    "planning_time": 0.099508,
                    "create_size": 2304
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.571015,
                    "execution_time": 0.404578,
                    "compile_time": 0.068556,
                    "planning_time": 0.005386,
                    "create_size": 570
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.432088,
                    "execution_time": 0.404256,
                    "compile_time": 6.866022,
                    "planning_time": 0.062216,
                    "create_size": 580
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_CNT\" AS \"SALES_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    d_year  i_brand_id  i_class_id  i_category_id  i_manufact_id  sales_cnt    sales_amt\n0     1998     4004001           4              4            178     273474  12269030.41\n1     2001     4004002           4              4             94      94101   4039695.48\n2     2002     4002002           6              4            231      44362   1989255.05\n3     2001     4001002           1              4            115      93112   4017094.06\n4     2002     4001002           1              4            871      89595   3877761.18\n5     1999     4003002           3              4            438      46461   2037634.77\n6     2002     4003002           3              4            156      88774   3778378.36\n7     2000     4003002           3              4            325     139917   6052493.63\n8     2001     6015003          15              4            123      46726   2105109.60\n9     1999     4001001           1              4             49     221987   9665336.32\n10    2000     4002002           2              4            416     131398   5574688.52\n11    2000     4004001           4              4            255      92634   3932244.13\n12    1998     4002002           2              4            287      90724   3914335.69\n13    2000     4002002           2              4            618      43357   2003994.35\n14    1999     4004002           4              4            914      49206   2193326.23\n15    1999     4003001           3              4            656     179572   7585519.02\n16    2001     4002002           2              4            549      45202   1925401.59\n17    1999     4001001           1              4             44     310661  13432973.88\n18    2001     4001002           1              4            529      91569   3874011.84\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.048592,
                    "execution_time": 0.007524,
                    "compile_time": 0.030543,
                    "planning_time": 0.003961
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.170288,
                    "execution_time": 0.007993,
                    "compile_time": 3.112589,
                    "planning_time": 0.039669
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_CNT\" AS \"SALES_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_CNT\" AS \"SALES_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    d_year  i_brand_id  i_class_id  i_category_id  i_manufact_id  sales_cnt    sales_amt\n0     1998     4004001           4              4            178     273474  12269030.41\n1     2001     4004002           4              4             94      94101   4039695.48\n2     2002     4002002           6              4            231      44362   1989255.05\n3     2001     4001002           1              4            115      93112   4017094.06\n4     2002     4001002           1              4            871      89595   3877761.18\n5     1999     4003002           3              4            438      46461   2037634.77\n6     2002     4003002           3              4            156      88774   3778378.36\n7     2000     4003002           3              4            325     139917   6052493.63\n8     2001     6015003          15              4            123      46726   2105109.60\n9     1999     4001001           1              4             49     221987   9665336.32\n10    2000     4002002           2              4            416     131398   5574688.52\n11    2000     4004001           4              4            255      92634   3932244.13\n12    1998     4002002           2              4            287      90724   3914335.69\n13    2000     4002002           2              4            618      43357   2003994.35\n14    1999     4004002           4              4            914      49206   2193326.23\n15    1999     4003001           3              4            656     179572   7585519.02\n16    2001     4002002           2              4            549      45202   1925401.59\n17    1999     4001001           1              4             44     310661  13432973.88\n18    2001     4001002           1              4            529      91569   3874011.84\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON item.i_item_sk=catalog_sales.cs_item_sk\n                          JOIN date_dim ON date_dim.d_date_sk=catalog_sales.cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (catalog_sales.cs_order_number=catalog_returns.cr_order_number \n                                                    AND catalog_sales.cs_item_sk=catalog_returns.cr_item_sk)\n       WHERE item.i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON item.i_item_sk=store_sales.ss_item_sk\n                        JOIN date_dim ON date_dim.d_date_sk=store_sales.ss_sold_date_sk\n                        LEFT JOIN store_returns ON (store_sales.ss_ticket_number=store_returns.sr_ticket_number \n                                                AND store_sales.ss_item_sk=store_returns.sr_item_sk)\n       WHERE item.i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON item.i_item_sk=web_sales.ws_item_sk\n                      JOIN date_dim ON date_dim.d_date_sk=web_sales.ws_sold_date_sk\n                      LEFT JOIN web_returns ON (web_sales.ws_order_number=web_returns.wr_order_number \n                                            AND web_sales.ws_item_sk=web_returns.wr_item_sk)\n       WHERE item.i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  all_sales.d_year AS prev_year\n/*CURSOR_IDENTIFIER*/ FROM all_sales",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"ALL_SALES\" AS \"ALL_SALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.116547,
                    "execution_time": 7.618246,
                    "compile_time": 0.001117,
                    "planning_time": 0.097208,
                    "create_size": 2304
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 20.577646,
                    "execution_time": 7.717084,
                    "compile_time": 12.19546,
                    "planning_time": 0.219335,
                    "create_size": 2304
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.300571,
                    "execution_time": 0.263665,
                    "compile_time": 0.000296,
                    "planning_time": 0.004083,
                    "create_size": 232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.710168,
                    "execution_time": 0.257072,
                    "compile_time": 0.354644,
                    "planning_time": 0.060683,
                    "create_size": 232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    prev_year\n0        2000\n1        2000\n2        2000\n3        2000\n4        1999\n5        1999\n6        1999\n7        1999\n8        1999\n9        1999\n10       1999\n11       1999\n12       1999\n13       1999\n14       1998\n15       1998\n16       1998\n17       1998\n18       1998\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01532,
                    "execution_time": 0.006809,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002934
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053376,
                    "execution_time": 0.007106,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038058
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    prev_year\n0        2000\n1        2000\n2        2000\n3        2000\n4        1999\n5        1999\n6        1999\n7        1999\n8        1999\n9        1999\n10       1999\n11       1999\n12       1999\n13       1999\n14       1998\n15       1998\n16       1998\n17       1998\n18       1998\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year\n      ,curr_yr.d_year AS year\n/*CURSOR_IDENTIFIER*/\nFROM all_sales prev_yr\n     JOIN all_sales curr_yr ON prev_yr.i_brand_id = curr_yr.i_brand_id\n                              AND prev_yr.i_class_id = curr_yr.i_class_id\n                              AND prev_yr.i_category_id = curr_yr.i_category_id\n                              AND prev_yr.i_manufact_id = curr_yr.i_manufact_id\n                              AND prev_yr.d_year = curr_yr.d_year - 1",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"ALL_SALES\" AS \"PREV_YR\" JOIN \"ALL_SALES\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.333606,
                    "execution_time": 0.270777,
                    "compile_time": 0.000296,
                    "planning_time": 0.004579,
                    "create_size": 456
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.591702,
                    "execution_time": 0.272942,
                    "compile_time": 0.19591,
                    "planning_time": 0.060276,
                    "create_size": 440
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"PREV_YR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.244947,
                    "execution_time": 0.057915,
                    "compile_time": 0.143853,
                    "planning_time": 0.00685,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.539679,
                    "execution_time": 0.071474,
                    "compile_time": 6.361134,
                    "planning_time": 0.062253,
                    "create_size": 200
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*    prev_year  year\n0        2000  2001\n1        2000  2001\n2        2000  2001\n3        2000  2001\n4        2000  2001\n5        2000  2001\n6        1998  1999\n7        1998  1999\n8        1998  1999\n9        1998  1999\n10       1998  1999\n11       1999  2000\n12       1999  2000\n13       1999  2000\n14       1998  1999\n15       1998  1999\n16       1998  1999\n17       1998  1999\n18       1998  1999\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015844,
                    "execution_time": 0.007033,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003014
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054296,
                    "execution_time": 0.007839,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038137
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"PREV_YR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*    prev_year  year\n0        2000  2001\n1        2000  2001\n2        2000  2001\n3        2000  2001\n4        2000  2001\n5        2000  2001\n6        1998  1999\n7        1998  1999\n8        1998  1999\n9        1998  1999\n10       1998  1999\n11       1999  2000\n12       1999  2000\n13       1999  2000\n14       1998  1999\n15       1998  1999\n16       1998  1999\n17       1998  1999\n18       1998  1999\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT a1.d_year - 1 AS prev_year\n      ,a1.d_year AS year\n      ,a1.i_brand_id\n/*CURSOR_IDENTIFIER*/\nFROM all_sales a1\nJOIN all_sales a2 ON a1.i_brand_id = a2.i_brand_id\n                 AND a1.i_class_id = a2.i_class_id\n                 AND a1.i_category_id = a2.i_category_id\n                 AND a1.i_manufact_id = a2.i_manufact_id\n                 AND a1.d_year = a2.d_year - 1;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"ALL_SALES\" AS \"A1\" JOIN \"ALL_SALES\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"A1\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.167645,
                    "execution_time": 0.057388,
                    "compile_time": 0.062134,
                    "planning_time": 0.006776,
                    "create_size": 234
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.617655,
                    "execution_time": 0.071421,
                    "compile_time": 6.434912,
                    "planning_time": 0.062944,
                    "create_size": 234
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id\n0        2001  2002     4002002\n1        2001  2002     4003002\n2        2001  2002     4002001\n3        2001  2002     2004001\n4        2001  2002     4003001\n5        2001  2002     4002002\n6        2001  2002     4002002\n7        2001  2002     7010009\n8        2001  2002     4002002\n9        2001  2002     7002007\n10       2001  2002     9007005\n11       2001  2002     4002002\n12       2001  2002     4004002\n13       2001  2002     4004002\n14       2001  2002     8009005\n15       2001  2002     3004001\n16       2001  2002     4004002\n17       2001  2002     4003002\n18       2001  2002     4001002\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033057,
                    "execution_time": 0.007263,
                    "compile_time": 0.016697,
                    "planning_time": 0.003256
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.137151,
                    "execution_time": 0.007693,
                    "compile_time": 3.081002,
                    "planning_time": 0.038174
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"A1\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id\n0        2001  2002     4002002\n1        2001  2002     4003002\n2        2001  2002     4002001\n3        2001  2002     2004001\n4        2001  2002     4003001\n5        2001  2002     4002002\n6        2001  2002     4002002\n7        2001  2002     7010009\n8        2001  2002     4002002\n9        2001  2002     7002007\n10       2001  2002     9007005\n11       2001  2002     4002002\n12       2001  2002     4004002\n13       2001  2002     4004002\n14       2001  2002     8009005\n15       2001  2002     3004001\n16       2001  2002     4004002\n17       2001  2002     4003002\n18       2001  2002     4001002\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  NULL AS prev_year\n                          ,NULL AS year\n                          ,NULL AS i_brand_id\n                          ,NULL AS i_class_id\n                          ,NULL AS i_category_id\n                          ,NULL AS i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*  prev_year  year i_brand_id i_class_id i_category_id i_manufact_id\n0      None  None       None       None          None          None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.662584,
                    "execution_time": 0.458741,
                    "compile_time": 0.000341,
                    "planning_time": 0.074691
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.674556,
                    "execution_time": 0.471556,
                    "compile_time": 0.000355,
                    "planning_time": 0.074631
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\"",
                "rewrite": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\""
            }
        ],
        "preview": "\n/*  prev_year  year i_brand_id i_class_id i_category_id i_manufact_id\n0      None  None       None       None          None          None*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')) sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  lag(d_year, 1) over (PARTITION BY i_brand_id, i_class_id, i_category_id, i_manufact_id ORDER BY d_year) AS prev_year\n                          ,d_year AS year\n                          ,i_brand_id\n                          ,i_class_id\n                          ,i_category_id\n                          ,i_manufact_id\n                          ,SUM(sales_cnt) AS prev_yr_cnt\nFROM all_sales\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' GROUP BY \"ITEM\".\"I_CATEGORY_ID\" ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_0\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" LEFT JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_1\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_2\".\"I_CATEGORY_ID\" IS NULL ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT LAG ( \"ALL_SALES\".\"D_YEAR\" , 1 ) OVER ( PARTITION BY \"ALL_SALES\".\"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" ORDER BY \"ALL_SALES\".\"D_YEAR\" NULLS LAST ) AS \"PREV_YEAR\" , \"ALL_SALES\".\"D_YEAR\" AS \"YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"ALL_SALES\".\"SALES_CNT\" ) AS \"PREV_YR_CNT\" FROM \"ALL_SALES\" AS \"ALL_SALES\" GROUP BY \"ALL_SALES\".\"D_YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.395518,
                    "execution_time": 0.081386,
                    "compile_time": 0.071746,
                    "planning_time": 0.025411,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.709494,
                    "execution_time": 0.081808,
                    "compile_time": 3.318692,
                    "planning_time": 0.084798,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' GROUP BY \"ITEM\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08437,
                    "execution_time": 0.035161,
                    "compile_time": 0.000268,
                    "planning_time": 0.024435,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.286725,
                    "execution_time": 0.034531,
                    "compile_time": 0.138086,
                    "planning_time": 0.084332,
                    "create_size": 8
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_11\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_1\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_2\".\"I_CATEGORY_ID\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY_ID IN ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY_ID IN ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY_ID IN ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' ) ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) SELECT LAG ( D_YEAR , 1 ) OVER ( PARTITION BY I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ORDER BY D_YEAR NULLS FIRST ) AS PREV_YEAR , D_YEAR AS YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS PREV_YR_CNT FROM ALL_SALES GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt\n0      2002.0  2003     1001001           1              4             56          772\n1      2001.0  2002     1001001           1              4             56        45374\n2         NaN  2001     1001001           1              4             56        44129\n3      2002.0  2003     1001001           1              4            162          579\n4      2001.0  2002     1001001           1              4            162        46009\n5         NaN  2001     1001001           1              4            162        45818\n6      2002.0  2003     1001001           1              4            250          737\n7      2001.0  2002     1001001           1              4            250        44134\n8         NaN  2001     1001001           1              4            250        42225\n9      2000.0  2001     1001001           1              4            263        43469\n10        NaN  2000     1001001           1              4            263        41996\n11     2002.0  2003     1001001           1              4            539          571\n12        NaN  2002     1001001           1              4            539        46432\n13     2000.0  2001     1001001           1              4            585        48134\n14        NaN  2000     1001001           1              4            585        46108\n15     2002.0  2003     1001001           1              4            644          478\n16        NaN  2002     1001001           1              4            644        43810\n17     2002.0  2003     1001001           1              4            888          258\n18        NaN  2002     1001001           1              4            888        46598\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.597437,
                    "execution_time": 5.30379,
                    "compile_time": 0.050828,
                    "planning_time": 0.282178
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 24.525246,
                    "execution_time": 5.359222,
                    "compile_time": 18.924821,
                    "planning_time": 3.659358
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt\n0      2002.0  2003     1001001           1              4             56          772\n1      2001.0  2002     1001001           1              4             56        45374\n2         NaN  2001     1001001           1              4             56        44129\n3      2002.0  2003     1001001           1              4            162          579\n4      2001.0  2002     1001001           1              4            162        46009\n5         NaN  2001     1001001           1              4            162        45818\n6      2002.0  2003     1001001           1              4            250          737\n7      2001.0  2002     1001001           1              4            250        44134\n8         NaN  2001     1001001           1              4            250        42225\n9      2000.0  2001     1001001           1              4            263        43469\n10        NaN  2000     1001001           1              4            263        41996\n11     2002.0  2003     1001001           1              4            539          571\n12        NaN  2002     1001001           1              4            539        46432\n13     2000.0  2001     1001001           1              4            585        48134\n14        NaN  2000     1001001           1              4            585        46108\n15     2002.0  2003     1001001           1              4            644          478\n16        NaN  2002     1001001           1              4            644        43810\n17     2002.0  2003     1001001           1              4            888          258\n18        NaN  2002     1001001           1              4            888        46598\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)) sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id),\n prev_yr AS (\n   SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt\n   FROM all_sales \n   WHERE d_year = (SELECT MAX(d_year) FROM all_sales) - 1\n ), \n curr_yr AS (\n   SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt\n   FROM all_sales \n   WHERE d_year = (SELECT MAX(d_year) FROM all_sales)\n )\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n/*CURSOR_IDENTIFIER*/ \nFROM prev_yr \nJOIN curr_yr \nON prev_yr.i_brand_id = curr_yr.i_brand_id \nAND prev_yr.i_class_id = curr_yr.i_class_id \nAND prev_yr.i_category_id = curr_yr.i_category_id \nAND prev_yr.i_manufact_id = curr_yr.i_manufact_id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' LIMIT 1 ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) , \"_U_3\" AS ( SELECT MAX ( \"ALL_SALES\".\"D_YEAR\" ) AS \"_COL_0\" FROM \"ALL_SALES\" AS \"ALL_SALES\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"PREV_YEAR\" , \"ALL_SALES_2\".\"D_YEAR\" AS \"YEAR\" , \"ALL_SALES_2\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES_2\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES_2\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"ALL_SALES\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"ALL_SALES_2\".\"SALES_CNT\" AS \"CURR_YR_CNT\" FROM \"ALL_SALES\" AS \"ALL_SALES\" JOIN \"_U_3\" AS \"_U_3\" ON \"ALL_SALES\".\"D_YEAR\" = \"_U_3\".\"_COL_0\" - 1 JOIN \"ALL_SALES\" AS \"ALL_SALES_2\" ON \"ALL_SALES\".\"I_BRAND_ID\" = \"ALL_SALES_2\".\"I_BRAND_ID\" AND \"ALL_SALES\".\"I_CATEGORY_ID\" = \"ALL_SALES_2\".\"I_CATEGORY_ID\" AND \"ALL_SALES\".\"I_CLASS_ID\" = \"ALL_SALES_2\".\"I_CLASS_ID\" AND \"ALL_SALES\".\"I_MANUFACT_ID\" = \"ALL_SALES_2\".\"I_MANUFACT_ID\" JOIN \"_U_3\" AS \"_U_4\" ON \"_U_4\".\"_COL_0\" = \"ALL_SALES_2\".\"D_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.06252,
                    "execution_time": 0.036054,
                    "compile_time": 0.000242,
                    "planning_time": 0.002867,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.122547,
                    "execution_time": 0.036024,
                    "compile_time": 0.000264,
                    "planning_time": 0.058429,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) , PREV_YR AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SALES_CNT FROM ALL_SALES WHERE D_YEAR = ( SELECT MAX ( D_YEAR ) FROM ALL_SALES ) - 1 ) , CURR_YR AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SALES_CNT FROM ALL_SALES WHERE D_YEAR = ( SELECT MAX ( D_YEAR ) FROM ALL_SALES ) ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT FROM PREV_YR JOIN CURR_YR ON PREV_YR.I_BRAND_ID = CURR_YR.I_BRAND_ID AND PREV_YR.I_CLASS_ID = CURR_YR.I_CLASS_ID AND PREV_YR.I_CATEGORY_ID = CURR_YR.I_CATEGORY_ID AND PREV_YR.I_MANUFACT_ID = CURR_YR.I_MANUFACT_ID",
                "preview": "\n/*      prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt\n0          2002  2003     4001002           1              4            442        91447         1521\n1          2002  2003     7009001           9              4            166        43800         1069\n2          2002  2003     4001002           1              4             49       182215         2153\n3          2002  2003     4004001           4              4            250        44813          730\n4          2002  2003     4001001           1              4            470       136064         2318\n5          2002  2003     1004001           4              4            270        44540          869\n6          2002  2003     4002002           2              4             72       139122         1416\n7          2002  2003     4004002           3              4            934        43950          826\n8          2002  2003     4003002           3              4             74       189384         2567\n9          2002  2003     4004001           4              4            139        44715          908\n10         2002  2003     4002002           2              4            206       181723         2741\n11         2002  2003     8001005           1              4            414        45437          848\n12         2002  2003     4004001           4              4            556        44962          796\n13         2002  2003     2003002           3              4            522        46458          609\n14         2002  2003     4003002           3              4            385       130575         2111\n15         2002  2003     6005006           2              4             39        44552          943\n16         2002  2003     4001002           1              4            231       136306         2373\n17         2002  2003     4003002           3              4            303       312231         3257\n18         2002  2003     4003001           4              4             26        43713          873\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 9.730783,
                    "execution_time": 8.108574,
                    "compile_time": 0.322161,
                    "planning_time": 9.296142
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 24.513465,
                    "execution_time": 9.777658,
                    "compile_time": 13.324531,
                    "planning_time": 17.266638
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*      prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt\n0          2002  2003     4001002           1              4            442        91447         1521\n1          2002  2003     7009001           9              4            166        43800         1069\n2          2002  2003     4001002           1              4             49       182215         2153\n3          2002  2003     4004001           4              4            250        44813          730\n4          2002  2003     4001001           1              4            470       136064         2318\n5          2002  2003     1004001           4              4            270        44540          869\n6          2002  2003     4002002           2              4             72       139122         1416\n7          2002  2003     4004002           3              4            934        43950          826\n8          2002  2003     4003002           3              4             74       189384         2567\n9          2002  2003     4004001           4              4            139        44715          908\n10         2002  2003     4002002           2              4            206       181723         2741\n11         2002  2003     8001005           1              4            414        45437          848\n12         2002  2003     4004001           4              4            556        44962          796\n13         2002  2003     2003002           3              4            522        46458          609\n14         2002  2003     4003002           3              4            385       130575         2111\n15         2002  2003     6005006           2              4             39        44552          943\n16         2002  2003     4001002           1              4            231       136306         2373\n17         2002  2003     4003002           3              4            303       312231         3257\n18         2002  2003     4003001           4              4             26        43713          873\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" CROSS JOIN \"ALL_SALES\" AS \"PREV_YR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.481678,
                    "execution_time": 0.385219,
                    "compile_time": 0.000298,
                    "planning_time": 0.005365,
                    "create_size": 580
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.694428,
                    "execution_time": 0.431541,
                    "compile_time": 0.109352,
                    "planning_time": 0.06195,
                    "create_size": 580
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4002001           2              4            716       184576        42144         -142432     -6203445.53\n1        1999  2000     4002001           2              4            716        91436        42144          -49292     -2112115.92\n2        1999  2000     4002001           2              4            716       280078        42144         -237934    -10398389.01\n3        1999  2000     4002001           2              4            716       131865        42144          -89721     -3817875.95\n4        1999  2000     4002001           2              4            716       135409        42144          -93265     -4072419.41\n5        1999  2000     4002001           2              4            716        89394        42144          -47250     -2106178.89\n6        1999  2000     4002001           2              4            716       179005        42144         -136861     -5942427.16\n7        1999  2000     4002001           2              4            716        90012        42144          -47868     -2222520.86\n8        1999  2000     4002001           2              4            716        87422        42144          -45278     -2119493.13\n9        1999  2000     4002001           2              4            716        46602        42144           -4458      -352483.90\n10       1999  2000     4002001           2              4            716       363774        42144         -321630    -14582033.24\n11       1999  2000     4002001           2              4            716        88544        42144          -46400     -2242503.98\n12       1999  2000     4002001           2              4            716       228989        42144         -186845     -7927113.25\n13       1999  2000     4002001           2              4            716        92349        42144          -50205     -2295797.85\n14       1999  2000     4002001           2              4            716        90626        42144          -48482     -2167027.69\n15       1999  2000     4002001           2              4            716       134299        42144          -92155     -4030492.29\n16       1999  2000     4002001           2              4            716        43166        42144           -1022      -210540.21\n17       1999  2000     4002001           2              4            716       365642        42144         -323498    -14037253.96\n18       1999  2000     4002001           2              4            716       177201        42144         -135057     -5967030.32\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031307,
                    "execution_time": 0.017146,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.006403
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.350662,
                    "execution_time": 0.070241,
                    "compile_time": 3.28835,
                    "planning_time": 0.041335
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\"",
                "rewrite": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4002001           2              4            716       184576        42144         -142432     -6203445.53\n1        1999  2000     4002001           2              4            716        91436        42144          -49292     -2112115.92\n2        1999  2000     4002001           2              4            716       280078        42144         -237934    -10398389.01\n3        1999  2000     4002001           2              4            716       131865        42144          -89721     -3817875.95\n4        1999  2000     4002001           2              4            716       135409        42144          -93265     -4072419.41\n5        1999  2000     4002001           2              4            716        89394        42144          -47250     -2106178.89\n6        1999  2000     4002001           2              4            716       179005        42144         -136861     -5942427.16\n7        1999  2000     4002001           2              4            716        90012        42144          -47868     -2222520.86\n8        1999  2000     4002001           2              4            716        87422        42144          -45278     -2119493.13\n9        1999  2000     4002001           2              4            716        46602        42144           -4458      -352483.90\n10       1999  2000     4002001           2              4            716       363774        42144         -321630    -14582033.24\n11       1999  2000     4002001           2              4            716        88544        42144          -46400     -2242503.98\n12       1999  2000     4002001           2              4            716       228989        42144         -186845     -7927113.25\n13       1999  2000     4002001           2              4            716        92349        42144          -50205     -2295797.85\n14       1999  2000     4002001           2              4            716        90626        42144          -48482     -2167027.69\n15       1999  2000     4002001           2              4            716       134299        42144          -92155     -4030492.29\n16       1999  2000     4002001           2              4            716        43166        42144           -1022      -210540.21\n17       1999  2000     4002001           2              4            716       365642        42144         -323498    -14037253.96\n18       1999  2000     4002001           2              4            716       177201        42144         -135057     -5967030.32\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" AND \"PREV_YR\".\"I_BRAND_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" AND \"PREV_YR\".\"I_BRAND_ID\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  1999     4001001           1              4            108       225990       184576          -41414     -2149131.74\n1        1998  1999     4001001           1              4            108       135615       184576           48961      2027653.27\n2        1998  1999     4001001           1              4            108       184989       184576            -413      -278086.37\n3        1998  1999     4001001           1              4            108       185299       184576            -723        59329.42\n4        1998  1999     4001001           1              4            108        92284       184576           92292      4027712.24\n5        1998  1999     4001001           1              4            108        46653       184576          137923      5799796.63\n6        1998  1999     4001001           1              4            108        87151       184576           97425      4219351.23\n7        1998  1999     4001001           1              4            108        43218       184576          141358      5934468.24\n8        1998  1999     4001001           1              4            108        91663       184576           92913      4003154.06\n9        1998  1999     4001001           1              4            108       263883       184576          -79307     -3629545.77\n10       1998  1999     4001001           1              4            108        86343       184576           98233      4326015.48\n11       1998  1999     4001001           1              4            108       133664       184576           50912      2127586.60\n12       1998  1999     4001001           1              4            108       178854       184576            5722       298562.68\n13       1998  1999     4001001           1              4            108       177089       184576            7487       372543.95\n14       1998  1999     4001001           1              4            108        44769       184576          139807      5838493.52\n15       1998  1999     4001001           1              4            108       140196       184576           44380      1874810.58\n16       1998  1999     4001001           1              4            108       306998       184576         -122422     -5277901.92\n17       1998  1999     4001001           1              4            108       132153       184576           52423      2275410.03\n18       1998  1999     4001001           1              4            108       132275       184576           52301      2213943.57\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.062182,
                    "execution_time": 0.017352,
                    "compile_time": 0.03612,
                    "planning_time": 0.007937
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.338888,
                    "execution_time": 0.017441,
                    "compile_time": 3.262367,
                    "planning_time": 0.043446
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\"",
                "rewrite": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" AND \"PREV_YR\".\"I_BRAND_ID\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  1999     4001001           1              4            108       225990       184576          -41414     -2149131.74\n1        1998  1999     4001001           1              4            108       135615       184576           48961      2027653.27\n2        1998  1999     4001001           1              4            108       184989       184576            -413      -278086.37\n3        1998  1999     4001001           1              4            108       185299       184576            -723        59329.42\n4        1998  1999     4001001           1              4            108        92284       184576           92292      4027712.24\n5        1998  1999     4001001           1              4            108        46653       184576          137923      5799796.63\n6        1998  1999     4001001           1              4            108        87151       184576           97425      4219351.23\n7        1998  1999     4001001           1              4            108        43218       184576          141358      5934468.24\n8        1998  1999     4001001           1              4            108        91663       184576           92913      4003154.06\n9        1998  1999     4001001           1              4            108       263883       184576          -79307     -3629545.77\n10       1998  1999     4001001           1              4            108        86343       184576           98233      4326015.48\n11       1998  1999     4001001           1              4            108       133664       184576           50912      2127586.60\n12       1998  1999     4001001           1              4            108       178854       184576            5722       298562.68\n13       1998  1999     4001001           1              4            108       177089       184576            7487       372543.95\n14       1998  1999     4001001           1              4            108        44769       184576          139807      5838493.52\n15       1998  1999     4001001           1              4            108       140196       184576           44380      1874810.58\n16       1998  1999     4001001           1              4            108       306998       184576         -122422     -5277901.92\n17       1998  1999     4001001           1              4            108       132153       184576           52423      2275410.03\n18       1998  1999     4001001           1              4            108       132275       184576           52301      2213943.57\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.065531,
                    "execution_time": 4.518758,
                    "compile_time": 0.000591,
                    "planning_time": 0.00718,
                    "create_size": 6016
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.008557,
                    "execution_time": 4.611295,
                    "compile_time": 6.778597,
                    "planning_time": 0.067334,
                    "create_size": 6016
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2003  1998     4004001           4              4            141          682       225990          225308     10066463.75\n1        2003  1998     4004001           4              4            141         1137       225990          224853     10047328.44\n2        2003  1998     4004001           4              4            141          863       225990          225127     10041157.05\n3        1999  1998     4004001           4              4            141        43478       225990          182512      8233112.27\n4        1999  1998     4004001           4              4            141        91199       225990          134791      6186061.67\n5        2003  1998     4004001           4              4            141         1382       225990          224608     10034107.71\n6        1998  1998     4004001           4              4            141        88491       225990          137499      6209922.67\n7        1999  1998     4004001           4              4            141        45964       225990          180026      8059408.19\n8        1998  1998     4004001           4              4            141       134201       225990           91789      4163695.98\n9        1998  1998     4004001           4              4            141        42116       225990          183874      8235501.79\n10       1999  1998     4004001           4              4            141        43890       225990          182100      8324295.35\n11       1999  1998     4004001           4              4            141        47355       225990          178635      7945513.53\n12       2003  1998     4004001           4              4            141          837       225990          225153     10060566.43\n13       2003  1998     4004001           4              4            141          879       225990          225111     10063422.20\n14       2003  1998     4004001           4              4            141          839       225990          225151     10063866.20\n15       2003  1998     4004001           4              4            141         1409       225990          224581     10051279.54\n16       2003  1998     4004001           4              4            141         1443       225990          224547     10037072.33\n17       2000  1998     4004001           4              4            141        44938       225990          181052      8143903.82\n18       1998  1998     4004001           4              4            141        42578       225990          183412      8252786.89\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.062599,
                    "execution_time": 0.008284,
                    "compile_time": 0.043195,
                    "planning_time": 0.004588
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.357709,
                    "execution_time": 0.009138,
                    "compile_time": 3.298029,
                    "planning_time": 0.040224
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2003  1998     4004001           4              4            141          682       225990          225308     10066463.75\n1        2003  1998     4004001           4              4            141         1137       225990          224853     10047328.44\n2        2003  1998     4004001           4              4            141          863       225990          225127     10041157.05\n3        1999  1998     4004001           4              4            141        43478       225990          182512      8233112.27\n4        1999  1998     4004001           4              4            141        91199       225990          134791      6186061.67\n5        2003  1998     4004001           4              4            141         1382       225990          224608     10034107.71\n6        1998  1998     4004001           4              4            141        88491       225990          137499      6209922.67\n7        1999  1998     4004001           4              4            141        45964       225990          180026      8059408.19\n8        1998  1998     4004001           4              4            141       134201       225990           91789      4163695.98\n9        1998  1998     4004001           4              4            141        42116       225990          183874      8235501.79\n10       1999  1998     4004001           4              4            141        43890       225990          182100      8324295.35\n11       1999  1998     4004001           4              4            141        47355       225990          178635      7945513.53\n12       2003  1998     4004001           4              4            141          837       225990          225153     10060566.43\n13       2003  1998     4004001           4              4            141          879       225990          225111     10063422.20\n14       2003  1998     4004001           4              4            141          839       225990          225151     10063866.20\n15       2003  1998     4004001           4              4            141         1409       225990          224581     10051279.54\n16       2003  1998     4004001           4              4            141         1443       225990          224547     10037072.33\n17       2000  1998     4004001           4              4            141        44938       225990          181052      8143903.82\n18       1998  1998     4004001           4              4            141        42578       225990          183412      8252786.89\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n1        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n2        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n3        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n4        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n5        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n6        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n7        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n8        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n9        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n10       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n11       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n12       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n13       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n14       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n15       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n16       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n17       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n18       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.075182,
                    "execution_time": 0.020074,
                    "compile_time": 0.037946,
                    "planning_time": 0.006815
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.379031,
                    "execution_time": 0.019855,
                    "compile_time": 3.291837,
                    "planning_time": 0.042507
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n1        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n2        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n3        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n4        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n5        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n6        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n7        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n8        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n9        1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n10       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n11       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n12       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n13       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n14       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n15       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n16       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n17       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n18       1998  1998     4004001           4              4            141        44462       225990          181528      8226100.64\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n1        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n2        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n3        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n4        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n5        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n6        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n7        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n8        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n9        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n10       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n11       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n12       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n13       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n14       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n15       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n16       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n17       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n18       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.034277,
                    "execution_time": 0.01694,
                    "compile_time": 0.000118,
                    "planning_time": 0.007293
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.605686,
                    "execution_time": 0.018073,
                    "compile_time": 3.530139,
                    "planning_time": 0.043094
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n1        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n2        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n3        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n4        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n5        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n6        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n7        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n8        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n9        2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n10       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n11       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n12       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n13       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n14       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n15       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n16       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n17       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n18       2003  1998     4004001           4              4            141          402       225990          225588     10086545.41\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.418672,
                    "execution_time": 0.063577,
                    "compile_time": 0.258049,
                    "planning_time": 0.009424,
                    "create_size": 507
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.376341,
                    "execution_time": 0.072092,
                    "compile_time": 10.141394,
                    "planning_time": 0.065743,
                    "create_size": 507
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_15\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  2000     4004001           4              4            141       225990       180453          -45537     -2107305.32\n1        1998  2000     4004001           4              4            202       135615        93183          -42432     -1983761.22\n2        1998  2000     4001001           1              4            340       184989       139052          -45937     -2074500.81\n3        1998  2000     4002001           2              4            567       185299        47194         -138105     -5810334.53\n4        1998  2000     4004001           4              4            244        92284          499          -91785     -3903461.58\n5        1998  2000     4004001           4              4            991        46653          217          -46436     -2144220.70\n6        1998  2000     4003001           3              4            139        87151        92359            5208       413336.99\n7        1998  2000     4002002           2              4            232        43218        44471            1253        12467.30\n8        1998  2000     4004001           4              4            597        91663        89313           -2350      -149327.88\n9        1998  2000     4002001           2              4            113       263883       176731          -87152     -3914077.90\n10       1998  2000     4004001           4              4            543        86343          182          -86161     -3617950.25\n11       1998  2000     4004001           4              4            138       133664        90388          -43276     -1931679.82\n12       1998  2000     4001001           1              4            351       178854        93180          -85674     -3475152.88\n13       1998  2000     4003001           3              4            215       177089        94635          -82454     -3508545.22\n14       1998  2000     4004001           4              4            748        44769        45665             896      -104179.56\n15       1998  2000     4001001           1              4             56       140196        91806          -48390     -2086572.79\n16       1998  2000     4001001           1              4             44       306998        95769         -211229     -9016887.20\n17       1998  2000     4001001           1              4            395       132153        48013          -84140     -3538558.01\n18       1998  2000     4002002           2              4            107       132275       184276           52001      2335080.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019319,
                    "execution_time": 0.007962,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004649
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.118341,
                    "execution_time": 0.007871,
                    "compile_time": 0.047242,
                    "planning_time": 0.053889
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_15\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  2000     4004001           4              4            141       225990       180453          -45537     -2107305.32\n1        1998  2000     4004001           4              4            202       135615        93183          -42432     -1983761.22\n2        1998  2000     4001001           1              4            340       184989       139052          -45937     -2074500.81\n3        1998  2000     4002001           2              4            567       185299        47194         -138105     -5810334.53\n4        1998  2000     4004001           4              4            244        92284          499          -91785     -3903461.58\n5        1998  2000     4004001           4              4            991        46653          217          -46436     -2144220.70\n6        1998  2000     4003001           3              4            139        87151        92359            5208       413336.99\n7        1998  2000     4002002           2              4            232        43218        44471            1253        12467.30\n8        1998  2000     4004001           4              4            597        91663        89313           -2350      -149327.88\n9        1998  2000     4002001           2              4            113       263883       176731          -87152     -3914077.90\n10       1998  2000     4004001           4              4            543        86343          182          -86161     -3617950.25\n11       1998  2000     4004001           4              4            138       133664        90388          -43276     -1931679.82\n12       1998  2000     4001001           1              4            351       178854        93180          -85674     -3475152.88\n13       1998  2000     4003001           3              4            215       177089        94635          -82454     -3508545.22\n14       1998  2000     4004001           4              4            748        44769        45665             896      -104179.56\n15       1998  2000     4001001           1              4             56       140196        91806          -48390     -2086572.79\n16       1998  2000     4001001           1              4             44       306998        95769         -211229     -9016887.20\n17       1998  2000     4001001           1              4            395       132153        48013          -84140     -3538558.01\n18       1998  2000     4002002           2              4            107       132275       184276           52001      2335080.72\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_15\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_15\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"PREV_YR\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 8.210408,
                    "execution_time": 7.709151,
                    "compile_time": 0.000563,
                    "planning_time": 0.007018,
                    "create_size": 9985
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.969562,
                    "execution_time": 7.86832,
                    "compile_time": 3.519333,
                    "planning_time": 0.064609,
                    "create_size": 9985
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_16\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_16\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n1        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n2        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n3        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n4        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n5        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n6        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n7        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n8        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n9        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n10       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n11       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n12       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n13       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n14       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n15       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n16       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n17       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n18       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020319,
                    "execution_time": 0.009007,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.00471
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058159,
                    "execution_time": 0.008702,
                    "compile_time": 5e-05,
                    "planning_time": 0.040248
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_16\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_16\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n1        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n2        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n3        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n4        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n5        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n6        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n7        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n8        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n9        2000  2000     4001002           1              4            583        88711        88711               0             0.0\n10       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n11       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n12       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n13       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n14       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n15       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n16       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n17       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n18       2000  2000     4001002           1              4            583        88711        88711               0             0.0\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.248811,
                    "execution_time": 0.049271,
                    "compile_time": 0.152452,
                    "planning_time": 0.011609,
                    "create_size": 52
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.799324,
                    "execution_time": 0.052446,
                    "compile_time": 6.632049,
                    "planning_time": 0.070454,
                    "create_size": 52
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4              7        89527        46347          -43180     -1948368.30\n1        1999  2000     4004001           4              4             47       139806        46152          -93654     -3982432.68\n2        1999  2000     4002001           2              4            636        93267        47540          -45727     -1899917.95\n3        1999  2000     4004001           4              4            262       138458        45897          -92561     -4026915.34\n4        1999  2000     4001001           1              4            653       133134        47671          -85463     -3750218.25\n5        1999  2000     4004001           4              4            306       228269        46687         -181582     -7940791.21\n6        1999  2000     4001001           1              4            165       182389        91278          -91111     -3941907.95\n7        1999  2000     4003001           3              4            407       135587        45417          -90170     -4072772.43\n8        1999  2000     4004001           4              4            273       136191        91007          -45184     -1987348.10\n9        1999  2000     4003001           3              4            216       179905        44351         -135554     -5772582.27\n10       1999  2000     4003001           3              4            284       178728        93250          -85478     -3918000.76\n11       1999  2000     4002001           2              4            574       137832        45571          -92261     -4026088.83\n12       1999  2000     4002001           2              4            554       139230        93103          -46127     -1879017.68\n13       1999  2000     4001001           1              4            159        89526        43676          -45850     -2038449.14\n14       1999  2000     4003001           3              4            188       178942        44859         -134083     -5911439.43\n15       1999  2000     4003001           3              4            588        86266        45107          -41159     -1691187.72\n16       1999  2000     4002001           2              4            474        91421        45278          -46143     -2030494.90\n17       1999  2000     4001001           1              4            976        92071        47419          -44652     -1990161.65\n18       1999  2000     4003001           3              4            371        89250        45926          -43324     -1767325.99\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01844,
                    "execution_time": 0.0075,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004357
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056687,
                    "execution_time": 0.007706,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.04009
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4              7        89527        46347          -43180     -1948368.30\n1        1999  2000     4004001           4              4             47       139806        46152          -93654     -3982432.68\n2        1999  2000     4002001           2              4            636        93267        47540          -45727     -1899917.95\n3        1999  2000     4004001           4              4            262       138458        45897          -92561     -4026915.34\n4        1999  2000     4001001           1              4            653       133134        47671          -85463     -3750218.25\n5        1999  2000     4004001           4              4            306       228269        46687         -181582     -7940791.21\n6        1999  2000     4001001           1              4            165       182389        91278          -91111     -3941907.95\n7        1999  2000     4003001           3              4            407       135587        45417          -90170     -4072772.43\n8        1999  2000     4004001           4              4            273       136191        91007          -45184     -1987348.10\n9        1999  2000     4003001           3              4            216       179905        44351         -135554     -5772582.27\n10       1999  2000     4003001           3              4            284       178728        93250          -85478     -3918000.76\n11       1999  2000     4002001           2              4            574       137832        45571          -92261     -4026088.83\n12       1999  2000     4002001           2              4            554       139230        93103          -46127     -1879017.68\n13       1999  2000     4001001           1              4            159        89526        43676          -45850     -2038449.14\n14       1999  2000     4003001           3              4            188       178942        44859         -134083     -5911439.43\n15       1999  2000     4003001           3              4            588        86266        45107          -41159     -1691187.72\n16       1999  2000     4002001           2              4            474        91421        45278          -46143     -2030494.90\n17       1999  2000     4001001           1              4            976        92071        47419          -44652     -1990161.65\n18       1999  2000     4003001           3              4            371        89250        45926          -43324     -1767325.99\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SALES_CNT_DIFF\" , \"SALES_AMT_DIFF\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325       351698         2535         -349163    -15255997.76\n1        1999  2000     4002001           2              4            145       408751        91398         -317353    -14166575.82\n2        1999  2000     4004001           4              4            304       314394         1529         -312865    -13898275.76\n3        1999  2000     4001001           1              4             25       354045        45907         -308138    -13463033.97\n4        1999  2000     4004001           4              4              1       417733       134412         -283321    -12583075.83\n5        1999  2000     4003001           3              4            115       358864        90036         -268828    -11386522.58\n6        1999  2000     4003001           3              4            297       324997        88444         -236553    -10611909.54\n7        1999  2000     4003001           3              4              3       321055        92014         -229041    -10099088.78\n8        1999  2000     4002001           2              4            295       230073         1669         -228404     -9695025.07\n9        1999  2000     4004001           4              4            609       229050          894         -228156     -9715757.06\n10       1999  2000     4004001           4              4            147       228900          807         -228093     -9990692.95\n11       1999  2000     4003001           3              4            177       226195          717         -225478     -9843496.87\n12       1999  2000     4003001           3              4            158       359142       133989         -225153     -9990871.10\n13       1999  2000     4003001           3              4             36       362084       137530         -224554    -10138594.29\n14       1999  2000     4004001           4              4             32       224346         1344         -223002     -9720783.61\n15       1999  2000     4004001           4              4            186       267654        48094         -219560     -9725809.91\n16       1999  2000     4001001           1              4             44       310661        95769         -214892     -9223137.33\n17       1999  2000     4003001           3              4            331       263297        49116         -214181     -9466429.60\n18       1999  2000     4001001           1              4             48       307029        95312         -211717     -9347024.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.036853,
                    "execution_time": 0.009258,
                    "compile_time": 0.016268,
                    "planning_time": 0.004724
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.350255,
                    "execution_time": 0.013316,
                    "compile_time": 3.296083,
                    "planning_time": 0.040401
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST"
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325       351698         2535         -349163    -15255997.76\n1        1999  2000     4002001           2              4            145       408751        91398         -317353    -14166575.82\n2        1999  2000     4004001           4              4            304       314394         1529         -312865    -13898275.76\n3        1999  2000     4001001           1              4             25       354045        45907         -308138    -13463033.97\n4        1999  2000     4004001           4              4              1       417733       134412         -283321    -12583075.83\n5        1999  2000     4003001           3              4            115       358864        90036         -268828    -11386522.58\n6        1999  2000     4003001           3              4            297       324997        88444         -236553    -10611909.54\n7        1999  2000     4003001           3              4              3       321055        92014         -229041    -10099088.78\n8        1999  2000     4002001           2              4            295       230073         1669         -228404     -9695025.07\n9        1999  2000     4004001           4              4            609       229050          894         -228156     -9715757.06\n10       1999  2000     4004001           4              4            147       228900          807         -228093     -9990692.95\n11       1999  2000     4003001           3              4            177       226195          717         -225478     -9843496.87\n12       1999  2000     4003001           3              4            158       359142       133989         -225153     -9990871.10\n13       1999  2000     4003001           3              4             36       362084       137530         -224554    -10138594.29\n14       1999  2000     4004001           4              4             32       224346         1344         -223002     -9720783.61\n15       1999  2000     4004001           4              4            186       267654        48094         -219560     -9725809.91\n16       1999  2000     4001001           1              4             44       310661        95769         -214892     -9223137.33\n17       1999  2000     4003001           3              4            331       263297        49116         -214181     -9466429.60\n18       1999  2000     4001001           1              4             48       307029        95312         -211717     -9347024.12\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SALES_CNT_DIFF\" , \"SALES_AMT_DIFF\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325       351698         2535         -349163    -15255997.76\n1        1999  2000     4002001           2              4            145       408751        91398         -317353    -14166575.82\n2        1999  2000     4004001           4              4            304       314394         1529         -312865    -13898275.76\n3        1999  2000     4001001           1              4             25       354045        45907         -308138    -13463033.97\n4        1999  2000     4004001           4              4              1       417733       134412         -283321    -12583075.83\n5        1999  2000     4003001           3              4            115       358864        90036         -268828    -11386522.58\n6        1999  2000     4003001           3              4            297       324997        88444         -236553    -10611909.54\n7        1999  2000     4003001           3              4              3       321055        92014         -229041    -10099088.78\n8        1999  2000     4002001           2              4            295       230073         1669         -228404     -9695025.07\n9        1999  2000     4004001           4              4            609       229050          894         -228156     -9715757.06\n10       1999  2000     4004001           4              4            147       228900          807         -228093     -9990692.95\n11       1999  2000     4003001           3              4            177       226195          717         -225478     -9843496.87\n12       1999  2000     4003001           3              4            158       359142       133989         -225153     -9990871.10\n13       1999  2000     4003001           3              4             36       362084       137530         -224554    -10138594.29\n14       1999  2000     4004001           4              4             32       224346         1344         -223002     -9720783.61\n15       1999  2000     4004001           4              4            186       267654        48094         -219560     -9725809.91\n16       1999  2000     4001001           1              4             44       310661        95769         -214892     -9223137.33\n17       1999  2000     4003001           3              4            331       263297        49116         -214181     -9466429.60\n18       1999  2000     4001001           1              4             48       307029        95312         -211717     -9347024.12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021871,
                    "execution_time": 0.01028,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004825
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019706,
                    "execution_time": 0.008364,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004745
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325       351698         2535         -349163    -15255997.76\n1        1999  2000     4002001           2              4            145       408751        91398         -317353    -14166575.82\n2        1999  2000     4004001           4              4            304       314394         1529         -312865    -13898275.76\n3        1999  2000     4001001           1              4             25       354045        45907         -308138    -13463033.97\n4        1999  2000     4004001           4              4              1       417733       134412         -283321    -12583075.83\n5        1999  2000     4003001           3              4            115       358864        90036         -268828    -11386522.58\n6        1999  2000     4003001           3              4            297       324997        88444         -236553    -10611909.54\n7        1999  2000     4003001           3              4              3       321055        92014         -229041    -10099088.78\n8        1999  2000     4002001           2              4            295       230073         1669         -228404     -9695025.07\n9        1999  2000     4004001           4              4            609       229050          894         -228156     -9715757.06\n10       1999  2000     4004001           4              4            147       228900          807         -228093     -9990692.95\n11       1999  2000     4003001           3              4            177       226195          717         -225478     -9843496.87\n12       1999  2000     4003001           3              4            158       359142       133989         -225153     -9990871.10\n13       1999  2000     4003001           3              4             36       362084       137530         -224554    -10138594.29\n14       1999  2000     4004001           4              4             32       224346         1344         -223002     -9720783.61\n15       1999  2000     4004001           4              4            186       267654        48094         -219560     -9725809.91\n16       1999  2000     4001001           1              4             44       310661        95769         -214892     -9223137.33\n17       1999  2000     4003001           3              4            331       263297        49116         -214181     -9466429.60\n18       1999  2000     4001001           1              4             48       307029        95312         -211717     -9347024.12\n...*/"
    }
]