[
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n group by a.ca_state/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 30,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\ngroup by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.658342,
                    "execution_time": 2.480183,
                    "compile_time": 0.091909,
                    "planning_time": 0.052351,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.483178,
                    "execution_time": 2.515488,
                    "compile_time": 11.789892,
                    "planning_time": 0.143458,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   state      cnt\n0     ND  4493554\n1     AR  6243373\n2     MO  9175935\n3     WV  4657407\n4     IA  8240655\n5     SD  5514500\n6     WY  1936864\n7     RI   441872\n8     CT   676433\n9     IL  8427555\n10    WI  5946980\n11    MN  7185954\n12    IN  7596366\n13    NH   838245\n14    CO  5299348\n15    FL  5396667\n16    AK  1903571\n17    ID  3644036\n18    UT  2427656\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032896,
                    "execution_time": 0.007279,
                    "compile_time": 0.016802,
                    "planning_time": 0.003047
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.103668,
                    "execution_time": 0.007545,
                    "compile_time": 3.050221,
                    "planning_time": 0.037822
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   state      cnt\n0     ND  4493554\n1     AR  6243373\n2     MO  9175935\n3     WV  4657407\n4     IA  8240655\n5     SD  5514500\n6     WY  1936864\n7     RI   441872\n8     CT   676433\n9     IL  8427555\n10    WI  5946980\n11    MN  7185954\n12    IN  7596366\n13    NH   838245\n14    CO  5299348\n15    FL  5396667\n16    AK  1903571\n17    ID  3644036\n18    UT  2427656\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,date_dim d\n where       a.ca_address_sk = d.d_date_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n/*CURSOR_IDENTIFIER*/)\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101545,
                    "execution_time": 0.037536,
                    "compile_time": 0.016502,
                    "planning_time": 0.024137,
                    "create_size": 16
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.317574,
                    "execution_time": 0.14912,
                    "compile_time": 3.054818,
                    "planning_time": 0.087056,
                    "create_size": 16
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.133334,
                    "execution_time": 0.060177,
                    "compile_time": 0.01388,
                    "planning_time": 0.032874,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.658234,
                    "execution_time": 0.061511,
                    "compile_time": 3.472738,
                    "planning_time": 0.099945,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016856,
                    "execution_time": 0.007038,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004176
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.095757,
                    "execution_time": 0.007265,
                    "compile_time": 0.04415,
                    "planning_time": 0.038556
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "select /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.110234,
                    "execution_time": 0.032068,
                    "compile_time": 0.028638,
                    "planning_time": 0.02599,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.430012,
                    "execution_time": 0.032201,
                    "compile_time": 3.283739,
                    "planning_time": 0.086946,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.202569,
                    "execution_time": 1.936757,
                    "compile_time": 0.174417,
                    "planning_time": 0.060268,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 20.636676,
                    "execution_time": 4.794174,
                    "compile_time": 15.665412,
                    "planning_time": 0.134936,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   state      cnt\n0     TN  1627548\n1     OH  1469575\n2     CA   983234\n3     NV   294341\n4     HI    68383\n5     MI  1356466\n6     NJ   348948\n7     KY  2010742\n8     MA   232672\n9     NE  1588805\n10    MD   382392\n11    DE    49816\n12    AL  1110585\n13    ME   274906\n14    NY  1012587\n15    VT   233762\n16    NM   541524\n17    GA  2659823\n18    AZ   252879\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016348,
                    "execution_time": 0.00752,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003016
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050607,
                    "execution_time": 0.007122,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.037705
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   state      cnt\n0     TN  1627548\n1     OH  1469575\n2     CA   983234\n3     NV   294341\n4     HI    68383\n5     MI  1356466\n6     NJ   348948\n7     KY  2010742\n8     MA   232672\n9     NE  1588805\n10    MD   382392\n11    DE    49816\n12    AL  1110585\n13    ME   274906\n14    NY  1012587\n15    VT   233762\n16    NM   541524\n17    GA  2659823\n18    AZ   252879\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119673,
                    "execution_time": 0.031704,
                    "compile_time": 0.037868,
                    "planning_time": 0.026858,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.477664,
                    "execution_time": 0.033416,
                    "compile_time": 3.32996,
                    "planning_time": 0.088283,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.311119,
                    "execution_time": 0.169591,
                    "compile_time": 0.049989,
                    "planning_time": 0.055748,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.279648,
                    "execution_time": 0.256578,
                    "compile_time": 5.846493,
                    "planning_time": 0.136649,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   state     cnt\n0     OH   68133\n1     CA   45958\n2     NV   14108\n3     HI    3256\n4     MI   63936\n5     TN   76515\n6     NJ   16477\n7     KY   93398\n8     MA   11093\n9     NE   75290\n10    DE    2158\n11    NY   47533\n12    ME   13470\n13    MD   18530\n14    NM   25724\n15    VT   11205\n16    TX  204674\n17    VA  106591\n18    MS   66086\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015619,
                    "execution_time": 0.00697,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003042
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056704,
                    "execution_time": 0.007147,
                    "compile_time": 4e-05,
                    "planning_time": 0.043924
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   state     cnt\n0     OH   68133\n1     CA   45958\n2     NV   14108\n3     HI    3256\n4     MI   63936\n5     TN   76515\n6     NJ   16477\n7     KY   93398\n8     MA   11093\n9     NE   75290\n10    DE    2158\n11    NY   47533\n12    ME   13470\n13    MD   18530\n14    NM   25724\n15    VT   11205\n16    TX  204674\n17    VA  106591\n18    MS   66086\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * i.i_current_price\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.213102,
                    "execution_time": 0.048045,
                    "compile_time": 0.073905,
                    "planning_time": 0.057793,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.78077,
                    "execution_time": 0.52114,
                    "compile_time": 6.080967,
                    "planning_time": 0.141624,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017028,
                    "execution_time": 0.007528,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004051
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051769,
                    "execution_time": 0.007513,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.03859
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n              from item j)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"_U_1\" AS \"_U_1\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.102394,
                    "execution_time": 0.03602,
                    "compile_time": 0.016158,
                    "planning_time": 0.025326,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.231024,
                    "execution_time": 0.034779,
                    "compile_time": 3.079641,
                    "planning_time": 0.08846,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" = 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.256639,
                    "execution_time": 0.0617,
                    "compile_time": 0.100147,
                    "planning_time": 0.059957,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.683307,
                    "execution_time": 0.068313,
                    "compile_time": 6.43531,
                    "planning_time": 0.140754,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017629,
                    "execution_time": 0.007744,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004126
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052492,
                    "execution_time": 0.007625,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038995
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j)\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"_U_1\" AS \"_U_1\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016686,
                    "execution_time": 0.006884,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004161
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051337,
                    "execution_time": 0.00705,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.0387
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.283656,
                    "execution_time": 0.037531,
                    "compile_time": 0.196215,
                    "planning_time": 0.025086,
                    "create_size": 50
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.19925,
                    "execution_time": 0.612342,
                    "compile_time": 6.469678,
                    "planning_time": 0.086192,
                    "create_size": 50
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.271953,
                    "execution_time": 0.09803,
                    "compile_time": 0.067609,
                    "planning_time": 0.068712,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.696041,
                    "execution_time": 0.09877,
                    "compile_time": 6.401524,
                    "planning_time": 0.153036,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   state    cnt\n0     TX  20167\n1     OH   6694\n2     MI   6193\n3     CA   4521\n4     NV   1366\n5     HI    328\n6     TN   7635\n7     KY   9122\n8     MA   1087\n9     NJ   1645\n10    NE   7548\n11    NY   4676\n12    ME   1335\n13    DE    233\n14    AL   5210\n15    VT   1101\n16    LA   4319\n17    VA  10482\n18    MS   6503\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016018,
                    "execution_time": 0.00737,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003051
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050817,
                    "execution_time": 0.007599,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.037529
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   state    cnt\n0     TX  20167\n1     OH   6694\n2     MI   6193\n3     CA   4521\n4     NV   1366\n5     HI    328\n6     TN   7635\n7     KY   9122\n8     MA   1087\n9     NJ   1645\n10    NE   7548\n11    NY   4676\n12    ME   1335\n13    DE    233\n14    AL   5210\n15    VT   1101\n16    LA   4319\n17    VA  10482\n18    MS   6503\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   state   cnt\n0     ND  4306\n1     AR  5854\n2     MO  8347\n3     WV  4468\n4     WY  1880\n5     IA  7827\n6     SD  4998\n7     RI   399\n8     CT   633\n9     IL  7621\n10    WI  5491\n11    MN  6669\n12    FL  5102\n13    CO  4900\n14    IN  7243\n15    NH   758\n16    ID  3273\n17    UT  2365\n18    OK  6082\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015438,
                    "execution_time": 0.006976,
                    "compile_time": 4e-05,
                    "planning_time": 0.002929
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050733,
                    "execution_time": 0.007164,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.037697
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT * FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   state   cnt\n0     ND  4306\n1     AR  5854\n2     MO  8347\n3     WV  4468\n4     WY  1880\n5     IA  7827\n6     SD  4998\n7     RI   399\n8     CT   633\n9     IL  7621\n10    WI  5491\n11    MN  6669\n12    FL  5102\n13    CO  4900\n14    IN  7243\n15    NH   758\n16    ID  3273\n17    UT  2365\n18    OK  6082\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.305777,
                    "execution_time": 0.129035,
                    "compile_time": 0.066527,
                    "planning_time": 0.070984,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.650973,
                    "execution_time": 0.12931,
                    "compile_time": 3.329568,
                    "planning_time": 0.150888,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   state   cnt\n0     ND  4306\n1     WY  1880\n2     IA  7827\n3     SD  4998\n4     MN  6669\n5     WI  5491\n6     FL  5102\n7     CO  4900\n8     ID  3273\n9     PA  5365\n10    OH  6694\n11    CA  4521\n12    NV  1366\n13    HI   328\n14    TN  7635\n15    NJ  1645\n16    KY  9122\n17    MA  1087\n18    NE  7548\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015967,
                    "execution_time": 0.007071,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003123
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051473,
                    "execution_time": 0.007763,
                    "compile_time": 4e-05,
                    "planning_time": 0.037915
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   state   cnt\n0     ND  4306\n1     WY  1880\n2     IA  7827\n3     SD  4998\n4     MN  6669\n5     WI  5491\n6     FL  5102\n7     CO  4900\n8     ID  3273\n9     PA  5365\n10    OH  6694\n11    CA  4521\n12    NV  1366\n13    HI   328\n14    TN  7635\n15    NJ  1645\n16    KY  9122\n17    MA  1087\n18    NE  7548\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 21",
                "preview": "\n/*   state   cnt\n0     DC    72\n1     DE   233\n2     HI   328\n3     RI   399\n4     CT   633\n5     NH   758\n6     MA  1087\n7     VT  1101\n8     AZ  1245\n9     ME  1335\n10    NV  1366\n11    NJ  1645\n12    AK  1823\n13    MD  1873\n14    WY  1880\n15    UT  2365\n16    NM  2536\n17    OR  2868\n18    WA  3198\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.037073,
                    "execution_time": 0.008179,
                    "compile_time": 0.019868,
                    "planning_time": 0.003368
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.264728,
                    "execution_time": 0.008875,
                    "compile_time": 3.213527,
                    "planning_time": 0.038671
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   state   cnt\n0     DC    72\n1     DE   233\n2     HI   328\n3     RI   399\n4     CT   633\n5     NH   758\n6     MA  1087\n7     VT  1101\n8     AZ  1245\n9     ME  1335\n10    NV  1366\n11    NJ  1645\n12    AK  1823\n13    MD  1873\n14    WY  1880\n15    UT  2365\n16    NM  2536\n17    OR  2868\n18    WA  3198\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 21",
                "preview": "\n/*   state   cnt\n0     DC    72\n1     DE   233\n2     HI   328\n3     RI   399\n4     CT   633\n5     NH   758\n6     MA  1087\n7     VT  1101\n8     AZ  1245\n9     ME  1335\n10    NV  1366\n11    NJ  1645\n12    AK  1823\n13    MD  1873\n14    WY  1880\n15    UT  2365\n16    NM  2536\n17    OR  2868\n18    WA  3198\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017713,
                    "execution_time": 0.008717,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.003341
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018177,
                    "execution_time": 0.008876,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003417
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   state   cnt\n0     DC    72\n1     DE   233\n2     HI   328\n3     RI   399\n4     CT   633\n5     NH   758\n6     MA  1087\n7     VT  1101\n8     AZ  1245\n9     ME  1335\n10    NV  1366\n11    NJ  1645\n12    AK  1823\n13    MD  1873\n14    WY  1880\n15    UT  2365\n16    NM  2536\n17    OR  2868\n18    WA  3198\n...*/"
    }
]